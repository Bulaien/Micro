(function() {
  window._satellite = window._satellite || {};
  window._satellite.container = {
  "buildInfo": {
    "buildDate": "2023-05-01T20:10:15Z",
    "turbineBuildDate": "2023-02-22T20:37:26Z",
    "turbineVersion": "27.5.0"
  },
  "environment": {
    "id": "ENf7805d09fd1b455883333cdf34ee4ca2",
    "stage": "production"
  },
  "dataElements": {
    "isSurfacePDP": {
      "modulePath": "core/src/lib/dataElements/customCode.js",
      "settings": {
        "source": function() {
  var dPDPs = new RegExp("/d/surface");
var pPDPs = new RegExp("/p/surface");
return dPDPs.test(window.location.pathname.toLowerCase()) || pPDPs.test(window.location.pathname.toLowerCase());
}
      }
    },
    "isSurfaceCategory": {
      "modulePath": "core/src/lib/dataElements/cookie.js",
      "settings": {
        "name": "test"
      }
    },
    "isSurfaceBusiness": {
      "modulePath": "core/src/lib/dataElements/customCode.js",
      "settings": {
        "source": function() {
  var surfaceForBusiness = new RegExp("store/b/surfaceforbusiness");
return surfaceForBusiness.test(window.location.pathname.toLowerCase());
}
      }
    },
    "PageInfo": {
      "modulePath": "core/src/lib/dataElements/customCode.js",
      "settings": {
        "source": function() {
  // JavaScript source code
try {
	var page = {
		pagename: "other",
		pageName: "other",
		pageType: "other",
		path: window.location.pathname.toLowerCase(),
		reflc: "",
		muid: "",
		pT: "",
		logRuleCall: function (r, d, i) {
			if (typeof _TMutils === 'object') {
				_TMutils.logRuleCall(r, d, i);
			} else {
				try {
					_satellite.logger.error("error in logging and no _satellite obj");
				} catch (_saterr) { }
			}
		},
		getQSParam: function (arr, param2find) {
			var n,
				i = 0,
				j = arr.length,
				nvpair = [];
			for (i = 0; i < j; i++) {
				nvpair = arr[i].split("=");
				if (nvpair[0].toLowerCase() == param2find.toLowerCase() && nvpair[1]) {
					return nvpair[1];
				}
			}
			return "";
		},
		readCookie: function (name) {
			var nameEQ = name + "=";
			var ca = document.cookie.split(';');
			for (var i = 0; i < ca.length; i++) {
				var c = ca[i];
				while (c.charAt(0) == ' ') c = c.substring(1, c.length);
				if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length, c.length);
			}
			return null;
		},
		createCookie: function (name, value, days) {
			var expires = "";
			var date;
			var domainstr = (~window.location.host.indexOf("microsoft.com")) ? "; domain=.microsoft.com; path=/; " : "; path=/; ";
			if (days) {
				date = new Date();
				date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
				expires = "; expires=" + date.toGMTString();
			}
			document.cookie = name + "=" + value + expires + domainstr;
		}
	};

	var qs = "",
		qsarr = [],
		pt,
		ptlower,
		_pagetypemap = {}
		;

	if (document.referrer) {
		reflc = document.referrer.toLowerCase();
	}

	qs = (window.location.search) ? window.location.search : "";
	if (qs.indexOf("?n=ensighten.html?") == 0) {
		qs = qs.substring(17);
	}
	if (qs.indexOf("?") == 0) {
		qs = qs.substring(1);
	}
	qs = qs.replace(/%20&%20/g, "%20%26%20");
	qs = qs.replace(/ & /g, "%20%26%20");
	qsarr = qs.split("&");


	if (~window.location.host.indexOf("compass-ssl.xboxlive.com") || ~window.location.host.indexOf("query.prod.cms.rt.microsoft.com")) {
		// top level params from iframe:  pN=cart&cl=en-US&market=US
		page.muid = page.getQSParam(qsarr, "muid");
		page.pageName = page.getQSParam(qsarr, "pN");
		page.pageType = page.pageName;
	} else if (typeof _pageBITags == "object") {
		// consume _pageBITags object from the non-iframe pages (e.g. OneRF)
		pt = _pageBITags.pageTags;
		ptlower = pt.pageType.toLowerCase();

		page.pageName = pt.pageName;
		page.pageType = pt.pageType;

		try {
			page.muid = page.readCookie("MUID");
		} catch (muiderr) { page.logRuleCall("muid err"); }

		if ((~ptlower.indexOf("pdp") || ~ptlower.indexOf("detail")) && ~page.path.indexOf("/configure/")) {
			ptlower = "configure";
			page.pageType = "configure";
		}
	}

	try {
		// remap pagetypes
		_pagetypemap = {
			// old : new
			"pdp": "detail",
			"product details": "detail",
			"sfw-pdp-pagetemplate": "detail",
			"sfw-category-pagetemplate": "category",
			"onestore-shoppingcart-template": "cart",
			"congrats": "receipt"
		};

		if (_pagetypemap[page.pageType.toLowerCase()]) {
			page.pageType = _pagetypemap[page.pageType.toLowerCase()];
		}

		page.pT = (page.pageType == "receipt") ? "rP" : page.pageType;

		// added 7/12/18 due to Convergence making category pagetype less reliable
		if (~window.location.pathname.indexOf("/b/") && window.location.pathname.indexOf("RETg7o") < 0) {
			page.pageType = "category";
		}

	} catch (err) { page.logRuleCall("pageTypeMapError", page.pageType); }

	page.pagename = page.pageName; // backwards compatibility for some tags
}
catch (err) { console.log("DataLayer: " + err.message); }

}
      }
    },
    "EventsHoliday": {
      "modulePath": "core/src/lib/dataElements/customCode.js",
      "settings": {
        "source": function() {
  var ehnsToAvoid = ["Extended free returns", "Pick the perfect gift with a product expert", "Fast, free shipping", "Our best price of the season", "90 days of free support", "60-day low price promise", "Free returns", "Free shipping"];
var usAndSingapore = 'div.card, ';
var div_enCa = 'div#coreui-contentplacement-f5d4afi, div#coreui-contentplacement-lzrgp5j, ';
var div_frca = 'div#coreui-contentplacement-h1khlym, div#coreui-contentplacement-y1o0trq, ';
var div_frfr = 'div#coreui-contentplacement-qxreqji, div#StoreLocations-HighlightHero-6ywe7ix div div div div ul, ';
var div_jajp = 'div#coreui-contentplacement-zlfss3q, div#coreui-hero-npd01s8 div div div ul, ';
var div_dede = 'div#coreui-contentplacement-a4imfpx, div#coreui-contentplacement-grqvg59, div#coreui-featurecollection-t1clixa div section ul, ';
var div_engb = 'div#coreui-contentplacement-fiqwvm2, div#coreui-contentplacement-bkhqr5t, div#coreui-contentplacement-ntwsdzm, ';
var div_enau = 'div#StoreLocations-HighlightHero-0qj0sa2, div#coreui-contentplacement-pwrxlcn, ';
var div_row = 'div.m-channel-placement a';
var allLocales = "" + usAndSingapore + div_enCa + div_frca + div_frfr + div_jajp + div_dede + div_engb + div_enau + div_row;

return allLocales;
}
      }
    },
    "LocationInfo": {
      "modulePath": "core/src/lib/dataElements/customCode.js",
      "settings": {
        "source": function() {
  // JavaScript source code
try {
	var location = {
		cc: "Unknown",
		geo: "",
		host: window.location.hostname.toLowerCase(),
		ll: "other",
		logRuleCall: function (r, d, i) {
			if (typeof _TMutils === 'object') {
				_TMutils.logRuleCall(r, d, i);
			} else {
				try {
					_satellite.logger.error("error in logging and no _satellite obj");
				} catch (_saterr) { }
			}
		},
		getQSParam: function (arr, param2find) {
			var n,
				i = 0,
				j = arr.length,
				nvpair = [];
			for (i = 0; i < j; i++) {
				nvpair = arr[i].split("=");
				if (nvpair[0].toLowerCase() == param2find.toLowerCase() && nvpair[1]) {
					return nvpair[1];
				}
			}
			return "";
		},
		readCookie: function (name) {
			var nameEQ = name + "=";
			var ca = document.cookie.split(';');
			for (var i = 0; i < ca.length; i++) {
				var c = ca[i];
				while (c.charAt(0) == ' ') c = c.substring(1, c.length);
				if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length, c.length);
			}
			return null;
		},
		createCookie: function (name, value, days) {
			var expires = "";
			var date;
			var domainstr = (~window.location.host.indexOf("microsoft.com")) ? "; domain=.microsoft.com; path=/; " : "; path=/; ";
			if (days) {
				date = new Date();
				date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
				expires = "; expires=" + date.toGMTString();
			}
			document.cookie = name + "=" + value + expires + domainstr;
		}
	};

	var qs = "",
		qsdecoded = "",
		qs2 = "",
		qsarr = [],
		jsonstr = "",
		jsonobj = {},
		jsonstr,
		pt,
		pc,
		ptlower,
		_pagetypemap = {}
		;

	qs = (window.location.search) ? window.location.search : "";
	if (qs.indexOf("?n=ensighten.html?") == 0) {
		qs = qs.substring(17);
	}
	if (qs.indexOf("?") == 0) {
		qs = qs.substring(1);
	}
	qs = qs.replace(/%20&%20/g, "%20%26%20");
	qs = qs.replace(/ & /g, "%20%26%20");
	qsarr = qs.split("&");


	if (~window.location.host.indexOf("compass-ssl.xboxlive.com") || ~window.location.host.indexOf("query.prod.cms.rt.microsoft.com")) {
		// top level params from iframe:  pN=cart&cl=en-US&market=US
		location.geo = location.getQSParam(qsarr, "market");
		location.ll = location.getQSParam(qsarr, "culture") || location.getQSParam(qsarr, "cl");

		// delete if no line item
		jsonstr = location.getQSParam(qsarr, "orderLineItems");

		if (!jsonstr) {
			location.logRuleCall("orderLineItems json missing");
		} else {
			try {
				if (jsonstr.indexOf("[") > -1) {
					jsonstr = jsonstr.replace(/%22%20Dis/g, '%20Dis');
					jsonstr = jsonstr.replace(/portable%2013%22%20/g, 'portable%2013%20');
					jsonstr = jsonstr.replace(/%22%204K/g, '%204K');
					jsonstr = jsonstr.replace(/%22Samsung%2049%22%20/g, '%22Samsung%2049%20');
					jsonstr = jsonstr.replace(/%22%2F/g, '%2F');
					jsonstr = jsonstr.replace(/5%22%20%2F/g, '5%2F');
					jsonstr = jsonstr.replace(/%223%2F4%22%20/g, '%223%2F4%20');
					jsonstr = jsonstr.replace(/15.6%22%20/g, '15.6%20');
					jsonstr = jsonstr.replace(/%22/g, '"');
					location.lineItems = JSON.parse(jsonstr);
				} else {
					jsonstr = jsonstr.replace(/%22%20Dis/g, '%20Dis');
					jsonstr = jsonstr.replace(/portable%2013%22%20/g, 'portable%2013%20');
					jsonstr = jsonstr.replace(/%22Samsung%2049%22%20/g, '%22Samsung%2049%20');
					jsonstr = jsonstr.replace(/%22%204K/g, '%204K');
					jsonstr = jsonstr.replace(/%22%2F/g, '%2F');
					jsonstr = jsonstr.replace(/5%22%20%2F/g, '5%2F');
					jsonstr = jsonstr.replace(/%223%2F4%22%20/g, '%223%2F4%20');
					jsonstr = jsonstr.replace(/15.6%22%20/g, '15.6%20');
					location.lineItems = JSON.parse(decodeURIComponent(jsonstr));
				}
			} catch (jsonparseerr) { location.logRuleCall("jsonparse error", "jsonparse error", window.location.search); _satellite.logger.error("jsonparse error"); }
		}
	} else if (typeof _pageBITags == "object") {
		// consume _pageBITags object from the non-iframe pages (e.g. OneRF)
		pt = _pageBITags.pageTags;
		ptlower = pt.pageType.toLowerCase();

		location.ll = pt.mkt;
		location.lang = pt.mkt.split("-")[0];
		location.geo = pt.mkt.split("-")[1];

		if ((~ptlower.indexOf("pdp") || ~ptlower.indexOf("detail")) && (typeof _pageBITags == "object" && typeof _pageBITags.pageContracts == "object" && typeof _pageBITags.pageContracts.ProductInfo == "object")) {
			// PDP PAGE
			pc = _pageBITags.pageContracts.ProductInfo;
			location.cc = pc.cur;
		}
	}

	//--------------------------------------------------------
	// create backwards compatible arrays from orderLineItems delete if no line items
	//--------------------------------------------------------
	var temppname;

	// delete if no line items
	for (var i = 0; i < location.lineItems.length; i++) {
		temppname = "";
		try {
			temppname = decodeURIComponent(location.lineItems[i].ti);
		} catch (pnameerr) {
			temppname = (location.lineItems[i].ti) ? location.lineItems[i].ti : "";
		}

		// ask justin about this -- doesn't make sense to me since you are reassigning this for every prod?
		if (location.lineItems[i].cur) {
			location.cc = location.lineItems[i].cur;
		}
	}

	var missingCCpagetype = "";
	if (location.cc == "Unknown" && ~window.location.host.indexOf("query.prod.cms.rt.microsoft.com")) {
		missingCCpagetype = (~window.location.href.indexOf("pN=congrats")) ? "receipt" : "cart";
		if (missingCCpagetype == "receipt") { location.logRuleCall("missingCC" + missingCCpagetype + "_" + location.geo, "missingCC" + "_" + location.geo, window.location.search); }
	}

	var ccmap = {
		'US': 'USD',
		'AU': 'AUD',
		'BR': 'BRL',
		'CA': 'CAD',
		'CH': 'CHF',
		'DK': 'DKK',
		'GB': 'GBP',
		'JP': 'JPY',
		'MX': 'MXN',
		'NO': 'NOK',
		'RU': 'RUB',
		'SE': 'SEK',
		'AT': 'EUR',
		'BE': 'EUR',
		'CY': 'EUR',
		'DE': 'EUR',
		'ES': 'EUR',
		'FI': 'EUR',
		'FR': 'EUR',
		'GR': 'EUR',
		'IR': 'EUR',
		'IT': 'EUR',
		'LU': 'EUR',
		'NL': 'EUR',
		'PT': 'EUR',
		'NEVERHIT': 'Unknown'
	};
	if (location.cc == "Unknown" || location.cc == "") {
		try {
			if (ccmap[location.geo.toUpperCase()]) {
				location.cc = ccmap[location.geo.toUpperCase()];
			}
		} catch (ccerr) { }
	}
	if (location.cc == "Unknown" && (window.location.href.indexOf('"EUR"') > -1 || window.location.href.indexOf("%22EUR%22") > -1)) {
		location.cc = "EUR";
	}

	location.pagename = location.pageName; // backwards compatibility for some tags

	// make global for access in other tags

	window.location = window.location || location;
}
catch (err) { console.log("DataLayer: " + err.message); }

}
      }
    },
    "ProductInfo": {
      "modulePath": "core/src/lib/dataElements/customCode.js",
      "settings": {
        "source": function() {
  //product information
var product = {
	busgrp: [],
	isprod: false,
	itemprices: [],
	lineItems: [],
	pids: [],
	pidsku: [],
	pnames: [],
	prdCt: [],
	prdFam: [],
	prdPrCat: [],
	prdSecCat: [],
	prdSubCat: [],
	prdType: [],
	skus: [],
	quantities: [],
	totamount: 0,
	totqty: 0,
	purchaseID: "",
};




var qs = "",
	qsdecoded = "",
	qs2 = "",
	qsarr = [],
	jsonstr = "",
	jsonobj = {},
	jsonstr,
	pt,
	pc,
	ptlower,
	_pagetypemap = {}
	;

if (document.referrer) {
	reflc = document.referrer.toLowerCase();
}

qs = (window.location.search) ? window.location.search : "";
if (qs.indexOf("?n=ensighten.html?") == 0) {
	qs = qs.substring(17);
}
if (qs.indexOf("?") == 0) {
	qs = qs.substring(1);
}
qs = qs.replace(/%20&%20/g, "%20%26%20");
qs = qs.replace(/ & /g, "%20%26%20");
qsarr = qs.split("&");


if (~window.location.host.indexOf("compass-ssl.xboxlive.com") || ~window.location.host.indexOf("query.prod.cms.rt.microsoft.com")) {
	// top level params from iframe:  pN=cart&cl=en-US&market=US
	purchaseID = getQSParam(qsarr, "orderId") || getQSParam(qsarr, "id");
	muid = getQSParam(qsarr, "muid");
	totamount = getQSParam(qsarr, "totAmtWoTx");
	jsonstr = getQSParam(qsarr, "orderLineItems");
	if (~reflc.indexOf("www.microsoft.com") && window.navigator.userAgent.toLowerCase().indexOf("soasta") < 0) { isprod = true; }
	if (!jsonstr) {
		logRuleCall("orderLineItems json missing");
	} else {
		try {
			if (jsonstr.indexOf("[") > -1) {
				jsonstr = jsonstr.replace(/%22%20Dis/g, '%20Dis');
				jsonstr = jsonstr.replace(/portable%2013%22%20/g, 'portable%2013%20');
				jsonstr = jsonstr.replace(/%22%204K/g, '%204K');
				jsonstr = jsonstr.replace(/%22Samsung%2049%22%20/g, '%22Samsung%2049%20');
				jsonstr = jsonstr.replace(/%22%2F/g, '%2F');
				jsonstr = jsonstr.replace(/5%22%20%2F/g, '5%2F');
				jsonstr = jsonstr.replace(/%223%2F4%22%20/g, '%223%2F4%20');
				jsonstr = jsonstr.replace(/15.6%22%20/g, '15.6%20');
				jsonstr = jsonstr.replace(/%22/g, '"');
				lineItems = JSON.parse(jsonstr);
			} else {
				jsonstr = jsonstr.replace(/%22%20Dis/g, '%20Dis');
				jsonstr = jsonstr.replace(/portable%2013%22%20/g, 'portable%2013%20');
				jsonstr = jsonstr.replace(/%22Samsung%2049%22%20/g, '%22Samsung%2049%20');
				jsonstr = jsonstr.replace(/%22%204K/g, '%204K');
				jsonstr = jsonstr.replace(/%22%2F/g, '%2F');
				jsonstr = jsonstr.replace(/5%22%20%2F/g, '5%2F');
				jsonstr = jsonstr.replace(/%223%2F4%22%20/g, '%223%2F4%20');
				jsonstr = jsonstr.replace(/15.6%22%20/g, '15.6%20');
				lineItems = JSON.parse(decodeURIComponent(jsonstr));
			}
		} catch (jsonparseerr) { logRuleCall("jsonparse error", "jsonparse error", window.location.search); _satellite.logger.error("jsonparse error"); }
	}
} else if (typeof _pageBITags == "object") {
	// consume _pageBITags object from the non-iframe pages (e.g. OneRF)
	pt = _pageBITags.pageTags;
	ptlower = pt.pageType.toLowerCase();

	if (~window.location.host.toLowerCase().indexOf("www.microsoft.com") && window.navigator.userAgent.toLowerCase().indexOf("soasta") < 0) { isprod = true; }

	try {
		muid = readCookie("MUID");
	} catch (muiderr) { logRuleCall("muid err"); }

	if (~ptlower.indexOf("category")) {
		// CATEGORY PAGE
		// https://onestore-ppe.microsoft.com/en-sg/store/b/surface?icid=CNavDevicesSurface&setswitch=optimizely_disabled%3A1%2Censighten_disabled%3D0

	} else if ((~ptlower.indexOf("pdp") || ~ptlower.indexOf("detail")) && (typeof _pageBITags == "object" && typeof _pageBITags.pageContracts == "object" && typeof _pageBITags.pageContracts.ProductInfo == "object")) {
		// PDP PAGE
		pc = _pageBITags.pageContracts.ProductInfo;
		pids.push(pc.id);
		skus.push(pc.sku);
		pidsku.push(pc.id + "-" + pc.sku);
		prdCt.push(pc.prdCt);
		prdPrCat.push(pc.priCat);
		prdSecCat.push(pc.prdSecCat);
		prdSubCat.push(pc.prdSubCat);
		prdType.push(pc.family);
		pnames.push(pc.title);
		quantities.push(1); // why is this listed twice
		sales.push(_pageBITags.pageContracts.ProductInfo.rtPrice);
		quantities.push(1); //why is this listed twice
		itemprices.push(sales[0]);
	} else if ((~ptlower.indexOf("pdp") || ~ptlower.indexOf("detail")) && ~path.indexOf("/configure/")) {
		ptlower = "configure";
		pageType = "configure";
	}
}



//--------------------------------------------------------
// create backwards compatible arrays from orderLineItems
//--------------------------------------------------------
var temppname;

for (var i = 0; i < lineItems.length; i++) {
	temppname = "";
	pids.push((lineItems[i].pId) ? lineItems[i].pId : "");
	skus.push((lineItems[i].sku) ? lineItems[i].sku : "");
	try {
		temppname = decodeURIComponent(lineItems[i].ti);
	} catch (pnameerr) {
		temppname = (lineItems[i].ti) ? lineItems[i].ti : "";
	}
	pnames.push(temppname);

	sales.push((lineItems[i].tot && typeof lineItems[i].txA !== 'undefined' && typeof lineItems[i].q !== 'undefined') ? (lineItems[i].tot - (lineItems[i].q * lineItems[i].txA)) : lineItems[i].tot);
	prdPrCat.push((lineItems[i].pC) ? lineItems[i].pC : "");
	prdFam.push((lineItems[i].pF) ? lineItems[i].pF : "");
	prdType.push((lineItems[i].pT) ? lineItems[i].pT : "");
	pidsku.push(pids[i] + "-" + skus[i]);
	quantities.push((lineItems[i].q) ? lineItems[i].q : 1);

	totqty += quantities[i];
	itemprices.push(sales[i] / quantities[i]);
}

return product;
}
      }
    },
    "isPurchase": {
      "modulePath": "core/src/lib/dataElements/customCode.js",
      "settings": {
        "source": function() {
  return (window.location.host.toLowerCase()=="query.prod.cms.rt.microsoft.com" && ~window.location.search.indexOf("pN=congrats"));
}
      }
    },
    "isHoliday": {
      "modulePath": "core/src/lib/dataElements/customCode.js",
      "settings": {
        "source": function() {
  var path = window.location.pathname.toLowerCase();
var boxingDayRegex = new RegExp("(en-ca|fr-ca)\/store\/b\/boxing-week");
var cyberMondayRegex = new RegExp("(us|ca|jp|au)\/store\/b\/cyber-monday");
var blackFridayRegex = new RegExp("(us|ca|jp|au)\/store\/b\/black-friday");
var storeSaleRegex = new RegExp("\/store\/b\/sale");

if (boxingDayRegex.test(path) || cyberMondayRegex.test(path) || blackFridayRegex.test(path) || storeSaleRegex.test(path)) {
  return true;
} else {
  return false;
}
}
      }
    },
    "isBusinessConsultation": {
      "modulePath": "core/src/lib/dataElements/customCode.js",
      "settings": {
        "source": function() {
  var surfaceForBusiness = new RegExp("store/b/business-consultation");
return surfaceForBusiness.test(window.location.pathname.toLowerCase());
}
      }
    },
    "isConsumerConsultation": {
      "modulePath": "core/src/lib/dataElements/customCode.js",
      "settings": {
        "source": function() {
  var surfaceForBusiness = new RegExp("store/b/online-computer-shopping-appointments");
return surfaceForBusiness.test(window.location.pathname.toLowerCase());
}
      }
    },
    "Bing UET Custom - Amplify ": {
      "modulePath": "core/src/lib/dataElements/customCode.js",
      "settings": {
        "source": function() {
  (function(w,d,t,r,u){var f,n,i;w[u]=w[u]||[],f=function(){var o={ti:"149014572"};o.q=w[u],w[u]=new UET(o),w[u].push("pageLoad")},n=d.createElement(t),n.src=r,n.async=1,n.onload=n.onreadystatechange=function(){var s=this.readyState;s&&s!=="loaded"&&s!=="complete"||(f(),n.onload=n.onreadystatechange=null)},i=d.getElementsByTagName(t)[0],i.parentNode.insertBefore(n,i)})(window,document,"script","//bat.bing.com/bat.js","uetq_Amplify")
}
      }
    }
  },
  "extensions": {
    "core": {
      "displayName": "Core",
      "hostedLibFilesBaseUrl": "//img-prod-cms-rt-microsoft-com.akamaized.net/launch/store/5ef092d1efb5/21b18fecd107/508b5fde54de/hostedLibFiles/EP9f64ab5391d540b0bb8658a244bbeb36/",
      "modules": {
        "core/src/lib/dataElements/customCode.js": {
          "name": "custom-code",
          "displayName": "Custom Code",
          "script": function(module, exports, require, turbine) {
/***************************************************************************************
 * (c) 2017 Adobe. All rights reserved.
 * This file is licensed to you under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License. You may obtain a copy
 * of the License at http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under
 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
 * OF ANY KIND, either express or implied. See the License for the specific language
 * governing permissions and limitations under the License.
 ****************************************************************************************/

'use strict';

/**
 * The custom data element.
 * @param {Object} settings The data element settings object.
 * @param {string} settings.source The function that should be called which will return a value.
 * @returns {string}
 */
module.exports = function(settings) {
  return settings.source();
};

          }

        },
        "core/src/lib/dataElements/cookie.js": {
          "name": "cookie",
          "displayName": "Cookie",
          "script": function(module, exports, require, turbine) {
/***************************************************************************************
 * (c) 2017 Adobe. All rights reserved.
 * This file is licensed to you under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License. You may obtain a copy
 * of the License at http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under
 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
 * OF ANY KIND, either express or implied. See the License for the specific language
 * governing permissions and limitations under the License.
 ****************************************************************************************/

'use strict';

var cookie = require('@adobe/reactor-cookie');

/**
 * The cookie data element.
 * @param {Object} settings The data element settings object.
 * @param {string} settings.name The name of the cookie for which a value should be retrieved.
 * @returns {string}
 */
module.exports = function(settings) {
  return cookie.get(settings.name);
};

          }

        },
        "core/src/lib/conditions/domain.js": {
          "name": "domain",
          "displayName": "Domain",
          "script": function(module, exports, require, turbine) {
/***************************************************************************************
 * (c) 2017 Adobe. All rights reserved.
 * This file is licensed to you under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License. You may obtain a copy
 * of the License at http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under
 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
 * OF ANY KIND, either express or implied. See the License for the specific language
 * governing permissions and limitations under the License.
 ****************************************************************************************/

'use strict';

var document = require('@adobe/reactor-document');
var escapeForRegex = require('../../../node_modules/escape-string-regexp/index.js');

/**
 * Domain condition. Determines if the actual domain matches at least one acceptable domain.
 * @param {Object} settings Condition settings.
 * @param {string[]} settings.domains An array of acceptable domains.
 * @returns {boolean}
 */
module.exports = function(settings) {
  var domain = document.location.hostname;

  return settings.domains.some(function(acceptableDomain) {
    // If document.location.hostname is example.com and the acceptableDomain is ample.com, the
    // condition would pass without (^|\.), which is incorrect. We can't only use ^ though because
    // if document.location.hostname is niner.example.com and the acceptableDomain is example.com,
    // the condition should pass. See the tests for examples of why this pattern is necessary.
    return domain.match(new RegExp('(^|\\.)' + escapeForRegex(acceptableDomain) + '$', 'i'));
  });
};


          }

        },
        "core/src/lib/events/pageBottom.js": {
          "name": "page-bottom",
          "displayName": "Page Bottom",
          "script": function(module, exports, require, turbine) {
/***************************************************************************************
 * (c) 2017 Adobe. All rights reserved.
 * This file is licensed to you under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License. You may obtain a copy
 * of the License at http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under
 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
 * OF ANY KIND, either express or implied. See the License for the specific language
 * governing permissions and limitations under the License.
 ****************************************************************************************/

'use strict';

var pageLifecycleEvents = require('./helpers/pageLifecycleEvents');

/**
 * Page bottom event. This event occurs as soon as the user calls _satellite.pageBottom() (which is
 * supposed to be at the bottom of the page).
 * @param {Object} settings The event settings object.
 * @param {ruleTrigger} trigger The trigger callback.
 */
module.exports = function(settings, trigger) {
  pageLifecycleEvents.registerPageBottomTrigger(trigger);
};

          }

        },
        "core/src/lib/conditions/path.js": {
          "name": "path",
          "displayName": "Path Without Query String",
          "script": function(module, exports, require, turbine) {
/***************************************************************************************
 * (c) 2017 Adobe. All rights reserved.
 * This file is licensed to you under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License. You may obtain a copy
 * of the License at http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under
 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
 * OF ANY KIND, either express or implied. See the License for the specific language
 * governing permissions and limitations under the License.
 ****************************************************************************************/

'use strict';

var document = require('@adobe/reactor-document');
var textMatch = require('../helpers/textMatch');

/**
 * Path condition. Determines if the actual path matches at least one acceptable path.
 * @param {Object} settings Condition settings.
 * @param {Object[]} settings.paths Acceptable paths.
 * @param {string} settings.paths[].value An acceptable path value.
 * @param {boolean} [settings.paths[].valueIsRegex=false] Whether <code>value</code> on the object
 * instance is intended to be a regular expression.
 * @returns {boolean}
 */
module.exports = function(settings) {
  var path = document.location.pathname;
  return settings.paths.some(function(acceptablePath) {
    var acceptableValue = acceptablePath.valueIsRegex ?
      new RegExp(acceptablePath.value, 'i') : acceptablePath.value;
    return textMatch(path, acceptableValue);
  });
};

          }

        },
        "core/src/lib/actions/customCode.js": {
          "name": "custom-code",
          "displayName": "Custom Code",
          "script": function(module, exports, require, turbine) {
/***************************************************************************************
 * (c) 2017 Adobe. All rights reserved.
 * This file is licensed to you under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License. You may obtain a copy
 * of the License at http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under
 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
 * OF ANY KIND, either express or implied. See the License for the specific language
 * governing permissions and limitations under the License.
 ****************************************************************************************/

'use strict';

var document = require('@adobe/reactor-document');
var decorateCode = require('./helpers/decorateCode');
var loadCodeSequentially = require('./helpers/loadCodeSequentially');
var postscribe = require('../../../node_modules/postscribe/dist/postscribe');

var postscribeWrite = (function() {
  var write = function(source) {
    postscribe(document.body, source, {
      error: function(error) {
        turbine.logger.error(error.msg);
      }
    });
  };

  var queue = [];

  // If the Launch library is loaded asynchronously, it may finish loading before document.body
  // is available. This means the custom code action may be running before document.body is
  // available, in which case can't write the custom code to document.body. We could, in this
  // case, write it to document.head since it will for sure be available, but the user's custom
  // code may have something like an img tag for sending a beacon (this use case was seen in DTM).
  // Adding display elements like an img tag to document.head is against HTML spec, though it
  // does seem like an image request is still made. We opted instead to ensure we comply with
  // HTML spec and wait until we see that document.body is available before writing.
  var flushQueue = function() {
    if (document.body) {
      while (queue.length) {
        write(queue.shift());
      }
    } else {
      // 20 is an arbitrarily small amount of time but not too aggressive.
      setTimeout(flushQueue, 20);
    }
  };

  return function(source) {
    queue.push(source);
    flushQueue();
  };
})();

var libraryWasLoadedAsynchronously = (function() {
  // document.currentScript is not supported by IE
  if (document.currentScript) {
    return document.currentScript.async;
  } else {
    var scripts = document.querySelectorAll('script');
    for (var i = 0; i < scripts.length; i++) {
      var script = scripts[i];
      // Find the script that loaded our library. Take into account embed scripts migrated
      // from DTM. We'll also consider that they may have added a querystring for cache-busting
      // or whatever.
      if (/(launch|satelliteLib)-[^\/]+.js(\?.*)?$/.test(script.src)) {
        return script.async;
      }
    }
    // We couldn't find the Launch script, so we'll assume it was loaded asynchronously. This
    // is the safer assumption.
    return true;
  }
})();

/**
 * The custom code action. This loads and executes custom JavaScript or HTML provided by the user.
 * @param {Object} settings Action settings.
 * @params {boolean} settings.isExternal When true, <code>settings.source</code> contains the
 * code itself. When false, <code>settings.source</code> contains a relative path to the file
 * containing the user's code.
 * @param {string} settings.source If <code>settings.external</code> is <code>false</code>,
 * this will be the user's code. Otherwise, it will be a relative path to the file containing
 * the user's code.
 * @param {string} settings.language The language of the user's code. Must be either javascript or
 * html.
 * @param {Object} event The underlying event object that triggered the rule.
 * @param {Object} event.element The element that the rule was targeting.
 * @param {Object} event.target The element on which the event occurred.
 * <code>javascript</code> or <code>html</code>.
 */
module.exports = function(settings, event) {
  var action = {
    settings: settings,
    event: event
  };

  var source = action.settings.source;
  if (!source) {
    return;
  }

  if (action.settings.isExternal) {
    return loadCodeSequentially(source).then(function(source) {
      if (source) {
        postscribeWrite(decorateCode(action, source));
      }
    });
  } else {
    // This area has been modified several times, so here are some helpful details:
    // 1. Custom code will be included into the main launch library if it's for a rule that uses the
    //    Library Loaded or Page Bottom event. isExternal will be false. However, keep in mind that
    //    the same rule may have other events that are not Library Loaded or Page Bottom. This means
    //    we could see isExternal = false on the action when the event that fired the rule is
    //    a click, for example.
    // 2. When users load a library synchronously which has a rule using the Library Loaded
    //    or Page Bottom event with a Custom Code action, they expect the custom code to be written
    //    to the document in a blocking fashion (prevent the parser from continuing until their
    //    custom code is executed). In other words, they expect document.write to be used. When
    //    the library is loaded asynchronously, they do not have this expectation. However, note
    //    that if the Library Loaded event is used and the website does not call
    //    _satellite.pageBottom(), page bottom rules will be run when the DOMContentLoaded event
    //    is fired (at which point we can't use document.write or it will wipe out website content).
    // 3. Calls to document.write will be ignored by the browser if the Launch library is loaded
    //    asynchronously, even if the calls are made before DOMContentLoaded.
    // 4. There's a bug in IE 10 where readyState is sometimes set to "interactive" too
    //    early (before DOMContentLoaded has fired). https://bugs.jquery.com/ticket/12282
    //    This may cause Postscribe to be used sometimes when document.write() could have been
    //    used instead, but we have concluded that IE 10 usage is low enough and the risk small
    //    enough that this behavior is tolerable.
    if (!libraryWasLoadedAsynchronously && document.readyState === 'loading') {
      // Document object in XML files is different from the ones in HTML files. Documents served
      // with the `application/xhtml+xml` MIME type don't have the `document.write` method.
      // More info:
      // https://www.w3.org/MarkUp/2004/xhtml-faq#docwrite
      // https://developer.mozilla.org/en-US/docs/Archive/Web/Writing_JavaScript_for_HTML
      if (document.write) {
        document.write(decorateCode(action, source));
      } else {
        postscribeWrite(decorateCode(action, source));
      }
    } else {
      postscribeWrite(decorateCode(action, source));
    }
  }
};

          }

        },
        "core/src/lib/conditions/dateRange.js": {
          "name": "date-range",
          "displayName": "Date Range",
          "script": function(module, exports, require, turbine) {
/***************************************************************************************
 * (c) 2017 Adobe. All rights reserved.
 * This file is licensed to you under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License. You may obtain a copy
 * of the License at http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under
 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
 * OF ANY KIND, either express or implied. See the License for the specific language
 * governing permissions and limitations under the License.
 ****************************************************************************************/

'use strict';

/**
 * Date range condition. Determines if we are within a specific date range.
 * @param {Object} settings Condition settings.
 * @param {string} [settings.start] A date, in ISO 8601, indicating when the condition should
 * start returning true.
 * @param {string} [settings.end] A date, in ISO 8601, indicating when the condition should
 * stop returning true.
 * @returns {boolean}
 */
module.exports = function(settings) {
  var now = new Date();

  if (settings.start && now < new Date(settings.start)) {
    return false;
  }

  if (settings.end && now > new Date(settings.end)) {
    return false;
  }

  return true;
};

          }

        },
        "core/src/lib/conditions/customCode.js": {
          "name": "custom-code",
          "displayName": "Custom Code",
          "script": function(module, exports, require, turbine) {
/***************************************************************************************
 * (c) 2017 Adobe. All rights reserved.
 * This file is licensed to you under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License. You may obtain a copy
 * of the License at http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under
 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
 * OF ANY KIND, either express or implied. See the License for the specific language
 * governing permissions and limitations under the License.
 ****************************************************************************************/

'use strict';

/**
 * Custom code condition. This executes condition code provided by the user.
 * @param {Object} settings Condition settings.
 * @param {Function} settings.source The custom script function.
 * @param {Object} event The underlying event object that triggered the rule.
 * @param {Object} event.element The element that the rule was targeting.
 * @param {Object} event.target The element on which the event occurred.
 * @returns {boolean}
 */
module.exports = function(settings, event) {
  // `this` and `target` are provided separately from event for backward-compatibility.
  return settings.source.call(event.element, event, event.target);
};

          }

        },
        "core/src/lib/conditions/sessions.js": {
          "name": "sessions",
          "displayName": "Sessions",
          "script": function(module, exports, require, turbine) {
/***************************************************************************************
 * (c) 2017 Adobe. All rights reserved.
 * This file is licensed to you under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License. You may obtain a copy
 * of the License at http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under
 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
 * OF ANY KIND, either express or implied. See the License for the specific language
 * governing permissions and limitations under the License.
 ****************************************************************************************/

'use strict';

var visitorTracking = require('../helpers/visitorTracking');
var compareNumbers = require('./helpers/compareNumbers');

/**
 * Sessions condition. Determines if the number of sessions matches constraints.
 * @param {Object} settings Condition settings.
 * @param {number} settings.count The number of sessions to compare against.
 * @param {comparisonOperator} settings.operator The comparison operator to use to
 * compare against count.
 * @returns {boolean}
 */
module.exports = function(settings) {
  return compareNumbers(
    visitorTracking.getSessionCount(),
    settings.operator,
    settings.count
  );
};


          }

        },
        "core/src/lib/conditions/valueComparison.js": {
          "name": "value-comparison",
          "displayName": "Value Comparison",
          "script": function(module, exports, require, turbine) {
/***************************************************************************************
 * (c) 2018 Adobe. All rights reserved.
 * This file is licensed to you under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License. You may obtain a copy
 * of the License at http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under
 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
 * OF ANY KIND, either express or implied. See the License for the specific language
 * governing permissions and limitations under the License.
 ****************************************************************************************/

/*eslint eqeqeq:0*/
'use strict';

var isNumber = function(value) {
  return typeof value === 'number' && isFinite(value); // isFinite weeds out NaNs.
};

var isString = function(value) {
  return typeof value === 'string' || value instanceof String;
};

var updateCase = function(operand, caseInsensitive) {
  return caseInsensitive && isString(operand) ? operand.toLowerCase() : operand;
};

var castToStringIfNumber = function(operand) {
  return isNumber(operand) ? String(operand) : operand;
};

var castToNumberIfString = function(operand) {
  return isString(operand) ? Number(operand) : operand;
};

var guardStringCompare = function(compare) {
  return function(leftOperand, rightOperand, caseInsensitive) {
    leftOperand = castToStringIfNumber(updateCase(leftOperand, caseInsensitive));
    rightOperand = castToStringIfNumber(updateCase(rightOperand, caseInsensitive));

    return (
      isString(leftOperand) &&
      isString(rightOperand) &&
      compare(leftOperand, rightOperand)
    );
  };
};

var guardNumberCompare = function(compare) {
  return function(leftOperand, rightOperand) {
    leftOperand = castToNumberIfString(leftOperand);
    rightOperand = castToNumberIfString(rightOperand);

    return (
      isNumber(leftOperand) &&
      isNumber(rightOperand) &&
      compare(leftOperand, rightOperand)
    );
  };
};

var conditions = {
  equals: function(leftOperand, rightOperand, caseInsensitive) {
    return updateCase(leftOperand, caseInsensitive) == updateCase(rightOperand, caseInsensitive);
  },
  doesNotEqual: function() {
    return !conditions.equals.apply(null, arguments);
  },
  contains: guardStringCompare(function(leftOperand, rightOperand) {
    return leftOperand.indexOf(rightOperand) !== -1;
  }),
  doesNotContain: function() {
    return !conditions.contains.apply(null, arguments);
  },
  startsWith: guardStringCompare(function(leftOperand, rightOperand) {
    return leftOperand.indexOf(rightOperand) === 0;
  }),
  doesNotStartWith: function() {
    return !conditions.startsWith.apply(null, arguments);
  },
  endsWith: guardStringCompare(function(leftOperand, rightOperand) {
    return leftOperand.substring(
      leftOperand.length - rightOperand.length,
      leftOperand.length
    ) === rightOperand;
  }),
  doesNotEndWith: function() {
    return !conditions.endsWith.apply(null, arguments);
  },
  matchesRegex: guardStringCompare(function(leftOperand, rightOperand, caseInsensitive) {
    // Doing something like new RegExp(/ab+c/, 'i') throws an error in some browsers (e.g., IE11),
    // so we don't want to instantiate the regex until we know we're working with a string.
    return new RegExp(rightOperand, caseInsensitive ? 'i' : '').test(leftOperand);
  }),
  doesNotMatchRegex: function() {
    return !conditions.matchesRegex.apply(null, arguments);
  },
  lessThan: guardNumberCompare(function(leftOperand, rightOperand) {
    return leftOperand < rightOperand;
  }),
  lessThanOrEqual: guardNumberCompare(function(leftOperand, rightOperand) {
    return leftOperand <= rightOperand;
  }),
  greaterThan: guardNumberCompare(function(leftOperand, rightOperand) {
    return leftOperand > rightOperand;
  }),
  greaterThanOrEqual: guardNumberCompare(function(leftOperand, rightOperand) {
    return leftOperand >= rightOperand;
  }),
  isTrue: function(leftOperand) {
    return leftOperand === true;
  },
  isTruthy: function(leftOperand) {
    return Boolean(leftOperand);
  },
  isFalse: function(leftOperand) {
    return leftOperand === false;
  },
  isFalsy: function(leftOperand) {
    return !leftOperand;
  },
};

module.exports = function(settings) {
  return conditions[settings.comparison.operator](
    settings.leftOperand,
    settings.rightOperand,
    Boolean(settings.comparison.caseInsensitive)
  );
};

          }

        },
        "core/src/lib/conditions/pathAndQuerystring.js": {
          "name": "path-and-querystring",
          "displayName": "Path And Query String",
          "script": function(module, exports, require, turbine) {
/***************************************************************************************
 * (c) 2017 Adobe. All rights reserved.
 * This file is licensed to you under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License. You may obtain a copy
 * of the License at http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under
 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
 * OF ANY KIND, either express or implied. See the License for the specific language
 * governing permissions and limitations under the License.
 ****************************************************************************************/

'use strict';

var document = require('@adobe/reactor-document');
var textMatch = require('../helpers/textMatch');

/**
 * Path and query string condition. Provided for legacy reasons. Determines if the actual path +
 * query string matches at least one acceptable path + query string.
 * @param {Object} settings Condition settings.
 * @param {Object[]} settings.paths Acceptable paths.
 * @param {string} settings.paths[].value An acceptable path value.
 * @param {boolean} [settings.paths[].valueIsRegex=false] Whether <code>value</code> on the object
 * instance is intended to be a regular expression.
 * @returns {boolean}
 */
module.exports = function(settings) {
  var path = document.location.pathname + document.location.search;
  return settings.paths.some(function(acceptablePath) {
    var acceptableValue = acceptablePath.valueIsRegex ?
      new RegExp(acceptablePath.value, 'i') : acceptablePath.value;
    return textMatch(path, acceptableValue);
  });
};

          }

        },
        "core/src/lib/events/libraryLoaded.js": {
          "name": "library-loaded",
          "displayName": "Library Loaded (Page Top)",
          "script": function(module, exports, require, turbine) {
/***************************************************************************************
 * (c) 2017 Adobe. All rights reserved.
 * This file is licensed to you under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License. You may obtain a copy
 * of the License at http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under
 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
 * OF ANY KIND, either express or implied. See the License for the specific language
 * governing permissions and limitations under the License.
 ****************************************************************************************/

'use strict';

var pageLifecycleEvents = require('./helpers/pageLifecycleEvents');

/**
 * Library loaded event. This event occurs as soon as the runtime library is loaded.
 * @param {Object} settings The event settings object.
 * @param {ruleTrigger} trigger The trigger callback.
 */
module.exports = function(settings, trigger) {
  pageLifecycleEvents.registerLibraryLoadedTrigger(trigger);
};

          }

        },
        "core/node_modules/escape-string-regexp/index.js": {
          "script": function(module, exports, require, turbine) {
'use strict';

var matchOperatorsRe = /[|\\{}()[\]^$+*?.]/g;

module.exports = function (str) {
	if (typeof str !== 'string') {
		throw new TypeError('Expected a string');
	}

	return str.replace(matchOperatorsRe, '\\$&');
};

          }

        },
        "core/src/lib/events/helpers/pageLifecycleEvents.js": {
          "script": function(module, exports, require, turbine) {
/***************************************************************************************
 * (c) 2018 Adobe. All rights reserved.
 * This file is licensed to you under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License. You may obtain a copy
 * of the License at http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under
 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
 * OF ANY KIND, either express or implied. See the License for the specific language
 * governing permissions and limitations under the License.
 ****************************************************************************************/

'use strict';

// We need to be able to fire the rules in a specific order, no matter if the library is loaded
// sync or async. The rules are fired in the following order:
// Library loaded rules -> Page bottom rules -> Dom Ready rules -> Window load rules.

var window = require('@adobe/reactor-window');
var document = require('@adobe/reactor-document');

var isIE10 = window.navigator.appVersion.indexOf('MSIE 10') !== -1;
var WINDOW_LOADED = 'WINDOW_LOADED';
var DOM_READY = 'DOM_READY';
var PAGE_BOTTOM = 'PAGE_BOTTOM';

var lifecycleEventsOrder = [PAGE_BOTTOM, DOM_READY, WINDOW_LOADED];

var createSyntheticEvent = function(element, nativeEvent) {
  return {
    element: element,
    target: element,
    nativeEvent: nativeEvent
  };
};

var registry = {};
lifecycleEventsOrder.forEach(function(event) {
  registry[event] = [];
});

var processRegistry = function(lifecycleEvent, nativeEvent) {
  lifecycleEventsOrder
    .slice(0, getLifecycleEventIndex(lifecycleEvent) + 1)
    .forEach(function(lifecycleEvent) {
      processTriggers(nativeEvent, lifecycleEvent);
    });
};

var detectLifecycleEvent = function() {
  if (document.readyState === 'complete') {
    return WINDOW_LOADED;
  } else if (document.readyState === 'interactive') {
    return !isIE10 ? DOM_READY : null;
  }
};

var getLifecycleEventIndex = function(event) {
  return lifecycleEventsOrder.indexOf(event);
};

var processTriggers = function(nativeEvent, lifecycleEvent) {
  registry[lifecycleEvent].forEach(function(triggerData) {
    processTrigger(nativeEvent, triggerData);
  });
  registry[lifecycleEvent] = [];
};

var processTrigger = function(nativeEvent, triggerData) {
  var trigger = triggerData.trigger;
  var syntheticEventFn = triggerData.syntheticEventFn;

  trigger(syntheticEventFn ? syntheticEventFn(nativeEvent) : null);
};

window._satellite = window._satellite || {};
window._satellite.pageBottom = processRegistry.bind(null, PAGE_BOTTOM);

document.addEventListener(
  'DOMContentLoaded',
  processRegistry.bind(null, DOM_READY),
  true
);
window.addEventListener(
  'load',
  processRegistry.bind(null, WINDOW_LOADED),
  true
);

// Depending on the way the Launch library was loaded, none of the registered listeners that
// execute `processRegistry` may fire . We need to execute the `processRegistry` method at
// least once. If this timeout fires before any of the registered listeners, we auto-detect the
// current lifecycle event and fire all the registered triggers in order. We don't care if the
// `processRegistry` is called multiple times for the same lifecycle event. We fire the registered
// triggers for a lifecycle event only once. We used a `setTimeout` here to make sure all the rules
// using Library Loaded are registered and executed synchronously and before rules using any of the
// other lifecycle event types.
window.setTimeout(function() {
  var lifecycleEvent = detectLifecycleEvent();
  if (lifecycleEvent) {
    processRegistry(lifecycleEvent);
  }
}, 0);

module.exports = {
  registerLibraryLoadedTrigger: function(trigger) {
    trigger();
  },
  registerPageBottomTrigger: function(trigger) {
    registry[PAGE_BOTTOM].push({
      trigger: trigger
    });
  },
  registerDomReadyTrigger: function(trigger) {
    registry[DOM_READY].push({
      trigger: trigger,
      syntheticEventFn: createSyntheticEvent.bind(null, document)
    });
  },
  registerWindowLoadedTrigger: function(trigger) {
    registry[WINDOW_LOADED].push({
      trigger: trigger,
      syntheticEventFn: createSyntheticEvent.bind(null, window)
    });
  }
};

          }

        },
        "core/src/lib/helpers/textMatch.js": {
          "script": function(module, exports, require, turbine) {
/***************************************************************************************
 * (c) 2017 Adobe. All rights reserved.
 * This file is licensed to you under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License. You may obtain a copy
 * of the License at http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under
 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
 * OF ANY KIND, either express or implied. See the License for the specific language
 * governing permissions and limitations under the License.
 ****************************************************************************************/

'use strict';

/**
 * Performs a string match based on another string or a regex.
 * @param {string} str The string to be evaluate.
 * @param {string|RegExp} pattern The pattern to match against.
 * @returns {boolean} Whether the string matches the pattern.
 */
module.exports = function(str, pattern) {
  if (pattern == null) {
    throw new Error('Illegal Argument: Pattern is not present');
  }
  if (str == null) {
    return false;
  }
  if (typeof pattern === 'string') {
    return str === pattern;
  } else if (pattern instanceof RegExp) {
    return pattern.test(str);
  } else {
    return false;
  }
};

          }

        },
        "core/src/lib/actions/helpers/decorateCode.js": {
          "script": function(module, exports, require, turbine) {
/***************************************************************************************
 * (c) 2017 Adobe. All rights reserved.
 * This file is licensed to you under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License. You may obtain a copy
 * of the License at http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under
 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
 * OF ANY KIND, either express or implied. See the License for the specific language
 * governing permissions and limitations under the License.
 ****************************************************************************************/

'use strict';

var id = 0;

var isSourceLoadedFromFile = function(action) {
  return action.settings.isExternal;
};

var decorateGlobalJavaScriptCode = function(action, source) {
  // The line break after the source is important in case their last line of code is a comment.
  return '<scr' + 'ipt>\n' + source + '\n</scr' + 'ipt>';
};

var decorateNonGlobalJavaScriptCode = function(action, source) {
  var runScriptFnName = '__runScript' + ++id;

  _satellite[runScriptFnName] = function(fn) {
    fn.call(action.event.element, action.event, action.event.target);
    delete _satellite[runScriptFnName];
  };

  // The line break after the source is important in case their last line of code is a comment.
  return '<scr' + 'ipt>_satellite["' + runScriptFnName + '"](function(event, target) {\n' +
    source +
    '\n});</scr' + 'ipt>';
};

var decorators = {
  javascript: function(action, source) {
    return action.settings.global ?
      decorateGlobalJavaScriptCode(action, source) :
      decorateNonGlobalJavaScriptCode(action, source);
  },
  html: function(action, source) {
    // We need to replace tokens only for sources loaded from external files. The sources from
    // inside the container are automatically taken care by Turbine.
    if (isSourceLoadedFromFile(action)) {
      return turbine.replaceTokens(source, action.event);
    }

    return source;
  }
};

module.exports = function(action, source) {
  return decorators[action.settings.language](action, source);
};

          }

        },
        "core/src/lib/actions/helpers/loadCodeSequentially.js": {
          "script": function(module, exports, require, turbine) {
/***************************************************************************************
 * (c) 2017 Adobe. All rights reserved.
 * This file is licensed to you under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License. You may obtain a copy
 * of the License at http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under
 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
 * OF ANY KIND, either express or implied. See the License for the specific language
 * governing permissions and limitations under the License.
 ****************************************************************************************/

'use strict';

var Promise = require('@adobe/reactor-promise');
var getSourceByUrl = require('./getSourceByUrl');

var previousExecuteCodePromise = Promise.resolve();

module.exports = function(sourceUrl) {
  var sequentiallyLoadCodePromise = new Promise(function(resolve) {
    var loadCodePromise = getSourceByUrl(sourceUrl);

    Promise.all([
      loadCodePromise,
      previousExecuteCodePromise
    ]).then(function(values) {
      var source = values[0];
      resolve(source);
    });
  });

  previousExecuteCodePromise = sequentiallyLoadCodePromise;
  return sequentiallyLoadCodePromise;
};

          }

        },
        "core/node_modules/postscribe/dist/postscribe.js": {
          "script": function(module, exports, require, turbine) {
/**
 * @file postscribe
 * @description Asynchronously write javascript, even with document.write.
 * @version v2.0.8
 * @see {@link https://krux.github.io/postscribe}
 * @license MIT
 * @author Derek Brans
 * @copyright 2016 Krux Digital, Inc
 */
(function webpackUniversalModuleDefinition(root, factory) {
	if(typeof exports === 'object' && typeof module === 'object')
		module.exports = factory();
	else if(typeof define === 'function' && define.amd)
		define([], factory);
	else if(typeof exports === 'object')
		exports["postscribe"] = factory();
	else
		root["postscribe"] = factory();
})(this, function() {
return /******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId])
/******/ 			return installedModules[moduleId].exports;
/******/
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			exports: {},
/******/ 			id: moduleId,
/******/ 			loaded: false
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.loaded = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(0);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	var _postscribe = __webpack_require__(1);
	
	var _postscribe2 = _interopRequireDefault(_postscribe);
	
	function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }
	
	module.exports = _postscribe2['default'];

/***/ },
/* 1 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	exports.__esModule = true;
	
	var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };
	
	exports['default'] = postscribe;
	
	var _writeStream = __webpack_require__(2);
	
	var _writeStream2 = _interopRequireDefault(_writeStream);
	
	var _utils = __webpack_require__(4);
	
	var utils = _interopRequireWildcard(_utils);
	
	function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj['default'] = obj; return newObj; } }
	
	function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }
	
	/**
	 * A function that intentionally does nothing.
	 */
	function doNothing() {}
	
	/**
	 * Available options and defaults.
	 *
	 * @type {Object}
	 */
	var OPTIONS = {
	  /**
	   * Called when an async script has loaded.
	   */
	  afterAsync: doNothing,
	
	  /**
	   * Called immediately before removing from the write queue.
	   */
	  afterDequeue: doNothing,
	
	  /**
	   * Called sync after a stream's first thread release.
	   */
	  afterStreamStart: doNothing,
	
	  /**
	   * Called after writing buffered document.write calls.
	   */
	  afterWrite: doNothing,
	
	  /**
	   * Allows disabling the autoFix feature of prescribe
	   */
	  autoFix: true,
	
	  /**
	   * Called immediately before adding to the write queue.
	   */
	  beforeEnqueue: doNothing,
	
	  /**
	   * Called before writing a token.
	   *
	   * @param {Object} tok The token
	   */
	  beforeWriteToken: function beforeWriteToken(tok) {
	    return tok;
	  },
	
	  /**
	   * Called before writing buffered document.write calls.
	   *
	   * @param {String} str The string
	   */
	  beforeWrite: function beforeWrite(str) {
	    return str;
	  },
	
	  /**
	   * Called when evaluation is finished.
	   */
	  done: doNothing,
	
	  /**
	   * Called when a write results in an error.
	   *
	   * @param {Error} e The error
	   */
	  error: function error(e) {
	    throw new Error(e.msg);
	  },
	
	
	  /**
	   * Whether to let scripts w/ async attribute set fall out of the queue.
	   */
	  releaseAsync: false
	};
	
	var nextId = 0;
	var queue = [];
	var active = null;
	
	function nextStream() {
	  var args = queue.shift();
	  if (args) {
	    var options = utils.last(args);
	
	    options.afterDequeue();
	    args.stream = runStream.apply(undefined, args);
	    options.afterStreamStart();
	  }
	}
	
	function runStream(el, html, options) {
	  active = new _writeStream2['default'](el, options);
	
	  // Identify this stream.
	  active.id = nextId++;
	  active.name = options.name || active.id;
	  postscribe.streams[active.name] = active;
	
	  // Override document.write.
	  var doc = el.ownerDocument;
	
	  var stash = {
	    close: doc.close,
	    open: doc.open,
	    write: doc.write,
	    writeln: doc.writeln
	  };
	
	  function _write(str) {
	    str = options.beforeWrite(str);
	    active.write(str);
	    options.afterWrite(str);
	  }
	
	  _extends(doc, {
	    close: doNothing,
	    open: doNothing,
	    write: function write() {
	      for (var _len = arguments.length, str = Array(_len), _key = 0; _key < _len; _key++) {
	        str[_key] = arguments[_key];
	      }
	
	      return _write(str.join(''));
	    },
	    writeln: function writeln() {
	      for (var _len2 = arguments.length, str = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
	        str[_key2] = arguments[_key2];
	      }
	
	      return _write(str.join('') + '\n');
	    }
	  });
	
	  // Override window.onerror
	  var oldOnError = active.win.onerror || doNothing;
	
	  // This works together with the try/catch around WriteStream::insertScript
	  // In modern browsers, exceptions in tag scripts go directly to top level
	  active.win.onerror = function (msg, url, line) {
	    options.error({ msg: msg + ' - ' + url + ': ' + line });
	    oldOnError.apply(active.win, [msg, url, line]);
	  };
	
	  // Write to the stream
	  active.write(html, function () {
	    // restore document.write
	    _extends(doc, stash);
	
	    // restore window.onerror
	    active.win.onerror = oldOnError;
	
	    options.done();
	    active = null;
	    nextStream();
	  });
	
	  return active;
	}
	
	function postscribe(el, html, options) {
	  if (utils.isFunction(options)) {
	    options = { done: options };
	  } else if (options === 'clear') {
	    queue = [];
	    active = null;
	    nextId = 0;
	    return;
	  }
	
	  options = utils.defaults(options, OPTIONS);
	
	  // id selector
	  if (/^#/.test(el)) {
	    el = window.document.getElementById(el.substr(1));
	  } else {
	    el = el.jquery ? el[0] : el;
	  }
	
	  var args = [el, html, options];
	
	  el.postscribe = {
	    cancel: function cancel() {
	      if (args.stream) {
	        args.stream.abort();
	      } else {
	        args[1] = doNothing;
	      }
	    }
	  };
	
	  options.beforeEnqueue(args);
	  queue.push(args);
	
	  if (!active) {
	    nextStream();
	  }
	
	  return el.postscribe;
	}
	
	_extends(postscribe, {
	  // Streams by name.
	  streams: {},
	  // Queue of streams.
	  queue: queue,
	  // Expose internal classes.
	  WriteStream: _writeStream2['default']
	});

/***/ },
/* 2 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';
	
	exports.__esModule = true;
	
	var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };
	
	var _prescribe = __webpack_require__(3);
	
	var _prescribe2 = _interopRequireDefault(_prescribe);
	
	var _utils = __webpack_require__(4);
	
	var utils = _interopRequireWildcard(_utils);
	
	function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj['default'] = obj; return newObj; } }
	
	function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }
	
	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
	/**
	 * Turn on to debug how each chunk affected the DOM.
	 * @type {boolean}
	 */
	var DEBUG_CHUNK = false;
	
	/**
	 * Prefix for data attributes on DOM elements.
	 * @type {string}
	 */
	var BASEATTR = 'data-ps-';
	
	/**
	 * ID for the style proxy
	 * @type {string}
	 */
	var PROXY_STYLE = 'ps-style';
	
	/**
	 * ID for the script proxy
	 * @type {string}
	 */
	var PROXY_SCRIPT = 'ps-script';
	
	/**
	 * Get data attributes
	 *
	 * @param {Object} el The DOM element.
	 * @param {String} name The attribute name.
	 * @returns {String}
	 */
	function getData(el, name) {
	  var attr = BASEATTR + name;
	
	  var val = el.getAttribute(attr);
	
	  // IE 8 returns a number if it's a number
	  return !utils.existy(val) ? val : String(val);
	}
	
	/**
	 * Set data attributes
	 *
	 * @param {Object} el The DOM element.
	 * @param {String} name The attribute name.
	 * @param {null|*} value The attribute value.
	 */
	function setData(el, name) {
	  var value = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;
	
	  var attr = BASEATTR + name;
	
	  if (utils.existy(value) && value !== '') {
	    el.setAttribute(attr, value);
	  } else {
	    el.removeAttribute(attr);
	  }
	}
	
	/**
	 * Stream static html to an element, where "static html" denotes "html
	 * without scripts".
	 *
	 * This class maintains a *history of writes devoid of any attributes* or
	 * "proxy history".
	 *
	 * Injecting the proxy history into a temporary div has no side-effects,
	 * other than to create proxy elements for previously written elements.
	 *
	 * Given the `staticHtml` of a new write, a `tempDiv`'s innerHTML is set to
	 * `proxy_history + staticHtml`.
	 * The *structure* of `tempDiv`'s contents, (i.e., the placement of new nodes
	 * beside or inside of proxy elements), reflects the DOM structure that would
	 * have resulted if all writes had been squashed into a single write.
	 *
	 * For each descendent `node` of `tempDiv` whose parentNode is a *proxy*,
	 * `node` is appended to the corresponding *real* element within the DOM.
	 *
	 * Proxy elements are mapped to *actual* elements in the DOM by injecting a
	 * `data-id` attribute into each start tag in `staticHtml`.
	 *
	 */
	
	var WriteStream = function () {
	  /**
	   * Constructor.
	   *
	   * @param {Object} root The root element
	   * @param {?Object} options The options
	   */
	  function WriteStream(root) {
	    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
	
	    _classCallCheck(this, WriteStream);
	
	    this.root = root;
	    this.options = options;
	    this.doc = root.ownerDocument;
	    this.win = this.doc.defaultView || this.doc.parentWindow;
	    this.parser = new _prescribe2['default']('', { autoFix: options.autoFix });
	
	    // Actual elements by id.
	    this.actuals = [root];
	
	    // Embodies the "structure" of what's been written so far,
	    // devoid of attributes.
	    this.proxyHistory = '';
	
	    // Create a proxy of the root element.
	    this.proxyRoot = this.doc.createElement(root.nodeName);
	
	    this.scriptStack = [];
	    this.writeQueue = [];
	
	    setData(this.proxyRoot, 'proxyof', 0);
	  }
	
	  /**
	   * Writes the given strings.
	   *
	   * @param {...String} str The strings to write
	   */
	
	
	  WriteStream.prototype.write = function write() {
	    var _writeQueue;
	
	    (_writeQueue = this.writeQueue).push.apply(_writeQueue, arguments);
	
	    // Process writes
	    // When new script gets pushed or pending this will stop
	    // because new writeQueue gets pushed
	    while (!this.deferredRemote && this.writeQueue.length) {
	      var arg = this.writeQueue.shift();
	
	      if (utils.isFunction(arg)) {
	        this._callFunction(arg);
	      } else {
	        this._writeImpl(arg);
	      }
	    }
	  };
	
	  /**
	   * Calls the given function.
	   *
	   * @param {Function} fn The function to call
	   * @private
	   */
	
	
	  WriteStream.prototype._callFunction = function _callFunction(fn) {
	    var tok = { type: 'function', value: fn.name || fn.toString() };
	    this._onScriptStart(tok);
	    fn.call(this.win, this.doc);
	    this._onScriptDone(tok);
	  };
	
	  /**
	   * The write implementation
	   *
	   * @param {String} html The HTML to write.
	   * @private
	   */
	
	
	  WriteStream.prototype._writeImpl = function _writeImpl(html) {
	    this.parser.append(html);
	
	    var tok = void 0;
	    var script = void 0;
	    var style = void 0;
	    var tokens = [];
	
	    // stop if we see a script token
	    while ((tok = this.parser.readToken()) && !(script = utils.isScript(tok)) && !(style = utils.isStyle(tok))) {
	      tok = this.options.beforeWriteToken(tok);
	
	      if (tok) {
	        tokens.push(tok);
	      }
	    }
	
	    if (tokens.length > 0) {
	      this._writeStaticTokens(tokens);
	    }
	
	    if (script) {
	      this._handleScriptToken(tok);
	    }
	
	    if (style) {
	      this._handleStyleToken(tok);
	    }
	  };
	
	  /**
	   * Write contiguous non-script tokens (a chunk)
	   *
	   * @param {Array<Object>} tokens The tokens
	   * @returns {{tokens, raw, actual, proxy}|null}
	   * @private
	   */
	
	
	  WriteStream.prototype._writeStaticTokens = function _writeStaticTokens(tokens) {
	    var chunk = this._buildChunk(tokens);
	
	    if (!chunk.actual) {
	      // e.g., no tokens, or a noscript that got ignored
	      return null;
	    }
	
	    chunk.html = this.proxyHistory + chunk.actual;
	    this.proxyHistory += chunk.proxy;
	    this.proxyRoot.innerHTML = chunk.html;
	
	    if (DEBUG_CHUNK) {
	      chunk.proxyInnerHTML = this.proxyRoot.innerHTML;
	    }
	
	    this._walkChunk();
	
	    if (DEBUG_CHUNK) {
	      chunk.actualInnerHTML = this.root.innerHTML;
	    }
	
	    return chunk;
	  };
	
	  /**
	   * Build a chunk.
	   *
	   * @param {Array<Object>} tokens The tokens to use.
	   * @returns {{tokens: *, raw: string, actual: string, proxy: string}}
	   * @private
	   */
	
	
	  WriteStream.prototype._buildChunk = function _buildChunk(tokens) {
	    var nextId = this.actuals.length;
	
	    // The raw html of this chunk.
	    var raw = [];
	
	    // The html to create the nodes in the tokens (with id's injected).
	    var actual = [];
	
	    // Html that can later be used to proxy the nodes in the tokens.
	    var proxy = [];
	
	    var len = tokens.length;
	    for (var i = 0; i < len; i++) {
	      var tok = tokens[i];
	      var tokenRaw = tok.toString();
	
	      raw.push(tokenRaw);
	
	      if (tok.attrs) {
	        // tok.attrs <==> startTag or atomicTag or cursor
	        // Ignore noscript tags. They are atomic, so we don't have to worry about children.
	        if (!/^noscript$/i.test(tok.tagName)) {
	          var id = nextId++;
	
	          // Actual: inject id attribute: replace '>' at end of start tag with id attribute + '>'
	          actual.push(tokenRaw.replace(/(\/?>)/, ' ' + BASEATTR + 'id=' + id + ' $1'));
	
	          // Don't proxy scripts: they have no bearing on DOM structure.
	          if (tok.attrs.id !== PROXY_SCRIPT && tok.attrs.id !== PROXY_STYLE) {
	            // Proxy: strip all attributes and inject proxyof attribute
	            proxy.push(
	            // ignore atomic tags (e.g., style): they have no "structural" effect
	            tok.type === 'atomicTag' ? '' : '<' + tok.tagName + ' ' + BASEATTR + 'proxyof=' + id + (tok.unary ? ' />' : '>'));
	          }
	        }
	      } else {
	        // Visit any other type of token
	        // Actual: append.
	        actual.push(tokenRaw);
	
	        // Proxy: append endTags. Ignore everything else.
	        proxy.push(tok.type === 'endTag' ? tokenRaw : '');
	      }
	    }
	
	    return {
	      tokens: tokens,
	      raw: raw.join(''),
	      actual: actual.join(''),
	      proxy: proxy.join('')
	    };
	  };
	
	  /**
	   * Walk the chunks.
	   *
	   * @private
	   */
	
	
	  WriteStream.prototype._walkChunk = function _walkChunk() {
	    var node = void 0;
	    var stack = [this.proxyRoot];
	
	    // use shift/unshift so that children are walked in document order
	    while (utils.existy(node = stack.shift())) {
	      var isElement = node.nodeType === 1;
	      var isProxy = isElement && getData(node, 'proxyof');
	
	      // Ignore proxies
	      if (!isProxy) {
	        if (isElement) {
	          // New actual element: register it and remove the the id attr.
	          this.actuals[getData(node, 'id')] = node;
	          setData(node, 'id');
	        }
	
	        // Is node's parent a proxy?
	        var parentIsProxyOf = node.parentNode && getData(node.parentNode, 'proxyof');
	        if (parentIsProxyOf) {
	          // Move node under actual parent.
	          this.actuals[parentIsProxyOf].appendChild(node);
	        }
	      }
	
	      // prepend childNodes to stack
	      stack.unshift.apply(stack, utils.toArray(node.childNodes));
	    }
	  };
	
	  /**
	   * Handles Script tokens
	   *
	   * @param {Object} tok The token
	   */
	
	
	  WriteStream.prototype._handleScriptToken = function _handleScriptToken(tok) {
	    var _this = this;
	
	    var remainder = this.parser.clear();
	
	    if (remainder) {
	      // Write remainder immediately behind this script.
	      this.writeQueue.unshift(remainder);
	    }
	
	    tok.src = tok.attrs.src || tok.attrs.SRC;
	
	    tok = this.options.beforeWriteToken(tok);
	    if (!tok) {
	      // User has removed this token
	      return;
	    }
	
	    if (tok.src && this.scriptStack.length) {
	      // Defer this script until scriptStack is empty.
	      // Assumption 1: This script will not start executing until
	      // scriptStack is empty.
	      this.deferredRemote = tok;
	    } else {
	      this._onScriptStart(tok);
	    }
	
	    // Put the script node in the DOM.
	    this._writeScriptToken(tok, function () {
	      _this._onScriptDone(tok);
	    });
	  };
	
	  /**
	   * Handles style tokens
	   *
	   * @param {Object} tok The token
	   */
	
	
	  WriteStream.prototype._handleStyleToken = function _handleStyleToken(tok) {
	    var remainder = this.parser.clear();
	
	    if (remainder) {
	      // Write remainder immediately behind this style.
	      this.writeQueue.unshift(remainder);
	    }
	
	    tok.type = tok.attrs.type || tok.attrs.TYPE || 'text/css';
	
	    tok = this.options.beforeWriteToken(tok);
	
	    if (tok) {
	      // Put the style node in the DOM.
	      this._writeStyleToken(tok);
	    }
	
	    if (remainder) {
	      this.write();
	    }
	  };
	
	  /**
	   * Build a style and insert it into the DOM.
	   *
	   * @param {Object} tok The token
	   */
	
	
	  WriteStream.prototype._writeStyleToken = function _writeStyleToken(tok) {
	    var el = this._buildStyle(tok);
	
	    this._insertCursor(el, PROXY_STYLE);
	
	    // Set content
	    if (tok.content) {
	      if (el.styleSheet && !el.sheet) {
	        el.styleSheet.cssText = tok.content;
	      } else {
	        el.appendChild(this.doc.createTextNode(tok.content));
	      }
	    }
	  };
	
	  /**
	   * Build a style element from an atomic style token.
	   *
	   * @param {Object} tok The token
	   * @returns {Element}
	   */
	
	
	  WriteStream.prototype._buildStyle = function _buildStyle(tok) {
	    var el = this.doc.createElement(tok.tagName);
	
	    el.setAttribute('type', tok.type);
	
	    // Set attributes
	    utils.eachKey(tok.attrs, function (name, value) {
	      el.setAttribute(name, value);
	    });
	
	    return el;
	  };
	
	  /**
	   * Append a span to the stream. That span will act as a cursor
	   * (i.e. insertion point) for the element.
	   *
	   * @param {Object} el The element
	   * @param {string} which The type of proxy element
	   */
	
	
	  WriteStream.prototype._insertCursor = function _insertCursor(el, which) {
	    this._writeImpl('<span id="' + which + '"/>');
	
	    var cursor = this.doc.getElementById(which);
	
	    if (cursor) {
	      cursor.parentNode.replaceChild(el, cursor);
	    }
	  };
	
	  /**
	   * Called when a script is started.
	   *
	   * @param {Object} tok The token
	   * @private
	   */
	
	
	  WriteStream.prototype._onScriptStart = function _onScriptStart(tok) {
	    tok.outerWrites = this.writeQueue;
	    this.writeQueue = [];
	    this.scriptStack.unshift(tok);
	  };
	
	  /**
	   * Called when a script is done.
	   *
	   * @param {Object} tok The token
	   * @private
	   */
	
	
	  WriteStream.prototype._onScriptDone = function _onScriptDone(tok) {
	    // Pop script and check nesting.
	    if (tok !== this.scriptStack[0]) {
	      this.options.error({ msg: 'Bad script nesting or script finished twice' });
	      return;
	    }
	
	    this.scriptStack.shift();
	
	    // Append outer writes to queue and process them.
	    this.write.apply(this, tok.outerWrites);
	
	    // Check for pending remote
	
	    // Assumption 2: if remote_script1 writes remote_script2 then
	    // the we notice remote_script1 finishes before remote_script2 starts.
	    // I think this is equivalent to assumption 1
	    if (!this.scriptStack.length && this.deferredRemote) {
	      this._onScriptStart(this.deferredRemote);
	      this.deferredRemote = null;
	    }
	  };
	
	  /**
	   * Build a script and insert it into the DOM.
	   * Done is called once script has executed.
	   *
	   * @param {Object} tok The token
	   * @param {Function} done The callback when complete
	   */
	
	
	  WriteStream.prototype._writeScriptToken = function _writeScriptToken(tok, done) {
	    var el = this._buildScript(tok);
	    var asyncRelease = this._shouldRelease(el);
	    var afterAsync = this.options.afterAsync;
	
	    if (tok.src) {
	      // Fix for attribute "SRC" (capitalized). IE does not recognize it.
	      el.src = tok.src;
	      this._scriptLoadHandler(el, !asyncRelease ? function () {
	        done();
	        afterAsync();
	      } : afterAsync);
	    }
	
	    try {
	      this._insertCursor(el, PROXY_SCRIPT);
	      if (!el.src || asyncRelease) {
	        done();
	      }
	    } catch (e) {
	      this.options.error(e);
	      done();
	    }
	  };
	
	  /**
	   * Build a script element from an atomic script token.
	   *
	   * @param {Object} tok The token
	   * @returns {Element}
	   */
	
	
	  WriteStream.prototype._buildScript = function _buildScript(tok) {
	    var el = this.doc.createElement(tok.tagName);
	
	    // Set attributes
	    utils.eachKey(tok.attrs, function (name, value) {
	      el.setAttribute(name, value);
	    });
	
	    // Set content
	    if (tok.content) {
	      el.text = tok.content;
	    }
	
	    return el;
	  };
	
	  /**
	   * Setup the script load handler on an element.
	   *
	   * @param {Object} el The element
	   * @param {Function} done The callback
	   * @private
	   */
	
	
	  WriteStream.prototype._scriptLoadHandler = function _scriptLoadHandler(el, done) {
	    function cleanup() {
	      el = el.onload = el.onreadystatechange = el.onerror = null;
	    }
	
	    var error = this.options.error;
	
	    function success() {
	      cleanup();
	      if (done != null) {
	        done();
	      }
	      done = null;
	    }
	
	    function failure(err) {
	      cleanup();
	      error(err);
	      if (done != null) {
	        done();
	      }
	      done = null;
	    }
	
	    function reattachEventListener(el, evt) {
	      var handler = el['on' + evt];
	      if (handler != null) {
	        el['_on' + evt] = handler;
	      }
	    }
	
	    reattachEventListener(el, 'load');
	    reattachEventListener(el, 'error');
	
	    _extends(el, {
	      onload: function onload() {
	        if (el._onload) {
	          try {
	            el._onload.apply(this, Array.prototype.slice.call(arguments, 0));
	          } catch (err) {
	            failure({ msg: 'onload handler failed ' + err + ' @ ' + el.src });
	          }
	        }
	        success();
	      },
	      onerror: function onerror() {
	        if (el._onerror) {
	          try {
	            el._onerror.apply(this, Array.prototype.slice.call(arguments, 0));
	          } catch (err) {
	            failure({ msg: 'onerror handler failed ' + err + ' @ ' + el.src });
	            return;
	          }
	        }
	        failure({ msg: 'remote script failed ' + el.src });
	      },
	      onreadystatechange: function onreadystatechange() {
	        if (/^(loaded|complete)$/.test(el.readyState)) {
	          success();
	        }
	      }
	    });
	  };
	
	  /**
	   * Determines whether to release.
	   *
	   * @param {Object} el The element
	   * @returns {boolean}
	   * @private
	   */
	
	
	  WriteStream.prototype._shouldRelease = function _shouldRelease(el) {
	    var isScript = /^script$/i.test(el.nodeName);
	    return !isScript || !!(this.options.releaseAsync && el.src && el.hasAttribute('async'));
	  };
	
	  return WriteStream;
	}();
	
	exports['default'] = WriteStream;

/***/ },
/* 3 */
/***/ function(module, exports, __webpack_require__) {

	/**
	 * @file prescribe
	 * @description Tiny, forgiving HTML parser
	 * @version vundefined
	 * @see {@link https://github.com/krux/prescribe/}
	 * @license MIT
	 * @author Derek Brans
	 * @copyright 2016 Krux Digital, Inc
	 */
	(function webpackUniversalModuleDefinition(root, factory) {
		if(true)
			module.exports = factory();
		else if(typeof define === 'function' && define.amd)
			define([], factory);
		else if(typeof exports === 'object')
			exports["Prescribe"] = factory();
		else
			root["Prescribe"] = factory();
	})(this, function() {
	return /******/ (function(modules) { // webpackBootstrap
	/******/ 	// The module cache
	/******/ 	var installedModules = {};
	
	/******/ 	// The require function
	/******/ 	function __webpack_require__(moduleId) {
	
	/******/ 		// Check if module is in cache
	/******/ 		if(installedModules[moduleId])
	/******/ 			return installedModules[moduleId].exports;
	
	/******/ 		// Create a new module (and put it into the cache)
	/******/ 		var module = installedModules[moduleId] = {
	/******/ 			exports: {},
	/******/ 			id: moduleId,
	/******/ 			loaded: false
	/******/ 		};
	
	/******/ 		// Execute the module function
	/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
	
	/******/ 		// Flag the module as loaded
	/******/ 		module.loaded = true;
	
	/******/ 		// Return the exports of the module
	/******/ 		return module.exports;
	/******/ 	}
	
	
	/******/ 	// expose the modules object (__webpack_modules__)
	/******/ 	__webpack_require__.m = modules;
	
	/******/ 	// expose the module cache
	/******/ 	__webpack_require__.c = installedModules;
	
	/******/ 	// __webpack_public_path__
	/******/ 	__webpack_require__.p = "";
	
	/******/ 	// Load entry module and return exports
	/******/ 	return __webpack_require__(0);
	/******/ })
	/************************************************************************/
	/******/ ([
	/* 0 */
	/***/ function(module, exports, __webpack_require__) {
	
		'use strict';
	
		var _HtmlParser = __webpack_require__(1);
	
		var _HtmlParser2 = _interopRequireDefault(_HtmlParser);
	
		function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }
	
		module.exports = _HtmlParser2['default'];
	
	/***/ },
	/* 1 */
	/***/ function(module, exports, __webpack_require__) {
	
		'use strict';
	
		exports.__esModule = true;
	
		var _supports = __webpack_require__(2);
	
		var supports = _interopRequireWildcard(_supports);
	
		var _streamReaders = __webpack_require__(3);
	
		var streamReaders = _interopRequireWildcard(_streamReaders);
	
		var _fixedReadTokenFactory = __webpack_require__(6);
	
		var _fixedReadTokenFactory2 = _interopRequireDefault(_fixedReadTokenFactory);
	
		var _utils = __webpack_require__(5);
	
		function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }
	
		function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj['default'] = obj; return newObj; } }
	
		function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
		/**
		 * Detection regular expressions.
		 *
		 * Order of detection matters: detection of one can only
		 * succeed if detection of previous didn't
	
		 * @type {Object}
		 */
		var detect = {
		  comment: /^<!--/,
		  endTag: /^<\//,
		  atomicTag: /^<\s*(script|style|noscript|iframe|textarea)[\s\/>]/i,
		  startTag: /^</,
		  chars: /^[^<]/
		};
	
		/**
		 * HtmlParser provides the capability to parse HTML and return tokens
		 * representing the tags and content.
		 */
	
		var HtmlParser = function () {
		  /**
		   * Constructor.
		   *
		   * @param {string} stream The initial parse stream contents.
		   * @param {Object} options The options
		   * @param {boolean} options.autoFix Set to true to automatically fix errors
		   */
		  function HtmlParser() {
		    var _this = this;
	
		    var stream = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';
		    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
	
		    _classCallCheck(this, HtmlParser);
	
		    this.stream = stream;
	
		    var fix = false;
		    var fixedTokenOptions = {};
	
		    for (var key in supports) {
		      if (supports.hasOwnProperty(key)) {
		        if (options.autoFix) {
		          fixedTokenOptions[key + 'Fix'] = true; // !supports[key];
		        }
		        fix = fix || fixedTokenOptions[key + 'Fix'];
		      }
		    }
	
		    if (fix) {
		      this._readToken = (0, _fixedReadTokenFactory2['default'])(this, fixedTokenOptions, function () {
		        return _this._readTokenImpl();
		      });
		      this._peekToken = (0, _fixedReadTokenFactory2['default'])(this, fixedTokenOptions, function () {
		        return _this._peekTokenImpl();
		      });
		    } else {
		      this._readToken = this._readTokenImpl;
		      this._peekToken = this._peekTokenImpl;
		    }
		  }
	
		  /**
		   * Appends the given string to the parse stream.
		   *
		   * @param {string} str The string to append
		   */
	
	
		  HtmlParser.prototype.append = function append(str) {
		    this.stream += str;
		  };
	
		  /**
		   * Prepends the given string to the parse stream.
		   *
		   * @param {string} str The string to prepend
		   */
	
	
		  HtmlParser.prototype.prepend = function prepend(str) {
		    this.stream = str + this.stream;
		  };
	
		  /**
		   * The implementation of the token reading.
		   *
		   * @private
		   * @returns {?Token}
		   */
	
	
		  HtmlParser.prototype._readTokenImpl = function _readTokenImpl() {
		    var token = this._peekTokenImpl();
		    if (token) {
		      this.stream = this.stream.slice(token.length);
		      return token;
		    }
		  };
	
		  /**
		   * The implementation of token peeking.
		   *
		   * @returns {?Token}
		   */
	
	
		  HtmlParser.prototype._peekTokenImpl = function _peekTokenImpl() {
		    for (var type in detect) {
		      if (detect.hasOwnProperty(type)) {
		        if (detect[type].test(this.stream)) {
		          var token = streamReaders[type](this.stream);
	
		          if (token) {
		            if (token.type === 'startTag' && /script|style/i.test(token.tagName)) {
		              return null;
		            } else {
		              token.text = this.stream.substr(0, token.length);
		              return token;
		            }
		          }
		        }
		      }
		    }
		  };
	
		  /**
		   * The public token peeking interface.  Delegates to the basic token peeking
		   * or a version that performs fixups depending on the `autoFix` setting in
		   * options.
		   *
		   * @returns {object}
		   */
	
	
		  HtmlParser.prototype.peekToken = function peekToken() {
		    return this._peekToken();
		  };
	
		  /**
		   * The public token reading interface.  Delegates to the basic token reading
		   * or a version that performs fixups depending on the `autoFix` setting in
		   * options.
		   *
		   * @returns {object}
		   */
	
	
		  HtmlParser.prototype.readToken = function readToken() {
		    return this._readToken();
		  };
	
		  /**
		   * Read tokens and hand to the given handlers.
		   *
		   * @param {Object} handlers The handlers to use for the different tokens.
		   */
	
	
		  HtmlParser.prototype.readTokens = function readTokens(handlers) {
		    var tok = void 0;
		    while (tok = this.readToken()) {
		      // continue until we get an explicit "false" return
		      if (handlers[tok.type] && handlers[tok.type](tok) === false) {
		        return;
		      }
		    }
		  };
	
		  /**
		   * Clears the parse stream.
		   *
		   * @returns {string} The contents of the parse stream before clearing.
		   */
	
	
		  HtmlParser.prototype.clear = function clear() {
		    var rest = this.stream;
		    this.stream = '';
		    return rest;
		  };
	
		  /**
		   * Returns the rest of the parse stream.
		   *
		   * @returns {string} The contents of the parse stream.
		   */
	
	
		  HtmlParser.prototype.rest = function rest() {
		    return this.stream;
		  };
	
		  return HtmlParser;
		}();
	
		exports['default'] = HtmlParser;
	
	
		HtmlParser.tokenToString = function (tok) {
		  return tok.toString();
		};
	
		HtmlParser.escapeAttributes = function (attrs) {
		  var escapedAttrs = {};
	
		  for (var name in attrs) {
		    if (attrs.hasOwnProperty(name)) {
		      escapedAttrs[name] = (0, _utils.escapeQuotes)(attrs[name], null);
		    }
		  }
	
		  return escapedAttrs;
		};
	
		HtmlParser.supports = supports;
	
		for (var key in supports) {
		  if (supports.hasOwnProperty(key)) {
		    HtmlParser.browserHasFlaw = HtmlParser.browserHasFlaw || !supports[key] && key;
		  }
		}
	
	/***/ },
	/* 2 */
	/***/ function(module, exports) {
	
		'use strict';
	
		exports.__esModule = true;
		var tagSoup = false;
		var selfClose = false;
	
		var work = window.document.createElement('div');
	
		try {
		  var html = '<P><I></P></I>';
		  work.innerHTML = html;
		  exports.tagSoup = tagSoup = work.innerHTML !== html;
		} catch (e) {
		  exports.tagSoup = tagSoup = false;
		}
	
		try {
		  work.innerHTML = '<P><i><P></P></i></P>';
		  exports.selfClose = selfClose = work.childNodes.length === 2;
		} catch (e) {
		  exports.selfClose = selfClose = false;
		}
	
		work = null;
	
		exports.tagSoup = tagSoup;
		exports.selfClose = selfClose;
	
	/***/ },
	/* 3 */
	/***/ function(module, exports, __webpack_require__) {
	
		'use strict';
	
		exports.__esModule = true;
	
		var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; };
	
		exports.comment = comment;
		exports.chars = chars;
		exports.startTag = startTag;
		exports.atomicTag = atomicTag;
		exports.endTag = endTag;
	
		var _tokens = __webpack_require__(4);
	
		/**
		 * Regular Expressions for parsing tags and attributes
		 *
		 * @type {Object}
		 */
		var REGEXES = {
		  startTag: /^<([\-A-Za-z0-9_]+)((?:\s+[\w\-]+(?:\s*=?\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)>/,
		  endTag: /^<\/([\-A-Za-z0-9_]+)[^>]*>/,
		  attr: /(?:([\-A-Za-z0-9_]+)\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|([^>\s]+)))|(?:([\-A-Za-z0-9_]+)(\s|$)+)/g,
		  fillAttr: /^(checked|compact|declare|defer|disabled|ismap|multiple|nohref|noresize|noshade|nowrap|readonly|selected)$/i
		};
	
		/**
		 * Reads a comment token
		 *
		 * @param {string} stream The input stream
		 * @returns {CommentToken}
		 */
		function comment(stream) {
		  var index = stream.indexOf('-->');
		  if (index >= 0) {
		    return new _tokens.CommentToken(stream.substr(4, index - 1), index + 3);
		  }
		}
	
		/**
		 * Reads non-tag characters.
		 *
		 * @param {string} stream The input stream
		 * @returns {CharsToken}
		 */
		function chars(stream) {
		  var index = stream.indexOf('<');
		  return new _tokens.CharsToken(index >= 0 ? index : stream.length);
		}
	
		/**
		 * Reads start tag token.
		 *
		 * @param {string} stream The input stream
		 * @returns {StartTagToken}
		 */
		function startTag(stream) {
		  var endTagIndex = stream.indexOf('>');
		  if (endTagIndex !== -1) {
		    var match = stream.match(REGEXES.startTag);
		    if (match) {
		      var _ret = function () {
		        var attrs = {};
		        var booleanAttrs = {};
		        var rest = match[2];
	
		        match[2].replace(REGEXES.attr, function (match, name) {
		          if (!(arguments[2] || arguments[3] || arguments[4] || arguments[5])) {
		            attrs[name] = '';
		          } else if (arguments[5]) {
		            attrs[arguments[5]] = '';
		            booleanAttrs[arguments[5]] = true;
		          } else {
		            attrs[name] = arguments[2] || arguments[3] || arguments[4] || REGEXES.fillAttr.test(name) && name || '';
		          }
	
		          rest = rest.replace(match, '');
		        });
	
		        return {
		          v: new _tokens.StartTagToken(match[1], match[0].length, attrs, booleanAttrs, !!match[3], rest.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g, ''))
		        };
		      }();
	
		      if ((typeof _ret === 'undefined' ? 'undefined' : _typeof(_ret)) === "object") return _ret.v;
		    }
		  }
		}
	
		/**
		 * Reads atomic tag token.
		 *
		 * @param {string} stream The input stream
		 * @returns {AtomicTagToken}
		 */
		function atomicTag(stream) {
		  var start = startTag(stream);
		  if (start) {
		    var rest = stream.slice(start.length);
		    // for optimization, we check first just for the end tag
		    if (rest.match(new RegExp('<\/\\s*' + start.tagName + '\\s*>', 'i'))) {
		      // capturing the content is inefficient, so we do it inside the if
		      var match = rest.match(new RegExp('([\\s\\S]*?)<\/\\s*' + start.tagName + '\\s*>', 'i'));
		      if (match) {
		        return new _tokens.AtomicTagToken(start.tagName, match[0].length + start.length, start.attrs, start.booleanAttrs, match[1]);
		      }
		    }
		  }
		}
	
		/**
		 * Reads an end tag token.
		 *
		 * @param {string} stream The input stream
		 * @returns {EndTagToken}
		 */
		function endTag(stream) {
		  var match = stream.match(REGEXES.endTag);
		  if (match) {
		    return new _tokens.EndTagToken(match[1], match[0].length);
		  }
		}
	
	/***/ },
	/* 4 */
	/***/ function(module, exports, __webpack_require__) {
	
		'use strict';
	
		exports.__esModule = true;
		exports.EndTagToken = exports.AtomicTagToken = exports.StartTagToken = exports.TagToken = exports.CharsToken = exports.CommentToken = exports.Token = undefined;
	
		var _utils = __webpack_require__(5);
	
		function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
	
		/**
		 * Token is a base class for all token types parsed.  Note we don't actually
		 * use intheritance due to IE8's non-existent ES5 support.
		 */
		var Token =
		/**
		 * Constructor.
		 *
		 * @param {string} type The type of the Token.
		 * @param {Number} length The length of the Token text.
		 */
		exports.Token = function Token(type, length) {
		  _classCallCheck(this, Token);
	
		  this.type = type;
		  this.length = length;
		  this.text = '';
		};
	
		/**
		 * CommentToken represents comment tags.
		 */
	
	
		var CommentToken = exports.CommentToken = function () {
		  /**
		   * Constructor.
		   *
		   * @param {string} content The content of the comment
		   * @param {Number} length The length of the Token text.
		   */
		  function CommentToken(content, length) {
		    _classCallCheck(this, CommentToken);
	
		    this.type = 'comment';
		    this.length = length || (content ? content.length : 0);
		    this.text = '';
		    this.content = content;
		  }
	
		  CommentToken.prototype.toString = function toString() {
		    return '<!--' + this.content;
		  };
	
		  return CommentToken;
		}();
	
		/**
		 * CharsToken represents non-tag characters.
		 */
	
	
		var CharsToken = exports.CharsToken = function () {
		  /**
		   * Constructor.
		   *
		   * @param {Number} length The length of the Token text.
		   */
		  function CharsToken(length) {
		    _classCallCheck(this, CharsToken);
	
		    this.type = 'chars';
		    this.length = length;
		    this.text = '';
		  }
	
		  CharsToken.prototype.toString = function toString() {
		    return this.text;
		  };
	
		  return CharsToken;
		}();
	
		/**
		 * TagToken is a base class for all tag-based Tokens.
		 */
	
	
		var TagToken = exports.TagToken = function () {
		  /**
		   * Constructor.
		   *
		   * @param {string} type The type of the token.
		   * @param {string} tagName The tag name.
		   * @param {Number} length The length of the Token text.
		   * @param {Object} attrs The dictionary of attributes and values
		   * @param {Object} booleanAttrs If an entry has 'true' then the attribute
		   *                              is a boolean attribute
		   */
		  function TagToken(type, tagName, length, attrs, booleanAttrs) {
		    _classCallCheck(this, TagToken);
	
		    this.type = type;
		    this.length = length;
		    this.text = '';
		    this.tagName = tagName;
		    this.attrs = attrs;
		    this.booleanAttrs = booleanAttrs;
		    this.unary = false;
		    this.html5Unary = false;
		  }
	
		  /**
		   * Formats the given token tag.
		   *
		   * @param {TagToken} tok The TagToken to format.
		   * @param {?string} [content=null] The content of the token.
		   * @returns {string} The formatted tag.
		   */
	
	
		  TagToken.formatTag = function formatTag(tok) {
		    var content = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;
	
		    var str = '<' + tok.tagName;
		    for (var key in tok.attrs) {
		      if (tok.attrs.hasOwnProperty(key)) {
		        str += ' ' + key;
	
		        var val = tok.attrs[key];
		        if (typeof tok.booleanAttrs === 'undefined' || typeof tok.booleanAttrs[key] === 'undefined') {
		          str += '="' + (0, _utils.escapeQuotes)(val) + '"';
		        }
		      }
		    }
	
		    if (tok.rest) {
		      str += ' ' + tok.rest;
		    }
	
		    if (tok.unary && !tok.html5Unary) {
		      str += '/>';
		    } else {
		      str += '>';
		    }
	
		    if (content !== undefined && content !== null) {
		      str += content + '</' + tok.tagName + '>';
		    }
	
		    return str;
		  };
	
		  return TagToken;
		}();
	
		/**
		 * StartTagToken represents a start token.
		 */
	
	
		var StartTagToken = exports.StartTagToken = function () {
		  /**
		   * Constructor.
		   *
		   * @param {string} tagName The tag name.
		   * @param {Number} length The length of the Token text
		   * @param {Object} attrs The dictionary of attributes and values
		   * @param {Object} booleanAttrs If an entry has 'true' then the attribute
		   *                              is a boolean attribute
		   * @param {boolean} unary True if the tag is a unary tag
		   * @param {string} rest The rest of the content.
		   */
		  function StartTagToken(tagName, length, attrs, booleanAttrs, unary, rest) {
		    _classCallCheck(this, StartTagToken);
	
		    this.type = 'startTag';
		    this.length = length;
		    this.text = '';
		    this.tagName = tagName;
		    this.attrs = attrs;
		    this.booleanAttrs = booleanAttrs;
		    this.html5Unary = false;
		    this.unary = unary;
		    this.rest = rest;
		  }
	
		  StartTagToken.prototype.toString = function toString() {
		    return TagToken.formatTag(this);
		  };
	
		  return StartTagToken;
		}();
	
		/**
		 * AtomicTagToken represents an atomic tag.
		 */
	
	
		var AtomicTagToken = exports.AtomicTagToken = function () {
		  /**
		   * Constructor.
		   *
		   * @param {string} tagName The name of the tag.
		   * @param {Number} length The length of the tag text.
		   * @param {Object} attrs The attributes.
		   * @param {Object} booleanAttrs If an entry has 'true' then the attribute
		   *                              is a boolean attribute
		   * @param {string} content The content of the tag.
		   */
		  function AtomicTagToken(tagName, length, attrs, booleanAttrs, content) {
		    _classCallCheck(this, AtomicTagToken);
	
		    this.type = 'atomicTag';
		    this.length = length;
		    this.text = '';
		    this.tagName = tagName;
		    this.attrs = attrs;
		    this.booleanAttrs = booleanAttrs;
		    this.unary = false;
		    this.html5Unary = false;
		    this.content = content;
		  }
	
		  AtomicTagToken.prototype.toString = function toString() {
		    return TagToken.formatTag(this, this.content);
		  };
	
		  return AtomicTagToken;
		}();
	
		/**
		 * EndTagToken represents an end tag.
		 */
	
	
		var EndTagToken = exports.EndTagToken = function () {
		  /**
		   * Constructor.
		   *
		   * @param {string} tagName The name of the tag.
		   * @param {Number} length The length of the tag text.
		   */
		  function EndTagToken(tagName, length) {
		    _classCallCheck(this, EndTagToken);
	
		    this.type = 'endTag';
		    this.length = length;
		    this.text = '';
		    this.tagName = tagName;
		  }
	
		  EndTagToken.prototype.toString = function toString() {
		    return '</' + this.tagName + '>';
		  };
	
		  return EndTagToken;
		}();
	
	/***/ },
	/* 5 */
	/***/ function(module, exports) {
	
		'use strict';
	
		exports.__esModule = true;
		exports.escapeQuotes = escapeQuotes;
	
		/**
		 * Escape quotes in the given value.
		 *
		 * @param {string} value The value to escape.
		 * @param {string} [defaultValue=''] The default value to return if value is falsy.
		 * @returns {string}
		 */
		function escapeQuotes(value) {
		  var defaultValue = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';
	
		  // There's no lookback in JS, so /(^|[^\\])"/ only matches the first of two `"`s.
		  // Instead, just match anything before a double-quote and escape if it's not already escaped.
		  return !value ? defaultValue : value.replace(/([^"]*)"/g, function (_, prefix) {
		    return (/\\/.test(prefix) ? prefix + '"' : prefix + '\\"'
		    );
		  });
		}
	
	/***/ },
	/* 6 */
	/***/ function(module, exports) {
	
		'use strict';
	
		exports.__esModule = true;
		exports['default'] = fixedReadTokenFactory;
		/**
		 * Empty Elements - HTML 4.01
		 *
		 * @type {RegExp}
		 */
		var EMPTY = /^(AREA|BASE|BASEFONT|BR|COL|FRAME|HR|IMG|INPUT|ISINDEX|LINK|META|PARAM|EMBED)$/i;
	
		/**
		 * Elements that you can intentionally leave open (and which close themselves)
		 *
		 * @type {RegExp}
		 */
		var CLOSESELF = /^(COLGROUP|DD|DT|LI|OPTIONS|P|TD|TFOOT|TH|THEAD|TR)$/i;
	
		/**
		 * Corrects a token.
		 *
		 * @param {Token} tok The token to correct
		 * @returns {Token} The corrected token
		 */
		function correct(tok) {
		  if (tok && tok.type === 'startTag') {
		    tok.unary = EMPTY.test(tok.tagName) || tok.unary;
		    tok.html5Unary = !/\/>$/.test(tok.text);
		  }
		  return tok;
		}
	
		/**
		 * Peeks at the next token in the parser.
		 *
		 * @param {HtmlParser} parser The parser
		 * @param {Function} readTokenImpl The underlying readToken implementation
		 * @returns {Token} The next token
		 */
		function peekToken(parser, readTokenImpl) {
		  var tmp = parser.stream;
		  var tok = correct(readTokenImpl());
		  parser.stream = tmp;
		  return tok;
		}
	
		/**
		 * Closes the last token.
		 *
		 * @param {HtmlParser} parser The parser
		 * @param {Array<Token>} stack The stack
		 */
		function closeLast(parser, stack) {
		  var tok = stack.pop();
	
		  // prepend close tag to stream.
		  parser.prepend('</' + tok.tagName + '>');
		}
	
		/**
		 * Create a new token stack.
		 *
		 * @returns {Array<Token>}
		 */
		function newStack() {
		  var stack = [];
	
		  stack.last = function () {
		    return this[this.length - 1];
		  };
	
		  stack.lastTagNameEq = function (tagName) {
		    var last = this.last();
		    return last && last.tagName && last.tagName.toUpperCase() === tagName.toUpperCase();
		  };
	
		  stack.containsTagName = function (tagName) {
		    for (var i = 0, tok; tok = this[i]; i++) {
		      if (tok.tagName === tagName) {
		        return true;
		      }
		    }
		    return false;
		  };
	
		  return stack;
		}
	
		/**
		 * Return a readToken implementation that fixes input.
		 *
		 * @param {HtmlParser} parser The parser
		 * @param {Object} options Options for fixing
		 * @param {boolean} options.tagSoupFix True to fix tag soup scenarios
		 * @param {boolean} options.selfCloseFix True to fix self-closing tags
		 * @param {Function} readTokenImpl The underlying readToken implementation
		 * @returns {Function}
		 */
		function fixedReadTokenFactory(parser, options, readTokenImpl) {
		  var stack = newStack();
	
		  var handlers = {
		    startTag: function startTag(tok) {
		      var tagName = tok.tagName;
	
		      if (tagName.toUpperCase() === 'TR' && stack.lastTagNameEq('TABLE')) {
		        parser.prepend('<TBODY>');
		        prepareNextToken();
		      } else if (options.selfCloseFix && CLOSESELF.test(tagName) && stack.containsTagName(tagName)) {
		        if (stack.lastTagNameEq(tagName)) {
		          closeLast(parser, stack);
		        } else {
		          parser.prepend('</' + tok.tagName + '>');
		          prepareNextToken();
		        }
		      } else if (!tok.unary) {
		        stack.push(tok);
		      }
		    },
		    endTag: function endTag(tok) {
		      var last = stack.last();
		      if (last) {
		        if (options.tagSoupFix && !stack.lastTagNameEq(tok.tagName)) {
		          // cleanup tag soup
		          closeLast(parser, stack);
		        } else {
		          stack.pop();
		        }
		      } else if (options.tagSoupFix) {
		        // cleanup tag soup part 2: skip this token
		        readTokenImpl();
		        prepareNextToken();
		      }
		    }
		  };
	
		  function prepareNextToken() {
		    var tok = peekToken(parser, readTokenImpl);
		    if (tok && handlers[tok.type]) {
		      handlers[tok.type](tok);
		    }
		  }
	
		  return function fixedReadToken() {
		    prepareNextToken();
		    return correct(readTokenImpl());
		  };
		}
	
	/***/ }
	/******/ ])
	});
	;

/***/ },
/* 4 */
/***/ function(module, exports) {

	'use strict';
	
	exports.__esModule = true;
	
	var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; };
	
	exports.existy = existy;
	exports.isFunction = isFunction;
	exports.each = each;
	exports.eachKey = eachKey;
	exports.defaults = defaults;
	exports.toArray = toArray;
	exports.last = last;
	exports.isTag = isTag;
	exports.isScript = isScript;
	exports.isStyle = isStyle;
	/**
	 * Determine if the thing is not undefined and not null.
	 *
	 * @param {*} thing The thing to test
	 * @returns {boolean} True if the thing is not undefined and not null.
	 */
	function existy(thing) {
	  return thing !== void 0 && thing !== null;
	}
	
	/**
	 * Is this a function?
	 *
	 * @param {*} x The variable to test
	 * @returns {boolean} True if the variable is a function
	 */
	function isFunction(x) {
	  return 'function' === typeof x;
	}
	
	/**
	 * Loop over each item in an array-like value.
	 *
	 * @param {Array<*>} arr The array to loop over
	 * @param {Function} fn The function to call
	 * @param {?Object} target The object to bind to the function
	 */
	function each(arr, fn, target) {
	  var i = void 0;
	  var len = arr && arr.length || 0;
	  for (i = 0; i < len; i++) {
	    fn.call(target, arr[i], i);
	  }
	}
	
	/**
	 * Loop over each key/value pair in a hash.
	 *
	 * @param {Object} obj The object
	 * @param {Function} fn The function to call
	 * @param {?Object} target The object to bind to the function
	 */
	function eachKey(obj, fn, target) {
	  for (var key in obj) {
	    if (obj.hasOwnProperty(key)) {
	      fn.call(target, key, obj[key]);
	    }
	  }
	}
	
	/**
	 * Set default options where some option was not specified.
	 *
	 * @param {Object} options The destination
	 * @param {Object} _defaults The defaults
	 * @returns {Object}
	 */
	function defaults(options, _defaults) {
	  options = options || {};
	  eachKey(_defaults, function (key, val) {
	    if (!existy(options[key])) {
	      options[key] = val;
	    }
	  });
	  return options;
	}
	
	/**
	 * Convert value (e.g., a NodeList) to an array.
	 *
	 * @param {*} obj The object
	 * @returns {Array<*>}
	 */
	function toArray(obj) {
	  try {
	    return Array.prototype.slice.call(obj);
	  } catch (e) {
	    var _ret = function () {
	      var ret = [];
	      each(obj, function (val) {
	        ret.push(val);
	      });
	      return {
	        v: ret
	      };
	    }();
	
	    if ((typeof _ret === 'undefined' ? 'undefined' : _typeof(_ret)) === "object") return _ret.v;
	  }
	}
	
	/**
	 * Get the last item in an array
	 *
	 * @param {Array<*>} array The array
	 * @returns {*} The last item in the array
	 */
	function last(array) {
	  return array[array.length - 1];
	}
	
	/**
	 * Test if token is a script tag.
	 *
	 * @param {Object} tok The token
	 * @param {String} tag The tag name
	 * @returns {boolean} True if the token is a script tag
	 */
	function isTag(tok, tag) {
	  return !tok || !(tok.type === 'startTag' || tok.type === 'atomicTag') || !('tagName' in tok) ? !1 : !!~tok.tagName.toLowerCase().indexOf(tag);
	}
	
	/**
	 * Test if token is a script tag.
	 *
	 * @param {Object} tok The token
	 * @returns {boolean} True if the token is a script tag
	 */
	function isScript(tok) {
	  return isTag(tok, 'script');
	}
	
	/**
	 * Test if token is a style tag.
	 *
	 * @param {Object} tok The token
	 * @returns {boolean} True if the token is a style tag
	 */
	function isStyle(tok) {
	  return isTag(tok, 'style');
	}

/***/ }
/******/ ])
});
;
//# sourceMappingURL=postscribe.js.map
          }

        },
        "core/src/lib/actions/helpers/getSourceByUrl.js": {
          "script": function(module, exports, require, turbine) {
/***************************************************************************************
 * (c) 2017 Adobe. All rights reserved.
 * This file is licensed to you under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License. You may obtain a copy
 * of the License at http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under
 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
 * OF ANY KIND, either express or implied. See the License for the specific language
 * governing permissions and limitations under the License.
 ****************************************************************************************/

'use strict';
var loadScript = require('@adobe/reactor-load-script');
var Promise = require('@adobe/reactor-promise');

var codeBySourceUrl = {};
var scriptStore = {};

var loadScriptOnlyOnce = function(url) {
  if (!scriptStore[url]) {
    scriptStore[url] = loadScript(url);
  }

  return scriptStore[url];
};

_satellite.__registerScript = function(sourceUrl, code) {
  codeBySourceUrl[sourceUrl] = code;
};

module.exports = function(sourceUrl) {
  if (codeBySourceUrl[sourceUrl]) {
    return Promise.resolve(codeBySourceUrl[sourceUrl]);
  } else {
    return new Promise(function(resolve) {
      loadScriptOnlyOnce(sourceUrl).then(function() {
        resolve(codeBySourceUrl[sourceUrl]);
      }, function() {
        resolve();
      });
    });
  }
};

          }

        },
        "core/src/lib/helpers/visitorTracking.js": {
          "script": function(module, exports, require, turbine) {
/***************************************************************************************
 * (c) 2017 Adobe. All rights reserved.
 * This file is licensed to you under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License. You may obtain a copy
 * of the License at http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under
 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
 * OF ANY KIND, either express or implied. See the License for the specific language
 * governing permissions and limitations under the License.
 ****************************************************************************************/

'use strict';

var cookie = require('@adobe/reactor-cookie');
var document = require('@adobe/reactor-document');
var window = require('@adobe/reactor-window');
var getNamespacedStorage = require('./getNamespacedStorage');

var COOKIE_PREFIX = '_sdsat_';
var STORAGE_NAMESPACE = 'visitorTracking';
var MIGRATED_KEY = 'cookiesMigrated';

var visitorTrackingLocalStorage = getNamespacedStorage('localStorage', STORAGE_NAMESPACE);
var visitorTrackingSessionStorage = getNamespacedStorage('sessionStorage', STORAGE_NAMESPACE);

// returns whether this is a new visitor session
var trackLandingPageAndTime = function() {
  var existingLandingPage = visitorTrackingSessionStorage.getItem('landingPage');

  if (!existingLandingPage) {
    visitorTrackingSessionStorage.setItem('landingPage', window.location.href);
    visitorTrackingSessionStorage.setItem('landingTime', new Date().getTime());
  }

  return !existingLandingPage;
};

var getLandingPage = function() {
  return visitorTrackingSessionStorage.getItem('landingPage');
};

var getLandingTime = function() {
  return Number(visitorTrackingSessionStorage.getItem('landingTime'));
};

var getSessionCount = function() {
  return Number(visitorTrackingLocalStorage.getItem('sessionCount'));
};

var getLifetimePageViewCount = function() {
  return Number(visitorTrackingLocalStorage.getItem('pagesViewed'));
};

var getMinutesOnSite = function() {
  var now = new Date().getTime();
  return Math.floor((now - getLandingTime()) / 1000 / 60);
};

var getTrafficSource = function() {
  return visitorTrackingSessionStorage.getItem('trafficSource');
};

var getSessionPageViewCount = function() {
  return Number(visitorTrackingSessionStorage.getItem('pagesViewed'));
};

var getIsNewVisitor = function() {
  return getSessionCount() === 1;
};

var trackSessionCount = function(newSession) {
  if (newSession) {
    visitorTrackingLocalStorage.setItem('sessionCount', getSessionCount() + 1);
  }
};

var trackSessionPageViewCount = function() {
  visitorTrackingSessionStorage.setItem('pagesViewed', getSessionPageViewCount() + 1);
};

var trackLifetimePageViewCount = function() {
  visitorTrackingLocalStorage.setItem('pagesViewed', getLifetimePageViewCount() + 1);
};

var trackTrafficSource = function() {
  if (!visitorTrackingSessionStorage.getItem('trafficSource')) {
    visitorTrackingSessionStorage.setItem('trafficSource', document.referrer);
  }
};

// Remove when migration period has ended. We intentionally leave cookies as they are so that if
// DTM is running on the same domain it can still use the persisted values. Our migration strategy
// is essentially copying data from cookies and then diverging the storage mechanism between
// DTM and Launch (DTM uses cookies and Launch uses session and local storage).
var migrateCookieData = function() {
  if (!visitorTrackingLocalStorage.getItem(MIGRATED_KEY)) {
    // We intentionally do not migrate session-based data since it would only affect a user that
    // came from a page running DTM to a page running Launch and only the first visit.
    var sessionCount = cookie.get(COOKIE_PREFIX + 'session_count');

    if (sessionCount) {
      visitorTrackingLocalStorage.setItem('sessionCount', sessionCount);
    }

    var lifetimePagesViewed = cookie.get(COOKIE_PREFIX + 'lt_pages_viewed');

    if (lifetimePagesViewed) {
      visitorTrackingLocalStorage.setItem('pagesViewed', lifetimePagesViewed);
    }

    visitorTrackingLocalStorage.setItem(MIGRATED_KEY, true);
  }
};

var trackVisitor = function() {
  var newSession = trackLandingPageAndTime();
  trackSessionCount(newSession);
  trackLifetimePageViewCount();
  trackSessionPageViewCount();
  trackTrafficSource();
};

migrateCookieData();
trackVisitor();

module.exports = {
  getLandingPage: getLandingPage,
  getLandingTime: getLandingTime,
  getMinutesOnSite: getMinutesOnSite,
  getSessionCount: getSessionCount,
  getLifetimePageViewCount: getLifetimePageViewCount,
  getSessionPageViewCount: getSessionPageViewCount,
  getTrafficSource: getTrafficSource,
  getIsNewVisitor: getIsNewVisitor
};

          }

        },
        "core/src/lib/conditions/helpers/compareNumbers.js": {
          "script": function(module, exports, require, turbine) {
/***************************************************************************************
 * (c) 2017 Adobe. All rights reserved.
 * This file is licensed to you under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License. You may obtain a copy
 * of the License at http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under
 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
 * OF ANY KIND, either express or implied. See the License for the specific language
 * governing permissions and limitations under the License.
 ****************************************************************************************/

'use strict';

/**
 * Enum for comparison operators.
 * @readonly
 * @enum {string}
 */
var comparisonOperator = {
  GREATER_THAN: '>',
  LESS_THAN: '<',
  EQUALS: '='
};

/**
 * Compares two numbers using a comparison operator enumeration value.
 * @param {number} num1 The first number.
 * @param {comparisonOperator} The comparison operator.
 * @param {number} num2 The second number.
 * @returns {Function}
 */
var compareNumbers = function(num1, op, num2) {
  switch (op) {
    case comparisonOperator.GREATER_THAN:
      return num1 > num2;
    case comparisonOperator.LESS_THAN:
      return num1 < num2;
    case comparisonOperator.EQUALS:
      return num1 === num2;
  }
};

/**
 * Utility for comparing two numbers.
 * @returns {Function}
 */
module.exports = compareNumbers;

          }

        },
        "core/src/lib/helpers/getNamespacedStorage.js": {
          "script": function(module, exports, require, turbine) {
/***************************************************************************************
 * (c) 2017 Adobe. All rights reserved.
 * This file is licensed to you under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License. You may obtain a copy
 * of the License at http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under
 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
 * OF ANY KIND, either express or implied. See the License for the specific language
 * governing permissions and limitations under the License.
 ****************************************************************************************/
'use strict';

var window = require('@adobe/reactor-window');
var BASE_NAMESPACE = 'com.adobe.reactor.core';

module.exports = function(storageType, additionalNamespace) {
  var namespace = BASE_NAMESPACE + '.' + additionalNamespace;

  // When storage is disabled on Safari, the mere act of referencing window.localStorage
  // or window.sessionStorage throws an error. For this reason, we wrap in a try-catch.
  return {
    /**
     * Reads a value from storage.
     * @param {string} name The name of the item to be read.
     * @returns {string}
     */
    getItem: function(name) {
      try {
        return window[storageType].getItem(namespace + '.' + name);
      } catch (e) {
        return null;
      }
    },
    /**
     * Saves a value to storage.
     * @param {string} name The name of the item to be saved.
     * @param {string} value The value of the item to be saved.
     * @returns {boolean} Whether the item was successfully saved to storage.
     */
    setItem: function(name, value) {
      try {
        window[storageType].setItem(namespace + '.' + name, value);
        return true;
      } catch (e) {
        return false;
      }
    }
  };
};


          }

        }
      }
    },
    "google-adwords": {
      "displayName": "Google Ads",
      "hostedLibFilesBaseUrl": "//img-prod-cms-rt-microsoft-com.akamaized.net/launch/store/5ef092d1efb5/21b18fecd107/508b5fde54de/hostedLibFiles/EP0c3eb682977f4498b44855d2e1d8c210/",
      "modules": {
      }
    },
    "linkedin": {
      "displayName": "LinkedIn Insight Tag",
      "hostedLibFilesBaseUrl": "//img-prod-cms-rt-microsoft-com.akamaized.net/launch/store/5ef092d1efb5/21b18fecd107/508b5fde54de/hostedLibFiles/EP56446adda5514f21aa663f9e3635ddaa/",
      "settings": {
        "insightTagID": "7850"
      },
      "modules": {
        "linkedin/src/lib/actions/loadInsightTag.js": {
          "name": "load-insight-tag",
          "displayName": "Load Insight Tag",
          "script": function(module, exports, require, turbine) {
'use strict';

/**
 * Adobe Launch sends settings object when this action is triggered.
 * @params {object} settings
 * @property {string} insightTagID
 */
module.exports = function() {
  // fetch extension configuration settings to read the insightTagID.
  var settings = turbine.getExtensionSettings();

  if (settings && settings.insightTagID) {
    // Below code is responsible in loading insight tag javascript which is same as asking customers
    // to copy paste the presented javascript code in Campaign Manager tool.
    // We don't want get this code dynamically by providing a public API because it may slow down our
    // customer's website due to 2 network calls one for loading below code and two for loading
    // insight.min.js.
    window['_linkedin_data_partner_id'] = settings.insightTagID;
    var s = document.getElementsByTagName("script")[0];
    var b = document.createElement("script");
    b.type = "text/javascript";
    b.async = true;
    b.src = "https://snap.licdn.com/li.lms-analytics/insight.min.js";
    s.parentNode.insertBefore(b, s);
  }
};

          }

        }
      }
    },
    "bing-ads-extension": {
      "displayName": "Bing Ads UET Tag",
      "hostedLibFilesBaseUrl": "//img-prod-cms-rt-microsoft-com.akamaized.net/launch/store/5ef092d1efb5/21b18fecd107/508b5fde54de/hostedLibFiles/EP05eac6e292f1486a812623da300a51b4/",
      "settings": {
        "qname": "uetq_Amplify",
        "tagid": "149014572",
        "navTimingApi": true,
        "storeConvTrackCookies": true
      },
      "modules": {
      }
    },
    "twitter-uwt": {
      "displayName": "Twitter Universal Website Tag",
      "hostedLibFilesBaseUrl": "//img-prod-cms-rt-microsoft-com.akamaized.net/launch/store/5ef092d1efb5/21b18fecd107/508b5fde54de/hostedLibFiles/EP0393ce01ac3540acb78f103d8e58a5a0/",
      "settings": {
        "account_id": "o4co9"
      },
      "modules": {
      }
    },
    "gtag.js": {
      "displayName": "Google gtag",
      "hostedLibFilesBaseUrl": "//img-prod-cms-rt-microsoft-com.akamaized.net/launch/store/5ef092d1efb5/21b18fecd107/508b5fde54de/hostedLibFiles/EPafb38e52c35f4c8e9725c5b669a4431d/",
      "settings": {
        "conversionIdList": [
          "923371515"
        ]
      },
      "modules": {
        "gtag.js/src/lib/gtagCode.js": {
          "script": function(module, exports, require, turbine) {
'use strict';

var loadScript = require('@adobe/reactor-load-script');
var extensionSettings = turbine.getExtensionSettings();
var conversionIdList = extensionSettings.conversionIdList;
var dataLayerName = extensionSettings.dataLayerName;
var url = 'https://www.googletagmanager.com/gtag/js?id=' + conversionIdList[0];

if (dataLayerName) {
    url = 'https://www.googletagmanager.com/gtag/js?id=' + conversionIdList[0] + '&l=' + dataLayerName;
}

loadScript(url);

if ((window.dataLayer && !Array.isArray(window.dataLayer)) && !dataLayerName) {
    console.log('window.dataLayer already exists and is not an array. Visit the gtag extension configuration in ' +
        'Launch and provide a custom data layer name of your choosing.');
}

if (dataLayerName) {
    window[dataLayerName] = window[dataLayerName] || [];
    window.gtag = function () {
        window[dataLayerName].push(arguments);
    };
} else {
    window.dataLayer = window.dataLayer || [];
    window.gtag = function () {
        dataLayer.push(arguments);
    };
}

gtag('js', new Date());
conversionIdList.forEach(function (conversionId) {
    gtag('config', conversionId);
});
          }

        }
      }
    }
  },
  "company": {
    "orgId": "EA76ADE95776D2EC7F000101@AdobeOrg",
    "dynamicCdnEnabled": false
  },
  "property": {
    "name": "Store",
    "settings": {
      "domains": [
        "microsoft.com"
      ],
      "undefinedVarsReturnEmpty": false,
      "ruleComponentSequencingEnabled": false
    },
    "id": "PRb55c9879b37e451cb2349365f439f194"
  },
  "rules": [
    {
      "id": "RL4f2bc935924f443e8a5d5f819389d319",
      "name": "Media_/EN-US/Business Consultation Signup LinkedIn (AEM/RT)",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 50.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/path.js",
          "settings": {
            "paths": [
              {
                "value": "/en-us/store/b/business-consultation",
                "valueIsRegex": true
              }
            ]
          }
        },
        {
          "modulePath": "core/src/lib/conditions/domain.js",
          "settings": {
            "domains": [
              "microsoft.com"
            ]
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "try\n{\n// LinkedIn pixel\n$('a[href*=\"https://digitalreservations.microsoft.com/en-us/appointment/create\"]').on(\"mousedown\", function () {\n  var image = new Image(1, 1);\n  image.src =\"https://px.ads.linkedin.com/collect/?pid=7850&conversionId=4082786&fmt=gif\";\n});\n  \n }\ncatch(err)\n{\n\t_satellite.logger.error(\"Media_/EN-US/Business Consultation Signup LinkedIn (AEM/RT)\");\n}",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RL9287f2337be44c2fba49bde96a312917",
      "name": "GOOGRTG",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 70.0
        }
      ],
      "conditions": [

      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "try\n{\n\tvar totamount = 0,\n\t  totvalstring = \"\",\n\t  googpagetype = \"other\",\n\t  prodstring = \"\",\n\t  img=\"\";\n\tvar pagetypemap = {\n\t  \"home\": \"home\",\n\t  \"search\": \"searchresults\",\n\t  \"detail\": \"product\",\n\t  \"category\": \"category\",\n\t  \"checkout_shopping_cart\": \"cart\",\n\t  \"cart\": \"cart\",\n\t  \"list\": \"category\",\n\t  \"receipt\": \"purchase\"\n\t};\n\n\ttry {\n\t  if (_TMDL.pageType && pagetypemap[_TMDL.pageType.toLowerCase()]) {\n\t\tgoogpagetype = pagetypemap[_TMDL.pageType.toLowerCase()];\n\t  }\n\t  for (var i = 0; i < _TMDL.pids.length; i++) {\n\t\tif (parseFloat(_TMDL.sales[i]) > 0) {\n\t\t  totamount += parseFloat(_TMDL.sales[i]);\n\t\t}\n\t  }\n\t} catch (e) {}\n\n\tif (_TMDL.pidsku.length) {\n\t  prodstring = \"%3Becomm_prodid%3D\" + _TMDL.pidsku.join(\"%2C\"); \n\t}\n\n\tif (totamount > 0) {\n\t  totvalstring = \"%3Becomm_totalvalue%3D\" + totamount;\n\t}\n\n\timg = \"//googleads.g.doubleclick.net/pagead/viewthroughconversion/923371515/?guid=ON&script=0&url=\" + encodeURIComponent(window.location.hostname + window.location.pathname) + \"&data=ecomm_pagetype%3D\" + googpagetype + prodstring + totvalstring;\n\n\tvar c=new Image(0,0);\n\tc.src=img;\n}\ncatch(err)\n{\n\t_satellite.logger.error(\"GOOGRTG\");\t\n}\n",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RL6e1b2c3b050c4302a2b7850482df32d0",
      "name": "Surface Indirect Consumer",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 50.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/path.js",
          "settings": {
            "paths": [
              {
                "value": "(en-ca|fr-ca|en-us|fr-fr|de-de|en-gb|ja-jp|es-es|nl-nl|en-au)/store/b/sale",
                "valueIsRegex": true
              },
              {
                "value": "(en-ca|fr-ca|fr-fr|de-de|en-gb|es-es|nl-nl|en-au|ja-jp)/store/b/student",
                "valueIsRegex": true
              },
              {
                "value": "/en-us/store/b/education",
                "valueIsRegex": true
              }
            ]
          }
        },
        {
          "modulePath": "core/src/lib/conditions/dateRange.js",
          "settings": {
            "end": "2023-08-01T00:00:00Z",
            "start": "2022-07-01T00:00:00Z"
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "// JavaScript source code\nvar allMicrosoftClicks = 'a[href*=\"microsoft\"]';\nvar allXboxClicks = 'a[href*=\"xbox\"]';\nvar otherRedirects = 'a[href*=\"#\"]';\nvar configBut = 'button[id*=\"buttons_ConfigureDeviceButton\"]';\nvar productCards = 'div[class*=\"material-card\"]';\nvar mat = 'div[class*=\"material-surface\"]';\n\nfunction attachPixels(elementAddress) {\n    $(document).on('mousedown', elementAddress, '', function () {\n        var image = new Image(1, 1);\n        image.src = \"https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&ea=SurfaceButtonClick\";\n\n        var image2 = new Image(1, 1);\n        image2.src = \"https://secure.adnxs.com/px?id=1268102&t=2\";\n    });\n}\n\ntry {\n    attachPixels(allMicrosoftClicks);\n    attachPixels(allXboxClicks);\n    attachPixels(otherRedirects);\n    attachPixels(configBut);\n    attachPixels(productCards);\n    attachPixels(mat);\n}\ncatch (err) {\n    _satellite.logger.error(\"Surface Indirect Consumer\");\n}",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RL665debaffb1f41d4aa72af52480b524b",
      "name": "Media_/LL-LL/ Reddit Surface Purchase",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 50.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/customCode.js",
          "settings": {
            "source": function(event, target) {
  return (window.location.host.toLowerCase()=="query.prod.cms.rt.microsoft.com" && ~window.location.search.indexOf("pN=congrats"));
}
          }
        },
        {
          "modulePath": "core/src/lib/conditions/dateRange.js",
          "settings": {
            "end": "2022-07-01T00:00:00Z",
            "start": "2021-11-03T00:00:00Z"
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "//Reddit Surface Pixel\nif (_TMDL.geo==\"US\" || _TMDL.geo==\"AU\" || _TMDL.geo==\"GB\") {\ntry\n{\nvar ps=\"\",inScope=0\nfor (var i=0; i<_TMDL.pids.length; i++) {\nif (_TMDL.pidsku.length > i) {\nps = _TMDL.pidsku[i].toUpperCase();\nif (ps==\"8VDB5VRKC5TQ-6V0M\" || ps==\"8MN7MP9NQDLK-7Z5S\" || ps==\"8N17J0M5ZZQS-KMF5\" || ps==\"8N17J0M5ZZQS-08ZH\" || ps==\"8VDB5VRKC5TQ-M6M3\" || ps==\"8X0X6SC9Z3XP-F0RD\" || ps==\"8V9DP4LNKNSZ-G8RH\" || ps==\"93H0MB2GQD5B-69W9\" || \n    ps==\"8MRGKL8T2V5D-23RF\" || ps==\"943Q37FN6ZPR-4J1S\" || ps==\"8XBW9G3Z71F1-32LS\" || ps==\"8N17J0M5ZZQS-H9HB\" || ps==\"8XJQ3D3LRP0R-31VG\" || ps==\"8P43N3K93409-JLV2\" || ps==\"91V4VTMHXWPM-6FK8\" || ps==\"8MRGKL8T2V5D-KJ9H\" || \n    ps==\"8MZBMMCK11LF-0002\" || ps==\"90Z3M8L4GD7W-0003\" || ps==\"8PG9R8WB09L0-D49K\" || ps==\"8XJQ3D3LRP0R-JX7S\" || ps==\"8P43N3K93409-2JJ1\" || ps==\"8V9DP4LNKNSZ-L8M8\" || ps==\"8TBXXVBPWHM1-GL2P\" || ps==\"8X1TZLKCLXTB-26TK\" || \n    ps==\"8VLM29FGK062-L12T\" || ps==\"8X1TZLKCLXTB-DBFX\" || ps==\"8XJQ3D3LRP0R-FJSJ\" || ps==\"8V5N3QW7D8H9-HDH2\" || ps==\"8XBW9G3Z71F1-KVHT\" || ps==\"8P43N3K93409-K4S8\" || ps==\"8T5N0LQMWFQG-4X5H\" || ps==\"8MZBMMCK15G3-0003\" || \n    ps==\"8NN2SMPXK1FR-98ZX\" || ps==\"8PFWCT94P154-0005\" || ps==\"8PT3S2VJMDR6-2473\" || ps==\"8X1TZLKCLXTB-KS6R\" || ps==\"8N17J0M5ZZQS-JTX3\" || ps==\"8XJQ3D3LRP0R-GRF9\" || ps==\"943Q37FN6ZPR-2Q0H\" || ps==\"8X1TZLKCLXTB-8MR5\" || \n    ps==\"8XJQ3D3LRP0R-9C5V\" || ps==\"8XBW9G3Z71F1-25QZ\" || ps==\"8T0RW4PT6NT4-C2GK\" || ps==\"8TH6D1P49DV4-HSS7\" || ps==\"8XJQ3D3LRP0R-51CT\" || ps==\"93LTM69S3RFF-70F1\" || ps==\"8Q4HGC6KBMDQ-C0WW\" || ps==\"8QD9GGH2HZQS-L58W\" || \n    ps==\"8VSZF6WTWF29-HP78\" || ps==\"8XJQ3D3LRP0R-007Q\" || ps==\"93ZCTN7HQTST-503S\" || ps==\"8N0KT2Q6SNRT-M373\" || ps==\"8VSZF6WTWF29-6PVT\" || ps==\"93D7NWW5NQ3H-BB5F\" || ps==\"8Q340M559RMR-6H18\" || ps==\"8MJC4RMVLTJ0-7HMP\" || \n    ps==\"92FP8Q09QHXC-829R\" || ps==\"93D7NWW5NQ3H-DFWC\" || ps==\"8ZC6JRR8JMR8-8B0T\" || ps==\"8T0RW4PT6NT4-74N8\" || ps==\"90FJ6ZKW1RZB-0B4L\" || ps==\"93D7NWW5NQ3H-DX19\" || ps==\"8ZG5FH1FMDSR-C3HL\" || ps==\"8R9CPQ146064-L5RT\" || \n    ps==\"8QC5P0D8DDJT-J96Z\" || ps==\"8Q340M559RMR-0CBH\" || ps==\"8RDF6XG9P8FG-0MNR\" || ps==\"8QD9GGH2HZQS-L2JG\" || ps==\"8MZBMMCK11L0-0008\" || ps==\"8XGR3X8N3768-G6M5\" || ps==\"8Q340M559RMR-KT9P\" || ps==\"8WD86SGSXXX2-6XGT\" || \n    ps==\"8N17J0M5ZZQS-53NW\" || ps==\"8P43N3K93409-3PL9\" || ps==\"8PT3S2VJMDR6-4GN7\" || ps==\"8N17J0M5ZZQS-65S0\" || ps==\"8X8MCQDZLJR8-5XH7\" || ps==\"943Q37FN6ZPR-GZTC\" || ps==\"8XJQ3D3LRP0R-3TR1\" || ps==\"8Z28DH01W36X-4K0H\" || \n    ps==\"8QCV8RZGXC70-JWPR\" || ps==\"8WZD6DHZJ7KV-8RFG\" || ps==\"8QXVFTB3PXHM-H05D\" || ps==\"8VDB5VRKC5TQ-KHJ3\" || ps==\"8N17J0M5ZZQS-J9PZ\" || ps==\"8VSZF6WTWF29-JB2T\" || ps==\"93H0MB2GQD5B-H714\" || ps==\"93KCSBM0CFPS-LZPM\" || \n    ps==\"90FJ6ZKW1RZB-J14K\" || ps==\"90XS39DJ3GSD-H6R9\" || ps==\"93H0MB2GQD5B-94ML\" || ps==\"90FJ6ZKW1RZB-LXTB\" || ps==\"8W78ML23MF1F-1Q8J\" || ps==\"90FJ6ZKW1RZB-G0QH\" || ps==\"8TZGFL7Z18PH-1M18\" || ps==\"8QCV8RZGXC70-J63K\" || \n    ps==\"8P43N3K93409-GDCM\" || ps==\"93H0MB2GQD5B-1PF1\" || ps==\"8P98GBQKDZL5-4BSG\" || ps==\"8XJQ3D3LRP0R-01GD\" || ps==\"8TBXXVBPWHM1-4CGS\" || ps==\"8TBXXVBPWHM1-55LC\" || ps==\"92F4TX2C1BQF-DFK4\" || ps==\"8P43N3K93409-BDQ0\" || \n    ps==\"8NN2SMPXK1FR-8GZ6\" || ps==\"8NRS20M7T03L-F6JM\" || ps==\"93H0MB2GQD5B-HD8J\" || ps==\"8XBW9G3Z71F1-782N\" || ps==\"8N17J0M5ZZQS-7GKZ\" || ps==\"8P98GBQKDZL5-4TVL\" || ps==\"8XTMB6C575MD-8FK0\" || ps==\"8XBW9G3Z71F1-4Q6R\" || \n    ps==\"92FP8Q09QHXC-4VRG\" || ps==\"8VDB5VRKC5TQ-H58Z\" || ps==\"91V4VTMHXWPM-0001\" || ps==\"8VWN2B9NTZ3M-8BT8\" || ps==\"8XTMB6C575MD-BWM7\" || ps==\"93LTM69S3RFF-0001\" || ps==\"8MZBMMCK15HN-0001\" || ps==\"8XBW9G3Z71F1-GDTX\" || \n    ps==\"8XTMB6C575MD-2N2D\" || ps==\"8MZBMMCK11L0-0006\" || ps==\"8W78ML23MF1F-7KM4\" || ps==\"8X04WWQRR44Z-F1QB\" || ps==\"8WCCSFNF593P-9L0X\" || ps==\"8W78ML23MF1F-LGKZ\" || ps==\"8V2K517TCSXF-L65D\" || ps==\"8QCV8RZGXC70-CNJ1\" || \n    ps==\"8R7NCZRD488L-6N5H\" || ps==\"8Q89H8VDGQZP-5W6D\" || ps==\"93H0MB2GQD5B-0BRD\" || ps==\"8N17J0M5ZZQS-6SQD\" || ps==\"8VSZF6WTWF29-09W8\" || ps==\"93HV8MDDV9X6-J631\" || ps==\"8TBXXVBPWHM1-2B1D\" || ps==\"8WZD6DHZJ7KV-DXW9\" || \n    ps==\"93N0DWRQJ14C-7C5Q\" || ps==\"8XGT2SCLG6KG-HKTX\" || ps==\"8SJJQT4L40XX-M4JL\" || ps==\"93C88HCHTL99-BJKL\" || ps==\"8XTMB6C575MD-3C1F\" || ps==\"8WCCSFNF593P-4F4Z\" || ps==\"8SJJQT4L40XX-LX6D\" || ps==\"8ZL5C82QMG6B-3BVF\" || \n    ps==\"8P43N3K93409-8PRD\" || ps==\"8QCV8RZGXC70-286D\" || ps==\"8WCCSFNF593P-9WWC\" || ps==\"8WCCSFNF593P-5261\" || ps==\"8XVMDMG6W4R4-F0PW\" || ps==\"8QXVFTB3PXHM-KPJF\" || ps==\"8WZD6DHZJ7KV-F0CQ\" || ps==\"8MZBMMCK15HN-0002\" || \n    ps==\"8P43N3K93409-6H5T\" || ps==\"8R9CPQ146064-BPXK\" || ps==\"8N6Q4DTNS5H9-HKV0\" || ps==\"8P43N3K93409-9K39\" || ps==\"8XTMB6C575MD-7FZD\" || ps==\"8ZL5C82QMG6B-7X3T\" || ps==\"8ND2W87Q3B2F-9K6G\" || ps==\"8NXBZW7HRXVG-6F25\" || \n    ps==\"941SBDCK81PQ-CD4R\" || ps==\"8S8D6DS8MWVL-HDHW\" || ps==\"8P43N3K93409-DTSN\" || ps==\"8WQ0BSX7G523-44BS\" || ps==\"8S1JPWZV6L0F-H2N7\" || ps==\"8SJJQT4L40XX-LF11\" || ps==\"93MDNP8WKPP6-HK4W\" || ps==\"8QXVFTB3PXHM-HFTS\" || \n    ps==\"8SBJXM0M58T4-D2Q1\" || ps==\"90Z4L7RP2ZVS-9XR5\" || ps==\"8Z28DH01W36X-6V4S\" || ps==\"8P43N3K93409-1JGW\" || ps==\"8NWRHPTVDF48-J0T5\" || ps==\"8T5N0LQMWFQG-902P\" || ps==\"8XBW9G3Z71F1-FZJ2\" || ps==\"8NRS20M7T03L-00XC\" || \n    ps==\"8PF90854NM73-LZNB\" || ps==\"8NWRHPTVDF48-B3Q4\" || ps==\"8ZCNC665SLQ5-0055\" || ps==\"8N17J0M5ZZQS-4MHN\" || ps==\"8RP9LH17GM18-8TX9\" || ps==\"8TB9XW8RWC14-9V9M\" || ps==\"91NNTGWL74FR-CWRD\" || ps==\"912896799BKG-6GB2\" || \n    ps==\"8M9ZFXKG88D8-4HN3\" || ps==\"8NN2SMPXK1FR-L0VT\" || ps==\"8RL0J2QXSM1S-F7NS\" || ps==\"90PNC9LJWPX9-5Z3V\" || ps==\"8P65LKW1LW5Z-32LD\" || ps==\"8P65LKW1LW5Z-630Z\" || ps==\"8RL0J2QXSM1S-GL6T\" || ps==\"8WZD6DHZJ7KV-7CG1\" || \n    ps==\"8QVCVB7847Z7-7HNL\" || ps==\"8PT3S2VJMDR6-JVTL\" || ps==\"8RCG8L253H2D-315T\" || ps==\"8ZG5FH1FMDSR-2LGJ\" || ps==\"8QD908364SG2-6WH3\" || ps==\"8SV14CF5HPMJ-38D1\" || ps==\"91NNTGWL74FR-J0PX\" || ps==\"8QPTVN4L2ZMJ-G683\" || \n    ps==\"8MZBMMCK11M7-0003\" || ps==\"93H0MB2GQD5B-4F51\" || ps==\"8WGCKKFKDVPH-D1GL\" || ps==\"8SJ5MNK7FKXQ-G66K\" || ps==\"8XN9FQVZBVQ0-830H\" || ps==\"8RW25SLD63VS-0JG3\" || ps==\"8R3RQVVFLP4K-DSNG\" || ps==\"8TZ3PKNDDHJD-D8NR\" || \n    ps==\"93H0MB2GQD5B-1TD0\" || ps==\"93H0MB2GQD5B-KMWP\" || ps==\"8P43N3K93409-FK6N\" || ps==\"943RTP2F0BG5-0001\" || ps==\"8XBW9G3Z71F1-GFS1\" || ps==\"92JCWN8K0B4D-42NW\" || ps==\"8P5SV2RX3RN5-GGLX\" || ps==\"8P43N3K93409-CWNX\" || \n    ps==\"92S67S7W23HX-CZGF\" || ps==\"8PGXP59JSKJ5-434B\" || ps==\"93JCD9MGFVR7-5SJ6\" || ps==\"92VQN82KF597-4ZL6\" || ps==\"92P1BXSBCPR0-7RTR\" || ps==\"8S1JPWZV6L0F-08SL\" || ps==\"8MPK1ZPSHGPP-GGWV\" || ps==\"8XTMB6C575MD-GM0P\" || \n    ps==\"8P43N3K93409-5DN6\" || ps==\"8MC6K8M228SK-0004\" || ps==\"8NN2SMPXK1FR-BFZJ\" || ps==\"9233B942X8CM-6GV6\" || ps==\"941SBDCK81PQ-11GL\" || ps==\"94CHB2M80S54-4GJ5\" || ps==\"8X9Z4S6RJ230-2J6K\" || ps==\"8NN2SMPXK1FR-HJ09\" || \n    ps==\"8NN2SMPXK1FR-J3N4\" || ps==\"8ZL8NH9VVD50-KN8T\" || ps==\"8RW25SLD63VS-FM63\" || ps==\"93XQV506ZGL5-H7XB\" || ps==\"8MRMSZC6VXKC-4596\" || ps==\"925R551SKTGN-D5FT\" || ps==\"8WQ0BSX7G523-CS2R\" || ps==\"8PDS243T398V-CLGF\" || \n    ps==\"8PT3S2VJMDR6-H4BW\" || ps==\"8MZBMMCK11MM-0003\" || ps==\"8MRMSZC6VXKC-DBH4\" || ps==\"8XP6FXFJKTHN-D2BL\" || ps==\"8RL0J2QXSM1S-L3C1\" || ps==\"93D8SRJ9BSL0-FXPZ\" || ps==\"93H0MB2GQD5B-2CX9\" || ps==\"8WT81CGLRBLP-1JJG\" || \n    ps==\"8MCPZJJCC98C-001M\" || ps==\"8RL0J2QXSM1S-4873\" || ps==\"8SBJXM0M58T4-G652\" || ps==\"8MG0JQHKPFWK-4PXN\" || ps==\"8WZD6DHZJ7KV-FP89\" || ps==\"941SBDCK81PQ-KHLG\" || ps==\"93QQRPT4NN85-5ZFJ\" || ps==\"8P62MW6BN9G4-BF2C\" || \n    ps==\"8WVJWP0KJQ0M-6TMH\" || ps==\"918XHHX1T2RK-H4L0\" || ps==\"8SPDXNWQZKJ5-7MV6\" || ps==\"8Q5DQKD29GXT-CH5Z\" || ps==\"91SX3ZZH91TF-4B52\" || ps==\"8S77QXRGW0KT-GB12\" || ps==\"8TRCT5P0SHHL-68CS\" || ps==\"91T3QGM634L7-8HTL\" || \n    ps==\"944KWKTXBL73-728B\" || ps==\"8MZBMMCK15G3-0002\" || ps==\"8SQJHGQS07NT-JLJ2\" || ps==\"8Q7QDH6V9CS5-60Z8\" || ps==\"8VFXVVDHT3MX-FRJT\" || ps==\"8QXVFTB3PXHM-1SGB\" || ps==\"8Z15VD4432GN-41W1\" || ps==\"8MZBMMCK15G3-0004\" || \n    ps==\"8X1N09MRQ5D0-4CX8\" || ps==\"8MZBMMCK1252-0001\" || ps==\"8QJP6K35J7SV-0003\" || ps==\"8ZG5FH1FMDSR-4FTL\" || ps==\"8X4HTZNFGG38-0019\" || ps==\"8SBJXM0M58T4-HV3T\" || ps==\"93D7NWW5NQ3H-K6RF\" || ps==\"929894RG3GD7-CC7L\" || \n    ps==\"8WVJ5P8DD2TH-3J13\" || ps==\"8WVJ5P8DD2TH-6Z7C\" || ps==\"8X4HTZNFGG38-JHZC\" || ps==\"929894RG3GD7-DS36\" || ps==\"929894RG3GD7-DWCM\" || ps==\"929894RG3GD7-9LC4\" || ps==\"8X4HTZNFGG38-GV99\" || ps==\"8WVJ5P8DD2TH-GXV3\" || \n    ps==\"8XLK0G60TLB6-C7QT\" || ps==\"8XLK0G60TLB6-DV4P\" || ps==\"94C4Z4FRS9SV-4VKK\" || ps==\"94C4Z4FRS9SV-3VG5\" || ps==\"8X4HTZNFGG38-1F4J\" || ps==\"8QWCRTQ8V8XG-4VB5\" || ps==\"8MCPZJJCC98C-FNJ9\" || ps==\"929894RG3GD7-M0NF\" || \n    ps==\"8MCPZJJCC98C-2MQS\" || ps==\"94C4Z4FRS9SV-L7KB\" || ps==\"94C4Z4FRS9SV-M8B8\" || ps==\"94C4Z4FRS9SV-8TK8\" || ps==\"8X4HTZNFGG38-0DJ9\" || ps==\"94C4Z4FRS9SV-KVNP\" || ps==\"8NN2SMPXK1FR-6HGK\" || ps==\"929894RG3GD7-CVS7\" || \n    ps==\"8WVJ5P8DD2TH-JFBV\" || ps==\"929894RG3GD7-5L7P\" || ps==\"8XLK0G60TLB6-JP2P\" || ps==\"9408KGXP4XJL-FN89\" || ps==\"8X4HTZNFGG38-BFM1\" || ps==\"929894RG3GD7-JR74\" || ps==\"904H27D0CBWN-HG5F\" || ps==\"8MCPZJJCC98C-2NQP\" || \n    ps==\"8WVJ5P8DD2TH-28M9\" || ps==\"929894RG3GD7-8CRZ\" || ps==\"929894RG3GD7-1H5G\" || ps==\"929894RG3GD7-0K24\" || ps==\"94C4Z4FRS9SV-KTLM\" || ps==\"929894RG3GD7-BN0M\" || ps==\"94FC0BDGQ7WV-3XVD\" || ps==\"94FC0BDGQ7WV-FLQD\" || \n    ps==\"946627FB12T1-D639\" || ps==\"946627FB12T1-02MB\" || ps==\"946627FB12T1-KKTG\" || ps==\"929894RG3GD7-5SD6\" || ps==\"8NR6D2WCLC72-KV52\" || ps==\"8SRDF62SWKPF-2VQK\" || ps==\"929894RG3GD7-89FF\" || ps==\"94FC0BDGQ7WV-25ZQ\" || \n    ps==\"929894RG3GD7-7SCP\" || ps==\"946627FB12T1-1PRD\" || ps==\"8WVJ5P8DD2TH-8NNW\" || ps==\"946627FB12T1-00GQ\" || ps==\"94FC0BDGQ7WV-2866\" || ps==\"94FC0BDGQ7WV-2639\" || ps==\"946627FB12T1-2D8G\" || ps==\"8PG9R8WB09L0-0009\" || \n    ps==\"8NR6D2WCLC72-2HSF\" || ps==\"8NR6D2WCLC72-3RSN\" || ps==\"946627FB12T1-GT8C\" || ps==\"94C4Z4FRS9SV-7SHJ\" || ps==\"946627FB12T1-9JZD\" || ps==\"8NR6D2WCLC72-810D\" || ps==\"94FC0BDGQ7WV-2ZQF\" || ps==\"929894RG3GD7-6ZV4\" || \n    ps==\"929894RG3GD7-50FB\" || ps==\"946627FB12T1-CNH9\" || ps==\"8MZBMMCK15G2-0003\" || ps==\"946627FB12T1-502J\" || ps==\"8QWCRTQ8V8XG-L323\" || ps==\"8QWCRTQ8V8XG-1QTX\" || ps==\"8SRDF62SWKPF-28P9\" || ps==\"8QWCRTQ8V8XG-CMNS\" || \n    ps==\"8MZBMMCK15G2-0001\" || ps==\"8XTMB6C575MD-GLGC\" || ps==\"8QWCRTQ8V8XG-2M6T\" || ps==\"8X4HTZNFGG38-KCKP\" || ps==\"946627FB12T1-31N4\" || ps==\"8SRDF62SWKPF-C74D\" || ps==\"904H27D0CBWN-K5HG\" || ps==\"946627FB12T1-59PW\" || \n    ps==\"8QWCRTQ8V8XG-31HC\" || ps==\"929894RG3GD7-6TXN\" || ps==\"929894RG3GD7-CBKS\" || ps==\"8MSJBNL8HBXW-9G7L\" || ps==\"8NR6D2WCLC72-6Z3P\" || ps==\"8SRDF62SWKPF-2GZM\" || ps==\"929894RG3GD7-J319\" || ps==\"8MSJBNL8HBXW-BV79\" || \n    ps==\"8SRDF62SWKPF-CMQJ\" || ps==\"929894RG3GD7-FQK5\" || ps==\"946627FB12T1-01S6\" || ps==\"8NN2SMPXK1FR-CT90\" || ps==\"946627FB12T1-HR8L\" || ps==\"94FC0BDGQ7WV-3MWT\" || ps==\"8NR6D2WCLC72-J490\" || ps==\"8MZBMMCK15G2-0004\" || \n    ps==\"8XTMB6C575MD-57K3\" || ps==\"8XTMB6C575MD-7DQ8\" || ps==\"946627FB12T1-3ZX4\" || ps==\"946627FB12T1-BG50\" || ps==\"929894RG3GD7-83Q9\" || ps==\"8QWCRTQ8V8XG-F24R\" || ps==\"946627FB12T1-B16M\" || ps==\"8S3V46W10HFR-M2HD\" || \n    ps==\"9408KGXP4XJL-HT2G\" || ps==\"9408KGXP4XJL-HTS6\" || ps==\"8XTMB6C575MD-L3VT\" || ps==\"8MZBMMCK15G2-0002\" || ps==\"8WVJ5P8DD2TH-4T87\" || ps==\"929894RG3GD7-HDCF\" || ps==\"946627FB12T1-3K1B\" || ps==\"8NR6D2WCLC72-8Q8M\" || \n    ps==\"929894RG3GD7-HC28\" || ps==\"946627FB12T1-JCJT\" || ps==\"946627FB12T1-HT6Q\" || ps==\"946627FB12T1-2CJX\" || ps==\"946627FB12T1-0C0T\" || ps==\"946627FB12T1-8QTP\" || ps==\"8QWCRTQ8V8XG-1ZWK\" || ps==\"8QWCRTQ8V8XG-KG8S\" || \n    ps==\"8QWCRTQ8V8XG-9R2P\" || ps==\"8NN2SMPXK1FR-HV0Z\" || ps==\"8NN2SMPXK1FR-GVNV\" || ps==\"8QWCRTQ8V8XG-H5SK\" || ps==\"929894RG3GD7-243Q\" || ps==\"8QWCRTQ8V8XG-6TF7\" || ps==\"8MCPZJJCC98C-4PTB\" || ps==\"904H27D0CBWN-2L0C\" || \n    ps==\"929894RG3GD7-86V2\" || ps==\"929894RG3GD7-D09T\" || ps==\"8QWCRTQ8V8XG-321S\" || ps==\"946627FB12T1-0BCZ\" || ps==\"929894RG3GD7-9X8V\" || ps==\"8S3V46W10HFR-5JSF\" || ps==\"8S3V46W10HFR-0DHP\" || ps==\"8S3V46W10HFR-DLR9\" || \n    ps==\"8S3V46W10HFR-GWHX\" || ps==\"9408KGXP4XJL-5DLK\" || ps==\"9408KGXP4XJL-CTMC\" || ps==\"946627FB12T1-1G5R\" || ps==\"946627FB12T1-J5VD\" || ps==\"8RH63J18M28T-BX58\" || ps==\"8QM7KKP2KX8L-GG05\" || ps==\"916ZQBWNGKZ5-28NJ\" \n\n){\ninScope=1\n}\nif (inScope) {\nvar image = new Image(1, 1);\nimage.src =\"https://alb.reddit.com/rp.gif?id=t2_ch5mi&event=Purchase&integration=noscript\";\n}\n}}}\ncatch(err)\n{\n_satellite.logger.error(\"Media_/LL-LL/ Reddit Surface Purchase\");\n}}",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RL5c1f0ed8f9c64aa488ccab2558f160dc",
      "name": "BingSurfClkCustom /d/ (AEM/RT)",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 80.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/customCode.js",
          "settings": {
            "source": function(event, target) {
  return (~window.location.pathname.toLowerCase().indexOf("/d/") && ~window.location.pathname.toLowerCase().indexOf("surface"))
}
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "\n\nvar tempobj; \n\ntry {\n\n\tif (~window.location.pathname.toLowerCase().indexOf(\"surface\") && ~window.location.pathname.toLowerCase().indexOf(\"/d/\") && window.navigator.userAgent.toLowerCase().indexOf(\"soasta\")<0 && (typeof uetq=='object')) {\n\n\t\ttempobj={};\n\t\t\n\t\tif (_TMDL.pidsku.length > 0) {\n\t\t\ttempobj.ecomm_prodid = (_TMDL.pidsku.length>0) ? _TMDL.pidsku : \"\";\n\t\t\ttempobj.ecomm_pagetype = \"product\";\n\t\t\ttempobj.items = [\n\t\t\t\t{\n\t\t\t\t  'id': _TMDL.pidsku[0],\n\t\t\t\t  'category': 'surface',\n\t\t\t\t  'price' : _TMDL.sales[0]\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\t\t\n\t\t// Configure Now CTA\n        /*\n\t\t$(document).on('mousedown','button[id*=\"ConfigureDeviceButton\"]','', function() {\n\t\t\twindow.uetq.push('event','configurenow', tempobj); \n\t\t});\n        */\n      \n\t\t// Configure Now CTA - Updated 7/19 to correct ID\n        jQuery(\"a:contains('Configure now'),button:contains('Configure now')\").on(\"mousedown\", function(){\n            window.uetq.push('event','configurenow', tempobj); \n         });\n      \n      \n\t\t// BuildYourBundle CTA\n        $(document).on('mousedown','button[id*=\"buttons_BuildABundleButton\"],a[href*=\"/store/build/\"]','', function() {\n\t\t\twindow.uetq.push('event','buildyourbundle', tempobj); \n\t\t});\n\t\t\t\n\t\t\n\t\t//check your eligibility CTA\n\t\t\n\t\t$(document).on('mousedown',\"a[href*='student-discounts?successurl']\",'', function() {\n\t\t\twindow.uetq.push('event','checkeligibility', tempobj); \n\t\t});\n      \n      \t// Add to Cart button, particularly needed for Surface Go PDP -- Update 7/19 Surface GO PDP and configurator page do not appear to have this ID. \"add to cart\" only exists after the bundle is created on the configurator. \n        //This should likely be updated to use: jQuery(\"a:contains('Add to cart'),button:contains('Add to cart')\");\n\t\t$(document).on('mousedown','button[id*=\"buttons_AddToCartButton\"]','', function() {\n\t\t\twindow.uetq.push('event','addtocartbutton', tempobj); \n\t\t});\t\t\n\t}\n} catch(bingerr) {console.log(\"bing onclick err\");}\n",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RL9092ef86ecbc48cebb72d1cd61b6a4f1",
      "name": "Media.SurfaceDuo_CPE (AEM/RT)",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 50.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/path.js",
          "settings": {
            "paths": [
              {
                "value": "/en-us/surface/devices/surface-duo"
              },
              {
                "value": "/en-us/surface/devices/surface-duo/"
              }
            ]
          }
        },
        {
          "modulePath": "core/src/lib/conditions/domain.js",
          "settings": {
            "domains": [
              "microsoft.com"
            ]
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "try\n{\n//Note - This page belongs with the Surface property. Rule likely can be removed.\n  \n// ADNXS\n   //Main & Sticky Header\n  jQuery(\"a:contains('SHOP NOW')\").on(\"mousedown\", function(){\nvar image = new Image(1, 1);\nimage.src = \"//secure.adnxs.com/px?id=1268102&t=2\";\n});\n //Bottom of page - Removing as this is no longer on page\n /*\njQuery(\"a.c-call-to-action.c-glyph:eq(17)\").on(\"mousedown\", function(){\nvar image = new Image(1, 1);\nimage.src = \"//secure.adnxs.com/px?id=1268102&t=2\";\n});\n*/\n  \n\n//DoubleClick\n  //Main & Sticky Header\n jQuery(\"a:contains('SHOP NOW')\").on(\"mousedown\", function(){\nvar image = new Image(1, 1);\nimage.src =\"https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1=\"+_TMDL.geo+\";u2=\"+_TMDL.ll+\";u6=\"+encodeURIComponent(_TMDL.pagename)+\";u50=PRE-ORDER\"+\";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;gdpr=;gdpr_consent=${gdpr_consent_755};ord=1?\";\n});\n  \n   \n //Bottom of page  Removing as this is no longer on page\n /*\njQuery(\"a.c-call-to-action.c-glyph:lt(17)\").on(\"mousedown\", function(){\nvar image = new Image(1, 1);\nimage.src =\"https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1=\"+_TMDL.geo+\";u2=\"+_TMDL.ll+\";u6=\"+encodeURIComponent(_TMDL.pagename)+\";u50=PRE-ORDER\"+\";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;gdpr=;gdpr_consent=${gdpr_consent_755};ord=1?\";\n});\n*/\n  \n}\ncatch(err)\n{\n\t_satellite.logger.error(\"Media.SurfaceDuo_CPE (AEM/RT)\");\n}\n",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RLd2efe62bee8d45ecbf62d39c15613ec0",
      "name": "Media_/de-de/store/b/sale",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 50.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/path.js",
          "settings": {
            "paths": [
              {
                "value": "/de-de/store/b/sale"
              },
              {
                "value": "/de-de/store/b/sale/"
              }
            ]
          }
        },
        {
          "modulePath": "core/src/lib/conditions/domain.js",
          "settings": {
            "domains": [
              "microsoft.com"
            ]
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "try\n{\n  \n// ADNXS\n \n //Surface Starter Packages Product Tiles\njQuery(\"section.m-product-placement-item:lt(4)\").on(\"mousedown\", function(){\nvar image = new Image(1, 1);\nimage.src = \"//secure.adnxs.com/px?id=1268102&t=2\";\n});\n //Further Information  \njQuery(\"a.c-call-to-action.c-glyph:eq(11)\").on(\"mousedown\", function(){\nvar image = new Image(1, 1);\nimage.src = \"//secure.adnxs.com/px?id=1268102&t=2\";\n});\n  \n\n\n//DoubleClick\n \n  //Surface Starter Packages Product Tiles\njQuery(\"section.m-product-placement-item:lt(4)\").on(\"mousedown\", function(){\n    Bootstrapper.imageRequest(\"https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1=\"+_TMDL.geo+\";u2=\"+_TMDL.ll+\";u6=\"+encodeURIComponent(_TMDL.pagename)+\";u25=\"+_TMDL.pids[0]+\";u26=\"+encodeURIComponent(_TMDL.pnames[0])+\";u50=Shop Now\"+\";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1?\");\n});\n  \n  //Further Information  \njQuery(\"a.c-call-to-action.c-glyph:eq(11)\").on(\"mousedown\", function(){\n    Bootstrapper.imageRequest(\"https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1=\"+_TMDL.geo+\";u2=\"+_TMDL.ll+\";u6=\"+encodeURIComponent(_TMDL.pagename)+\";u25=\"+_TMDL.pids[0]+\";u26=\"+encodeURIComponent(_TMDL.pnames[0])+\";u50=Product Options\"+\";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1?\");\n});\n  \n  \n//Yahoo\n \n  //Surface Starter Packages Product Tiles\njQuery(\"section.m-product-placement-item:lt(4)\").on(\"mousedown\", function(){\n    Bootstrapper.imageRequest(\"https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&ea=SurfaceButtonClick\");\n});\n  \n  //Further Information \njQuery(\"a.c-call-to-action.c-glyph:eq(11)\").on(\"mousedown\", function(){\n    Bootstrapper.imageRequest(\"https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&ea=SurfaceButtonClick\");\n});\n\n}\ncatch(err)\n{\n\t_satellite.logger.error(\"Media_/de-de/store/b/sale\");\n}\n  ",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RLe377a68ea5f544699a1d32b4a92b2986",
      "name": "Media_/en-au/store/b/surfaceforbusiness Tax Day",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 50.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/path.js",
          "settings": {
            "paths": [
              {
                "value": "/en-au/store/b/surfaceforbusiness",
                "valueIsRegex": true
              }
            ]
          }
        },
        {
          "modulePath": "core/src/lib/conditions/domain.js",
          "settings": {
            "domains": [
              "microsoft.com"
            ]
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "\ntry\n{\n\njQuery(\"div.m-content-placement:Lt(1)\").on(\"mousedown\", function(){  \nvar image = new Image(1, 1);\nimage.src =\"https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1=\"+_TMDL.geo+\";u2=\"+_TMDL.ll+\";u6=\"+encodeURIComponent(_TMDL.pagename)+\";u50=CTA;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;ord=1?\";\n\n});\n\n}\ncatch(err)\n{\n\t_satellite.logger.error(\"Media_/en-au/store/b/surfaceforbusiness Tax Day\");\n}\n\n",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RL7366dbe28a18463aa3f26f7f05ff21cc",
      "name": "BoostSurfacePDPs",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 50.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/path.js",
          "settings": {
            "paths": [
              {
                "value": "/en-us/d/",
                "valueIsRegex": true
              },
              {
                "value": "/en-us/store/configure/",
                "valueIsRegex": true
              }
            ]
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "var configureA = 'a[href*=\"/configure/\"]';\nvar configureNow = \"button[id*='Configure']\";\nvar configureSpan = 'span[id*=\"cta\"]';\nvar addToCart = 'button[data-automation-id*=\"configurator\"]';\nvar addToCartTwo = 'button[data-bi-mto]';\n\nfunction attachPixels(elementAddress) {\n    $(document).on('mousedown', elementAddress, '', function () {\n        window.uetq_Amplify = window.uetq_Amplify || [];\n        if (_TMDL.pageName === \"Configure\") {\n            window.uetq_Amplify.push('event', 'click', { 'event_label': _TMDL.path.split('/')[4] });\n        } else {\n            window.uetq_Amplify.push('event', 'click', { 'event_label': _TMDL.pageName });\n        }\n\n    });\n} \n\ntry {\n    (function (w, d, t, r, u) {\n        var f, n, i; w[u] = w[u] || [], f = function () {\n            var o = { ti: \"149014572\" }; o.q = w[u], w[u] = new UET(o), w[u].push(\"pageLoad\")\n        },\n            n = d.createElement(t), n.src = r, n.async = 1,\n            n.onload = n.onreadystatechange = function () {\n                var s = this.readyState; s && s !== \"loaded\" && s !== \"complete\" || (f(), n.onload = n.onreadystatechange = null)\n            }, i = d.getElementsByTagName(t)[0], i.parentNode.insertBefore(n, i)\n    })(window, document, \"script\", \"//bat.bing.com/bat.js\", \"uetq_Amplify\");\n\n    attachPixels(configureA);\n    attachPixels(configureNow);\n    attachPixels(configureSpan);\n    attachPixels(addToCart);\n    attachPixels(addToCartTwo);\n}\ncatch (err) {\n    _satellite.logger.error(\"Boost Surface PDP\");\n}",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RL6216f8312ce14cfeb3cf6fb09225775a",
      "name": "Media_/en-au/store/collections Tax Day",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 50.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/path.js",
          "settings": {
            "paths": [
              {
                "value": "/en-au/store/collections/surfaceforbusiness",
                "valueIsRegex": true
              },
              {
                "value": "/en-au/store/collections/accessoriesforbusiness",
                "valueIsRegex": true
              }
            ]
          }
        },
        {
          "modulePath": "core/src/lib/conditions/domain.js",
          "settings": {
            "domains": [
              "microsoft.com"
            ]
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "\ntry\n{\n\njQuery(\"div[id*='productPlacementList']\").on(\"mousedown\", function(){  \nvar image = new Image(1, 1);\nimage.src =\"https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1=\"+_TMDL.geo+\";u2=\"+_TMDL.ll+\";u6=\"+encodeURIComponent(_TMDL.pagename)+\";u50=CTA;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;ord=1?\";\n\n});\n\n}\ncatch(err)\n{\n\t_satellite.logger.error(\"Media_/en-au/store/collections Tax Day\");\n}\n\n",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RLa05d6900d727495f891e610e6e502aa6",
      "name": "Media_/LL-LL/Reddit Xbox PV (AEM/RT)",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 50.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/path.js",
          "settings": {
            "paths": [
              {
                "value": "(us|gb|au)/store/configure/xbox-design-lab",
                "valueIsRegex": true
              },
              {
                "value": "(us|gb|au)/d/.*xbox",
                "valueIsRegex": true
              },
              {
                "value": "(us|gb|au)/d/bang-olufsen-beoplay-portal-headset",
                "valueIsRegex": true
              }
            ]
          }
        },
        {
          "modulePath": "core/src/lib/conditions/dateRange.js",
          "settings": {
            "end": "2022-07-01T00:00:00Z",
            "start": "2021-11-03T00:00:00Z"
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "try\n{\n//Reddit Xbox Pixel PL\nvar image = new Image(1, 1);\nimage.src =\"https://alb.reddit.com/rp.gif?id=t2_7knbgndc&event=PageVisit&integration=noscript\";\n\n}\ncatch(err)\n{\n\t_satellite.logger.error(\"Media_/LL-LL/Reddit Xbox PV (AEM/RT)\");\n}\n",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RLedaa4f43b645422ab6a3a750868a5260",
      "name": "LinkedIn/VSB/US",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 50.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/path.js",
          "settings": {
            "paths": [
              {
                "value": "/en-us/store/b/microsoft-small-business",
                "valueIsRegex": true
              },
              {
                "value": "/en-us/store/b/surfaceforbusiness",
                "valueIsRegex": true
              },
              {
                "value": "/en-us/store/b/business-laptop-deals",
                "valueIsRegex": true
              }
            ]
          }
        },
        {
          "modulePath": "core/src/lib/conditions/dateRange.js",
          "settings": {
            "end": "2023-08-01T00:00:00Z",
            "start": "2023-04-20T00:00:00Z"
          }
        },
        {
          "modulePath": "core/src/lib/conditions/sessions.js",
          "settings": {
            "count": 1,
            "operator": "="
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "var micClick = 'a[href]';\nvar secondConfig = 'button[data-action*=Configure]';\nvar cardClick = 'div[class*=material-card]';\nvar hasClicked = false;\n\nfunction attachPixels(elementAddress) {\n    $(document).on('mousedown', elementAddress, '', function () {\n        if (!hasClicked) {\n            var image1 = new Image(1, 1);\n            image1.src = \"https://px.ads.linkedin.com/collect/?pid=7850&conversionId=12089188&fmt=gif\"; \n            hasClicked = true;\n        }\n        \n    });\n} \n\ntry {\n    attachPixels(micClick);\n    attachPixels(secondConfig);\n    attachPixels(cardClick);\n}\ncatch (err) {\n    _satellite.logger.error(\"US-VSB Prospecting-LinkedIn\");\n}\n",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RL540e8548e4cf4a23b1c50783151ec10b",
      "name": "IRCV",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 30.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/customCode.js",
          "settings": {
            "source": function(event, target) {
  return (window.location.host.toLowerCase()=="query.prod.cms.rt.microsoft.com" && ~window.location.search.indexOf("pN=congrats"));
}
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "try\n{\n\tvar marketMap = {\n\t\t'NZ' : ['d.impactradius-event.com/A1143145-4ed3-453a-8ac9-f0c166db12591.js' , '13903' , '7815'],\n\t\t'AU' : ['d.impactradius-event.com/A1143145-4ed3-453a-8ac9-f0c166db12591.js' , '13901' , '7815'],\n\t\t'CA' : ['d.impactradius-event.com/A1143100-98df-45ee-8c6e-2dec4e6eb56e1.js' , '13899' , '7814'],\n\t\t'BG' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],  // master for CEE\n\t\t'RU' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],  // added to CEE\n\t\t'HR' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],\n\t\t'CY' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],\n\t\t'HU' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],\n\t\t'SK' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],\n\t\t'EE' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],\n\t\t'CZ' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],\n\t\t'GR' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],\n\t\t'LT' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],\n\t\t'PL' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],\n\t\t'FR' : ['d.impactradius-event.com/A1143111-30b6-46be-bbab-c7bbbca8eb991.js' , '13876' , '7809'],\n\t\t'TW' : ['d.impactradius-event.com/A1143121-28a1-47b0-8a2c-8128049efd901.js' , '13874' , '7808'],\n\t\t'HK' : ['d.impactradius-event.com/A1143121-28a1-47b0-8a2c-8128049efd901.js' , '13872' , '7808'],\n\t\t'CN' : ['d.impactradius-event.com/A1143121-28a1-47b0-8a2c-8128049efd901.js' , '13870' , '7808'],\n\t\t'DE' : ['d.impactradius-event.com/A1143124-6b0f-4685-b9ab-e289200ad2901.js' , '13868' , '7806'],\n\t\t'IN' : ['d.impactradius-event.com/A1143126-787b-4983-ad6f-e804972459e91.js' , '13865' , '7805'],\n\t\t'JP' : ['d.impactradius-event.com/A1143130-b81e-4371-9b61-b590cea59c051.js' , '13863' , '7804'],\n\t\t'BO' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'], // master for LATAM\n\t\t'DO' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'],\n\t\t'GT' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'],\n\t\t'HN' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'],\n\t\t'PA' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'],\n\t\t'PY' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'],\n\t\t'SV' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'],\n\t\t'VE' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'],\n\t\t'EC' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'],\n\t\t'CR' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'],\n\t\t'PE' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'],\n\t\t'CL' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'],\n\t\t'AR' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'],\n\t\t'MX' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'],\n\t\t'BR' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'],\n\t\t'BS' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'],\n\t\t'BB' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'],\n\t\t'CO' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'],\n\t\t'JM' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'],\n\t\t'NI' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'],\n\t\t'TT' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'],\n\t\t'UY' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'],\n\t\t'BH' : ['d.impactradius-event.com/A1143144-62f4-44be-93a3-7c960374e2961.js' , '13816' , '7796'], // master for MEA\n\t\t'MA' : ['d.impactradius-event.com/A1143144-62f4-44be-93a3-7c960374e2961.js' , '13816' , '7796'],\n\t\t'OM' : ['d.impactradius-event.com/A1143144-62f4-44be-93a3-7c960374e2961.js' , '13816' , '7796'],\n\t\t'QA' : ['d.impactradius-event.com/A1143144-62f4-44be-93a3-7c960374e2961.js' , '13816' , '7796'],\n\t\t'NG' : ['d.impactradius-event.com/A1143144-62f4-44be-93a3-7c960374e2961.js' , '13816' , '7796'],\n\t\t'KW' : ['d.impactradius-event.com/A1143144-62f4-44be-93a3-7c960374e2961.js' , '13816' , '7796'],\n\t\t'EG' : ['d.impactradius-event.com/A1143144-62f4-44be-93a3-7c960374e2961.js' , '13816' , '7796'],\n\t\t'SA' : ['d.impactradius-event.com/A1143144-62f4-44be-93a3-7c960374e2961.js' , '13816' , '7796'],\n\t\t'IL' : ['d.impactradius-event.com/A1143144-62f4-44be-93a3-7c960374e2961.js' , '13816' , '7796'],\n\t\t'ZA' : ['d.impactradius-event.com/A1143144-62f4-44be-93a3-7c960374e2961.js' , '13816' , '7796'],\n\t\t'TR' : ['d.impactradius-event.com/A1143144-62f4-44be-93a3-7c960374e2961.js' , '13816' , '7796'],\n\t\t'AE' : ['d.impactradius-event.com/A1143144-62f4-44be-93a3-7c960374e2961.js' , '13816' , '7796'],  // check on Geo code (was UAE, now AE_\n\t\t'PH' : ['d.impactradius-event.com/A1143145-4ed3-453a-8ac9-f0c166db12591.js' , '13785' , '7795'],\n\t\t'TH' : ['d.impactradius-event.com/A1143145-4ed3-453a-8ac9-f0c166db12591.js' , '13783' , '7795'],\n\t\t'ID' : ['d.impactradius-event.com/A1143145-4ed3-453a-8ac9-f0c166db12591.js' , '13781' , '7795'],\n\t\t'MY' : ['d.impactradius-event.com/A1143145-4ed3-453a-8ac9-f0c166db12591.js' , '13777' , '7795'],\n\t\t'KR' : ['d.impactradius-event.com/A1143145-4ed3-453a-8ac9-f0c166db12591.js' , '13779' , '7795'],\n\t\t'SG' : ['d.impactradius-event.com/A1143145-4ed3-453a-8ac9-f0c166db12591.js' , '13775' , '7795'],\n\t\t'UK' : ['d.impactradius-event.com/A1143151-5b4f-4392-9e5d-0d32d4dda7b21.js' , '13773' , '7794'],\n\t\t'GB' : ['d.impactradius-event.com/A1143151-5b4f-4392-9e5d-0d32d4dda7b21.js' , '13773' , '7794'], // added GB as UK\n\t\t'IE' : ['d.impactradius-event.com/A1143151-5b4f-4392-9e5d-0d32d4dda7b21.js' , '13773' , '7794'], // map to UK/GB\n\t\t'PR' : ['d.impactradius-event.com/A1133099-331c-4cdf-89b0-06dc20e168021.js' , '13588' , '7593'], // mspped to US\n\t\t'US' : ['d.impactradius-event.com/A1133099-331c-4cdf-89b0-06dc20e168021.js' , '13588' , '7593'],\n\t\t'LU' : ['d.impactradius-event.com/A1143167-163d-430c-aa98-4062268d1ce01.js' , '13768' , '7793'], // changed from LUX\n\t\t'BE' : ['d.impactradius-event.com/A1143167-163d-430c-aa98-4062268d1ce01.js' , '13766' , '7793'],\n\t\t'AT' : ['d.impactradius-event.com/A1143124-6b0f-4685-b9ab-e289200ad2901.js' , '13868' , '7806'], // mapped to DE\n\t\t'NL' : ['d.impactradius-event.com/A1143167-163d-430c-aa98-4062268d1ce01.js' , '13760' , '7793'],\n\t\t'FI' : ['d.impactradius-event.com/A1143167-163d-430c-aa98-4062268d1ce01.js' , '13758' , '7792'],\n\t\t'DK' : ['d.impactradius-event.com/A1143167-163d-430c-aa98-4062268d1ce01.js' , '13756' , '7792'],\n\t\t'NO' : ['d.impactradius-event.com/A1143167-163d-430c-aa98-4062268d1ce01.js' , '13754' , '7792'],\n\t\t'SE' : ['d.impactradius-event.com/A1143167-163d-430c-aa98-4062268d1ce01.js' , '13752' , '7792'],\n\t\t'PT' : ['d.impactradius-event.com/A1143167-163d-430c-aa98-4062268d1ce01.js' , '13750' , '7791'],\n\t\t'IT' : ['d.impactradius-event.com/A1143167-163d-430c-aa98-4062268d1ce01.js' , '13748' , '7791'],\n\t\t'ES' : ['d.impactradius-event.com/A1143167-163d-430c-aa98-4062268d1ce01.js' , '13746' , '7791'],\n\t\t'CH' : ['d.impactradius-event.com/A1143124-6b0f-4685-b9ab-e289200ad2901.js' , '13868' , '7806'], // mapped to DE\n\t\t// FR\n\t\t'RE' : ['d.impactradius-event.com/A1143111-30b6-46be-bbab-c7bbbca8eb991.js' , '13876' , '7809'],\n\t\t'NC' : ['d.impactradius-event.com/A1143111-30b6-46be-bbab-c7bbbca8eb991.js' , '13876' , '7809'],\n\t\t'AD' : ['d.impactradius-event.com/A1143111-30b6-46be-bbab-c7bbbca8eb991.js' , '13876' , '7809'],\n\t\t// APAC TH\n\t\t'VN' : ['d.impactradius-event.com/A1143145-4ed3-453a-8ac9-f0c166db12591.js' , '13783' , '7795'],\n\t\t'PF' : ['d.impactradius-event.com/A1143145-4ed3-453a-8ac9-f0c166db12591.js' , '13783' , '7795'],\n\t\t'KH' : ['d.impactradius-event.com/A1143145-4ed3-453a-8ac9-f0c166db12591.js' , '13783' , '7795'],\n\t\t'LA' : ['d.impactradius-event.com/A1143145-4ed3-453a-8ac9-f0c166db12591.js' , '13783' , '7795'],\n\t\t//'GA' : ['d.impactradius-event.com/A1143145-4ed3-453a-8ac9-f0c166db12591.js' , '13783' , '7795'], // Gabon, removed so that it will default to MEA\n\n\t\t// FI\n\t\t'IS' : ['d.impactradius-event.com/A1143167-163d-430c-aa98-4062268d1ce01.js' , '13758' , '7792'],\n\t\t'GL' : ['d.impactradius-event.com/A1143167-163d-430c-aa98-4062268d1ce01.js' , '13758' , '7792'],\n\t\t// IN\n\t\t'PK' : ['d.impactradius-event.com/A1143126-787b-4983-ad6f-e804972459e91.js' , '13865' , '7805'],\n\t\t'LK' : ['d.impactradius-event.com/A1143126-787b-4983-ad6f-e804972459e91.js' , '13865' , '7805'],\n\t\t'BD' : ['d.impactradius-event.com/A1143126-787b-4983-ad6f-e804972459e91.js' , '13865' , '7805'],\n\t\t'NP' : ['d.impactradius-event.com/A1143126-787b-4983-ad6f-e804972459e91.js' , '13865' , '7805'],\n\t\t'MM' : ['d.impactradius-event.com/A1143126-787b-4983-ad6f-e804972459e91.js' , '13865' , '7805'],\n\t\t// LATAM\n\t\t'GP' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'],\n\t\t'KY' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'],\n\t\t// NL\n\t\t'AW' : ['d.impactradius-event.com/A1143167-163d-430c-aa98-4062268d1ce01.js' , '13760' , '7793'],\n\t\t// US\n\t\t'GU' : ['d.impactradius-event.com/A1133099-331c-4cdf-89b0-06dc20e168021.js' , '13588' , '7593'],\n\t\t'BM' : ['d.impactradius-event.com/A1133099-331c-4cdf-89b0-06dc20e168021.js' , '13588' , '7593'],\n\t\t'VI' : ['d.impactradius-event.com/A1133099-331c-4cdf-89b0-06dc20e168021.js' , '13588' , '7593'],\n\t\t// UK\n\t\t'JE' : ['d.impactradius-event.com/A1143151-5b4f-4392-9e5d-0d32d4dda7b21.js' , '13773' , '7794'],\n\t\t// CEE\n\t\t'RO' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],  // added to CEE\n\t\t'UA' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],  // added to CEE\n\t\t'SI' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],  // added to CEE\n\t\t'MT' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],  // added to CEE\n\t\t'LV' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],  // added to CEE\n\t\t'MU' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],  // added to CEE\n\t\t'KZ' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],  // added to CEE\n\t\t'RS' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],  // added to CEE\n\t\t'BY' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],  // added to CEE\n\t\t'BA' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],  // added to CEE\n\t\t'GE' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],  // added to CEE\n\t\t'AL' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],  // added to CEE\n\t\t'AM' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],  // added to CEE\n\t\t'MK' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],  // added to CEE\n\t\t'MD' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],  // added to CEE\n\t\t'AZ' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],  // added to CEE\n\t\t'UZ' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811']  // added to CEE\n\t\t// Everything else map to MEA\n\t};\n\n\n\t/*\n\t// OLD TD\n\tvar eventIDmap = {\n\t\tpc : \"259975\",\n\t\twindows : \"259977\",\n\t\toffice : \"259979\",\n\t\tothersoftware : \"259981\",\n\t\txbox : \"259983\",\n\t\tbackup : \"259985\",  // developer and visual studio\n\t\tmspress : \"259987\",  // and hp tablet, only remapped for hptablet not mspress\n\t\tx1 : \"287980\",\n\t\tsurface : \"287592\",\n\t\to365monthy : \"275200\",\n\t\tphone : \"287982\",\n\t\to365yearly : \"276225\",\n\t\thptablet : \"259987\",\n\t\t//  new additions\n\t\tband : \"333480\",\n\t\taccessories : \"321395\",\n\t\tdummy : \"359828\", // used as placeholder when testing\n\t\txboxlive1mo : \"363063\", // added 7/27/17\n\t\txboxlive3mo : \"363065\", // added 7/27/17\n\t\txboxlive12mo : \"363067\" // added 7/27/17\n\t};\n\n\t// new IR category names\n\tvar eventIDmap = {\n\t\tpc : \"PC\",\n\t\twindows : \"Windows\",\n\t\toffice : \"OfficeNonSub\",\n\t\tothersoftware : \"Software\",\n\t\txbox : \"Xbox\",\n\t\tbackup : \"259985\",  // developer and visual studio\n\t\tmspress : \"259987\",  // and hp tablet, only remapped for hptablet not mspress\n\t\tx1 : \"287980\",\n\t\tsurface : \"Surface\",\n\t\to365monthy : \"Office1M\",\n\t\tphone : \"Phone\",\n\t\to365yearly : \"Office1Y\",\n\t\thptablet : \"259987\",\n\t\t//  new additions\n\t\tband : \"Band\",\n\t\taccessories : \"Accessory\",\n\t\tdummy : \"359828\", // used as placeholder when testing\n\t\txboxlive1mo : \"XboxLive1M\", \n\t\txboxlive3mo : \"XboxLive3M\", // added 7/27/17\n\t\txboxlive12mo : \"XboxLive12M\", // added 7/27/17\n\t\t\n\t\tDevVisualStudio : \"DevVisualStudio\", // split out from Software 7/24/18\n\n\t\tmrvr : \"MRVR\"\n\t};\n\t*/\n\n  \tvar pidexclude={\n\t\t'Nevermatch_sku' : 'Default'\n\t};\n\n\tvar pidlist = {\n\t\t'Nevermatch' : 'Default'\n\t};\n\t\n\tvar skulist = {\n\t\t'Nevermatch_sku' : 'Default'\n\t};\n  \n\n\n\tvar cid=\"\"; // map based on geo and campaign\n\tvar irchannel=\"\";  // map based on geo\n\tvar anonarr = [];\n\tvar anonID = \"\";\n\tvar mapCat = function(pid,pidsku,pname,ptype) {\n\t\tif (pidexclude[pid]) {\n\t\t\treturn \"\";\n\t\t} else if (skulist[pidsku]) {\n\t\t\treturn skulist[pidsku];\n\t\t} else if (pidlist[pid]) {\n\t\t\treturn pidlist[pid];\n\t\t} /*else if (pname && ~pname.toLowerCase().indexOf(\"surface\") ) {\n\t\t\treturn \"Surface\";\n\t\t} else if (pname && ~pname.toLowerCase().indexOf(\"xbox\") ) {\n\t\t\treturn \"Xbox\";\n\t\t} */ else if (~ptype.toLowerCase().indexOf(\"app\") || ~ptype.toLowerCase().indexOf(\"durable\") || ~ptype.toLowerCase().indexOf(\"consumable\")) {\n\t\t\treturn \"App\";\n\t\t} else if (~ptype.toLowerCase().indexOf(\"tv\") || ~ptype.toLowerCase().indexOf(\"movie\")) {\n\t\t\treturn \"MoviesTV\";\n\t\t} else {\n\t\t\treturn \"Default\";\n\t\t}\n\t};\n\tvar lineItemStr=\"\";\n\tvar li=0; // line item number\n\tvar cat=\"\";\n\tvar totlines=0;\n\tvar u=\"\";\n\tvar ptype=\"\";\n\tvar hupurl=\"\";\n\n\ttry {\n\t\tif(_TMDL && marketMap[(_TMDL.geo).toUpperCase()] ){\n\t\t\tirchannel = marketMap[(_TMDL.geo).toUpperCase()][1];\n\t\t\tcid = marketMap[(_TMDL.geo).toUpperCase()][2];\n\t\t}\n\t} catch(err) {}\n\n\tif (cid==\"\") {\n\t\t// map to MEA as catchall\n\t\t// 'BH' : ['d.impactradius-event.com/A1143144-62f4-44be-93a3-7c960374e2961.js' , '13816' , '7796'],\n\t\tirchannel = '13816';\n\t\tcid = '7796';\n\t}\n\n\tfor (var i=0; i<_TMDL.pids.length; i++) {\n\t\t//\"&amt1=Item Sub Total&cat1=Item Category&sku1=Item SKU&qty1=Item Quantity&name1=Item Name\";\n\t\tli = i+1;\n\t\tptype=\"\";\n\t\ttry {\n\t\t\tif ((typeof _TMDL.prdType == \"object\") && (typeof _TMDL.prdType[i] == \"string\")) {\n\t\t\t\tptype = _TMDL.prdType[i];\n\t\t\t}\n\t\t} catch(ptypeerr) {}\n\t\tcat = mapCat(_TMDL.pids[i],_TMDL.pidsku[i],_TMDL.pnames[i],ptype); // added ptype 12/3/18\n\t\tif (cat) {  // only emit if category matches (e.g. if not filtered)\n\t\t\ttotlines++;\n\t\t\tlineItemStr += ( \"&amt\"+li+\"=\"+_TMDL.sales[i]\n\t\t\t\t\t\t\t+\"&cat\"+li+\"=\"+cat\n\t\t\t\t\t\t\t+\"&sku\"+li+\"=\"+_TMDL.pidsku[i].replace(\"-\",\"_\")\n\t\t\t\t\t\t\t+\"&qty\"+li+\"=\"+_TMDL.quantities[i]\n\t\t\t\t\t\t\t+\"&name\"+li+\"=\"+encodeURIComponent(_TMDL.pnames[i])\n\t\t\t\t\t\t);\n\t\t}\n\t}\n\n\tu=\"https://microsoft.msafflnk.net/conv/?\"\n\t\t+\"irchannel=\"+irchannel\n\t\t+\"&cid=\"+cid\n\t\t+\"&oid=\"+_TMDL.purchaseID\n\t\t//+\"&custid=\"+anonID\n\t\t+\"&status=\"\n\t\t+\"&note=\"+_TMDL.geo\n\t\t+\"&custctry=\"+_TMDL.geo\n\t\t//+\"&custemail=\"\n\t\t+\"&currency=\"+_TMDL.cc\n\t\t//+\"&promocode=\"\n\t\t+lineItemStr;\n\n\tvar hupurl=\"\";\n/*\n\thupurl=\"https://microsoft.msafflnk.net/conv/?\"\n\t\t+\"irchannel=13588\"\n\t\t+\"&cid=9340\"\n\t\t+\"&oid=\"+_TMDL.purchaseID\n\t\t+\"&status=\"\n\t\t+\"&note=\"+_TMDL.geo\n\t\t+\"&custctry=\"+_TMDL.geo\n\t\t+\"&currency=\"+_TMDL.cc\n\t\t+lineItemStr;\n*/\n  \n  \thupurl = \"https://microsoft.msafflnk.net/conv/?\" + \"irchannel=16760\" + \"&cid=9429\" + \"&oid=\" + _TMDL.purchaseID + \"&status=\" + \"&note=\" + _TMDL.geo + \"&custctry=\" + _TMDL.geo + \"&currency=\" + _TMDL.cc + lineItemStr;\n\n\tvar\tmktstring = \"AT,AU,BE,BR,CA,CH,CN,DE,DK,ES,FR,GB,IE,IN,IT,JP,KR,MX,NL,NO,NZ,PL,SA,SE,SG,TW,US,ZA\";\n    var mktInScope=true;\n\tmktInScope = (mktstring.indexOf(_TMDL.geo.toUpperCase())>-1);\n  \n\tif (cid && mktInScope && lineItemStr) {\n\t\tdbugimgurl = u; \n\t\tBootstrapper.imageRequest(u);\n\t\tdbugimgurl = hupurl; \n\t\tBootstrapper.imageRequest(hupurl);\n\t}\t\n}\ncatch(err)\n{\n\tif (typeof(_TMutils) !== \"undefined\") {_TMutils.logRuleCall(\"IRCV\",err.message,dbugimgurl);}\n\t_satellite.logger.error(\"IRCV\");\t\n}",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RLbce7faddd577453299ebe0a2cad2a168",
      "name": "Media.Verizon.Surface_081620 (AEM/RT)",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 50.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/path.js",
          "settings": {
            "paths": [
              {
                "value": "(/en-us)\\/p\\/surface",
                "valueIsRegex": true
              },
              {
                "value": "(/en-us)\\/d\\/surface",
                "valueIsRegex": true
              }
            ]
          }
        },
        {
          "modulePath": "core/src/lib/conditions/domain.js",
          "settings": {
            "domains": [
              "microsoft.com"
            ]
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "try\n{\n  \n // Promo Bar\n  \njQuery(\"a:contains('Book your online appointment')\")\n.on(\"mousedown\", function(){\nvar image = new Image(1, 1);\nimage.src = \"https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=10084084&ea=SurfaceButtonClick\";\n});\n  \njQuery(\"a:contains('Build your bundle')\")\n.on(\"mousedown\", function(){\nvar image = new Image(1, 1);\nimage.src = \"https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=10084084&ea=SurfaceButtonClick\";\n});\n  \njQuery(\"a:contains('Learn more about promise')\")\n.on(\"mousedown\", function(){\nvar image = new Image(1, 1);\nimage.src = \"https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=10084084&ea=SurfaceButtonClick\";\n});\n  \njQuery(\"a[href*='/en-us/p/surface']\").filter('a:contains(\"BUSINESS\")')\n.on(\"mousedown\", function(){\nvar image = new Image(1, 1);\nimage.src = \"https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=10084084&ea=SurfaceButtonClick\";\n});\n  \n \n //Configure now & Sticky\njQuery(\"a:contains('Configure now'),button:contains('Configure now')\")\n.on(\"mousedown\", function(){\nvar image = new Image(1, 1);\nimage.src = \"https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=10084084&ea=SurfaceButtonClick\";\n});\n  \n}\ncatch(err)\n{\n\t_satellite.logger.error(\"Media.Verizon.Surface_081620 (AEM/RT)\");\n}\n",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RLa67f4dc061f942af82f4b73a8ddb9b42",
      "name": "VRZNCVF",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 60.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/customCode.js",
          "settings": {
            "source": function(event, target) {
  return (window.location.host.toLowerCase()=="query.prod.cms.rt.microsoft.com");
}
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "/*\nVerizonCVF\n*/\n\ntry {\n\tvar i=0,inScope=0,imageURL=\"\",g=_TMDL.geo.toLowerCase();\n\tif (g==\"us\" || g==\"de\" || g==\"fr\" || g==\"gb\" || g==\"au\" || g==\"jp\" || g==\"ca\") {\n\t\tfor (i=0; i<_TMDL.pidsku.length; i++) {\n\t\t\tif (~_TMDL.pnames[i].toLowerCase().indexOf(\"surface\") || ~_TMDL.pnames[i].toLowerCase().indexOf(\"xbox\")) {\n\t\t\t\tinScope=1;\n\t\t\t} \n\t\t}\n\t}\n\tif (g==\"sg\" || g==\"nl\" || g==\"se\" || g==\"no\" || g==\"dk\" || g==\"ie\" || g==\"es\" || g==\"ch\") {\n\t\tfor (i=0; i<_TMDL.pidsku.length; i++) {\n\t\t\tif (~_TMDL.pnames[i].toLowerCase().indexOf(\"surface\")) {\n\t\t\t\tinScope=1;\n\t\t\t} \n\t\t}\n\t}\n\n\tif (inScope) {\n\t\tif (_TMDL.pT==\"cart\") {\n\t\t\timageURL = \"https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=10084084&ea=AddToCart&langgeo=\"+_TMDL.ll+\"&product_id=\"+_TMDL.pidsku.join(\",\");  \n\t\t} else if (_TMDL.pT==\"rP\") {\n\t\t\timageURL = \"https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=10084084&ea=Purchase&langgeo=\"+_TMDL.ll+\"&product_id=\"+_TMDL.pidsku.join(\",\")+\"&gv=\"+_TMDL.totamount;\n\t\t} \n\t\tBootstrapper.imageRequest(imageURL);\n\t}\n} catch(e) {\n  _satellite.logger.error(\"VerizonCVF\");\n}",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RLd8f2cc1b3c7942cd8016c9c927841162",
      "name": "LINKEDIN",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 50.0
        }
      ],
      "conditions": [

      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "/*\nLinkedIn tag\n*/\ntry\n{\n\tvar c=new Image(0,0);\n\tc.src=\"https://dc.ads.linkedin.com/collect/?pid=7850&fmt=gif\";\n}\ncatch(err)\n{\n\tif (typeof(_TMutils) !== \"undefined\") {_TMutils.logRuleCall(\"LINKEDIN\",err.message,c.src);}\n\t_satellite.logger.error(\"LINKEDIN\");\t\n}\n",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RL3329950363d843f9a5524bfff31f3b56",
      "name": "Media_/en-au/store/b/surface-accessories Tax Day",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 50.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/path.js",
          "settings": {
            "paths": [
              {
                "value": "/en-au/store/b/surface-accessories",
                "valueIsRegex": true
              }
            ]
          }
        },
        {
          "modulePath": "core/src/lib/conditions/domain.js",
          "settings": {
            "domains": [
              "microsoft.com"
            ]
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "\ntry\n{\n\njQuery(\"div.herohighlight, div.c-carousel, div.m-content-placement.x-clearfix\").on(\"mousedown\", function(){  \nvar image = new Image(1, 1);\nimage.src =\"https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1=\"+_TMDL.geo+\";u2=\"+_TMDL.ll+\";u6=\"+encodeURIComponent(_TMDL.pagename)+\";u50=CTA;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;ord=1?\";\n\n});\n\n}\ncatch(err)\n{\n\t_satellite.logger.error(\"Media_/en-au/store/b/surface-accessories Tax Day\");\n}\n\n",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RLff024ff211024496b1ca0dd8147087b9",
      "name": "OffDCMCV",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 60.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/customCode.js",
          "settings": {
            "source": function(event, target) {
  return (window.location.host.toLowerCase()=="query.prod.cms.rt.microsoft.com" && ~window.location.search.indexOf("pN=congrats"));
}
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "/* Office DCM CV\n*/\ntry\n{\n\tvar a, imgsrc1, ps;\n\tvar inScope=0;\n\n\tvar mc1 = \"\";\n\tif (_TMutils.readCookie(\"MC1\")) {\n\t\tmc1 = _TMutils.readCookie(\"MC1\").split(\"&\")[0].split(\"=\")[1]; //use in u58\n\t}\n\n\tfor (var i=0; i<_TMDL.pidsku.length; i++) {\n\t\tps = _TMDL.pidsku[i].toUpperCase();\n\t\tif (ps==\"CFQ7TTC0K5DM-007R\" || ps==\"CFQ7TTC0K5DM-007W\"){\n\t\t\t// Home Annual\n\t\t\tinScope=1;\n\t\t} else if (ps==\"CFQ7TTC0K5FB-0002\" || ps==\"CFQ7TTC0K5FC-0002\" || ps==\"CFQ7TTC0K5FB-000D\" || ps==\"CFQ7TTC0K5FC-000C\") {\n\t\t\t// Home and Student 2016 (for Mac and Windows SKUs)\n\t\t\tinScope=1;\t\t\n\t\t} \n\t}\n\n\tif ((_TMDL.pageType==\"receipt\" || _TMDL.pageType==\"congrats\") && _TMDL.isprod && inScope==1) {\n\t\ta = \"\" + (Math.random() * 10000000000000);\n\t\timgsrc1 = \"https://ad.doubleclick.net/ddm/activity/src=6952136;type=store00;cat=zzzst0;qty=1;cost=\"+_TMDL.totamount+\";u1=\"+_TMDL.geo.toUpperCase()+\";u2=\"+_TMDL.ll\n\t\t\t//+\";u5=\"+encodeURIComponent(document.referrer)\n\t\t\t+\";u25=\"+_TMDL.pids.join(\"_\")\n\t\t\t+\";u26=\"+encodeURIComponent(_TMDL.pnames.join(\"_\"))\n\t\t\t+\";u58=\"+mc1\n\t\t\t+\";u31=\"+_TMDL.cc+\";u32=\"+_TMDL.pids.join(\"_\")+\";u33=\"+_TMDL.pidsku.join(\"_\")+\";u34=\"+_TMDL.purchaseID+\";u35=\"+_TMDL.totqty\n\t\t\t+\";u39=\"+_TMDL.sales.join(\"_\")+\";u40=\"+_TMDL.quantities.join(\"_\")\n\t\t\t+\";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=\"+_TMDL.purchaseID+\"?\";\n\t\t//console.log(imgsrc1);\n\t\tBootstrapper.imageRequest(imgsrc1);\n\t\t\n\t\t// added 6/18/2018\n\t\tBootstrapper.imageRequest(\"//www.googleadservices.com/pagead/conversion/862646735/?value=1.00&currency_code=USD&label=KXsqCL2B2nEQz-OrmwM&uid=ON&script=0\");\n\t}\n}\ncatch(err)\n{\n\tif (typeof(_TMutils) !== \"undefined\") {_TMutils.logRuleCall(\"OffDCMCV\",err.message,imgsrc1);}\n\t_satellite.logger.error(\"OffDCMCV\");\t\n}\n\n\n",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RL786094462b894139ab3b2c6dee7ade87",
      "name": "Media_/LL-LL/Business Consultation Signup Facebook (RT)",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 50.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/path.js",
          "settings": {
            "paths": [
              {
                "value": "/en-au/store/b/business-consultation",
                "valueIsRegex": true
              },
              {
                "value": "/en-gb/store/b/business-consultation",
                "valueIsRegex": true
              }
            ]
          }
        },
        {
          "modulePath": "core/src/lib/conditions/domain.js",
          "settings": {
            "domains": [
              "microsoft.com"
            ]
          }
        },
        {
          "modulePath": "core/src/lib/conditions/dateRange.js",
          "settings": {
            "end": "2021-12-31T00:00:00Z",
            "start": "2021-07-12T00:00:00Z"
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "try\n{\n// Facebook\n jQuery(\"a.c-hyperlink:Lt(1),a.c-call-to-action:Lt(1)\").on(\"mousedown\", function(){\nvar image = new Image(1, 1);\nimage.src =\"https://www.facebook.com/tr?id=1770559986549030&amp&ev=CompleteRegistration&cd[content_names]=[\"+encodeURIComponent(_TMDL.pagename) + \"]\";\n  \n });\n }\ncatch(err)\n{\n\t_satellite.logger.error(\"Media_/LL-LL/Business Consultation Signup Facebook (RT)\");\n}\n",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RLafca8ec24b594c8e8d900f5fd9373a36",
      "name": "VRZN_LP_Srfc",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 60.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/domain.js",
          "settings": {
            "domains": [
              "microsoft.com"
            ]
          }
        },
        {
          "modulePath": "core/src/lib/conditions/path.js",
          "settings": {
            "paths": [
              {
                "value": "^/en-us/d/surface.*",
                "valueIsRegex": true
              },
              {
                "value": "^/en-ca/d/surface.*",
                "valueIsRegex": true
              },
              {
                "value": "^/de-de/d/surface.*",
                "valueIsRegex": true
              },
              {
                "value": "^/fr-fr/d/surface.*",
                "valueIsRegex": true
              },
              {
                "value": "^/en-gb/d/surface.*",
                "valueIsRegex": true
              },
              {
                "value": "^/en-au/d/surface.*",
                "valueIsRegex": true
              },
              {
                "value": "^/jp-jp/d/surface.*",
                "valueIsRegex": true
              },
              {
                "value": "^/en-ca/d/surface.*",
                "valueIsRegex": true
              },
              {
                "value": "^/fr-ca/d/surface.*",
                "valueIsRegex": true
              },
              {
                "value": "^/en-sg/d/surface.*",
                "valueIsRegex": true
              },
              {
                "value": "^/nl-nl/d/surface.*",
                "valueIsRegex": true
              },
              {
                "value": "^/sv-se/d/surface.*",
                "valueIsRegex": true
              },
              {
                "value": "^/nb-no/d/surface.*",
                "valueIsRegex": true
              },
              {
                "value": "^/da-dk/d/surface.*",
                "valueIsRegex": true
              },
              {
                "value": "^/en-ie/d/surface.*",
                "valueIsRegex": true
              },
              {
                "value": "^/es-es/d/surface.*",
                "valueIsRegex": true
              },
              {
                "value": "^/de-ch/d/surface.*",
                "valueIsRegex": true
              },
              {
                "value": "^/fr-ch/d/surface.*",
                "valueIsRegex": true
              },
              {
                "value": "^/(d|p)/surface.*",
                "valueIsRegex": true
              }
            ]
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "try {\n  var image = new Image(1,1);\n  image.src = \"//sp.analytics.yahoo.com/spp.pl?a=10000&.yp=10084084&ea=ViewProduct&product_id=\" + _pageBITags.pageContracts.ProductInfo.id + \"-\" + _pageBITags.pageContracts.ProductInfo.sku;\n}\ncatch(err)\n{\n\t_satellite.logger.error(\"Verizon_LP\");\n}",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RL31a7aedc0d414d348830e9091f084726",
      "name": "Media_/en-au/store/b/business Tax Day",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 50.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/path.js",
          "settings": {
            "paths": [
              {
                "value": "/en-au/store/b/business",
                "valueIsRegex": true
              }
            ]
          }
        },
        {
          "modulePath": "core/src/lib/conditions/domain.js",
          "settings": {
            "domains": [
              "microsoft.com"
            ]
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "\ntry\n{\n\njQuery(\"div.m-multi-hero, div.m-channel-placement:Lt(1), div.m-content-placement:Lt(1)\").on(\"mousedown\", function(){  \nvar image = new Image(1, 1);\nimage.src =\"https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1=\"+_TMDL.geo+\";u2=\"+_TMDL.ll+\";u6=\"+encodeURIComponent(_TMDL.pagename)+\";u50=CTA;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;ord=1?\";\n\n});\n\n}\ncatch(err)\n{\n\t_satellite.logger.error(\"Media_/en-au/store/b/business Tax Day\");\n}\n\n",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RL55e46cd9bd74412b8e2e75232422973c",
      "name": "FBLP",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 40.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/domain.js",
          "settings": {
            "domains": [
              "microsoft.com"
            ]
          }
        },
        {
          "modulePath": "core/src/lib/conditions/customCode.js",
          "settings": {
            "source": function(event, target) {
  return (window.location.host.toLowerCase()=="www.microsoft.com");
}
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "try\n{\n\tvar marketMap = {\n\t\t\"AT\": \"562684790554330\",  \n\t\t\"AU\": \"284489665351238\", // iProspect\n\t\t\"BE\": \"1441341485948213\", // iProspect  (FR) \n\t\t\"BR\": \"1351385668312384\", // iProspect\n\t\t\"CA\": \"822106911286239\", // iProspect\n\t\t\"CH\": \"1701617263415580\",   \n\t\t\"CN\": \"1675926909345981\", \n\t\t\"DE\": \"108292966463738\",  // iProspect\n\t\t\"DK\": \"254705608267657\",  // iProspect\n\t\t\"ES\": \"1626525834066953\",  // iProspect\n\t\t\"FI\": \"1719588481615214\", \n\t\t\"FR\": \"824192544408978\", // iProspect\n\t\t\"GB\": \"120587825211084\", // iProspect\n\t\t\"HK\": \"539267979583843\", \n\t\t\"IE\": \"249404655562787\", // IProspect (added 9/13/17)\n\t\t\"IN\": \"1974106256199230\",  // (EN) iProspect\n\t\t\"IR\": \"172987109739933\",  \n\t\t\"IT\": \"1598310580201695\",  // iProspect\n\t\t\"JP\": \"288860468248601\", // iProspect\n\t\t\"KR\": \"1413279412072377\", // iProspect\n\t\t\"MX\": \"113583175941450\",  // iProspect\n\t\t\"NL\": \"656219287899900\", // iProspect\n\t\t\"NO\": \"1675926909345981\",  \n\t\t\"NZ\": \"1925863447693257\", // iProspect 9/13/17\n\t\t\"PH\" : \"109126313071654\", // iProspect  (NEW)\n\t\t\"PT\" : \"1368140109922230\",\n\t\t\"RU\": \"514282922073511\",  \n\t\t\"SE\": \"1400129366740315\", // iProspect\n\t\t\"SG\": \"1240252356085595\", // iProspect\n\t\t\"TW\": \"266771177060777\",  // iProspect\n\t\t\"US\": \"141890703034968\" // iProspect\n\t};\n\n\tvar llfbmap = {\n\t\t\"fr-ca\": \"165913903949482\",  \n\t\t\"hi-in\": \"1419329368162069\", \n\t\t\"nl-be\": \"129122374248830\", \n\t\t\"de-ch\": \"1674321202841213\", // iProspect\n\t\t\"never\": \"1111111111111111\"\n\t};\n\t\n\tvar baseurl=\"\",imgurlcart=\"\",imgurlpurchase=\"\",imgurllead=\"\",dbugimgurl=\"\";\n\tvar ts = new Date().valueOf();\n\tvar contentIDs=\"\";\n\tvar i=0;\n\tvar pidstringarr=[];\n\tvar pnamearr=[];\n\tvar feedID=\"\";\n\n\ttry {\n\t\tif(_TMDL && marketMap[(_TMDL.geo).toUpperCase()] ){\n\t\t\tfeedID = marketMap[(_TMDL.geo).toUpperCase()].toLowerCase();\n\t\t}\n\t} catch(err) {}\n\n\ttry {\n\t\tif(_TMDL && llfbmap[(_TMDL.ll).toLowerCase()]){\n\t\t\tfeedID = llfbmap[(_TMDL.ll).toLowerCase()].toLowerCase();\n\t\t}\n\t} catch(llerr) {}\n\n\tif (_TMDL.cc==\"Unknown\" && _TMDL.geo==\"US\") {_TMDL.cc=\"USD\";}\n\n\tbaseurl = \"https://www.facebook.com/tr?id=\"; \n\n\tpageviewurl = baseurl+\"1770559986549030\"+\"&ev=PageView\"+\"&dpo=LDU&dpoco=0&dpost=0\"+\"&ts=\"+ts;\n\tiniturl = baseurl+\"1770559986549030\"+\"&ev=PixelInitialized\"+\"&dpo=LDU&dpoco=0&dpost=0\"+\"&ts=\"+ts;\n\tpdpurl = baseurl+\"1770559986549030\"+\"&ev=ViewContent\"+\"&dpo=LDU&dpoco=0&dpost=0\"\n\t\t+\"&ts=\"+ts\n\t\t+\"&cd[product_catalog_id]=\"+feedID\n\t\t+\"&cd[content_ids]=[\"+encodeURIComponent(_TMDL.pidsku.slice(0)) + \"]\"\n\t\t+\"&cd[content_names]=[\"+encodeURIComponent(_TMDL.pnames.slice(0)) + \"]\"\n\t\t+\"&cd[content_type]=product\";\n\n\tif (_TMDL.isprod)\n\t{\n\t\tdbugimgurl = initurl; \n\t\tBootstrapper.imageRequest(initurl);\n\t\tBootstrapper.imageRequest(initurl.replace(\"1770559986549030\"));\t\n\t\tdbugimgurl = pageviewurl;\n\t\tBootstrapper.imageRequest(pageviewurl);\t\n\t\tBootstrapper.imageRequest(pageviewurl.replace(\"1770559986549030\"));\t\n\t\tif (_TMDL.pageType==\"detail\" || _TMDL.pageType==\"pdp\") {\n\t\t\tdbugimgurl = pdpurl; \n\t\t\tBootstrapper.imageRequest(pdpurl);\t\n\t\t\tBootstrapper.imageRequest(pdpurl.replace(\"1770559986549030\"));\t\n\t\t} \n\t}\n\n\tfor (i=0; i<_TMDL.pidsku.length;i++){\n\t\tpidstringarr.push('\"'+_TMDL.pidsku[i]+'\"');\n\t\tpnamearr.push('\"'+_TMDL.pnames[i]+'\"');\n\t}\n\n\timgurlcart = baseurl+\"1770559986549030\"+\"&ev=AddToCart\"+\"&dpo=LDU&dpoco=0&dpost=0\"\n\t\t+\"&ts=\"+ts\n\t\t+\"&cd[product_catalog_id]=\"+feedID\n\t\t+\"&cd[content_ids]=[\"+encodeURIComponent(pidstringarr.join(\",\")) + \"]\"\n\t\t+\"&cd[content_names]=[\"+encodeURIComponent(pnamearr.join(\",\")) + \"]\"\n\t\t+\"&cd[content_type]=product\";\n\n\timgurlpurchase = baseurl+\"1770559986549030\"+\"&ev=Purchase\"+\"&dpo=LDU&dpoco=0&dpost=0\"\n\t\t+\"&ts=\"+ts\n\t\t+\"&cd[currency]=\"+_TMDL.cc\n\t\t+\"&cd[product_catalog_id]=\"+feedID\n\t\t+\"&cd[content_ids]=[\"+encodeURIComponent(pidstringarr.join(\",\")) + \"]\"\n\t\t+\"&cd[content_names]=[\"+encodeURIComponent(pnamearr.join(\",\")) + \"]\"\n\t\t+\"&cd[content_type]=product\";\n\n\t// Digital Games or Xbox Passes\n  \tif (feedID && _TMDL.isprod && (typeof _TMDL.prdType[0] !== 'undefined') && (typeof _TMDL.pnames[0] !== 'undefined') && (_TMDL.prdType[0]==\"Games\" || ( ~_TMDL.prdType[0].indexOf(\"Pass\") && ~_TMDL.pnames[0].indexOf(\"Xbox\")))) {\n\t\t$(document).on('mousedown','button[id*=\"BuyButton\"]','', function() {\n\t\t\tdbugimgurl = imgurlcart;\n\t\t\tBootstrapper.imageRequest(imgurlcart);\n\t\t\tBootstrapper.imageRequest(imgurlcart.replace(\"1770559986549030\"));\t\n\t\t});\n\t\t_TMDL.fbpchurl = imgurlpurchase;\n\t}\n\n\timgurllead = baseurl+\"1770559986549030\"+\"&ev=Lead\"+\"&dpo=LDU&dpoco=0&dpost=0\"\n\t\t+\"&ts=\"+ts\n\t\t+\"&cd[product_catalog_id]=\"+feedID\n\t\t+\"&cd[content_ids]=[\"+encodeURIComponent(pidstringarr.join(\",\")) + \"]\"\n\t\t+\"&cd[content_names]=[\"+encodeURIComponent(pnamearr.join(\",\")) + \"]\"\n\t\t+\"&cd[content_type]=product\";\n\t\t\n\tif (feedID && ~window.location.pathname.indexOf(\"/p/\") && typeof _TMDL.prdType[0] !== 'undefined' && (_TMDL.prdType[0]==\"Devices\" || _TMDL.prdType[0]==\"Passes\" || _TMDL.prdType[0]==\"Bundles\")) {\n\t\t$(document).on('mousedown','button[id*=\"AddToCartButton\"],button[id*=\"buttons_BuildABundleButton\"],button[id*=\"ConfigureDeviceButton\"],a[href*=\"student-discounts?successurl\"]','', function() {\n\t\t\tdbugimgurl = imgurllead;\n\t\t\tBootstrapper.imageRequest(imgurllead);\n\t\t\tBootstrapper.imageRequest(imgurllead.replace(\"1770559986549030\"));\t\n\t\t});\n\t}\n}\ncatch(err)\n{\n\tif (typeof(_TMutils) !== \"undefined\") {_TMutils.logRuleCall(\"FB LP\",err.message,dbugimgurl);}\n\t_satellite.logger.error(\"FB LP\");\t\n}\n",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RL5e42368dbb6146c0898be78620eeae63",
      "name": "Test Rule - Surface PDP Data Elements",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 50.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/valueComparison.js",
          "settings": {
            "comparison": {
              "operator": "isTrue"
            },
            "leftOperand": "%isSurfacePDP%"
          }
        }
      ],
      "actions": [

      ]
    },
    {
      "id": "RL9effe5e8fdb64618b9c8c6b182f342ae",
      "name": "XboxGrCPE_PMP CTA",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 70.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/domain.js",
          "settings": {
            "domains": [
              "microsoft.com"
            ]
          }
        },
        {
          "modulePath": "core/src/lib/conditions/path.js",
          "settings": {
            "paths": [
              {
                "value": "(us|ca|au|gb)\\/store\\/b\\/xbox",
                "valueIsRegex": true
              }
            ]
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "// OVERWRITES jquery contains to make it case insensitive\njQuery.expr[':'].contains = function(a, i, m) {\n  return jQuery(a).text().toUpperCase()\n      .indexOf(m[3].toUpperCase()) >= 0;\n};\n\nvar debug=0,fireDCM=1;\nvar ll=_TMDL.geo.toLowerCase();\n\nfunction attachAnalyticsToElement(elementAddress, actionName, actionURL) {\n\t$(document).on('mousedown', elementAddress, '', function() {\n\t\tif (debug) { \n\t\t\tconsole.log(actionName); \n\t\t}\n\n\t\tvar j={},pid=\"\",cN=\"\",u=\"\",hr=\"\";\n\t\tvar\ta = \"\" + (Math.random() * 10000000000000);\n\n\t\ttry {\n\t\t\tj=JSON.parse($(this).attr(\"data-m\"));\n\t\t\tpid = j.pid;\n\t\t\tcN= j.cN;\n\t\t\t//hr=this.href;\n\t\t} catch(proderr) {\n\t\t\tif (debug) { \n\t\t\t\tconsole.log(\"catch \"+ actionName + \" \" + hr); \n\t\t\t}\n\t\t}\n\n\t\tu=actionURL + \";u1=\"\n\t\t+_TMDL.geo\n\t\t+\";u2=\"+_TMDL.ll\n\t\t+\";u6=\"+encodeURIComponent(window.location.pathname)\n\t\t+\";u25=\"+pid\n\t\t+\";u26=\"+encodeURIComponent(cN)\n\t\t+\";u50=\"+encodeURIComponent(cN)\n\t\t+\";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=\"\t+ a + \"?\";\n\n\t\tif (debug) { \n\t\t\tconsole.log(actionName+\" u25=\"+pid+\" u26=\"+cN+\"\\t\"+u); \n\t\t}\n\n\t\tif (fireDCM) {\n\t\t\tBootstrapper.imageRequest(u);\n\t\t}\n\t});\n}\n\n\nif (ll==\"us\" || ll==\"ca\" || ll==\"gb\" || ll==\"au\") {\n\ttry {\n\t\tattachAnalyticsToElement(\n\t\t\t'a.small-icon, a.f-image',\n\t\t\t'Hero banner click on Learn More or Free Return & Shipping Icons above the hero',\n\t\t\t'https://ad.doubleclick.net/ddm/activity/src=8391491;type=xbxp;cat=lrn_std');\n\n\t\tattachAnalyticsToElement(\n\t\t\t\"div[id*='oneStore-quicklinksmodule-'] a.large-icon, div[id*='coreui-hero-'] ul li:contains('SHOP NOW'), div[id*='coreui-hero-'] ul li:contains('Shop now')\",\n\t\t\t'Hero banner click on Shop Now or icon menu below banner',\n\t\t\t'https://ad.doubleclick.net/ddm/activity/src=8391491;type=xbxp;cat=pchn_std');\n\n\t\tattachAnalyticsToElement(\n\t\t\t\"div[id*='coreui-hero-'] ul li:contains('Learn more')\",\n\t\t\t'Hero banner click on Learn More',\n\t\t\t'https://ad.doubleclick.net/ddm/activity/src=8391491;type=xbxp;cat=lrn_std');\n\n\t\tattachAnalyticsToElement(\n\t\t\t\"div:contains('Shop') section.m-content-placement-item, div:contains('Join') section.m-content-placement-item\",\n\t\t\t'Click on c-call-to-action Shop Now',\n\t\t\t'https://ad.doubleclick.net/ddm/activity/src=8391491;type=xbxp;cat=pchn_std');\n\n\t\tattachAnalyticsToElement(\n\t\t\t\"div[id*='coreui-productplacement'] div.m-channel-placement-item, div[id*='coreui-productplacement'] a.c-hyperlink\",\n\t\t\t'Click on m-channel-placement on the product trays',\n\t\t\t'https://ad.doubleclick.net/ddm/activity/src=8391491;type=xbxp;cat=pchn_std');\n\n\t\tattachAnalyticsToElement(\n\t\t\t\"div:contains('Learn more') section.m-content-placement-item\",\n\t\t\t'Click on c-call-to-action Learn More',\n\t\t\t'https://ad.doubleclick.net/ddm/activity/src=8391491;type=xbxp;cat=lrn_std');\n\t} catch(clkerr) {\n\t\tconsole.log(\"Xbox PMP CPE Error\");\n\t}\n}",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RL683ad07cec0f4be5a6c44515d9d77917",
      "name": "Media_/LL-LL/Surface- Configurations (AEM/RT)",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 50.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/path.js",
          "settings": {
            "paths": [
              {
                "value": "/p/surface-pro-x/",
                "valueIsRegex": true
              },
              {
                "value": "/p/surface-laptop-go/",
                "valueIsRegex": true
              },
              {
                "value": "/d/surface-pro-x/",
                "valueIsRegex": true
              },
              {
                "value": "/d/surface-laptop-go/",
                "valueIsRegex": true
              }
            ]
          }
        },
        {
          "modulePath": "core/src/lib/conditions/domain.js",
          "settings": {
            "domains": [
              "microsoft.com"
            ]
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "try\n{\n//See all configurations button\n jQuery(\"[href*='/configure/Surface-Pro-X/8qg3bmrhnwhk']\").on(\"mousedown\", function(){\nvar image = new Image(1, 1);\nimage.src =\"https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1=\"+_TMDL.geo+\";u2=\"+_TMDL.ll+\";u6=\"+encodeURIComponent(_TMDL.pagename)+\";u25=\" + _TMDL.pids[0] + \";u26=\" + encodeURIComponent(_TMDL.pnames[0]) + \";u32=\" + _TMDL.skus[0] + \";u50=View all configurations\"+\";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;gdpr=${GDPR};gdpr_consent=${GDPR_CONSENT_755};ord=1?\";\n});\n  \njQuery(\"[href*='/configure/surface-laptop-go/94FC0BDGQ7WV']\").on(\"mousedown\", function(){\nvar image = new Image(1, 1);\nimage.src =\"https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1=\"+_TMDL.geo+\";u2=\"+_TMDL.ll+\";u6=\"+encodeURIComponent(_TMDL.pagename)+\";u25=\" + _TMDL.pids[0] + \";u26=\" + encodeURIComponent(_TMDL.pnames[0]) + \";u32=\" + _TMDL.skus[0] + \";u50=View all configurations\"+\";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;gdpr=${GDPR};gdpr_consent=${GDPR_CONSENT_755};ord=1?\";\n});  \n  \n//The Surface Book 3 Page is no longer required to be tagged as this element is duplicated in an already existing rule (SurfaceGrowthCPE)\n// jQuery(\"[href*='/configure/Surface-Book-3/8XBW9G3Z71F1']\").on(\"mousedown\", function(){\n//var image = new Image(1, 1);\n//image.src =\"https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1=\"+_TMDL.geo+\";u2=\"+_TMDL.ll+\";u6=\"+encodeURIComponent(_TMDL.pagename)+\";u25=\" + _TMDL.pids[0] + \";u26=\" + encodeURIComponent(_TMDL.pnames[0]) + \";u32=\" + _TMDL.skus[0] + \";u50=View all configurations\"+\";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;gdpr=${GDPR};gdpr_consent=${GDPR_CONSENT_755};ord=1?\";\n//});   \n    \n  \n }\ncatch(err)\n{\n\t_satellite.logger.error(\"Media_/LL-LL/Surface- Configurations\");\n}\n",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RLd73c3b4bf4e447aa9825807eb823eca1",
      "name": "Media_/LL-LL/d/surface Twitter (RT)",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 60.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/domain.js",
          "settings": {
            "domains": [
              "microsoft.com"
            ]
          }
        },
        {
          "modulePath": "core/src/lib/conditions/path.js",
          "settings": {
            "paths": [
              {
                "value": "/d/surface",
                "valueIsRegex": true
              },
              {
                "value": "/d/surface/",
                "valueIsRegex": true
              }
            ]
          }
        },
        {
          "modulePath": "core/src/lib/conditions/path.js",
          "settings": {
            "paths": [
              {
                "value": "/en-us/d/surface",
                "valueIsRegex": true
              },
              {
                "value": "/en-us/d/surface/",
                "valueIsRegex": true
              }
            ]
          },
          "negate": true
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "try {\n  \n  //Page Load\n  var image = new Image(1,1);\n  image.src = \"https://analytics.twitter.com/i/adsct?p_id=Twitter&p_user_id=0&txn_id=o4co9&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0&type=image&version=1.1.0\";\n  var image2 = new Image(1,1);\n  image2.src=\"//t.co/i/adsct?p_id=Twitter&p_user_id=0&txn_id=o4co9&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0&type=image&version=1.1.0\";\n\n  \n   //Configure Now button\njQuery(\"button.c-button.f-primary:eq(0)\").on(\"mousedown\", function(){\nvar image = new Image(1,1);\n  image.src = \"https://analytics.twitter.com/i/adsct?p_id=Twitter&p_user_id=0&txn_id=o4co9u&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0&type=image&version=1.1.0\";\nvar image2 = new Image(1,1);  \n  image2.src=\"//t.co/i/adsct?p_id=Twitter&p_user_id=0&txn_id=o4co9&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0&type=image&version=1.1.0\";\n});\n  \n   //Surface Laptop Go for Business Button\njQuery(\"a.c-hyperlink:eq(2)\").on(\"mousedown\", function(){\nvar image = new Image(1,1);\n  image.src = \"https://analytics.twitter.com/i/adsct?p_id=Twitter&p_user_id=0&txn_id=o4co9&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0&type=image&version=1.1.0\";\nvar image2 = new Image(1,1);\n  image2.src=\"//t.co/i/adsct?p_id=Twitter&p_user_id=0&txn_id=o4co9&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0&type=image&version=1.1.0\";\n});\n\n}\ncatch(err)\n{\n\t_satellite.logger.error(\"Media_/LL-LL/d/surface Twitter (RT)\");\n}",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RLc0091ae7ec8549d2947cec9fe6d70168",
      "name": "Media_/en-us/ TikTok Purchase",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 50.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/customCode.js",
          "settings": {
            "source": function(event, target) {
  return (window.location.host.toLowerCase()=="query.prod.cms.rt.microsoft.com" && ~window.location.search.indexOf("pN=congrats"));
}
          }
        },
        {
          "modulePath": "core/src/lib/conditions/path.js",
          "settings": {
            "paths": [
              {
                "value": "/(en-us|en-gb|fr-fr|de-de)",
                "valueIsRegex": true
              }
            ]
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "try\n{\n!function (w, d, t) {\n  w.TiktokAnalyticsObject=t;var ttq=w[t]=w[t]||[];ttq.methods=[\"page\",\"track\",\"identify\",\"instances\",\"debug\",\"on\",\"off\",\"once\",\"ready\",\"alias\",\"group\",\"enableCookie\",\"disableCookie\"],ttq.setAndDefer=function(t,e){t[e]=function(){t.push([e].concat(Array.prototype.slice.call(arguments,0)))}};for(var i=0;i<ttq.methods.length;i++)ttq.setAndDefer(ttq,ttq.methods[i]);ttq.instance=function(t){for(var e=ttq._i[t]||[],n=0;n<ttq.methods.length;n++)ttq.setAndDefer(e,ttq.methods[n]);return e},ttq.load=function(e,n){var i=\"https://analytics.tiktok.com/i18n/pixel/events.js\";ttq._i=ttq._i||{},ttq._i[e]=[],ttq._i[e]._u=i,ttq._t=ttq._t||{},ttq._t[e]=+new Date,ttq._o=ttq._o||{},ttq._o[e]=n||{};var o=document.createElement(\"script\");o.type=\"text/javascript\",o.async=!0,o.src=i+\"?sdkid=\"+e+\"&lib=\"+t;var a=document.getElementsByTagName(\"script\")[0];a.parentNode.insertBefore(o,a)};\n\n//part2\n  ttq.load('C5S71GC247CAE4T3VM1G');\n  ttq.track('CompletePayment');\n}(window, document, 'ttq');\n\n}\ncatch(err)\n{\n\t_satellite.logger.error(\"TikTok Purchase\");\n}\n\n",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RL5495657f599a44fb901e913901431d97",
      "name": "ADHOCCVF",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 60.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/customCode.js",
          "settings": {
            "source": function(event, target) {
  return (window.location.host.toLowerCase()=="query.prod.cms.rt.microsoft.com");
}
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "/*\nADHOC CVF\n*/\ntry\n{\n\tvar geolc=_TMDL.geo.toLowerCase();\n\tvar adobedsp=\"\";\n\tvar imgsrc=\"\";\n\n\tif (_TMDL.isprod && _TMDL.pT==\"rP\")\n\t{\n\n\t\t// uses approach 2:  single pixel, concatenating the product IDs (rather than sending a separate pixel for each line\n\t\t// DE, FR, GB, US\n\t\tif (geolc==\"de\" || geolc==\"fr\" || geolc==\"gb\" || geolc==\"us\") {\n\t\t\tadobedsp=\"https://pixel.everesttech.net/px2/5584?px_evt=t&ev_\"+_TMDL.pidsku.join(\"_\")+\"_count=\"+_TMDL.totqty\n\t\t\t\t+\"&ev_\"+_TMDL.pidsku.join(\"_\")+\"_revenue=\"+_TMDL.totamount\n\t\t\t\t+\"&ev_transid=\"+_TMDL.purchaseID;\n\t\t\timgsrc=adobedsp;\n\t\t\tBootstrapper.imageRequest(adobedsp);\n\t\t}\n\t}\n\n\tvar twmarketMap = {\n\t\"BE\" : \"o173t\",\n\t\"DK\" : \"nznex\",\n\t\"FI\" : \"nznez\",\n\t\"NO\" : \"nznf1\",\n\t\"SE\" : \"nznf3\",\n\t\"IT\" : \"o0287\",\n\t\"ES\" : \"o028a\",\n\t\"PT\" : \"o0289\",\n\t\"NL\" : \"nvq0j\",\n\t\"LU\" : \"o18ai\"\n\t};\n\tvar twtagID=\"\",twimg1=\"\",twimg2=\"\";\n\n\tif(_TMDL && twmarketMap[_TMDL.geo.toUpperCase()] ){twtagID = twmarketMap[_TMDL.geo.toUpperCase()];}\n\t\n\tif (twtagID && _TMDL.isprod && _TMDL.pT==\"rp\") \n\t{\n\t\ttwimg1 = \"https://analytics.twitter.com/i/adsct?txn_id=\"+tagID+\"&p_id=Twitter&tw_sale_amount=\"+_TMDL.totamount+\"&tw_order_quantity=1\";\n\t\ttwimg2 = \"//t.co/i/adsct?txn_id=\"+tagID+\"&p_id=Twitter&tw_sale_amount=\"+_TMDL.totamount+\"&tw_order_quantity=1\";\n\t\timgsrc=twimg1;\n\t\tBootstrapper.imageRequest(img1);\n\t\timgsrc=twimg2;\n\t\tBootstrapper.imageRequest(img2);\t\n\t}\n}\ncatch(err)\n{\n\tif (typeof(_TMutils) !== \"undefined\") {_TMutils.logRuleCall(\"ADHOC CVF\",err.message,imgsrc);}\n\t_satellite.logger.error(\"ADHOC CVF\");\n}\n\n",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RL6a1ffa017a6447ce99ac33bf53bffe46",
      "name": "Surface_XANDR LP",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 70.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/path.js",
          "settings": {
            "paths": [
              {
                "value": "/en-us/p/surface-go/8v9dp4lnknsz",
                "valueIsRegex": true
              },
              {
                "value": "/en-us/p/surface-book-2/8mcpzjjcc98c",
                "valueIsRegex": true
              }
            ]
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "if (~window.location.pathname.toLowerCase().indexOf(\"surface\") && ~window.location.pathname.toLowerCase().indexOf(\"/p/\")) {\n\tif (~window.location.pathname.toLowerCase().indexOf(\"/en-us/p/surface-go/8v9dp4lnknsz\")){\n\t\tBootstrapper.imageRequest(\"https://secure.adnxs.com/px?id=1182093&seg=19686450&t=2\");\t\n\t} else if (~window.location.pathname.toLowerCase().indexOf(\"/en-us/p/surface-book-2/8mcpzjjcc98c\")){\n\t\tBootstrapper.imageRequest(\"https://secure.adnxs.com/px?id=1182149&seg=19686725&t=2\");\t\t\n\t} \t\n}",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RL15699aee762d46598e7641f7823efcba",
      "name": "OffAdobeCV",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 60.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/customCode.js",
          "settings": {
            "source": function(event, target) {
  return (window.location.host.toLowerCase()=="query.prod.cms.rt.microsoft.com" && ~window.location.search.indexOf("pN=congrats"));
}
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "/* Office Adobe DCO CV\n*/\n\ntry\n{\n\tvar inScope=0;\n\tvar ps;\n\tvar rand = parseInt(1E5 * 1E4 * Math.random() * Math.random());\n\tvar u=\"\";\n\tvar totunits = 0;\n\t//var lang = (_TMDL.ll.indexOf(\"-\")>-1) ? _TMDL.ll.split(\"-\")[0].toLowerCase() : \"\";\n\t//var utstring = \"&ut1=\"+_TMDL.pidsku.join(\"%2C\")+\"&ut2=\"+lang+\"&ut3=\"+_TMDL.geo.toLowerCase()+\"&cachebuster=\"+rand;\n\n\tfor (var i=0; i<_TMDL.pidsku.length; i++) {\n\t\tps = _TMDL.pidsku[i].toUpperCase();\n\t\tif (ps==\"CFQ7TTC0K5DM-007R\" || ps==\"CFQ7TTC0K5DM-007W\"){\n\t\t\t// Home Annual\n\t\t\tinScope=1;\n\t\t\ttotunits+=parseInt(_TMDL.quantities[i],10);\n\t\t} else if (ps==\"CFQ7TTC0K5FB-0002\" || ps==\"CFQ7TTC0K5FC-0002\" || ps==\"CFQ7TTC0K5FB-000D\" || ps==\"CFQ7TTC0K5FC-000C\") {\n\t\t\t// Home and Student 2016 (for Mac and Windows SKUs)\n\t\t\tinScope=1;\t\t\n\t\t\ttotunits+=parseInt(_TMDL.quantities[i],10);\n\t\t} \n\t}\n\n\tif (~_TMDL.pageType.indexOf(\"receipt\") && _TMDL.isprod && inScope) {\n\t\t// purchase\n\t\tu=\"https://ats.everesttech.net/ats/ats?cmd=ACTION&MerchantID=MICROSOFTSTORE&ActionID=50106&ActionName=Microsoft_Store_Office_Conversion_Pixel\"\n\t\t\t//+\"&Revenue=\"+_TMDL.totamount  // updated by request from Carat <NAME REMOVED> on 11/8/18\n\t\t\t+\"&Revenue=\"+totunits\n\t\t\t+\"&TransactionID=\"+_TMDL.purchaseID\n\t\t\t+\"&Currency=\"+_TMDL.cc\n\t\t\t+\"&cachebuster=\"+rand;\n\t\tBootstrapper.imageRequest(u); \n\t}\n}\ncatch(err)\n{\n\tif (typeof(_TMutils) !== \"undefined\") {_TMutils.logRuleCall(\"OffAdobeCV\",err.message,u);}\n\t_satellite.logger.error(\"OffAdobeCV\");\t\n}\n",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RL6f8fb5069e2e42759675c7ae03b63753",
      "name": "LinkedIn Surface - CA",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 50.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/path.js",
          "settings": {
            "paths": [
              {
                "value": "ca.*surface",
                "valueIsRegex": true
              }
            ]
          }
        },
        {
          "modulePath": "core/src/lib/conditions/dateRange.js",
          "settings": {
            "end": "2023-04-30T00:00:00Z",
            "start": "2023-02-09T00:00:00Z"
          }
        },
        {
          "modulePath": "core/src/lib/conditions/sessions.js",
          "settings": {
            "count": 1,
            "operator": "="
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "// START OF LINKED IN\nvar micClick = 'a[href]';\nvar secondConfig = 'button[data-action*=\"Configure\"]';\nvar hasClicked = false;\n\nfunction attachPixels(elementAddress) {\n    $(document).on('mousedown', elementAddress, '', function () {\n        if (!hasClicked) {\n            var image1 = new Image(1, 1);\n            image1.src = \"https://px.ads.linkedin.com/collect/?pid=7850&conversionId=10944332&fmt=gif\";\n            hasClicked = true;\n        }\n        \n    });\n} \n\ntry {\n    attachPixels(micClick);\n    attachPixels(secondConfig);\n}\ncatch (err) {\n    _satellite.logger.error(\"CA-LinkedIn\");\n}",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RLa26a28b876c94cf1b014cfe3a839d969",
      "name": "BINGLPCVF",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 70.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/customCode.js",
          "settings": {
            "source": function(event, target) {
  return (window.location.host.toLowerCase()=="www.microsoft.com" || window.location.host.toLowerCase()=="query.prod.cms.rt.microsoft.com")
}
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "// BINGUET\ntry\n{\n\t(function (w, d, t, r, u) {\n\t\tvar f,\n\t\tn,\n\t\ti;\n\t\tw[u] = w[u] || [],\n\t\tf = function () {\n\t\t\tvar o = {\n\t\t\t\tti: \"4000034\", navTimingApi:true  // set navTimingApi flag\n\t\t\t};\n\t\t\to.q = w[u],\n\t\t\tw[u] = new UET(o),\n\t\t\tw[u].push(\"pageLoad\")\n\t\t},\n\t\tn = d.createElement(t),\n\t\tn.src = r,\n\t\tn.async = 1,\n\t\tn.onload = n.onreadystatechange = function () {\n\t\t\tvar s = this.readyState;\n\t\t\ts && s !== \"loaded\" && s !== \"complete\" || (f(), n.onload = n.onreadystatechange = null)\n\t\t},\n\t\ti = d.getElementsByTagName(t)[0],\n\t\ti.parentNode.insertBefore(n, i)\n\t})(window, document, \"script\", \"//bat.bing.com/bat.js\", \"uetq\");\n\n\tvar totamount = 0,\n\t  totvalstring = \"\",\n\t  googpagetype = \"other\",\n\t  prodstring = \"\",\n\t  img=\"\";\n\tvar pagetypemap = {\n\t  // old : [new, eventname]\n\t  \"home\": [\"general_visitor\",\"page_view\"],\n\t  \"search\": [\"search_results\",\"view_search_results\"],\n\t  \"detail\": [\"general_visitor\",\"view_item\"],\n\t  \"category\": [\"general_visitor\",\"view_item_list\"],\n\t  \"checkout_shopping_cart\": [\"cart\",\"add_to_cart\"],\n\t  \"cart\": [\"cart\",\"add_to_cart\"],\n\t  \"receipt\": [\"purchase\",\"Purchase\"]\n\t};\n\n\tvar lineitemObj={};\n\tvar itemsArray=[];\n\n\tvar tempobj = {};\n\tvar eventname=\"page_view\";\n\n\tif (_TMDL.pageType && pagetypemap[_TMDL.pageType.toLowerCase()]) {\n\t\tgoogpagetype = pagetypemap[_TMDL.pageType.toLowerCase()][0];\n\t\teventname = pagetypemap[_TMDL.pageType.toLowerCase()][1];\n\t}\n\tfor (var i = 0; i < _TMDL.pids.length; i++) {\n\t  //TODO add name\n\t\titemsArray.push({'id' : _TMDL.pidsku[i], 'category': (typeof _TMDL.dcmcat =='object')?_TMDL.dcmcat[i]:'', 'price' : _TMDL.sales[i], 'name' : _TMDL.pnames[i]});\n\t\tif (parseFloat(_TMDL.sales[i]) > 0) {\n\t\t\ttotamount += parseFloat(_TMDL.sales[i]);\n\t\t}\n\t}\n    \n\tif (~window.location.pathname.indexOf(\"/b/\")) {\n\t\tgoogpagetype=\"category\";\n\t} else if (~window.location.pathname.indexOf(\"/p/\")) {\n\t\tgoogpagetype=\"product\";\n\t}\n    \n\twindow.uetq = window.uetq || [];\n\n\tif (_TMDL.pidsku.length > 0) {\n\t\ttempobj.ecomm_prodid = (_TMDL.pidsku.length>0) ? _TMDL.pidsku : \"\";\n\t\ttempobj.ecomm_pagetype = googpagetype;\n\t\t//tempobj.ecomm_items = itemsArray;\n\t\ttempobj.items = itemsArray;\n\t}\n\n\tif (~_TMDL.pageType.indexOf(\"cart\") || ~_TMDL.pageType.indexOf(\"receipt\")) {\n\t\ttempobj.currency = _TMDL.cc;\n\t\ttempobj.revenue_value = totamount;\n\t\ttempobj.transaction_id = _TMDL.purchaseID;\n\t}\n\n\twindow.uetq.push('event',eventname, tempobj); \n}\ncatch(err)\n{\n\t_satellite.logger.error(\"BINGLPCVF\");\t\n}\n\n",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RL6960d527cf5e4f06b954e4283c73cc62",
      "name": "MediaIQAppnexusFY20_CV",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 70.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/customCode.js",
          "settings": {
            "source": function(event, target) {
  return (window.location.host.toLowerCase()=="query.prod.cms.rt.microsoft.com" && ~window.location.search.indexOf("pN=congrats"));
}
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "/*\nMedia IQ Appnexus FY20 Conversion Pixel  \nMediaIQAppnexusFY20_CV\n\nMSFT - Office Direct - Consumer - TY Page\n\n*/\n\ntry {\n\tvar imgurl = \"https://secure.adnxs.com/px?id=1095391&seg=17503076&redir=https%3A%2F%2Fpixel.mediaiqdigital.com%2Fpixel\"\n\t\t+\"%3Fu1%3D\"+_TMDL.purchaseID\n\t\t+\"%26u2%3D\"+_TMDL.ll.split(\"-\")[1]\n\t\t+\"%26u3%3D\"\n\t\t+\"%26u4%3D\"\n\t\t+\"%26u5%3D\"+_TMDL.pidsku.join(\"_\")\n\t\t+\"%26u6%3D\"+_TMDL.totamount\n\t\t+\"%26u7%3D\"+_TMDL.totqty\n\t\t+\"%26u8%3D\"+_TMDL.quantities.join(\"_\")\n\t\t+\"%26u9%3D\"+_TMDL.sales.join(\"_\")\n\t\t+\"%26u10%3D\"+_TMDL.cc\n\t\t+\"%26pixel_id%3D1095391%26uid%3D%24%7BUID%7D&t=2\";\n\n\t/*\n\t\t//old:\n\tvar imgurl = \"https://secure.adnxs.com/px?id=929469&seg=10765629&redir=https%3A%2F%2Fsecure.adnxs.com%2Fgetuid%3Fhttps%3A%2F%2Fpixel.mediaiqdigital.com%2Fpixel%3Fu1%3DConsPurchase%26u2%3D\"\n\t+_TMDL.ll\n\t+\"%26u3%3D\"+_TMDL.ll.split(\"-\")[1]\n\t+\"%26u6%3D\"+\"thankyoupage\"\n\t+\"%26u20%3D\"+_TMDL.pidsku.join(\"_\")\n\t+\"%26u26%3D\"+encodeURIComponent(_TMDL.pnames.join(\"_\"))\n\t+\"%26u31%3D\"+_TMDL.cc\n\t+\"%26u34%3D\"+_TMDL.purchaseID\n\t+\"%26u35%3D\"+_TMDL.totqty\n\t+\"%26u39%3D\"+_TMDL.sales.join(\"_\")\n\t+\"%26u40%3D\"+_TMDL.quantities.join(\"_\")\n\t+\"%26pixel_id%3D929469%26uid%3D%24UID&t=2\";\n\t*/\n\n\tif (imgurl && _TMDL.isprod && _TMDL.pageType==\"receipt\") {\n\t\tBootstrapper.imageRequest(imgurl);\n\t}\n} catch(e) {console.log(\"MediaIQAppnexusFY20_CV err\");}",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RLf6485d219649415ab9f7aef1461c1c3a",
      "name": "DCMLP",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 60.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/customCode.js",
          "settings": {
            "source": function(event, target) {
  return (window.location.host.toLowerCase()=="www.microsoft.com");
}
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "try\n{\n\tvar doFloodlights = function(debug) {\n\t\ttry {\n\t\t\t_TMDL.dcmcat = [];\n\n\t\t\tvar imgsrc1,imgsrc2,imgsrc3,imgscr4;\n\t\t\tvar\ta = \"\" + (Math.random() * 10000000000000);\n\t\t\tvar mc1 = \"\";\n\t\t\tvar pth = window.location.pathname.toLowerCase();\n\t\t\tvar pthmatch;\n\t\t\t\n\t\t\t// office and surface don't have the same structure for \"cat\" parameter\n\t\t\tvar landingpageCountFloodlights = {\n\t\t\t\t\twindowsdevices : \"/src=8406115;type=wndv;cat=phy_std\",\n\t\t\t\t\twindowssoftware : \"/src=8406727;type=wsft;cat=phy_std\",\n\t\t\t\t\tothersoftware : \"/src=8406724;type=sftw;cat=phy_std\",\n\t\t\t\t\tsurface : \"/src=8400690;type=surf;cat=lp_phy\",  // nonstandard\n\t\t\t\t\txboxplatform : \"/src=8391491;type=xbxp;cat=phy_std\",\n\t\t\t\t\txboxgames : \"exclude\",\n\t\t\t\t\txboxdesignlabs : \"/src=8404966;type=xdl;cat=phy_std\",\n\t\t\t\t\txboxgamepass : \"/src=8406391;type=xgpg;cat=phy_std\",\n\t\t\t\t\txboxlive : \"/src=8391497;type=xlg;cat=phy_std\",\n\t\t\t\t\thololens : \"/src=8391509;type=hll;cat=phy_std\",\n\t\t\t\t\toffice : \"/src=8406097;type=ofco;cat=lpst_std\",  // nonstandard\n\t\t\t\t\tminecraft : \"exclude\",\n\t\t\t\t\tother : \"/src=8406157;type=stoth;cat=phy_std\"\t\n\t\t\t};\n\n\t\t\tvar genericLandingpageFloodlights = {\n\t\t\t\t\twindowsdevices : \"/src=8406115;type=wndv;cat=lp_std\",\n\t\t\t\t\twindowssoftware : \"exclude\",\n\t\t\t\t\tothersoftware : \"exclude\",\n\t\t\t\t\tsurface : \"/src=8400690;type=surf;cat=lp_std\",  // nonstandard\n\t\t\t\t\txboxplatform : \"/src=8391491;type=xbxp;cat=lp_std\",\n\t\t\t\t\txboxgames : \"/src=8406391;type=xbxgms;cat=lp_std\",\n\t\t\t\t\txboxdesignlabs : \"/src=8404966;type=xdl;cat=lp_std\",\n\t\t\t\t\txboxgamepass : \"/src=8406391;type=xgpg;cat=gplp_std\",\n\t\t\t\t\txboxlive : \"/src=8391497;type=xlg;cat=lp_std\",\n\t\t\t\t\thololens : \"/src=8391509;type=hll;cat=lp_std\",\n\t\t\t\t\toffice : \"exclude\",  // nonstandard\n\t\t\t\t\tminecraft : \"/src=8400687;type=mc;cat=lp_std\",\n\t\t\t\t\tother : \"exclude\"\t\n\t\t\t};\n\t\t\t\n\t\t\tvar landingpageUniqueFloodlights = {\n\t\t\t\t\twindowsdevices : \"/src=8406115;type=wndv;cat=phy_uni\",\n\t\t\t\t\twindowssoftware : \"/src=8406727;type=wsft;cat=phy_uni\",\n\t\t\t\t\tothersoftware : \"/src=8406724;type=sftw;cat=phy_uni\",\n\t\t\t\t\tsurface : \"/src=8400690;type=surf;cat=lp_uni\",  // nonstandard\n\t\t\t\t\txboxplatform : \"/src=8391491;type=xbxp;cat=phy_uni\",\n\t\t\t\t\txboxgames : \"exclude\",\n\t\t\t\t\txboxdesignlabs : \"/src=8404966;type=xdl;cat=phy_uni\",\n\t\t\t\t\txboxgamepass : \"/src=8406391;type=xgpg;cat=phy_uni\",\n\t\t\t\t\txboxlive : \"/src=8391497;type=xlg;cat=phy_uni\",\n\t\t\t\t\thololens : \"/src=8391509;type=hll;cat=phy_uni\",\n\t\t\t\t\toffice : \"/src=8406097;type=ofco;cat=lp_uni\",  // nonstandard\n\t\t\t\t\tminecraft : \"exclude\",\n\t\t\t\t\tother : \"exclude\"\t\n\t\t\t};\n\n\t\t\t// only windowssoftware has a PrdCatVue tag (WindowsSoftware_GBL_PrdCatVue_Count_PhysicalStore)\n\t\t\tvar categoryFloodlights = {\n\t\t\t\t\twindowsdevices : \"exclude\",\n\t\t\t\t\twindowssoftware : \"/src=8406727;type=wsft;cat=pdcv_phy\",\n\t\t\t\t\tothersoftware : \"exclude\",\n\t\t\t\t\tsurface : \"exclude\",\n\t\t\t\t\txboxplatform : \"exclude\",\n\t\t\t\t\txboxgames : \"exclude\",\n\t\t\t\t\txboxdesignlabs : \"exclude\",\n\t\t\t\t\txboxgamepass : \"exclude\",\n\t\t\t\t\txboxlive : \"exclude\",\n\t\t\t\t\thololens : \"exclude\",\n\t\t\t\t\toffice : \"exclude\",\n\t\t\t\t\tminecraft : \"exclude\",\n\t\t\t\t\tother : \"exclude\"\t\n\t\t\t};\n\n\t\t\tvar pdpFloodlights = {\n\t\t\t\twindowsdevices : \"/src=8406115;type=wndv;cat=prdv_std\",  // nonstandard\n\t\t\t\twindowssoftware : \"/src=8406727;type=wsft_sls;cat=pdv_phy\",\n\t\t\t\tothersoftware : \"/src=8406724;type=sftw_sls;cat=pdv_phy\",\n\t\t\t\tsurface : \"/src=8400690;type=surf;cat=prdv_std\",  // nonstandard\n\t\t\t\txboxplatform : \"/src=8391491;type=xbxp;cat=pdv_phy\",\n\t\t\t\txboxgames : \"xboxgames\",\n\t\t\t\txboxdesignlabs : \"/src=8404966;type=xdl_sls;cat=pdv_phy\",\n\t\t\t\txboxgamepass : \"/src=8406391;type=xgpg_sls;cat=pdv_phy\",\n\t\t\t\txboxlive : \"/src=8391497;type=xlg;cat=pdv_phy\",\n\t\t\t\thololens : \"/src=8391509;type=hll;cat=pdv_phy\",\n\t\t\t\toffice : \"/src=8406097;type=ofco;cat=prdv_std\",  // nonstandard\n\t\t\t\tminecraft : \"exclude\",\n\t\t\t\tother : \"exclude\"\n\t\t\t};\n\t\t\t\n\t\t\tvar categoryCounts = {\n\t\t\t\twindowsdevices : 0,\n\t\t\t\twindowssoftware : 0,\n\t\t\t\tothersoftware : 0,\n\t\t\t\tsurface : 0,\n\t\t\t\txboxplatform : 0,\n\t\t\t\txboxgames : 0,\n\t\t\t\txboxdesignlabs : 0,\n\t\t\t\txboxgamepass : 0,\n\t\t\t\txboxlive : 0,\n\t\t\t\thololens : 0,\n\t\t\t\toffice : 0,\n\t\t\t\tminecraft : 0,\n\t\t\t\tother : 0\n\t\t\t};\n\t\t\t\n\t\t\tvar matchWindowBrand = function(pname) {\n\t\t\t\tvar brandnames = [\n\t\t\t\t\t[\"acer\",\"windowsdevices\"],\n\t\t\t\t\t[\"alienware\",\"windowsdevices\"],\n\t\t\t\t\t[\"asus\",\"windowsdevices\"],\n\t\t\t\t\t[\"cyberpowerpc\",\"windowsdevices\"],\n\t\t\t\t\t[\"dell\",\"windowsdevices\"],\n\t\t\t\t\t[\"hp\",\"windowsdevices\"],\n\t\t\t\t\t[\"huawei\",\"windowsdevices\"],\n\t\t\t\t\t[\"ibuypower\",\"windowsdevices\"],\n\t\t\t\t\t[\"lenovo\",\"windowsdevices\"],\n\t\t\t\t\t[\"linx\",\"windowsdevices\"],\n\t\t\t\t\t[\"logah\",\"windowsdevices\"],\n\t\t\t\t\t[\"millet\",\"windowsdevices\"],\n\t\t\t\t\t[\"porsche\",\"windowsdevices\"],\n\t\t\t\t\t[\"razer\",\"windowsdevices\"],\n\t\t\t\t\t[\"samsung\",\"windowsdevices\"],\n\t\t\t\t\t[\"toshiba\",\"windowsdevices\"],\n\t\t\t\t\t[\"/collections/laptops\",\"windowsdevices\"],\n\t\t\t\t\t[\"/store/b/pc\",\"windowsdevices\"],\t\t\n\t\t\t\t\t[\"/store/b/pc\",\"windowsdevices\"]\t\t\n\t\t\t\t];\n\t\t\t\tfor (var i=0; i<brandnames.length; i++){\n\t\t\t\t\tif (~pname.toLowerCase().indexOf(brandnames[i][0])) {\n\t\t\t\t\t\tif (debug) { console.log(\"matched windows brand\");}\n\t\t\t\t\t\treturn brandnames[i][1];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t};\n\n\t\t\t// update pidlist\n\t\t\tvar pidlist={\n\t\t\t\t\n\t\t\t'D76QX4BZNWK4' : 'windowssoftware',\n\t\t\t'DF77X4D43RKT' : 'windowssoftware',\n\t\t\t'DG7GMGF0DS12' : 'windowssoftware',\n\t\t\t'DG7GMGF0DS1H' : 'windowssoftware',\n\t\t\t\n\t\t\t'DG7GMGF0DST3' : 'othersoftware',\n\t\t\t'DG7GMGF0DST4' : 'othersoftware',\n\t\t\t'DG7GMGF0DST5' : 'othersoftware',\n\t\t\t'DG7GMGF0DST6' : 'othersoftware',\n\t\t\t'DG7GMGF0DWP2' : 'othersoftware',  \n\n\n\t\t\t'8MB6CR05S1QD' : 'xboxplatform',\n\n\t\t\t'8MC6K8M228SK' : 'surface',\n\t\t\t'8MCPZJJCC98C' : 'surface',\n\t\t\t'8N1V4QJ3GQ5X' : 'surface',\n\t\t\t'8NKT9WTTRBJK' : 'surface',\n\t\t\t'8RKCLMWPW1PP' : 'surface',\n\t\t\t'8XCW9BBPVFV9' : 'surface',\n\t\t\t'907TDS4DGWWV' : 'surface',\n\t\t\t'90FC23DV6SNZ' : 'surface',\n\t\t\t'93LTM69S3RFF' : 'surface',\n\n\t\t\t'8XF18PQZ17TS' : 'hololens',\n\t\t\t'90MDTZVL02K9' : 'hololens',\n\t\t\t'944XGCF64Z5B' : 'hololens',\n\t\t\t\n\t\t\t'900WZDF9XJVG' : 'xboxdesignlabs',\n\t\t\t'93JLLWMDZ0V7' : 'xboxdesignlabs',\n\t\t\t'941H3FP99RM3' : 'xboxdesignlabs',\n\t\t\t'8TBJW32WJF8C' : 'xboxdesignlabs',\n\t\t\t'90T6CGN08P38' : 'xboxdesignlabs',\n\t\t\t'90K4SGTLSKML' : 'xboxdesignlabs',\n\t\t\t'8VK59S4SSLWD' : 'xboxdesignlabs',\n\t\t\t'8TVCQSJ7V6PT' : 'xboxdesignlabs',\n\t\t\t'8T07Q5SRTV11' : 'xboxdesignlabs',\n\t\t\t'8VKFWF7M03NJ' : 'xboxdesignlabs',\n\t\t\t'90GBR9CZBHJ9' : 'xboxdesignlabs',\n\t\t\t'9355VZP4KXB8' : 'xboxdesignlabs',\n\t\t\t'8QT59S4FDX8Z' : 'xboxdesignlabs',\n\t\t\t\n\t\t\t'CFQ7TTC0K5ZM' : 'xboxlive',\n\t\t\t\n\t\t\t'CFQ7TTC0K5F8' : 'office',\n\t\t\t'CFQ7TTC0K5FD' : 'office',\n\t\t\t'CFQ7TTC0K5FF' : 'office',\n\t\t\t'CFQ7TTC0K5BB' : 'office',\n\t\t\t'CFQ7TTC0K5BC' : 'office',\n\t\t\t'CFQ7TTC0K5BD' : 'office',\n\t\t\t'8N0LL43Q1H85' : 'office',\n\t\t\t'CFQ7TTC0K5DZ' : 'office',\n\t\t\t'CFQ7TTC0K5F2' : 'office',\n\t\t\t'CFQ7TTC0K5F3' : 'office',\n\t\t\t'CFQ7TTC0K5BH' : 'office',\n\t\t\t'CFQ7TTC0K5D6' : 'office',\n\t\t\t'CFQ7TTC0K5D7' : 'office',\n\t\t\t'CFQ7TTC0K5CD' : 'office',\n\t\t\t'CFQ7TTC0K5CF' : 'office',\n\t\t\t'CFQ7TTC0K5CP' : 'office',\n\t\t\t'CFQ7TTC0K5CS' : 'office',\n\t\t\t'CFQ7TTC0K5CT' : 'office',\n\t\t\t'CFQ7TTC0K5D0' : 'office',\n\t\t\t'CFQ7TTC0K5DN' : 'office',\n\t\t\t'CFQ7TTC0K5DM' : 'office',\n\t\t\t'CFQ7TTC0K5BF' : 'office',\n\t\t\t'CFQ7TTC0K5FB' : 'office',\n\t\t\t'CFQ7TTC0K5FC' : 'office',\n\t\t\t\n            // added 4/20/20 for alta\n            '8PC5BJBHN74P' : 'office',\n            '94CM694VJ57P' : 'office',\n            '900RPBX20TS6' : 'office',\n            '93R684WJ71VJ' : 'office',\n            '8V9J0T4JFZ6W' : 'office',\n            '8NFJC88FKMRZ' : 'office',\n            '8SZWM812T6N1' : 'office',\n            'CFQ7TTC0K5BG' : 'office',\n            '8V883X3J1V40' : 'office',\n            // end alta\n              \n\t\t\t'BPSWGQBW7R3G': 'xboxplatform',\n\t\t\t'9NBLGGH4PBBM': 'xboxplatform', \n\n\n\t\t\t'SHOULDNEVERMATCH' : 'pc'\n\t\t\t};\n\n\t\t\t// _TMDL.prdType and _TMDL.prdFam\n\t\t\t\n\t\t\tif ((~pth.indexOf(\"/d/\") || ~pth.indexOf(\"/p/\")) && _TMDL.pids && pidlist[_TMDL.pids[0]]) {\n\t\t\t\t// check pids for anything explicitly mapped\n\t\t\t\tcategoryCounts[pidlist[_TMDL.pids[0]]]++;\n\t\t\t\tif (debug) { console.log(\"matched PID\", _TMDL.pids[0], pidlist[_TMDL.pids[0]]); }\n\t\t\t} else if (~pth.indexOf(\"surface\") ) {\n\t\t\t\tcategoryCounts[\"surface\"]++;\n\t\t\t} else if (~pth.indexOf(\"office\") || ~pth.indexOf(\"o365\")) {\n\t\t\t\tcategoryCounts[\"office\"]++;\n\t\t\t} else if (~pth.indexOf(\"minecraft\") ) {\n\t\t\t\tcategoryCounts[\"minecraft\"]++;\n\t\t\t} else if (~pth.indexOf(\"xbox\") ) {\n\t\t\t\tcategoryCounts[\"xboxplatform\"]++;\n\t\t\t} else if (~pth.indexOf(\"hololens\") ) {\n\t\t\t\tcategoryCounts[\"hololens\"]++;\n\t\t\t} else {\n\t\t\t\tpthmatch = matchWindowBrand(pth);\n\t\t\t\tif (pthmatch) {\n\t\t\t\t\tcategoryCounts[pthmatch]++;\n\t\t\t\t} else {\n\t\t\t\t\t// TODO:  check if physical\n\t\t\t\t\tcategoryCounts[\"other\"]++;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\ttry {\n\t\t\t\tif (_TMutils.readCookie(\"MC1\")) {\n\t\t\t\t\tmc1 = _TMutils.readCookie(\"MC1\").split(\"&\")[0].split(\"=\")[1]; //use in u58\n\t\t\t\t}\n\t\t\t} catch(mc1err) {}\t\n\n\n\t\t\t/* set the floodlights based on the page */\n\t\t\tif (_TMDL.pageType==\"receipt\" || _TMDL.pageType==\"congrats\") {\n\t\t\t\tfloodlights = purchaseFloodlights;\n\t\t\t} else if (~_TMDL.pageType.indexOf(\"cart\")) {\n\t\t\t\tfloodlights = cartFloodlights;\n\t\t\t}\n\t\t\t\n\t\t\tif(debug) {\tconsole.log(categoryCounts); }\n\n\t\t\tfor (key in categoryCounts) {\n\n\t\t\t\tif (categoryCounts[key]>0) {\t\t\n\t\t\t\t\tif (debug) {console.log(key,categoryCounts[key],landingpageUniqueFloodlights[key],\"\\n\");}\n\t\t\t\t\n\t\t\t\t\t// Activity Name: Store_AllProd_GBL_LandingPageVue_Unique_\n\t\t\t\t\tif (landingpageUniqueFloodlights[key] !== \"exclude\") {\n\t\t\t\t\t\timgsrc1 = \"https://ad.doubleclick.net/ddm/activity\"+landingpageUniqueFloodlights[key]+\";u1=\"+_TMDL.geo.toUpperCase()+\";u2=\"+_TMDL.ll\n\t\t\t\t\t\t\t//+\";u5=\"+encodeURIComponent(document.referrer)\n\t\t\t\t\t\t\t+\";u6=\"+encodeURIComponent(_TMDL.pageName)\n\t\t\t\t\t\t\t+\";u7=\"+encodeURIComponent(window.location.pathname.toLowerCase())\n\t\t\t\t\t\t\t+\";u25=\"+_TMDL.pids+\";u26=\"+encodeURIComponent(_TMDL.pnames[0])+\";u31=\"+_TMDL.cc+\";u33=\"+_TMDL.pidsku\n\t\t\t\t\t\t\t+\";u58=\"+mc1\n\t\t\t\t\t\t\t+\";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1;num=\"+a+\"?\";\n\t\t\t\t\t\timgsrc = imgsrc1;\n\t\t\t\t\t\tif (debug) { console.log(imgsrc1); }\n\t\t\t\t\t\tBootstrapper.imageRequest(imgsrc1);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\n\t\t\t\t\t/* Activity name of this tag: Store_AllProd_GBL_LandingPageVue_Count_  */\n\t\t\t\t\tif (landingpageCountFloodlights[key] !== \"exclude\") {\n\t\t\t\t\t\timgsrc2 = \"https://ad.doubleclick.net/ddm/activity\"+landingpageCountFloodlights[key]+\";u1=\"+_TMDL.geo.toUpperCase()+\";u2=\"+_TMDL.ll\n\t\t\t\t\t\t\t+\";u6=\"+encodeURIComponent(_TMDL.pageName)\n\t\t\t\t\t\t\t+\";u7=\"+encodeURIComponent(window.location.pathname.toLowerCase())\n\t\t\t\t\t\t\t+\";u25=\"+_TMDL.pids+\";u26=\"+encodeURIComponent(_TMDL.pnames[0])+\";u31=\"+_TMDL.cc+\";u33=\"+_TMDL.pidsku\n\t\t\t\t\t\t\t+\";u58=\"+mc1\n\t\t\t\t\t\t\t+\";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1;num=\"+a+\"?\";\n\t\t\t\t\t\timgsrc = imgsrc2;\n\t\t\t\t\t\tif (debug) { console.log(imgsrc2); }\n\t\t\t\t\t\tBootstrapper.imageRequest(imgsrc2);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t/*  genericLandingpageFloodlights  */\n\t\t\t\t\tif (genericLandingpageFloodlights[key] !== \"exclude\") {\n\t\t\t\t\t\timgsrc1 = \"https://ad.doubleclick.net/ddm/activity\"+genericLandingpageFloodlights[key]+\";u1=\"+_TMDL.geo.toUpperCase()+\";u2=\"+_TMDL.ll\n\t\t\t\t\t\t\t//+\";u5=\"+encodeURIComponent(document.referrer)\n\t\t\t\t\t\t\t+\";u6=\"+encodeURIComponent(_TMDL.pageName)\n\t\t\t\t\t\t\t+\";u7=\"+encodeURIComponent(window.location.pathname.toLowerCase())\n\t\t\t\t\t\t\t+\";u25=\"+_TMDL.pids+\";u26=\"+encodeURIComponent(_TMDL.pnames[0])+\";u31=\"+_TMDL.cc+\";u33=\"+_TMDL.pidsku\n\t\t\t\t\t\t\t+\";u58=\"+mc1\n\t\t\t\t\t\t\t+\";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1;num=\"+a+\"?\";\n\t\t\t\t\t\timgsrc = imgsrc1;\n\t\t\t\t\t\tif (debug) { console.log(imgsrc1); }\n\t\t\t\t\t\tBootstrapper.imageRequest(imgsrc1);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tif (_TMDL.pageType==\"detail\" && (~_TMDL.prdType[0].toLowerCase().indexOf(\"device\") || ~_TMDL.prdType[0].toLowerCase().indexOf(\"pass\"))) {\n\t\t\t\t\t\t_TMDL.dcmcat.push(key);\n\t\t\t\t\t\tif (pdpFloodlights[key] !== \"exclude\") {\n\t\t\t\t\t\t\t// Store_AllProd_GBL_PrdVue_Count_PhysicalStore\n\t\t\t\t\t\t\timgsrc3 = \"https://ad.doubleclick.net/ddm/activity\"+pdpFloodlights[key]+\";u1=\"+_TMDL.geo.toUpperCase()+\";u2=\"+_TMDL.ll\n\t\t\t\t\t\t\t\t+\";u6=\"+encodeURIComponent(_TMDL.pageName)\n\t\t\t\t\t\t\t\t+\";u7=\"+encodeURIComponent(window.location.pathname.toLowerCase())\n\t\t\t\t\t\t\t\t+\";u25=\"+_TMDL.pids+\";u26=\"+encodeURIComponent(_TMDL.pnames)+\";u32=\"+_TMDL.pids+\";u33=\"+_TMDL.pidsku+\";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=\"+a;\n\t\t\t\t\t\t\timgsrc = imgsrc3;\n\t\t\t\t\t\t\tBootstrapper.imageRequest(imgsrc3);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (~_TMDL.pageType.toLowerCase().indexOf(\"category\") && ~window.location.pathname.indexOf(\"/b/\")){\n\t\t\t\t\t\t_TMDL.dcmcat.push(key);\n\t\t\t\t\t\tif (categoryFloodlights[key] !== \"exclude\") {\n\t\t\t\t\t\t\timgsrc4 = \"https://ad.doubleclick.net/ddm/activity\"+categoryFloodlights[key]+\";u1=\"+_TMDL.geo.toUpperCase()+\";u2=\"+_TMDL.ll\n\t\t\t\t\t\t\t\t+\";u6=\"+encodeURIComponent(_TMDL.pageName)\n\t\t\t\t\t\t\t\t+\";u7=\"+encodeURIComponent(window.location.pathname.toLowerCase())\n\t\t\t\t\t\t\t\t+\";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=\"+a+\"?\";\n\t\t\t\t\t\t\timgsrc = imgsrc4;\n\t\t\t\t\t\t\tBootstrapper.imageRequest(imgsrc4);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (debug) { console.log(_TMDL.dcmcat) ; }\n\t\t\t\t}\n\t\t\t}\n\t\t\n\t\t} catch(flerr) {\n\t\t\t_TMutils.logRuleCall(\"DCMLP err\",flerr.name,flerr.message);\n\t\t}\n\n\t};\n\n\n\tvar pth = window.location.pathname.toLowerCase();\n\tvar debug = ~window.location.href.indexOf(\"debug\") ? 1 : 0;\n\n\n\n\t// -----------------------------------------\n\t//   previously separate digital pages tags\n\t// -----------------------------------------\n\n\tvar _getMetaValue = function(name) {\n\t\t\treturn $('meta[name=\"' + name + '\"]').attr('content');\n\t\t};\n\t\t\n\tvar fireDCM = function(params) {\n\t\tvar a, imgsrc1, imgsrc2;\n\t\ta = \"\" + (Math.random() * 10000000000000);\n\t\timgsrc1 = \"https://ad.doubleclick.net/ddm/activity/\"+params+\";u1=\"+_TMDL.geo.toUpperCase()+\";u2=\"+_TMDL.ll\n\t\t\t+\";u20=\"+_TMDL.pidsku\n\t\t\t+\";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=\"+a+\"?\";\n\t\timgsrc = imgsrc1;\n\t\tBootstrapper.imageRequest(imgsrc1);\n\t\t\n\t\tif (debug) {console.log(params);}\n\t};\n\n\tvar matchXboxBrand = function(pname) {\n\t\tvar brandnames = [\n\t\t\t\"forza\",\n\t\t\t\"call of duty\",\n\t\t\t\"tomb raider\",\n\t\t\t\"toy soldiers war chest\",\n\t\t\t\"red dead\"\n\t\t\t];\n\t\tfor (var i=0; i<brandnames.length; i++){\n\t\t\tif (~pname.toLowerCase().indexOf(brandnames[i])) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t};\n\n\tvar pdpname = (_TMDL.pnames.length>0 && ~_TMDL.pnames[0]) ? _TMDL.pnames[0].toLowerCase() : \"\";\n\tvar isPhysicalPage = (~pth.indexOf(\"/store/\") && pth.indexOf(\"/p/\")<0) || (~pth.indexOf(\"/p/\") && _TMDL.prdType[0]!==\"Apps\" && _TMDL.prdType[0]!==\"Games\");\n\tvar\ta = \"\" + (Math.random() * 10000000000000);\n\tvar configdeviceurl=\"\",buildyourbundleurl=\"\", checkeligibilityurl=\"\", addtocarturl=\"\";\n\tvar imgsrc=\"\";\n\t\n\tif (isPhysicalPage) {doFloodlights(debug);}\n\n\tif (_TMDL.prdType==\"Games\" || _TMDL.prdType==\"Passes\" || _TMDL.prdType==\"Apps\") {\n\t\tif ( ~pth.indexOf(\"cfq7ttc0k5zm\") || ~pth.indexOf(\"cfq7ttc0k5dj\")) {\n\t\t\t// XboxLiveGold_GBL_PrdVue_Count_DigitalStore:  /src=8391497;type=xlg;cat=pdv_dgtl;\n\t\t\tfireDCM(\"src=8391497;type=xlg;cat=pdv_dgtl\");  \n          $(document).on('mousedown','button#buttons_AddToCartButton,button:contains(\"Buy\"),a:contains(\"Buy\"), button[id*=\"RedeemCodeButton\"]','', function() {\n\t\t\t\t//console.log(\"AddToCart\");  // XboxLiveGold_GBL_CartVue_Count_DigitalStore\n\t\t\t\tfireDCM(\"src=8391497;type=xlg;cat=crtd_std\");\n\t\t\t});\n\t\t} else if (\t( _TMDL.prdType==\"Games\" && (_getMetaValue(\"ms\\\\.prod_worksonxbox\")==\"true\" || matchXboxBrand(pdpname))) || (pth.indexOf(\"xbox\") > -1) || ~pdpname.indexOf(\"xbox\") ) {\n\t\t\t//XboxGamePassGames_GBL_PrdVue_Count_DigitalStore:  /src=8406391;type=xgpg;cat=pdv_dgtl;\n\t\t\t//console.log(\"XboxGamePassGames_GBL_PrdVue_Count_DigitalStore\");\n\t\t\tfireDCM(\"src=8406391;type=xgpg;cat=pdv_dgtl\");\n          $(document).on('mousedown','button#buttons_AddToCartButton,button:contains(\"Buy\"),a:contains(\"Buy\"), button[id*=\"RedeemCodeButton\"]','', function() {\n\t\t\t\t//console.log(\"AddToCart\"); //XboxGamePassGames_GBL_CartVue_Count_DigitalStore\n\t\t\t\tfireDCM(\"src=8406391;type=xgpg;cat=crtd_std\");\n\t\t\t});\n\t\t} else if (_TMDL.prdType==\"Apps\" || _TMDL.prdType==\"Games\") {\n\t\t\t//WindowsSoftware_GBL_PrdVue_Count_DigitalStore\n\t\t\t//console.log(\"WindowsSoftware_GBL_PrdVue_Count_DigitalStore\");\n\t\t\tfireDCM(\"src=8406727;type=wsft;cat=pdv_dgtl\");\n\t\t\t$(document).on('mousedown','button#buttons_AddToCartButton,button:contains(\"Buy\"),a:contains(\"Buy\"), button[id*=\"RedeemCodeButton\"]','', function() {\n\t\t\t\t//console.log(\"AddToCart\"); //WindowsSoftware_GBL_CartVue_Count_DigitalStore\n\t\t\t\tfireDCM(\"src=8406727;type=wsft;cat=crtd_std\");\n\t\t\t});\n\t\t}\n\t}\n\n\n\t// Surface Configure Device tag as Surface Learn More  (request from Ahmed Homsi)\n\tif (~window.location.pathname.toLowerCase().indexOf(\"surface\") && ~window.location.pathname.toLowerCase().indexOf(\"/d/\")) {\n\n\t\tconfigdeviceurl = \"https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=lrn_std;u1=\"\n\t\t\t+_TMDL.geo\n\t\t\t+\";u2=\"+_TMDL.ll\n\t\t\t+\";u6=\"+encodeURIComponent(_TMDL.pagename)\n\t\t\t+\";u25=\"+_TMDL.pids[0]\n\t\t\t+\";u26=\"+encodeURIComponent(_TMDL.pnames[0])\n\t\t\t+\";u50=Configure%20now\"\n\t\t\t+\";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=\"\t+ a + \"?\";\n\t\timgsrc = configdeviceurl;\n\n\t\t// Configure Now CTA\n\t\t$(document).on('mousedown','a:contains(\"Configure now\"),button:contains(\"Configure now\")','', function() {\n\t\t\tBootstrapper.imageRequest(configdeviceurl);\n\t\t});\n      \n      \tbuildyourbundleurl = \"https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=lrn_std;u1=\"\n    \t\t+_TMDL.geo\n    \t\t+\";u2=\"+_TMDL.ll\n    \t\t+\";u6=\"+encodeURIComponent(_TMDL.pagename)\n    \t\t+\";u25=\"+_TMDL.pids[0]\n    \t\t+\";u26=\"+encodeURIComponent(_TMDL.pnames[0])\n    \t\t+\";u50=BuildYourBundle\"\n    \t\t+\";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=\"\t+ a + \"?\";\n\n\n    \t// BuildYourBundle CTA\n        $(document).on('mousedown','a:contains(\"Build your bundle\"),button:contains(\"Build your bundle\"),a[href*=\"/store/build/\"]','', function() {\n    \t\tBootstrapper.imageRequest(buildyourbundleurl);\n    \t});\n      \n\t// Shop Now CTA from PDP (Surface_GBL_PchNow_Count_)  (src=8400690;type=surf;cat=pchn_std;)  added 5/6/19, modified 12/319 for exclusions\n\t$(document).on('mousedown','div.pi-promotion-bar a','', function() {\n\t\tvar inScope=1;\n\t\ttry {\n\t\t\tif (~this.href.indexOf(\"/build/\") || ~this.href.indexOf(\"student-discounts?successurl\")) {\n\t\t\t\t_satellite.logger.log(\"out of scope\");\n\t\t\t\tinScope=0;\n\t\t\t}\n\t\t} catch(shperr) {_satellite.logger.log(\"shopnow err\");}\n\n\t\tif (inScope) { \n\t\t\tBootstrapper.imageRequest(\"https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1=\"\n\t\t\t+_TMDL.geo\n\t\t\t+\";u2=\"+_TMDL.ll\n\t\t\t+\";u6=\"+encodeURIComponent(_TMDL.pagename)\n\t\t\t+\";u25=\"+_TMDL.pids[0]\n\t\t\t+\";u26=\"+encodeURIComponent(_TMDL.pnames[0])\n\t\t\t+\";u50=ShopNow\"\n\t\t\t+\";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=\"\t+ a + \"?\");\n\t\t}\n\t});\n\n        // added 12/2/19 to add in shop for business in non-promobar area\t\n        $(document).on('mousedown','div.store-finance-offer a','', function() {\n                Bootstrapper.imageRequest(\"https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1=\"\n                +_TMDL.geo\n                +\";u2=\"+_TMDL.ll\n                +\";u6=\"+encodeURIComponent(_TMDL.pagename)\n                +\";u25=\"+_TMDL.pids[0]\n                +\";u26=\"+encodeURIComponent(_TMDL.pnames[0])\n                +\";u50=BusinessOffer\"\n                +\";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=\"\t+ a + \"?\");\n        });\n      \n        // check your eligibility CTA\n      \tcheckeligibilityurl = \"https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=lrn_std;u1=\"+_TMDL.geo+\";u2=\"+_TMDL.ll+\";u6=\"+encodeURIComponent(_TMDL.pagename)+\";u25=\"+_TMDL.pids[0]\t+\";u26=\"+encodeURIComponent(_TMDL.pnames[0])+\";u50=CheckYourEligibility;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=\"+a+\"?\";\n        $(document).on('mousedown',\"a[href*='student-discounts?successurl']\",'', function() {\n            Bootstrapper.imageRequest(checkeligibilityurl);\n        });\n      \n      \t// added 11/26/19\n\t\n        addtocarturl = \"https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1=\"+_TMDL.geo+\";u2=\"+_TMDL.ll+\";u6=\"+encodeURIComponent(_TMDL.pagename)+\";u25=\"+_TMDL.pids[0]+\";u26=\"+encodeURIComponent(_TMDL.pnames[0])+\";u50=AddToCartClick\"+\";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=\"+ a + \"?\";\n\n        $(document).on('mousedown','a:contains(\"Add to cart\"),button:contains(\"Add to cart\")','', function() {\n            Bootstrapper.imageRequest(addtocarturl);\n        });\t\n\t}\n}\ncatch(err)\n{\n\t_satellite.logger.error(\"DCM LP\");\n}",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RL68ed140e62e94d2db9455a01d87bffcf",
      "name": "OffTryCV",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 60.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/customCode.js",
          "settings": {
            "source": function(event, target) {
  return (window.location.host.toLowerCase()=="query.prod.cms.rt.microsoft.com" && ~window.location.search.indexOf("pN=congrats"));
}
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "/*\nOfficeTrialCompletionPixels\n*/\ntry\n{\n\tvar inScope=0;\n\n\tvar MSFPC=\"\";  \n\n\tvar skulist = {\n\t\t\"cfq7ttc0k5bc-0003\" : 1,\n\t\t\"cfq7ttc0k5dm-007n\" : 1,\n\t\t\"cfq7ttc0k5dm-007q\" : 1,\n\t\t\"cfq7ttc0k5dm-007s\" : 1,\n\t\t\"cfq7ttc0k5dm-00hq\" : 1,\n\t\t\"cfq7ttc0k5dm-00hr\" : 1\n\t};\n\n\tfor (var j = 0; j < _TMDL.pidsku.length; j++) {\n\t\tif (skulist[_TMDL.pidsku[j].toLowerCase()]==1) {\n\t\t\tinScope=1;\n\t\t}\n\t}\n\n\tif (inScope) {\n\t\tBootstrapper.imageRequest(\"https://ad.doubleclick.net/ddm/activity/src=8406097;type=ofco;cat=tsu_uni;u17=OfficeConsumerTrial;u59=\" + MSFPC + \";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1;num=\" + Math.random());\n\t\t//MediaMath\n\t\tBootstrapper.imageRequest(\"https://pixel.mathtag.com/event/img?mt_id=1259909&mt_adid=166372&product_name=Office365HomeTrial&s26=Office365HomeTrial&v1=OfficeConsTrial\");\n\t\t//Quantcast\n\t\tBootstrapper.imageRequest(\"https://pixel.quantserve.com/pixel/p-tTB93UFC5vepM.gif?labels=_fp.event.OfficeConsTrial,_fp.productname.Office365HomeTrial\");\n\t\t//Bidtellect\n\t\tBootstrapper.imageRequest(\"https://bttrack.com/pixel/uconversion/2682\");\n\t\t//Facebook\n\t\tBootstrapper.imageRequest(\"https://www.facebook.com/tr?id=535974873423448&ev=Lead&noscript=1\");\n\t\t//Amobee\n\t\tBootstrapper.imageRequest(\"https://d.turn.com/r/dd/id/L21rdC84ODQvY2lkLzE3NDc0Nzk4MzYvdC8y/kv/orderid=[ORDER_ID],product=Office365HomeTrial,conversio=OfficeConsTrial,offerid=cfq7ttc0k5dm-007n\");\n\t\tBootstrapper.imageRequest(\"https://r.turn.com/r/beacon?b2=UQ33J2E3GCSx7-KKGp5vpXBNpsaOMjkmcU2_M7zYy7_ou6cxrU_k3avmwgRgF-V19uqO5Y8wqz4CcEqYo96czw&cid=&bprice=\");\n\t\t//MediaIQ\n\t\tBootstrapper.imageRequest(\"https://secure.adnxs.com/px?id=930630&seg=10824846&redir=https%3A%2F%2Fsecure.adnxs.com%2Fgetuid%3Fhttps%3A%2F%2Fpixel.mediaiqdigital.com%2Fpixel%3Fu1%3DOfficeConsTrial%26pixel_id%3D930630%26uid%3D%24UID&t=2\");\n\t\t//AMO\n\t\tBootstrapper.imageRequest(\"https://pixel.everesttech.net/px2/4249?px_evt=t&ev_officetrial=1\");\n\t}\n}\ncatch(err)\n{\n\tif (typeof(_TMutils) !== \"undefined\") {_TMutils.logRuleCall(\"OffTryCV\",err.message,err.stack);}\n\t_satellite.logger.error(\"OffTryCV\");\t\n}",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RLab4fd1d7566a4c858a54b382ad0c6b73",
      "name": "BingSurfClkCustom (AEM/RT)",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 80.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/customCode.js",
          "settings": {
            "source": function(event, target) {
  return (~window.location.pathname.toLowerCase().indexOf("/d/") && ~window.location.pathname.toLowerCase().indexOf("surface"))
}
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "/*\n\nRule: BingSurfClkCustom\n\nreturn (~window.location.pathname.toLowerCase().indexOf(\"/p/\") && ~window.location.pathname.toLowerCase().indexOf(\"surface\")\t)\n\n*/\n\nvar tempobj; \n\ntry {\n\n\tif (~window.location.pathname.toLowerCase().indexOf(\"surface\") && ~window.location.pathname.toLowerCase().indexOf(\"/d/\") && window.navigator.userAgent.toLowerCase().indexOf(\"soasta\")<0 && (typeof uetq=='object')) {\n\n\t\ttempobj={};\n\t\t\n\t\tif (_TMDL.pidsku.length > 0) {\n\t\t\ttempobj.ecomm_prodid = (_TMDL.pidsku.length>0) ? _TMDL.pidsku : \"\";\n\t\t\ttempobj.ecomm_pagetype = \"product\";\n\t\t\ttempobj.items = [\n\t\t\t\t{\n\t\t\t\t  'id': _TMDL.pidsku[0],\n\t\t\t\t  'category': 'surface',\n\t\t\t\t  'price' : _TMDL.sales[0]\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\t\t\n\t\t// Configure Now CTA\n        /*\n\t\t$(document).on('mousedown','button[id*=\"ConfigureDeviceButton\"]','', function() {\n\t\t\twindow.uetq.push('event','configurenow', tempobj); \n\t\t});\n        */\n      \n\t\t// Configure Now CTA - Updated 7/19 to correct ID\n        jQuery(\"a:contains('Configure now'),button:contains('Configure now')\").on(\"mousedown\", function(){\n            window.uetq.push('event','configurenow', tempobj); \n         });\n      \n\t\t// BuildYourBundle CTA\n        $(document).on('mousedown','button[id*=\"buttons_BuildABundleButton\"],a[href*=\"/store/build/\"]','', function() {\n\t\t\twindow.uetq.push('event','buildyourbundle', tempobj); \n\t\t});\n\t\t\t\n\t\t\n\t\t// check your eligibility CTA\n\t\t\n\t\t$(document).on('mousedown',\"a[href*='student-discounts?successurl']\",'', function() {\n\t\t\twindow.uetq.push('event','checkeligibility', tempobj); \n\t\t});\n      \n      \t// Add to Cart button, particularly needed for Surface Go PDP\n\t\t$(document).on('mousedown','button[id*=\"buttons_AddToCartButton\"]','', function() {\n\t\t\twindow.uetq.push('event','addtocartbutton', tempobj); \n\t\t});\t\t\n\t}\n} catch(bingerr) {console.log(\"bing onclick err\");}\n",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RLff01f3eef86c424db18d4d6e39bcb2ae",
      "name": "Media_/LL-LL/ Xandr Purchase",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 50.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/dateRange.js",
          "settings": {
            "end": "2023-07-31T00:00:00Z",
            "start": "2021-08-18T00:00:00Z"
          }
        },
        {
          "modulePath": "core/src/lib/conditions/customCode.js",
          "settings": {
            "source": function(event, target) {
  return (window.location.host.toLowerCase()=="query.prod.cms.rt.microsoft.com" && ~window.location.search.indexOf("pN=congrats"));
}
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "// Xandr Purchase\ntry\n{\nvar LimitString = function (item, index, arr) {\narr[index] = item.substr(0,98)};\n_TMDL.pnames.forEach(LimitString);\nvar image = new Image(1, 1);\nimage.src =\"https://ib.adnxs.com/pixie?pi=94211d4b-5aba-46aa-8d38-30818c4beba9&e=Purchase&ii=\"+_TMDL.pids+\"&in=\"+_TMDL.pnames.toString().substr(0,1800)+\",\"+_TMDL.geo+\",\"+_TMDL.cc+\"&itp=\"+_TMDL.prdType+\"&va=\"+_TMDL.totamount+\"&script=0\";\n}\ncatch(err)\n{\n_satellite.logger.error(\"Media_/LL-LL/ Xandr Purchase\");\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RL7ec829bc27b74a98b6340a1eee3869b0",
      "name": "Media_/DE-DE/Surface International",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 50.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/pathAndQuerystring.js",
          "settings": {
            "paths": [
              {
                "value": "/de-de/d/surface-laptop-4/946627fb12t1?ocid=paidmedia_sponsored_SLG4_PaidMediade_de_MayFY21&activetab=pivot:overviewtab"
              },
              {
                "value": "/de-de/p/surface-laptop-4/946627fb12t1?activetab=pivot:techspecstab"
              }
            ]
          }
        },
        {
          "modulePath": "core/src/lib/conditions/domain.js",
          "settings": {
            "domains": [
              "microsoft.com"
            ]
          }
        },
        {
          "modulePath": "core/src/lib/conditions/dateRange.js",
          "settings": {
            "end": "2021-08-01T00:00:00Z",
            "start": "2021-06-16T00:00:00Z"
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "try\n  {\n   //Twitter pv\n   var image = new Image(1, 1);\n   image.src =\"https://analytics.twitter.com/i/adsct?p_id=Twitter&p_user_id=0&txn_id=o5fpi&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0&type=image&version=1.1.0\";  \n \n   var image = new Image(1, 1);\n   image.src =\"//t.co/i/adsct?p_id=Twitter&p_user_id=0&txn_id=o5fpi&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0&type=image&version=1.1.0\"; \n \n   //Pinterest pv\n   var image = new Image(1, 1);\n   image.src =\"https://ct.pinterest.com/v3/?event=init&tid=2613156653032&pd[em]=<hashed_email_address>&noscript=1\"; \n\n    \n   //Facebook clk \n  jQuery(\"button[id*='ConfigureDeviceButton']\").on(\"mousedown\", function(){  \n  var image = new Image(1, 1);\n  image.src =\"https://www.facebook.com/tr?id=1770559986549030&ev=Lead&dpo=LDU&dpoco=0&dpost=0&ts=1619098009484&cd[product_catalog_id]=108292966463738&cd[content_ids]=['946627FB12T1-WZZJ']&cd[content_names]=['Surface Laptop 4']&cd[content_type]=['product']\";\n  \n  \n  });\n  \n  }\n  catch(err)\n  {\n      _satellite.logger.error(\"Media_/DE-DE/Surface International\");\n  }\n",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RL78c9bc5a0724444cba047576c8920ec0",
      "name": "Surface-Commercial/Consumer Campaign Yahoo ROW",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 50.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/path.js",
          "settings": {
            "paths": [
              {
                "value": "(/ja-jp|/en-ca|/fr-ca|/de-de|/en-au|/en-gb|/fr-fr|/en-sg)/d/surface-laptop-studio",
                "valueIsRegex": true
              },
              {
                "value": "(/ja-jp|/en-ca|/fr-ca|/de-at|/en-au|/en-gb|/fr-fr|/en-sg)/d/surface-pro-8",
                "valueIsRegex": true
              }
            ]
          }
        },
        {
          "modulePath": "core/src/lib/conditions/domain.js",
          "settings": {
            "domains": [
              "microsoft.com"
            ]
          }
        },
        {
          "modulePath": "core/src/lib/conditions/dateRange.js",
          "settings": {
            "end": "2022-07-01T00:00:00Z",
            "start": "2021-12-29T00:00:00Z"
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "// JavaScript source code\n// Consumer and commercial campaign tagging\n\ntry {\n\t// Configure Now buttons\n\tjQuery(\"button[id*='ConfigureDeviceButton']\").on(\"mousedown\", function () {\n\t\tvar image = new Image(1, 1);\n\t\timage.src = \"https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&ea=SurfaceButtonClick\";\n\t});\n\n\t//Check Your Eligibility button\n\tjQuery('a[href*=\"student-discounts?successurl\"]').on(\"mousedown\", function () {\n\t\tvar image = new Image(1, 1);\n\t\timage.src = \"https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&ea=SurfaceButtonClick\";\n\t});\n\n\t//Promotional Bar links\n\tjQuery(\"div.pi-promotion-bar\").on(\"mousedown\", function () {\n\t\tvar image = new Image(1, 1);\n\t\timage.src = \"https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&ea=SurfaceButtonClick\";\n\t});\n\n}\ncatch (err) {\n\t_satellite.logger.error(\"Media.Verizon.Commercial/ConsumerCampaign/LL-LL\");\n}\n",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RLb9638e6a11854c11b48d315d3f8fc064",
      "name": "Media.ja-jp.store.b.surface-studentdeals",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 50.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/path.js",
          "settings": {
            "paths": [
              {
                "value": "/ja-jp/store/b/surface-studentdeals"
              },
              {
                "value": "/ja-jp/store/b/surface-studentdeals/"
              }
            ]
          }
        },
        {
          "modulePath": "core/src/lib/conditions/domain.js",
          "settings": {
            "domains": [
              "microsoft.com"
            ]
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "// JavaScript source code\ntry {\n    //ADNXS\n    jQuery(\".m-hero, #primaryR4, #primaryR6, #onestore-quicklinksmodule-s99z4gv-quicklink1, #onestore-quicklinksmodule-s99z4gv-quicklink2, #onestore-quicklinksmodule-s99z4gv-quicklink3\").on(\"mousedown\", function () {\n        var image = new Image(1, 1);\n        image.src = \"//secure.adnxs.com/px?id=1268102&t=2\";\n    });\n\n    //DCM\n    jQuery(\".m-hero, #primaryR4, #primaryR6, #onestore-quicklinksmodule-s99z4gv-quicklink1, #onestore-quicklinksmodule-s99z4gv-quicklink2, #onestore-quicklinksmodule-s99z4gv-quicklink3\").on(\"mousedown\", function () {\n        var image = new Image(1, 1);\n        image.src = \"https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1=\" + _TMDL.geo + \";u2=\" + _TMDL.ll + \";u6=\" + encodeURIComponent(_TMDL.pagename) + \";u25=\" + _TMDL.pids[0] + \";u26=\" + encodeURIComponent(_TMDL.pnames[0]) + \";u50=Check Eligibility Student\" + \";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1?\";\n    });\n\n    //Yahoo\n    jQuery(\".m-hero, #primaryR4, #primaryR6, #onestore-quicklinksmodule-s99z4gv-quicklink1, #onestore-quicklinksmodule-s99z4gv-quicklink2, #onestore-quicklinksmodule-s99z4gv-quicklink3\").on(\"mousedown\", function () {\n        var image = new Image(1, 1);\n        image.src = \"https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&ea=SurfaceButtonClick\";\n    });\n\n    //Adobe DCO\n    var rand = parseInt(Math.random() * 10000000000000);\n    jQuery(\".m-hero, #primaryR4, #primaryR6, #onestore-quicklinksmodule-s99z4gv-quicklink1, #onestore-quicklinksmodule-s99z4gv-quicklink2, #onestore-quicklinksmodule-s99z4gv-quicklink3\").on(\"mousedown\", function () {\n        var image = new Image(1, 1);\n        image.src = \"https://ats.everesttech.net/ats/ats?cmd=ACTION&MerchantID=MICROSOFTSTORE&ActionID=50188&ActionName=Store_Site_Visit&cachebuster=\" + rand;\n    });\n\n}\ncatch (err) { satellite.logger.error(\"Media.ja-jp.store.b.surface-studentdeals\"); }\n\n",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RLae38a03ca6914b4dbd6fc77c006a5ad3",
      "name": "XTAAMCVFSignals",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 50.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/customCode.js",
          "settings": {
            "source": function(event, target) {
  return (window.location.host.toLowerCase()=="query.prod.cms.rt.microsoft.com");
}
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "// AAM Image Pixel for Cart Flow\ntry\n{\n\tvar pn = _TMDL.pageName,extraSignals = \"\",imgurl=\"\",_ts;\n\n\tif (pn == \"receipt\" || pn==\"congrats\") {\n\t\textraSignals = \t\"&c_purchasepid=\"+encodeURIComponent(_TMDL.pids.join(\"|\"))\n\t\t\t\t\t\t+\"&c_purchasepidsku=\"+encodeURIComponent(_TMDL.pidsku.join(\"|\"))\n\t\t\t\t\t\t+\"&c_purchasepnames=\"+encodeURIComponent(_TMDL.pnames.join(\"|\"))\n\t\t\t\t\t\t\n\t} else if (~pn.indexOf(\"interstitial\") || ~pn.indexOf(\"cart\")) {\n\t\textraSignals = \t\"&c_cartpid=\"+encodeURIComponent(_TMDL.pids.join(\"|\"))\n\t\t\t\t\t+\"&c_cartpidsku=\"+encodeURIComponent(_TMDL.pidsku.join(\"|\"))\n\t\t\t\t\t+\"&c_cartpnames=\"+encodeURIComponent(_TMDL.pnames.join(\"|\"));\n\t} \n\n\tif (extraSignals) {\n\t\t_ts= (new Date).getTime();\n\t\timgurl = \"https://mscom.demdex.net/event?d_nsid=0&d_ld=_ts%3D\"+_ts+\"&d_rtbd=json&d_jsonv=1&d_dst=1\"\n\t\t//+\"&d_cb=demdexRequestCallback_0_1521748306026\"\n\t\t+\"&c_ms.siteorg=Retail&c_ms.sitename=Store\"\n\t\t+\"&c_ms.pagetype=\"+_TMDL.pageType\n\t\t+\"&c_ms.sup_ln=\"+_TMDL.ll\n\t\t+extraSignals;\n\n\t\tBootstrapper.imageRequest(imgurl);\n\t}\n}\ncatch(err)\n{\n\t_satellite.logger.error(\"XTAAMCVG\");\t\n}",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RL5eab5a9198f842fa8eb98ab1205d77aa",
      "name": "AMOXbox",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 70.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/customCode.js",
          "settings": {
            "source": function(event, target) {
  return (window.location.host.toLowerCase()=="query.prod.cms.rt.microsoft.com" && ~window.location.search.indexOf("pN=congrats"));
}
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "/* \n  RULE NAME:  AMOXBOXPLATCV \n  add after DCM so categories are set\n  \t\t\txboxplatform (only this for now)\n\t\t\txboxgames \n\t\t\txboxdesignlabs \n\t\t\txboxgamepass \n\t\t\txboxlive \n\t\t\txboxdigitalgames \n*/\n\n\n(function(debug) {\n\tvar tot=0;\n\tvar units=0;\n\tvar inscope=0;\n\tvar imgurl=\"\";\n\tif (_TMDL.pids) {\n\t\tfor (var i = 0; i < _TMDL.pids.length; i++) {\n\t\t\tif (_TMDL.dcmcat[i].indexOf(\"xboxplatform\")>-1) {\n\t\t\t\tunits += _TMDL.quantities[i];\n\t\t\t\ttot += _TMDL.sales[i];\t\n\t\t\t\tinscope=1;\n\t\t\t}\n\t\t}\n\t}\n\t\n\tif (inscope && _TMDL.pageType==\"receipt\") {\n\t\t// fire AMO pixel\n\t\timgurl = \"https://pixel.everesttech.net/px2/5584?px_evt=t&ev_store_xbox_purchase=1&ev_\"+_TMDL.cc+\"_store_xbox_purchase_value=\"+tot+\"&ev_transid=\"+_TMDL.purchaseID;\n\t\tBootstrapper.imageRequest(imgurl);\n\t}\n})();\n\n",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RL990ee7ad1d174cfdb65bc9c4d5298165",
      "name": "BoostSurfacePurchase",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 50.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/customCode.js",
          "settings": {
            "source": function(event, target) {
  return (window.location.host.toLowerCase()=="query.prod.cms.rt.microsoft.com" && ~window.location.search.indexOf("pN=congrats"));
}
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "if (_TMDL.geo.toLowerCase() == \"us\") {\n    try {\n        (function (w, d, t, r, u) {\n            var f, n, i; w[u] = w[u] || [], f = function () {\n                var o = { ti: \"149014572\" }; o.q = w[u], w[u] = new UET(o), w[u].push(\"purchase\")\n            },\n                n = d.createElement(t), n.src = r, n.async = 1,\n                n.onload = n.onreadystatechange = function () {\n                    var s = this.readyState; s && s !== \"loaded\" && s !== \"complete\" || (f(), n.onload = n.onreadystatechange = null)\n                }, i = d.getElementsByTagName(t)[0], i.parentNode.insertBefore(n, i)\n        })(window, document, \"script\", \"//bat.bing.com/bat.js\", \"uetq_Amplify\");\n        setTimeout(delayedFunction, 200);\n    }\n    catch (err) {\n        _satellite.logger.error(\"Amplify Surface Purchase\");\n    }\n}\n\nfunction delayedFunction() {\n    // loop through all of the product ids and fire an event for each one as the event label\n    let totalQty = _TMDL.pids.length\n    for (let i = 0; i < totalQty; i++) {\n        window.uetq_Amplify.push('event', 'purchase', { 'event_label': _TMDL.pids[i], 'action_label': _TMDL.pnames[i], 'revenue_value': _TMDL.itemprices[i], 'currency': _TMDL.cc});\n    }\n}",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RLe7c9245a98a34085a2d36b5bc0e59655",
      "name": "Media_/LL-LL/ Verizon Intel Purchase",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 50.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/dateRange.js",
          "settings": {
            "end": "2022-07-01T00:00:00Z",
            "start": "2021-08-12T00:00:00Z"
          }
        },
        {
          "modulePath": "core/src/lib/conditions/customCode.js",
          "settings": {
            "source": function(event, target) {
  return (window.location.host.toLowerCase()=="query.prod.cms.rt.microsoft.com" && ~window.location.search.indexOf("pN=congrats"));
}
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "//Verizon Intel Conversion Pixel\nvar ProdIds = [\"8MBBH5XNQ26W-B8JJ\", \"8N6JC13K88R3-0R4G\",\"8RNR51C616JN-GN27\",\"8V98SNJCL7S5-JB2L\",\"8VKVC3HV7MN3-0XQ4\", \"8WDP52FJ5BW6-6TRK\", \"8WK9MPLRT4J6-0ZK7\", \"92ZT4D2BFXZ7-D1V2\", \"93PH0KP05GVS-G707\", \"947XD4Q6JGMB-8VHK\", \"8P3VQXVFXB8T-53FX\", \"8S5MW3SB3WH3-CB2L\", \"8TLRDNCNFB2W-HJ6N\",\"8V1ZZN1705ND-7MFP\",\"8XPNZ11M83CX-KHLP\",\"8XV46FCD1K60-LMGR\",\"91NC3TWTBS77-4S46\",\"940V5N9LPW8S-3XC9\",\"8N4MP37WP3TW-K158\",\"8P5Z681FM7SG-1L61\",\"8PMX6PND6T7M-4RRJ\",\"8QDJP7HHPM4X-35JM\",\"8QHLW3FRLZ50-8HT3\",\"8R1CPF43RLGG-JCVZ\",\"8SWR7XV37VJS-LMGR\",\"8TFR99W15F0N-GRPP\",\"8TPB638BVLC3-KV7J\",\"8TTJ7DWB4L7J-7XT7\",\"8VJVMX57SF6H-1R0D\",\"8VKJT6BXRBTT-8Z32\",\"8WBGNTHHTBT3-DR6Q\",\"8XPSVT5P7P97-L12Q\",\"9018RPZRS5QC-CQ7L\",\"92HKS90BGLVK-DRWD\",\"9331N6HDRNJH-G5HV\",\"8N1D1TBVWDQX-MCWK\",\"8N8N7926WBH7-9WJV\",\"8PW8SGQW0ZKL-CCM5\",\"8QB0TGT9CH62-D4GT\",\"8QHTD06GZVS4-DM19\",\"8T46HJBH5LJ4-9HHZ\",\"8VZS01B31W39-9X7Q\",\"8WJPPTH2Z2VK-6403\",\"8ZMR8B6L9D98-9NGF\",\"90VS480C9LV1-8G38\",\"91M891L4C1P2-5PXH\",\"938HBL4D1L5S-L1XF\",\"8MM7SQSJRTJ3-89K6\",\"8RBMPP1KB0P5-06ZS\",\"8WN2VT4FQMT1-HC2D\",\"8WZRPCJLCZC8-CTQ9\",\"8X3212P6575Q-F1NM\",\"902J8R09XZN7-3WX8\",\"92PTWSLZLML7-C9WL\",\"93N2N33HKCZ6-0QGC\",\"8MPZ2S6WPN6Q-2S1R\",\"8N6Z0696WK9H-9FM8\",\"8PGCRF362PMQ-3KPK\",\"8PRZLRDW91HW-4HC8\",\"8RBMPP1KB0P5-85ZC\",\"8R6WBMVWBTB2-BHLF\",\"8RDDD3KW3JT1-DFW2\",\"8RLTRBHFHVR2-5ZVW\",\"8T38KCB9TS6J-2R23\",\"8TN74R7JDPVX-7GQ7\",\"8XX5FZ602G3J-9RSK\",\"8ZPJ34TRGBSW-MCPB\",\"9030MRLSKNKQ-HR75\",\"92BVJ237TD5H-LRLL\",\"92RFGLVGLGH6-8PCT\",\"93GP7GTCSGP6-24J3\",\"93VLG6Q3MTDH-86DN\",\"94GHD48R24G5-7SHN\",\"8MJQMBD0Q63M-5P8Q\",\"8QVFVKTXQJKQ-6403\",\"8R44XH29FDCS-7ZFW\",\"8R90BSLNBDV3-HF6S\",\"8SGXFNB06DNW-6RLD\",\"8V5J9JDGS1PN-H3R3\",\"8ZF00WQQCNL6-54B9\",\"92B8DQ7412KM-D3JB\",\"92D2BF52X92G-6F9R\",\"92J0L2VMFCQM-B1PL\",\"94109T3VWKKZ-DT32\",\"94CZ66KVGG05-2VXB\",\"8NFC4VTH7H85-2JB9\",\"8P0C9W16R212-LZ5Z\",\"8PXKQBTXR8DT-7QMN\",\"8Q42JBD9HN8P-JJH8\",\"8QVL59ZRS6QR-CJF6\",\"8RBMPP1KB0P5-03HL\",\"8RBMPP1KB0P5-JHKM\",\"8RBMPP1KB0P5-M0DW\",\"8RH52ZFQMN54-8XPH\",\"8S869KLMWNZZ-2WD8\",\"8SNLGX6M7T2N-981P\",\"8SVWBNDF3GQX-1SJH\",\"8WBQFL7P88VW-6360\",\"8WMLV0JNRKP9-5C9V\",\"8Z43LDLCKXHB-50NM\",\"8ZZ6S7H1GXQN-DWNW\",\"919755ZR2V9X-8P7H\",\"92B6VNCSDXDR-LVT2\",\"92RGCNBNLTC8-1WHW\",\"92WGTC7J8TW7-J1X6\",\"93JMJ3S1L0Q6-H7KW\",\"8QXTJ6R4JR4J-CM5T\",\"8RM3FX4DF8S0-DBJ7\",\"8X9R9LZ9LZC1-K7XX\",\"8XBGP60M5X7V-C8BH\",\"8Z1XZVZ23CCT-9CG8\",\"90CND5G044X4-597F\",\"90H2LJX1Z20C-48N4\",\"93FKSHD3FW9B-DGV7\",\"9486HGBVVP08-L4PP\",\"94HH753VLZRQ-3CBC\",\"8MPMVZKHQDCH-5PCS\",\"8NLXKHRD4F5H-LB5J\",\"8P16043R5LWH-HD2V\",\"8Q608SK6243F-6G64\",\"8QKT9WHDJ64X-8TPK\",\"8QWCJ8T0W1KL-5ZB3\",\"8RBMPP1KB0P5-25Z0\",\"8SHS6884DSB6-1FST\",\"8SM1L2HHFNK7-JXG6\",\"8SNHK4KD0SXS-M8P9\",\"8TKM0Q0NGQ2H-GGRV\",\"8WTWWRRLWHNX-J8FT\",\"8XL8KL8J72K7-32RJ\",\"8XWG2QG6C7ZX-H281\",\"8ZVNZJ6XKL9F-B7ZB\",\"901Z559K08DM-7Q4N\",\"90LWXQT7RGN5-7ZKJ\",\"928NKS7X3PHL-5KJW\",\"9433NPPRPNHW-DC9S\",\"8NK56K1QS0HQ-6J7Z\",\"8P7B2H1JB09H-BR46\",\"8PD6FJD0F5LN-1L8C\",\"8PJ7VF874V83-4MSJ\",\"8PTR6JKJCW0N-M7SW\",\"8QFLG68DM2Z6-5F7Z\",\"8QTKVQ4TP25K-8P7B\",\"8RBMPP1KB0P5-7N16\",\"8S6RFVC67CVD-FN03\",\"8SPRVG4VP1SF-B1PN\",\"8V3RSTHVS030-4GSP\",\"8VMJWGDQ9WQX-5S0W\",\"8XXPDT84JLTC-CGH4\",\"8ZR46GB4640X-G3K1\",\"8ZXHQ9K4QF08-DRPT\",\"8ZZQJRF5C191-5JR2\",\"91FGGM4FPST2-FWXM\",\"91LF05JFK79S-4WJ1\",\"91NXHK0X2WC0-8CMW\",\"92ZL9HT9L6WV-881Z\",\"92ZZGCK3VT09-7B0V\",\"93FBLZ9KHCM1-1T9G\",\"8MCZWVH7MQH3-DTD6\",\"8MP95M2B95KB-L84C\",\"8NC2CDLKV6QG-GZ77\",\"8NFC4VTH7H85-HF3S\",\"8PDLXDL9C7H9-7BBX\",\"8QP9V8J31VZ0-3BZW\",\"8RBMPP1KB0P5-1FXQ\",\"8RBMPP1KB0P5-1W60\",\"8RBMPP1KB0P5-20XR\",\"8RBMPP1KB0P5-KPFR\",\"8SL5J7W62V51-0WSD\",\"8T0BDK5XWX88-9JFT\",\"8T4FJD8FG7ML-JGDH\",\"8TH02027N32J-7KK5\",\"8THSTBZ641DH-LQB8\",\"8V282TS7BWKG-KF4W\",\"8V79DPWNQPZX-JKXP\",\"8VP3HT9FV22J-956M\",\"8WLR0NL58799-D0BS\",\"8X8XJNL58VBF-1058\",\"8X8ZKQCX06P4-GVQ9\",\"913PF6TNVPJF-JHBG\",\"919K47WMRKNF-47D2\",\"92ZT4D2BFXZ7-9RPQ\",\"933BFPFP2VPC-DVVV\",\"933DZQNS8NW0-BR6Z\",\"934BFN9HBMT5-HVNJ\",\"9350057L72XG-8QLF\",\"93TBPJTC7XKB-2SZ1\"];\nif (_TMDL.geo==\"US\" || _TMDL.geo==\"CA\") {\ntry\n{\nvar ps=\"\"\nfor (var i=0; i<_TMDL.pids.length; i++) {\n  if (_TMDL.pidsku.length > i) {\n    ps = _TMDL.pidsku[i].toUpperCase();\n    if (ProdIds.includes(ps)){\n      var image = new Image(1, 1);\n      image.src =\"https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&he={INSERT_MACRO_HERE}&ec=intelpurchases\";\n  }}}}\ncatch(err)\n{\n_satellite.logger.error(\"Media_/LL-LL/ Verizon Intel Purchase\");\n}}",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RLff8b1c846ac24f94ae93df1af6fc2580",
      "name": "Media_/EN-US/Consumer Consultation Tag (AEM/RT)",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 50.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/path.js",
          "settings": {
            "paths": [
              {
                "value": "\\/en-us/store/b/online-computer-shopping-appointments",
                "valueIsRegex": true
              }
            ]
          }
        },
        {
          "modulePath": "core/src/lib/conditions/domain.js",
          "settings": {
            "domains": [
              "microsoft.com"
            ]
          }
        },
        {
          "modulePath": "core/src/lib/conditions/dateRange.js",
          "settings": {
            "end": "2022-08-01T00:00:00Z",
            "start": "2021-07-15T00:00:00Z"
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "// JavaScript source code\ntry {\n    //Floodlight pv\n    var image = new Image(1, 1);\n    image.src = \"https://ad.doubleclick.net/ddm/activity/src=8406733;type=corpothe;cat=corpo0;u1=\" + _TMDL.geo + \";u2=\" + _TMDL.ll + \";u6=\" + encodeURIComponent(_TMDL.pagename) + \";u25=\" + _TMDL.pids[0] + \";u26=\" + encodeURIComponent(_TMDL.pnames[0]) + \";u52=Visit;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;gdpr=${GDPR};gdpr_consent=${GDPR_CONSENT_755};ord=1?\";\n\n    //Xandr pv\n    var image = new Image(1, 1);\n    image.src = \"https://secure.adnxs.com/px?id=1472085&t=2\";\n\n    // Yahoo pv\n    var image = new Image(1, 1);\n    image.src = \"https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&js=no\";\n\n    // training - training\n    $('a[href*=\"https://answerdesk.microsoft.com/appointment/create\"]').on(\"mousedown\", function () {\n        //file the calls\n        var data = JSON.parse($(this).attr(\"data-m\"));\n        var cN = data[\"cN\"];\n\n        var image = new Image(1, 1);\n        image.src = \"https://ad.doubleclick.net/ddm/activity/src=8406733;type=corpothe;cat=corpo000;u1=\" + _TMDL.geo + \";u2=\" + _TMDL.ll + \";u6=\" + encodeURIComponent(_TMDL.pagename) + \";u25=\" + _TMDL.pids[0] + \";u26=\" + encodeURIComponent(_TMDL.pnames[0]) + \";u50=\" + cN +\";u52=Click;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;gdpr=${GDPR};gdpr_consent=${GDPR_CONSENT_755};ord=1?\";\n\n        //Xandr clk\n        image2 = new Image(1, 1);\n        image2.src = \"https://secure.adnxs.com/px?id=1478377&t=2\";\n\n        //Yahoo clk\n        image3 = new Image(1, 1);\n        image3.src = \"https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&ea=surfaceshoppingclick\";\n    });\n\n    // training - training\n    $('a[href*=\"https://digitalreservations.microsoft.com/en-us/appointment/create\"]').on(\"mousedown\", function () {\n        var data = JSON.parse($(this).attr(\"data-m\"));\n        var cN = data[\"cN\"];\n\n        var image = new Image(1, 1);\n        image.src = \"https://ad.doubleclick.net/ddm/activity/src=8406733;type=corpothe;cat=corpo000;u1=\" + _TMDL.geo + \";u2=\" + _TMDL.ll + \";u6=\" + encodeURIComponent(_TMDL.pagename) + \";u25=\" + _TMDL.pids[0] + \";u26=\" + encodeURIComponent(_TMDL.pnames[0]) + \";u50=\" + cN + \";u52=Click;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;gdpr=${GDPR};gdpr_consent=${GDPR_CONSENT_755};ord=1?\";\n\n        //Xandr clk\n        image2 = new Image(1, 1);\n        image2.src = \"https://secure.adnxs.com/px?id=1478377&t=2\";\n\n        //Yahoo clk\n        image3 = new Image(1, 1);\n        image3.src = \"https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&ea=surfaceshoppingclick\";\n    });\n\n}\ncatch (err) {\n    _satellite.logger.error(\"Media_/EN-US/Consumer Consultation Tag\");\n}",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RL64b67def4fa648f4b67cc6d001fac8f0",
      "name": "XboxGrCPE_OneSCat",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 70.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/domain.js",
          "settings": {
            "domains": [
              "microsoft.com"
            ]
          }
        },
        {
          "modulePath": "core/src/lib/conditions/path.js",
          "settings": {
            "paths": [
              {
                "value": "(us|ca|au|gb)\\/store\\/collections\\/xboxonesconsoles",
                "valueIsRegex": true
              }
            ]
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "var debug=0,fireDCM=1;\nvar ll=_TMDL.geo.toLowerCase();\n\nif (ll==\"us\" || ll==\"ca\" || ll==\"gb\" || ll==\"au\") {\n\ttry {\n\t\t$(document).on('mousedown','div.m-channel-placement-item','', function() {\n\t\t\tif (debug) { \n\t\t\t\tconsole.log(\"Xbox One S consoles\"); \n\t\t\t}\n\n\t\t\tvar j={},pid=\"\",cN=\"\",u=\"\",hr=\"\";\n\t\t\tvar\ta = \"\" + (Math.random() * 10000000000000);\n\n\t\t\ttry {\n\t\t\t\tj=JSON.parse($(this).attr(\"data-m\"));\n\t\t\t\tpid = j.pid;\n\t\t\t\tcN= j.cN;\n\t\t\t\t//hr=this.href;\n\t\t\t} catch(proderr) {\n\t\t\t\tif (debug) { \n\t\t\t\t\tconsole.log(\"catch Xbox One S consoles \"+hr); \n\t\t\t\t}\n\t\t\t}\n\n\t\t\tu=\"https://ad.doubleclick.net/ddm/activity/src=8391491;type=xbxp;cat=pchn_std;u1=\"\n\t\t\t+_TMDL.geo\n\t\t\t+\";u2=\"+_TMDL.ll\n\t\t\t+\";u6=\"+encodeURIComponent(window.location.pathname)\n\t\t\t+\";u25=\"+pid\n\t\t\t+\";u26=\"+encodeURIComponent(cN)\n\t\t\t+\";u50=\"+encodeURIComponent(cN)\n\t\t\t+\";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=\"\t+ a + \"?\";\n\n\t\t\tif (debug) { \n\t\t\t\tconsole.log(\"Xbox One S consoles: u25=\"+pid+\" u26=\"+cN+\"\\t\"+u); \n\t\t\t}\n\n\t\t\tif (fireDCM) {\n\t\t\t\tBootstrapper.imageRequest(u);\n\t\t\t}\n\t\t});\n\t} catch(clkerr) {\n\t\tconsole.log(\"Xbox One S consoles\");\n\t}\n}",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RL799d3721df324acab122e08d3898f7c9",
      "name": "Surface-US/Amazon",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 50.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/dateRange.js",
          "settings": {
            "end": "2023-07-31T00:00:00Z",
            "start": "2023-01-01T00:00:00Z"
          }
        },
        {
          "modulePath": "core/src/lib/conditions/path.js",
          "settings": {
            "paths": [
              {
                "value": "us.*surface",
                "valueIsRegex": true
              }
            ]
          }
        },
        {
          "modulePath": "core/src/lib/conditions/sessions.js",
          "settings": {
            "count": 1,
            "operator": "="
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "// US-Amazon\nvar webClick = '[href*=\"https\"]';\nvar phoneClick = '[href*=\"tel\"]';\nvar digClick = '[href*=\"#dig_\"]';\nvar secondConfig = 'button[data-action*=\"Configure\"]';\nvar cardClick = 'div[class*=\"slide-item\"]';\nvar cardClick2 = 'div[class*=\"material-card\"]';\nvar hasClicked = false;\n\nfunction attachPixels(elementAddress) {\n    $(document).on('mousedown', elementAddress, '', function () {\n        if (!hasClicked) {\n            var image = new Image(1, 1);\n            image.src = 'https://s.amazon-adsystem.com/iui3?d=forester-did&ex-fargs=%3Fid%3Dc366c000-856d-deaf-b133-4472abac66ae%26type%3D55%26m%3D1&ex-fch=416613&ex-src=https://microsoft.com&ex-hargs=v%3D1.0%3Bc%3D580391718615469870%3Bp%3DC366C000-856D-DEAF-B133-4472ABAC66AE';\n            hasClicked = true;\n        }\n    });\n}\n\ntry {\n    attachPixels(webClick);\n    attachPixels(phoneClick);\n    attachPixels(digClick);\n    attachPixels(secondConfig);\n    attachPixels(cardClick);\n    attachPixels(cardClick2);\n}\ncatch (err) {\n    _satellite.logger.error(\"US-Amazon-Pixel\");\n}",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RL5edc7c294e774dfba549b529ad58df5b",
      "name": "AU-GB/Business-Consultation",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 50.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/path.js",
          "settings": {
            "paths": [
              {
                "value": "/en-AU/store/b/business-consultation",
                "valueIsRegex": true
              },
              {
                "value": "/en-gb/store/b/business-consultation",
                "valueIsRegex": true
              }
            ]
          }
        },
        {
          "modulePath": "core/src/lib/conditions/dateRange.js",
          "settings": {
            "end": "2022-08-01T00:00:00Z",
            "start": "2022-02-04T00:00:00Z"
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "try {\n    // landing page\n    var locale = _TMDL.geo;\n    var floodlightLand = \"https://ad.doubleclick.net/ddm/activity/src=8406733;type=corpothe;cat=corpo0;u1=\" + locale + \";u2=\" + _TMDL.ll + \";u6=\" + encodeURIComponent(_TMDL.pagename) + \";u25=\" + _TMDL.pids[0] + \";u26=\" + encodeURIComponent(_TMDL.pnames[0]) + \";u52=Click;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;gdpr=${GDPR};gdpr_consent=${GDPR_CONSENT_755};ord=1?\";\n    var fb = \"https://www.facebook.com/tr?id=1770559986549030&ev=PageView&noscript=1\";\n    var linked = \"https://px.ads.linkedin.com/collect/?pid=7850&fmt=gif\";\n\n    Bootstrapper.imageRequest(floodlightLand);\n    Bootstrapper.imageRequest(fb);\n\n    if (locale == \"au\") {\n        Bootstrapper.imageRequest(\"https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&he={INSERT_MACRO_HERE}&ea=AUlandingpagevist\");\n    } else {\n        Bootstrapper.imageRequest(\"https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&he={INSERT_MACRO_HERE}&ea=UKlandingpagevisit\");\n    }\n\n    // \"Book a consultation\" clicks\n    $('a[href*=\"https://digitalreservations.microsoft.com/en-gb/appointment/create\"]').on(\"mousedown\", function () {\n        var data = JSON.parse($(this).attr(\"data-m\"));\n        var cN = data[\"cN\"];\n\n        Bootstrapper.imageRequest(fb);\n        Bootstrapper.imageRequest(\"https://ad.doubleclick.net/ddm/activity/src=8406733;type=corpothe;cat=corpo000;u1=\" + locale + \";u2=\" + _TMDL.ll + \";u6=\" + encodeURIComponent(_TMDL.pagename) + \";u25=\" + _TMDL.pids[0] + \";u26=\" + encodeURIComponent(_TMDL.pnames[0]) + \";u50=\" + cN + \"u52=Click;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;gdpr=${GDPR};gdpr_consent=${GDPR_CONSENT_755};ord=1?\");\n    });\n\n    $('a[href*=\"https://digitalreservations.microsoft.com/en-au/appointment/create\"]').on(\"mousedown\", function () {\n        var data = JSON.parse($(this).attr(\"data-m\"));\n        var cN = data[\"cN\"];\n\n        Bootstrapper.imageRequest(fb);\n        Bootstrapper.imageRequest(\"https://ad.doubleclick.net/ddm/activity/src=8406733;type=corpothe;cat=corpo000;u1=\" + locale + \";u2=\" + _TMDL.ll + \";u6=\" + encodeURIComponent(_TMDL.pagename) + \";u25=\" + _TMDL.pids[0] + \";u26=\" + encodeURIComponent(_TMDL.pnames[0]) + \";u50=\" + cN + \"u52=Click;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;gdpr=${GDPR};gdpr_consent=${GDPR_CONSENT_755};ord=1?\");\n    });\n}\ncatch (err) {\n    console.log(\"AU-GB/Business-Consultation\");\n}\n\n",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RL936a3e0c2d8040c190a9ef23a728fe86",
      "name": "SundaySkyPurchase",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 50.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/customCode.js",
          "settings": {
            "source": function(event, target) {
  return (window.location.host.toLowerCase()=="query.prod.cms.rt.microsoft.com" && ~window.location.search.indexOf("pN=congrats"));
}
          }
        },
        {
          "modulePath": "core/src/lib/conditions/dateRange.js",
          "settings": {
            "end": "2023-08-01T00:00:00Z",
            "start": "2023-03-20T00:00:00Z"
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "// SundaySkyPurchase\ntry {\n    var rand1 = parseInt(Math.random() * 10000000000000);\n    var rand2 = parseInt(Math.random() * 10000000000000);\n    var rand3 = parseInt(Math.random() * 10000000000000);\n    var rand4 = parseInt(Math.random() * 10000000000000);\n\n    var image1 = new Image(1, 1);\n    image1.src = \"https://s-vop.sundaysky.com/t/v1/img?a=microsoft&ap=1&pb=f&sp=https://www.microsoft.com/\" + _TMDL.ll + \"/store/congrats&cb=\" + rand1 +\"&m=conv&udt[segment]=[visitor,buyer]&udt[userid]=[USER_ID]&udt[sku]=\"+ _TMDL.pids.map(x => x.toUpperCase()) + \"&udt[cat]=\"+ _TMDL.prdType + \"&udt[ptype]=[cart]&udt[bu]=[surface]&udt[kw]=[KEYWORDS]& el=ORDER_ID&ev=\" + _TMDL.totamount;\n\n    var image2 = new Image(1, 1);\n    image2.src = \"https://s-vop.sundaysky.com/t/v1/img?a=microsoft&cb=\" + rand2 +\"&s=1\";\n\n    var image3 = new Image(1, 1);\n    image3.src = \"https://s-vop.sundaysky.com/t/v1/img?a=microsoft&cb=\" + rand3 +\"&s=2\";\n\n    var image4 = new Image(1, 1);\n    image4.src = \"https://s-vop.sundaysky.com/t/v1/img?a=microsoft&cb=\" + rand4 +\"&s=3\";\n} catch {\n    _satellite.logger.error(\"Sunday Sky Purchase\");\n}\n",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RL83f784964f9f4aeb89f164274dec4c93",
      "name": "XANDR Universal LP",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 70.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/customCode.js",
          "settings": {
            "source": function(event, target) {
  return (window.location.host.toLowerCase()=="query.prod.cms.rt.microsoft.com" && ~window.location.search.indexOf("pN=congrats"));
}
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "/*\nxandr universal \nhttps://ib.adnxs.com/pixie?pi=8b1ad172-7b69-4621-be02-60f12c250344&e=Purchase&ii=CFQ7TTC0K7C8&in=Office%20Home%20%20Student%202019%2CUS%2CUSD&itp=office&va=1.99&script=0\n//imgurl = \"https://ib.adnxs.com/pixie?pi=8b1ad172-7b69-4621-be02-60f12c250344&e=Purchase&ii=test&in=test&itp=test&va=0&script=0\";\n*/\n\n\n(function() {\n\ttry {\n\t\tvar imgurl=\"\",pn=[],itp=[],c=\",\";\n\t\tfor (var i=0; i<_TMDL.pids.length; i++) {\n\t\t\tpn[i]=encodeURIComponent(_TMDL.pnames[i]).slice(0,100);\n\t\t\tif ((typeof(_TMDL.dcmcat)=='object') && (typeof(_TMDL.dcmcat[i])=='string')) {\n\t\t\t\titp.push(encodeURIComponent(_TMDL.dcmcat[i]).slice(0,100));\n\t\t\t}\n\t\t}\n\t\tif (_TMDL.pT==\"rP\") {\n\t\t\timgurl = \"https://ib.adnxs.com/pixie?pi=8b1ad172-7b69-4621-be02-60f12c250344&e=Purchase&ii=\"+_TMDL.pids.join(c)\n\t\t\t\t+\"&in=\"+_TMDL.geo+c+_TMDL.cc+c+pn.join(c)\n\t\t\t\t+\"&itp=\"+itp.join(c)+\"&va=\"+_TMDL.totamount+\"&u=\"+encodeURIComponent(window.location.protocol+\"//\"+window.location.host+window.location.pathname)+\"&script=0\";\n\t\t\tBootstrapper.imageRequest(imgurl);\n\t\t}\n\t} catch(e) { _satellite.logger.log(\"warn: \"+e);\t}\n})();\n",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RLf09c4e2b3a1a48e2aff0ef3e101b1029",
      "name": "Media_/en-gb/p/surface-pro-7 Twitter",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 50.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/path.js",
          "settings": {
            "paths": [
              {
                "value": "/en-gb/p/surface-pro-7",
                "valueIsRegex": true
              },
              {
                "value": "/en-gb/d/surface-pro-7",
                "valueIsRegex": true
              }
            ]
          }
        },
        {
          "modulePath": "core/src/lib/conditions/domain.js",
          "settings": {
            "domains": [
              "microsoft.com"
            ]
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "try\n{\n//Page View  \nvar image = new Image(1, 1);\nimage.src =\"https://analytics.twitter.com/i/adsct?p_id=Twitter&p_user_id=0&txn_id=nzzcs&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0&type=image&version=1.1.0\";\n  \nvar image2 = new Image(1, 1);\nimage2.src =\"//t.co/i/adsct?p_id=Twitter&p_user_id=0&txn_id=nzzcs&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0&type=image&version=1.1.0\";  \n\n }\ncatch(err)\n{\n\t_satellite.logger.error(\"Media_/en-gb/p/surface-pro-7 Twitter\");\n}\n",
            "language": "javascript"
          }
        },
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "try\n{\n  \n//Clicks\n jQuery(\"a.c-button:Lt(1),a.c-hyperlink:Lt(2)\").on(\"mousedown\", function(){\nvar image = new Image(1, 1);\nimage.src =\"https://analytics.twitter.com/i/adsct?p_id=Twitter&p_user_id=0&txn_id=nzzcs&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0&type=image&version=1.1.0\";\n  \nvar image2 = new Image(1, 1);\nimage2.src =\"//t.co/i/adsct?p_id=Twitter&p_user_id=0&txn_id=nzzcs&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0&type=image&version=1.1.0\";   \n });\n\n\n }\ncatch(err)\n{\n\t_satellite.logger.error(\"Media_/en-gb/p/surface-pro-7 Twitter\");\n}\n",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RL1281b827de3444418825cfe32745f48a",
      "name": "QuantcastLPandCT",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 60.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/customCode.js",
          "settings": {
            "source": function(event, target) {
  return (window.location.host.toLowerCase()=="query.prod.cms.rt.microsoft.com" && ~window.location.search.indexOf("pN=congrats"));
}
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "/* OFF_QuantCast */\n\n\nvar isTrial=0;\nvar inScope=0;\nvar quanturl;\n\nvar trialskus = {\n\t\"cfq7ttc0k5bc-0003\" : 1,\n\t\"cfq7ttc0k5dm-007n\" : 1,\n\t\"cfq7ttc0k5dm-007q\" : 1,\n\t\"cfq7ttc0k5dm-007s\" : 1,\n\t\"cfq7ttc0k5dm-00hq\" : 1,\n\t\"cfq7ttc0k5dm-00hr\" : 1\n};\n\n// added for Alta\nvar office365bigids = {\n\t\"cfq7ttc0k5bf\" : 1,\n\t\"cfq7ttc0k5dm\" : 1,\n\t\"cfq7ttc0k5bc\" : 1,\n\t\"8pc5bjbhn74p\" : 1, //new\n\t\"94cm694vj57p\" : 1, //new\n\t\"900rpbx20ts6\" : 1, //new\n\t\"93r684wj71vj\" : 1, //new\n\t\"8v9j0t4jfz6w\" : 1, //new\n\t\"cfq7ttc0k5bd\" : 1,\n\t\"8nfjc88fkmrz\" : 1, //new\n\t\"8szwm812t6n1\" : 1, //new\n\t\"cfq7ttc0k5bg\" : 1, //new\n\t\"8v883x3j1v40\" : 1  //new\n};\n\ntry {\n\tfor (var i = 0; i < _TMDL.pidsku.length; i++) {\n\t  // update check to also look for office365bigids to adapt to Alta\n\t\tif (_TMDL.pnames && (~_TMDL.pnames[i].toLowerCase().indexOf(\"office\") || ~_TMDL.pnames[i].toLowerCase().indexOf(\"o365\") || ~_TMDL.pnames[i].toLowerCase().indexOf(\"off365\") || office365bigids[_TMDL.pids[i].toLowerCase()]==1 )  && trialskus[_TMDL.pidsku[i].toLowerCase()]!==1) {\n\t\t\tinScope=1;\n\t\t}\n\t}\n\n  if (inScope) {\n\t\t  quanturl = \"https://pixel.quantserve.com/pixel/p-4T98ck4dZrJdS.gif?labels=_fp.event.OfficeConsumerPurchase,_fp.pcat.\"+_TMDL.pidsku.join(\",_fp.pcat.\")+\",_fp.customer.\"+_TMDL.ll+\",_fp.channel.\"+_TMDL.geo+\"&orderid=\"+_TMDL.purchaseID+\"\";\n\t\t  Bootstrapper.imageRequest(quanturl);\n  }\n} catch(err) {_satellite.logger.log(\"QuantCast ERR\");}\n\n\n\n",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RL804049235a48433cb1e82263436fba08",
      "name": "ADOBEDCORTG",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 70.0
        }
      ],
      "conditions": [

      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "/*  Adobe DCO Retargeting tag\n*/\n\ntry {\n\t// landing pages\n\tvar rand = parseInt(1E5 * 1E4 * Math.random() * Math.random());\n\tvar u=\"\";\n\tvar lang = (_TMDL.ll.indexOf(\"-\")>-1) ? _TMDL.ll.split(\"-\")[0].toLowerCase() : \"\";\n\tvar utstring = \"&ut1=\"+_TMDL.pidsku.join(\"%2C\")+\"&ut2=\"+lang+\"&ut3=\"+_TMDL.geo.toLowerCase()+\"&cachebuster=\"+rand;\n\n\tif (_TMDL.pT.indexOf(\"cart\")<0 && _TMDL.pageType!=='rP' ) {\n\t\t// landing pages\n\t\tu=\"https://ats.everesttech.net/ats/ats?cmd=RT&AdvertiserID=4249&platform=TUMRI&ActionID=20114&ActionName=Microsoft_Store_RT_Pixel\"+utstring;\n\t\tBootstrapper.imageRequest(u); \n\t}\n\n\tif (~_TMDL.pT.indexOf(\"rP\") && _TMDL.isprod) {\n\t\tu=\"https://ats.everesttech.net/ats/ats?cmd=ACTION&MerchantID=MICROSOFTSTORE&ActionID=50081&ActionName=Microsoft_Store_Conv_Pixel&Revenue=\"+_TMDL.totamount+\"&TransactionID=\"+_TMDL.purchaseID+\"&Currency=\"+_TMDL.cc+utstring;\n\t\tBootstrapper.imageRequest(u); \n\t} else if (~_TMDL.pageType.toLowerCase().indexOf(\"cart\") && _TMDL.isprod) {\n\t\tu=\"https://ats.everesttech.net/ats/ats?cmd=RT&AdvertiserID=4249&platform=TUMRI&ActionID=20132&ActionName=Microsoft_Store_Cart_Abandoner\"+utstring;\n\t\tBootstrapper.imageRequest(u); \n\t}\n} catch(err){\n\tif (_satellite) {\n\t  _satellite.logger.error(\"Adobe DCO Retargeting Error\");\n\t  if (_TMutils){_TMutils.logRuleCall(\"Adobe DCO Retargeting\",err.message,u);}\n\t} \n}\n",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RLde75a20693bd4fb18a1f30e9505db8c0",
      "name": "Media_/en-us/ TikTok Clicks",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 60.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/path.js",
          "settings": {
            "paths": [
              {
                "value": "/en-us/d/",
                "valueIsRegex": true
              },
              {
                "value": "/en-us/p/",
                "valueIsRegex": true
              },
              {
                "value": "/en-us/store/configure/Surface",
                "valueIsRegex": true
              },
              {
                "value": "/en-gb/d/",
                "valueIsRegex": true
              },
              {
                "value": "/fr-fr/d/",
                "valueIsRegex": true
              },
              {
                "value": "/de-de/d/",
                "valueIsRegex": true
              },
              {
                "value": "/en-gb/p/",
                "valueIsRegex": true
              },
              {
                "value": "/fr-fr/p/",
                "valueIsRegex": true
              },
              {
                "value": "/de-de/p/",
                "valueIsRegex": true
              },
              {
                "value": "/en-gb/store/configure/Surface",
                "valueIsRegex": true
              },
              {
                "value": "/fr-fr/store/configure/Surface",
                "valueIsRegex": true
              },
              {
                "value": "/de-de/store/configure/Surface",
                "valueIsRegex": true
              }
            ]
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "try {\n//PlaceAnOrder\njQuery(\"button:contains('Buy')\").on(\"mousedown\", function(){\n    var ttp = {};\n    ttp.content_id = _TMDL.pids[0];\n    ttp.content_name = _TMDL.pnames;\n    ttp.quantity =_TMDL.totqty[0];\n    ttp.price = _TMDL.itemprices[0];\n      ttq.track('PlaceAnOrder', ttp);\n  });\n        \n//AddToCart\njQuery(\"button:contains('Add to cart')\").on(\"mousedown\", function(){\n    var ttp = {};\n    ttp.content_id = _TMDL.pids[0];\n    ttp.content_name = _TMDL.pnames;\n    ttp.content_type = _TMDL.prdType;\n    ttp.quantity =_TMDL.totqty[0];\n    ttp.price = _TMDL.itemprices[0];\n      ttq.track('AddToCart', ttp);\n  });\n  \n//ClickButton\njQuery(\"button:contains('Rent'), button:contains('Get'), button:contains('Free'), button:contains('Configure now')\").on(\"mousedown\", function(){\n    var ttp = {};\n    ttp.content_id = _TMDL.pids[0];\n    ttp.content_name = _TMDL.pnames;\n    ttp.quantity =_TMDL.totqty[0];\n    ttp.price = _TMDL.itemprices[0];\n      ttq.track('ClickButton', ttp);  \n  });                                                                  \n}\ncatch(err)\n{\n\t_satellite.logger.error(\"Media_/en-us/ TikTok Clicks\");\n}",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RL0850ad6b15104b70b962304589f9e22d",
      "name": "Media_/en-us/b/ Snap Pixel",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 60.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/domain.js",
          "settings": {
            "domains": [
              "microsoft.com"
            ]
          }
        },
        {
          "modulePath": "core/src/lib/conditions/path.js",
          "settings": {
            "paths": [
              {
                "value": "/en-us/store/b/black-friday",
                "valueIsRegex": true
              },
              {
                "value": "/en-us/store/b/black-friday/",
                "valueIsRegex": true
              },
              {
                "value": "/en-us/store/b/cyber-monday",
                "valueIsRegex": true
              },
              {
                "value": "/en-us/store/b/cyber-monday/",
                "valueIsRegex": true
              },
              {
                "value": "/en-us/store/b/sale",
                "valueIsRegex": true
              }
            ]
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "try {\n    var timestamp = new Date();\n    var qs = \"rand=\" + Math.ceil(Math.random() * 99999999) + timestamp.getUTCFullYear() + timestamp.getUTCMonth()+ timestamp.getUTCDate() + timestamp.getUTCHours() + timestamp.getUTCMinutes() + timestamp.getUTCSeconds() + timestamp.getUTCMilliseconds();\n   image = new Image(1, 1);\n    image.src = \"https://tr.snapchat.com/p?pid=c99b5ed8-ec61-4350-b6a8-77e2eabd90ab&ev=PAGE_VIEW&v=2.3&\"+qs+\"&pl=\"+_TMDL.host+_TMDL.path+\"&u_hem=\";\n  image2 = new Image(1, 1);\n    image2.src = \"https://tr.snapchat.com/p?pid=0e03788f-4580-42d4-b751-693344c41c6f&ev=PAGE_VIEW&v=2.3&\"+qs+\"&pl=\"+_TMDL.host+_TMDL.path+\"&u_hem=\";\n   image3 = new Image(1, 1); \n    image3.src=\"https://tr.snapchat.com/cm/s?pnid=140\";\n}\ncatch(err)\n{\n    _satellite.logger.error(\"Media_/en-us/b/SnapPixel\");\n}",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RL68235348568040d4bda4a81492fce87f",
      "name": "AUStudentStore",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 50.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/path.js",
          "settings": {
            "paths": [
              {
                "value": "en-au/store/b/student",
                "valueIsRegex": true
              }
            ]
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "// JavaScript source code section.m-multi-hero-item, div.m-channel-placement-item, section.m-content-placement-item,\nvar debug = 0, fireTags = 1;\nvar elements = \"section.m-multi-hero-item, div#coreui-feature-fuhlmyn section div a, a#coreui-highlightfeature-q04bez3-0, ul.c-group, section.m-content-placement-item\";\n\ntry {\n\t$(document).on('mousedown', elements, '', function () {\n\t\tif (debug) { console.log(\"Tag is running\") }\n\n\t\tvar rand = parseInt(Math.random() * 10000000000000);\n\t\tif (fireTags) {\n\t\t\tBootstrapper.imageRequest('https://ats.everesttech.net/ats/ats?cmd=ACTION&MerchantID=MICROSOFTSTORE&ActionID=50188&ActionName=Store_Site_Visit&cachebuster=' + rand);\n\t\t\tBootstrapper.imageRequest('https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&ea=SurfaceButtonClick');\n\t\t\tBootstrapper.imageRequest(\"https://secure.adnxs.com/px?id=1268102&t=2\");\n\t\t}\n\n\n\t});\n} catch (clkerr) { console.log(\"au student store error\"); }",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RL6e837a4ee338456db500b886b2d772c3",
      "name": "Media_/en-au/store/b/student",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 50.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/path.js",
          "settings": {
            "paths": [
              {
                "value": "/en-au/store/b/student",
                "valueIsRegex": true
              },
              {
                "value": "/en-au/store/b/student/",
                "valueIsRegex": true
              }
            ]
          }
        },
        {
          "modulePath": "core/src/lib/conditions/domain.js",
          "settings": {
            "domains": [
              "microsoft.com"
            ]
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "try\n{\n//DCM Hero\n  jQuery(\"div[id*='coreui-multihero-yko9tu6']\").on(\"mousedown\", function(){\nvar image = new Image(1, 1);\nimage.src =\"https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1=\"+_TMDL.geo+\";u2=\"+_TMDL.ll+\";u6=\"+encodeURIComponent(_TMDL.pagename)+\";u25=\"+_TMDL.pids[0]+\";u26=\"+encodeURIComponent(_TMDL.pnames[0])+\";u50=Check Eligibility Student\"+\";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1?\";\n});\n  \n//DCM Quick Links\n  jQuery(\"div[id*='oneStore-quicklinksmodule-hl74ock']\").on(\"mousedown\", function(){\nvar image = new Image(1, 1);\nimage.src =\"https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1=\"+_TMDL.geo+\";u2=\"+_TMDL.ll+\";u6=\"+encodeURIComponent(_TMDL.pagename)+\";u25=\"+_TMDL.pids[0]+\";u26=\"+encodeURIComponent(_TMDL.pnames[0])+\";u50=Check Eligibility Student\"+\";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1?\";\n}); \n  \n//ADNXS Hero\n  jQuery(\"div[id*='coreui-multihero-yko9tu6']\").on(\"mousedown\", function(){\nvar image = new Image(1, 1);\nimage.src =\"//secure.adnxs.com/px?id=1268102&t=2\";\n});\n  \n//ADNXS Quick Links\n  jQuery(\"div[id*='oneStore-quicklinksmodule-hl74ock']\").on(\"mousedown\", function(){\nvar image = new Image(1, 1);\nimage.src =\"//secure.adnxs.com/px?id=1268102&t=2\";\n});   \n  \n//Yahoo Hero\n  jQuery(\"div[id*='coreui-multihero-yko9tu6']\").on(\"mousedown\", function(){\nvar image = new Image(1, 1);\nimage.src =\"https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&ea=SurfaceButtonClick\";\n});\n  \n//Yahoo Quick Links\n  jQuery(\"div[id*='oneStore-quicklinksmodule-hl74ock']\").on(\"mousedown\", function(){\nvar image = new Image(1, 1);\nimage.src =\"https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&ea=SurfaceButtonClick\";\n});     \n   \n  \n }\ncatch(err)\n{\n\t_satellite.logger.error(\"Media_/en-au/store/b/student\");\n}\n",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RL9efd51544b5c4e1294bccf5e3c790eac",
      "name": "SundaySkySurface",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 50.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/path.js",
          "settings": {
            "paths": [
              {
                "value": "/en-us/.*surface",
                "valueIsRegex": true
              }
            ]
          }
        },
        {
          "modulePath": "core/src/lib/conditions/dateRange.js",
          "settings": {
            "end": "2023-08-01T00:00:00Z",
            "start": "2023-03-20T00:00:00Z"
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "var firstConfig = 'a[href*=\"/store/configure\"]';\nvar secondConfig = 'button[data-action*=\"Configure\"]';\n\nfunction attachPixels(elementAddress) {\n    $(document).on('mousedown', elementAddress, '', function () {\n        const rand5 = parseInt(Math.random() * 10000000000000);\n        const rand6 = parseInt(Math.random() * 10000000000000);\n        const rand7 = parseInt(Math.random() * 10000000000000);\n        const rand8 = parseInt(Math.random() * 10000000000000);\n\n        var image = new Image(1, 1);\n        image.src = \"https://s-vop.sundaysky.com/t/v1/img?a=microsoft&ap=1&pb=f&sp=\" + _TMDL.host + _TMDL.path + \"&cb=\" + rand5 + \"&m=atc&udt[segment]=[visitor,atc]&udt[userid]=[USER_ID]&udt[sku]=\" + _TMDL.pids.map(x => x.toUpperCase()) + \"&udt[cat]=\" + _TMDL.prdType + \"&udt[ptype]=\" + _TMDL.pageType + \"&udt[bu]=[surface]&udt[kw]=[KEYWORDS]\";\n\n        var image2 = new Image(1, 1);\n        image2.src = \"https://s-vop.sundaysky.com/t/v1/img?a=microsoft&cb=\" + rand6 + \"&s=1\";\n\n        var image3 = new Image(1, 1);\n        image3.src = \"https://s-vop.sundaysky.com/t/v1/img?a=microsoft&cb=\" + rand7 + \"&s=2\";\n\n        var image4 = new Image(1, 1);\n        image4.src = \"https://s-vop.sundaysky.com/t/v1/img?a=microsoft&cb=\" + rand8 + \"&s=3\";\n    });\n}\n\ntry {\n    const rand1 = parseInt(Math.random() * 10000000000000);\n    const rand2 = parseInt(Math.random() * 10000000000000);\n    const rand3 = parseInt(Math.random() * 10000000000000);\n    const rand4 = parseInt(Math.random() * 10000000000000);\n    const pids = _TMDL.path.includes(\"configure\") ? [].concat(_TMDL.pageName.toUpperCase()) : _TMDL.pids.map(x => x.toUpperCase());\n\n    var pageLoad = new Image(1, 1);\n    pageLoad.src = \"https://s-vop.sundaysky.com/t/v1/img?a=microsoft&ap=1&pb=f&sp=\" + _TMDL.host + _TMDL.path + \"&cb=\" + rand1 + \"&m=uui&udt[segment]=[visitor]&udt[userid]=[USER_ID]&udt[sku]=\" + pids + \"&udt[cat]=\" + _TMDL.prdType + \"&udt[bu]=[surface]&udt[kw]=[KEYWORDS]\";\n\n    var image2 = new Image(1, 1);\n    image2.src = \"https://s-vop.sundaysky.com/t/v1/img?a=microsoft&cb=\" + rand2 + \"&s=1\";\n\n    var image3 = new Image(1, 1);\n    image3.src = \"https://s-vop.sundaysky.com/t/v1/img?a=microsoft&cb=\" + rand3 + \"&s=2\";\n\n    var image4 = new Image(1, 1);\n    image4.src = \"https://s-vop.sundaysky.com/t/v1/img?a=microsoft&cb=\" + rand4 + \"&s=3\";\n\n    attachPixels(firstConfig);\n    attachPixels(secondConfig);\n    \n}\ncatch (err) {\n    _satellite.logger.error(\"Sunday Sky Category/PDP\");\n}",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RL11bcd2cc8bc2418f87c203a3c8580113",
      "name": "DCMCVF",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 60.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/customCode.js",
          "settings": {
            "source": function(event, target) {
  return (window.location.host.toLowerCase()=="query.prod.cms.rt.microsoft.com");
}
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "try\n{\n\tvar doFloodlights = function(debug) {\n\t\t_TMDL.dcmcat = [];\n\n\t\tvar pnames, pids, pidsku, sales, quantities, totqty, totamt, imgsrc1;\n\t\tvar\ta = \"\" + (Math.random() * 10000000000000);\n\t\tvar mc1 = \"\";\n\t\tvar floodlights = {};\n\n\n\t\tvar cartFloodlights = {\n\t\t\t\twindowsdevices : \"/src=8406115;type=wndv;cat=crtv_std\",\n\t\t\t\twindowssoftware : \"/src=8406727;type=wsft;cat=crtv_std\",\n\t\t\t\tothersoftware : \"/src=8406724;type=sftw;cat=crtv_std\",\n\t\t\t\tsurface : \"/src=8400690;type=surf;cat=crtv_std\",\n\t\t\t\txboxplatform : \"/src=8391491;type=xbxp;cat=crtv_std\",\n\t\t\t\txboxgames : \"exclude\",\n\t\t\t\txboxdesignlabs : \"/src=8404966;type=xdl;cat=crtv_std\",\n\t\t\t\txboxgamepass : \"/src=8406391;type=xgpg;cat=crtv_std\",\n\t\t\t\txboxlive : \"/src=8391497;type=xlg;cat=crtv_std\",\n\t\t\t\thololens : \"/src=8391509;type=hll;cat=crtv_std\",\n\t\t\t\toffice : \"/src=8406097;type=ofco;cat=crtv_std\",\n\t\t\t\tminecraft : \"/src=8400687;type=mc;cat=crtv_std\",\n\t\t\t\tother : \"/src=8406157;type=stoth;cat=crtv_std\",\n\t\t\t\txboxdigitalgames : \"/src=8406391;type=xgpg;cat=crtd_std\",\n\t\t\t\twinsoftdigital : \"/src=8406727;type=wsft;cat=pdv_dgtl\"\n\t\t};\n\n\t\tvar purchaseFloodlights = {\n\t\t\twindowsdevices : \"/src=8406115;type=wndv_sls;cat=pch_phy\",\n\t\t\twindowssoftware : \"/src=8406727;type=wsft_sls;cat=pch_phy\",\n\t\t\tothersoftware : \"/src=8406724;type=sftw_sls;cat=pch_phy\",\n\t\t\tsurface : \"/src=8400690;type=surf_sls;cat=pch_phy\",\n\t\t\txboxplatform : \"/src=8391491;type=xbxp_sls;cat=pch_phy\",\n\t\t\txboxgames : \"exclude\",\n\t\t\txboxdesignlabs : \"/src=8404966;type=xdl_sls;cat=pch_phy\",\n\t\t\txboxgamepass : \"/src=8406391;type=xgpg_sls;cat=pch_phy\",\n\t\t\txboxlive : \"/src=8391497;type=xlg_sale;cat=pch_phy\",\n\t\t\thololens : \"/src=8391509;type=hll_sls;cat=pch_phy\",\n\t\t\toffice : \"/src=8406097;type=ofco_sls;cat=pch_phy\",\n\t\t\tminecraft : \"/src=8400687;type=mc_sls;cat=pch_phy\",\n\t\t\tother : \"/src=8406157;type=stot_sl;cat=pch_phy\",\n\t\t\txboxdigitalgames : \"/src=8406391;type=xgpg_sls;cat=pch_dgtl\",\n\t\t\twinsoftdigital : \"/src=8406727;type=wsft_sls;cat=pch_dgtl\"\n\t\t};\n\t\t\n\t\tvar categoryAmounts = {\n\t\t\twindowsdevices : 0,\n\t\t\twindowssoftware : 0,\n\t\t\tothersoftware : 0,\n\t\t\tsurface : 0,\n\t\t\txboxplatform : 0,\n\t\t\txboxgames : 0,\n\t\t\txboxdesignlabs : 0,\n\t\t\txboxgamepass : 0,\n\t\t\txboxlive : 0,\n\t\t\thololens : 0,\n\t\t\toffice : 0,\n\t\t\tminecraft : 0,\n\t\t\tother : 0,\n\t\t\txboxdigitalgames : 0,\n\t\t\twinsoftdigital : 0\n\t\t};\n\t\t\n\t\tvar categoryOrders = {\n\t\t\twindowsdevices : 0,\n\t\t\twindowssoftware : 0,\n\t\t\tothersoftware : 0,\n\t\t\tsurface : 0,\n\t\t\txboxplatform : 0,\n\t\t\txboxgames : 0,\n\t\t\txboxdesignlabs : 0,\n\t\t\txboxgamepass : 0,\n\t\t\txboxlive : 0,\n\t\t\thololens : 0,\n\t\t\toffice : 0,\n\t\t\tminecraft : 0,\n\t\t\tother : 0,\n\t\t\txboxdigitalgames : 0,\n\t\t\twinsoftdigital : 0\n\t\t};\n\n\t\tvar pidexclude = {\n\t\t};\n\t\tvar skulist = {\n          '8MXP0HW2H8GR-8JK6' : 'surface',\n          '8MXP0HW2H8GR-9T1P' : 'surface',\n          '8MXP0HW2H8GR-LVMX' : 'surface'\t\t\t\n\t\t};\n\t\t\n\t\tvar matchWindowBrand = function(pname) {\n\t\t\tvar brandnames = [\n\t\t\t\t\"acer\",\n\t\t\t\t\"alienware\",\n\t\t\t\t\"asus\",\n\t\t\t\t\"cyberpowerpc\",\n\t\t\t\t\"dell\",\n\t\t\t\t\"hp\",\n\t\t\t\t\"huawei\",\n\t\t\t\t\"ibuypower\",\n\t\t\t\t\"lenovo\",\n\t\t\t\t\"linx\",\n\t\t\t\t\"logah\",\n\t\t\t\t\"millet\",\n\t\t\t\t\"razer\",\n\t\t\t\t\"porsche\",\n\t\t\t\t\"samsung\",\n\t\t\t\t\"toshiba\"\n\t\t\t\t];\n\t\t\tfor (var i=0; i<brandnames.length; i++){\n\t\t\t\tif (~pname.toLowerCase().indexOf(brandnames[i])) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn false;\n\t\t};\n\t\t\n\t\tvar matchXboxBrand = function(pname) {\n\t\t\tvar brandnames = [\n\t\t\t\t\"forza\",\n\t\t\t\t\"call of duty\",\n\t\t\t\t\"tomb raider\",\n\t\t\t\t\"toy soldiers war chest\",\n\t\t\t\t\"red dead\",\n\t\t\t\t\"halo\",\n\t\t\t\t\"state of decay\",\n\t\t\t\t\"fifa\",\n\t\t\t\t\"sea of thieves\",\n\t\t\t\t\"fallout\",\n\t\t\t\t\"playerunknown\"\n\t\t\t\t];\n\t\t\tfor (var i=0; i<brandnames.length; i++){\n\t\t\t\tif (~pname.toLowerCase().indexOf(brandnames[i])) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn false;\n\t\t};\n\n\t\t// update pidlist\n\t\tvar pidlist={\n\t\t\t\n\t\t'D76QX4BZNWK4' : 'windowssoftware',\n\t\t'DF77X4D43RKT' : 'windowssoftware',\n\t\t'DG7GMGF0DS12' : 'windowssoftware',\n\t\t'DG7GMGF0DS1H' : 'windowssoftware',\n\t  'DG7GMGF0DT05' : 'windowssoftware',\n\t\t'DG7GMGF0DT06' : 'windowssoftware',\n\t\t\n\t\t'DG7GMGF0DST3' : 'othersoftware',\n\t\t'DG7GMGF0DST4' : 'othersoftware',\n\t\t'DG7GMGF0DST5' : 'othersoftware',\n\t\t'DG7GMGF0DST6' : 'othersoftware',\n\t\t'DG7GMGF0DWP2' : 'othersoftware',  // sql server\n\n\n\t\t'8MB6CR05S1QD' : 'xboxplatform',\n\t  '8W68VXXMN260' : 'xboxplatform', // forza\n\t\t'9NV34NLCLG81' : 'xboxplatform', // forza\n\t\t'8SVG47RPZDDN' : 'xboxplatform', \n\n\t\t'8MC6K8M228SK' : 'surface',\n\t\t'8MCPZJJCC98C' : 'surface',\n\t\t'8N1V4QJ3GQ5X' : 'surface',\n\t\t'8NKT9WTTRBJK' : 'surface',\n\t\t'8RKCLMWPW1PP' : 'surface',\n\t\t'8XCW9BBPVFV9' : 'surface',\n\t\t'907TDS4DGWWV' : 'surface',\n\t\t'90FC23DV6SNZ' : 'surface',\n\t\t'93LTM69S3RFF' : 'surface',\n\n\t\t'8XF18PQZ17TS' : 'hololens',\n\t\t'90MDTZVL02K9' : 'hololens',\n\t\t'944XGCF64Z5B' : 'hololens',\n          \n        '91PNZZZNZWCP' : 'hololens', //device\n        '8TQMXX9XJFLL' : 'hololens', //acc\n        '8WXL8WMK1F7Z' : 'hololens', //acc\n        '8VJ21F2Z8PK5' : 'hololens', //acc\n\t\t\n\t\t'900WZDF9XJVG' : 'xboxdesignlabs',\n\t\t'93JLLWMDZ0V7' : 'xboxdesignlabs',\n\t\t'941H3FP99RM3' : 'xboxdesignlabs',\n\t\t'8TBJW32WJF8C' : 'xboxdesignlabs',\n\t\t'90T6CGN08P38' : 'xboxdesignlabs',\n\t\t'90K4SGTLSKML' : 'xboxdesignlabs',\n\t\t'8VK59S4SSLWD' : 'xboxdesignlabs',\n\t\t'8TVCQSJ7V6PT' : 'xboxdesignlabs',\n\t\t'8T07Q5SRTV11' : 'xboxdesignlabs',\n\t\t'8VKFWF7M03NJ' : 'xboxdesignlabs',\n\t\t'90GBR9CZBHJ9' : 'xboxdesignlabs',\n\t\t'9355VZP4KXB8' : 'xboxdesignlabs',\n\t\t'8QT59S4FDX8Z' : 'xboxdesignlabs',\n\t\t'936X3M90WS2S' : 'xboxdesignlabs', // configs\n\t\t'9102F5Z9J68L' : 'xboxdesignlabs', // configs\n\t\t'8ST76B99KP7D' : 'xboxdesignlabs', // configs\n\t\t'90SX28477R3L' : 'xboxdesignlabs', // configs\n\t\t\n\t\t'CFQ7TTC0K5ZM' : 'xboxlive',\n\t  'CFQ7TTC0K5DJ' : 'xboxlive',\n\t\t\n\t\t'CFQ7TTC0K5F8' : 'office',\n\t\t'CFQ7TTC0K5FD' : 'office',\n\t\t'CFQ7TTC0K5FF' : 'office',\n\t\t'CFQ7TTC0K5BB' : 'office',\n\t\t'CFQ7TTC0K5BC' : 'office',\n\t\t'CFQ7TTC0K5BD' : 'office',\n\t\t'8N0LL43Q1H85' : 'office',\n\t\t'CFQ7TTC0K5DZ' : 'office',\n\t\t'CFQ7TTC0K5F2' : 'office',\n\t\t'CFQ7TTC0K5F3' : 'office',\n\t\t'CFQ7TTC0K5BH' : 'office',\n\t\t'CFQ7TTC0K5D6' : 'office',\n\t\t'CFQ7TTC0K5D7' : 'office',\n\t\t'CFQ7TTC0K5CD' : 'office',\n\t\t'CFQ7TTC0K5CF' : 'office',\n\t\t'CFQ7TTC0K5CP' : 'office',\n\t\t'CFQ7TTC0K5CS' : 'office',\n\t\t'CFQ7TTC0K5CT' : 'office',\n\t\t'CFQ7TTC0K5D0' : 'office',\n\t\t'CFQ7TTC0K5DN' : 'office',\n\t\t'CFQ7TTC0K5DM' : 'office',\n\t\t'CFQ7TTC0K5BF' : 'office',\n\t\t'CFQ7TTC0K5FB' : 'office',\n\t\t'CFQ7TTC0K5FC' : 'office',\n\t\t'CFQ7TTC0K5D2' : 'office',  // project  4/2/18\n\t\t'CFQ7TTC0K5DB' : 'office',  // visio  4/2/18\n\t\t'CFQ7TTC0K5CW' : 'office',  // visio  4/2/18\n          \n         // added 4/20/20 for alta\n\t\t'8PC5BJBHN74P' : 'office',\n\t\t'94CM694VJ57P' : 'office',\n\t\t'900RPBX20TS6' : 'office',\n\t\t'93R684WJ71VJ' : 'office',\n\t\t'8V9J0T4JFZ6W' : 'office',\n\t\t'8NFJC88FKMRZ' : 'office',\n\t\t'8SZWM812T6N1' : 'office',\n\t\t'CFQ7TTC0K5BG' : 'office',\n\t\t'8V883X3J1V40' : 'office',\n        // end alta\n\n         // post-alta\n        '8Q3ZWVGG3FQC' : 'office',\n        '8N98X0XQT2FQ' : 'office',\n        '8PRQ1VSC8Q22' : 'office',\n        '8NVJD5ZKHMFX' : 'office',\n        '94924XCG402M' : 'xboxplatform',\n        '942ZHD9DCWXM' : 'xboxplatform',\n        // end post-alta\n          \n\t  '8V9DP4LNKNSZ' : 'surface',  // surface go added 7/10/18\n\t  \n\t\t// xbox games  9/27/18\n\t\t'8XMZ4ZZX5JT8' : 'xboxplatform',\n\t\t'8N4KPS2M97J6' : 'xboxplatform',\n\t\t'BTH9X5LM11MV' : 'xboxplatform',\n\t\t'8MSBS8Q55DBG' : 'xboxplatform',\n\t\t'BR8QZQXJVQD0' : 'xboxplatform',\n\n\t\t// 10/8/18\n\t\t'8Z1WM755TWGX' : 'xboxplatform', \n\t\t'C3C71TV51SQC' : 'xboxplatform', \n\t\t'8TSHP571GP11' : 'xboxplatform',\n\t\t'CFQ7TTC0K7Q8' : 'office',  \n\t\t'CFQ7TTC0K7DX' : 'office', \n\t\t'CFQ7TTC0K7C4' : 'office',\n\t\t'CFQ7TTC0K7C6' : 'office',\n\t\t'CFQ7TTC0K7C3' : 'office',\n\t\t'CFQ7TTC0K7C7' : 'office',\n\t\t'DG7GMGF0DW9S' : 'windowssoftware',\n\t\t'DG7GMGF0DS1G' : 'windowssoftware',\n\t\t'CFQ7TTC0K7CJ' : 'othersoftware',\n\t\t'CFQ7TTC0K7CH' : 'othersoftware',\n\t\t'CFQ7TTC0K7CF' : 'othersoftware',\n\t\t\n\t\t// 10/15/18\n\t\t'CFQ7TTC0K7C9': 'office',\n\t\t'CFQ7TTC0K7CG': 'office',\n\t\t'CFQ7TTC0K7CK': 'office',\n\t\t\n\t\t// 11/5/18\n\t\t'BPSWGQBW7R3G': 'xboxplatform', // red dead redemption 2\n\t\t'9NBLGGH4PBBM': 'xboxplatform', // Gears of War 4\n\t\t\n\t\t// 11/9/18\n\t\t'92594H05TKL3': 'xboxplatform', // fortnite bundle\n\t\t'8VDVCNF9F65W': 'xboxplatform', // playerunknowns battleground\n\t\t\n\t\t// 11/23/2018\n\t\t//'C0MN5DN8KR3F': 'xboxplatform', // playerunknowns full release\n\t\t'9PB2MZ1ZMB1S': 'winsoftdigital', // itunes\n\t\t'9WZDNCRFJ3TJ': 'winsoftdigital', // netflix\n\t\t'8NPV33DJ370P': 'xboxdesignlabs',\n\t\t'8Z1WFX3PP9BP': 'xboxdesignlabs',\n\t\t'8TN029PXKRTV': 'xboxdesignlabs',\n\t\t'8TMZXJV9D39G': 'xboxdesignlabs',\n          \n        // 10/21/19 -- all of the variations are for these BigIDs \n        'CFQ7TTC0K61W' : 'other',\t\n        'CFQ7TTC0K64F' : 'other',\t\n        'CFQ7TTC0K56K' : 'other',\n          \n        // 10/6/20 - Xbox Series X & S \n        '8T65QFQQ4K01' : 'xboxplatform',\t\n        '8RRVZ1VF9SF3' : 'xboxplatform',\n\n        // 10/12/20 - Xbox Game Pass (cfq7ttc0k6l8,CFQ7TTC0KGQ8,CFQ7TTC0KHS0)\n        'cfq7ttc0k6l8' : 'xboxgamepass',\t\n        'CFQ7TTC0KGQ8' : 'xboxgamepass',\n        'CFQ7TTC0KHS0' : 'xboxgamepass',\n\n\t\t// leave this as last\n\t\t'SHOULDNEVERMATCH' : 'pc'\n\t\t};\n\n\t\t// _TMDL.prdType and _TMDL.prdFam\n\t\t\n\t\tif (_TMDL.pids) {\n\t\t\tfor (var i = 0; i < _TMDL.pids.length; i++) {\n\t\t\t\tif (_TMDL.pids && _TMDL.pids[i] && pidexclude[_TMDL.pids[i]]) {\n\t\t\t\t\t// do nothing, not commissionable\n\t\t\t\t\t_TMDL.dcmcat[i]=\"excluded\";\n\t\t\t\t} else if (_TMDL.pidsku && _TMDL.pidsku[i] && skulist[_TMDL.pidsku[i]]) {\n\t\t\t\t\t// sku lookup based eventID\n\t\t\t\t\t_TMDL.dcmcat[i]=skulist[_TMDL.pidsku[i]];\n\t\t\t\t\tcategoryOrders[skulist[_TMDL.pidsku[i]]]++;\n\t\t\t\t\tcategoryAmounts[skulist[_TMDL.pidsku[i]]]+=_TMDL.sales[i];\n\t\t\t\t} else if (_TMDL.pids && _TMDL.pids[i] && pidlist[_TMDL.pids[i]]) {\n\t\t\t\t\t_TMDL.dcmcat[i]=pidlist[_TMDL.pids[i]];\n\t\t\t\t\tcategoryOrders[pidlist[_TMDL.pids[i]]]++;\n\t\t\t\t\tcategoryAmounts[pidlist[_TMDL.pids[i]]]+=_TMDL.sales[i];\n\t\t\t\t} else if (_TMDL.pnames && ~_TMDL.pnames[i].toLowerCase().indexOf(\"surface\") ) {\n\t\t\t\t\t_TMDL.dcmcat[i]=\"surface\";\n\t\t\t\t\tcategoryOrders[\"surface\"]++;\n\t\t\t\t\tcategoryAmounts[\"surface\"]+=_TMDL.sales[i];\n\t\t\t\t} else if (_TMDL.pnames && (~_TMDL.pnames[i].toLowerCase().indexOf(\"office\") || ~_TMDL.pnames[i].toLowerCase().indexOf(\"o365\"))) {\n\t\t\t\t\t_TMDL.dcmcat[i]=\"office\";\n\t\t\t\t\tcategoryOrders[\"office\"]++;\n\t\t\t\t\tcategoryAmounts[\"office\"]+=_TMDL.sales[i];\n\t\t\t\t} else if (_TMDL.pnames && ~_TMDL.pnames[i].toLowerCase().indexOf(\"minecraft\") ) {\n\t\t\t\t\t_TMDL.dcmcat[i]=\"minecraft\";\n\t\t\t\t\tcategoryOrders[\"minecraft\"]++;\n\t\t\t\t\tcategoryAmounts[\"minecraft\"]+=_TMDL.sales[i];\n\t\t\t\t} else if (_TMDL.pnames && ~_TMDL.pnames[i].toLowerCase().indexOf(\"xbox\")) {\n\t\t\t\t\t_TMDL.dcmcat[i]=\"xboxplatform\";\n\t\t\t\t\tcategoryOrders[\"xboxplatform\"]++;\n\t\t\t\t\tcategoryAmounts[\"xboxplatform\"]+=_TMDL.sales[i];\n\t\t\t\t} else if (_TMDL.pnames && matchXboxBrand(_TMDL.pnames[i]) ) {\n\t\t\t\t\t_TMDL.dcmcat[i]=\"xboxplatform\";\n\t\t\t\t\tcategoryOrders[\"xboxplatform\"]++;\n\t\t\t\t\tcategoryAmounts[\"xboxplatform\"]+=_TMDL.sales[i];\n\t\t\t\t} else if (_TMDL.pnames && matchWindowBrand(_TMDL.pnames[i]) ) {\n\t\t\t\t\t_TMDL.dcmcat[i]=\"windowsdevices\";\n\t\t\t\t\tcategoryOrders[\"windowsdevices\"]++;\n\t\t\t\t\tcategoryAmounts[\"windowsdevices\"]+=_TMDL.sales[i];\n\t\t\t\t} else if ((typeof _TMDL.prdType == \"object\") && (typeof _TMDL.prdType[i] == \"string\") && ~_TMDL.prdType[i].toLowerCase().indexOf(\"game\") && (~_TMDL.pnames[i].toLowerCase().indexOf(\"xbox\") || matchXboxBrand(_TMDL.pnames[i]) || _TMDL.sales[i]>0)) {\n\t\t\t\t\t// look for digital goods\n\t\t\t\t\t_TMDL.dcmcat[i]=\"xboxdigitalgames\";\n\t\t\t\t\tcategoryOrders[\"xboxdigitalgames\"]++;\n\t\t\t\t\tcategoryAmounts[\"xboxdigitalgames\"]+=_TMDL.sales[i];\n\t\t\t\t} else if ((typeof _TMDL.prdType == \"object\") && (typeof _TMDL.prdType[i] == \"string\") && _TMDL.prdType[i].toLowerCase().indexOf(\"device\")<0 && _TMDL.prdType[i].toLowerCase().indexOf(\"pass\")<0) {\n\t\t\t\t\t// look for digital goods\n\t\t\t\t\t_TMDL.dcmcat[i]=\"winsoftdigital\";\n\t\t\t\t\tcategoryOrders[\"winsoftdigital\"]++;\n\t\t\t\t\tcategoryAmounts[\"winsoftdigital\"]+=_TMDL.sales[i];\n\t\t\t\t} else {\n\t\t\t\t\t_TMDL.dcmcat[i]=\"other\";\n\t\t\t\t\tcategoryOrders[\"other\"]++;\n\t\t\t\t\tcategoryAmounts[\"other\"]+=_TMDL.sales[i];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\t\n\t\ttry {\n\t\t\tif (_TMutils.readCookie(\"MC1\")) {\n\t\t\t\tmc1 = _TMutils.readCookie(\"MC1\").split(\"&\")[0].split(\"=\")[1]; //use in u58\n\t\t\t}\n\t\t} catch(mc1err) {}\t\n\n\t\t// set the floodlights based on the page\n\t\tif (_TMDL.pageType==\"receipt\" || _TMDL.pageType==\"congrats\") {\n\t\t\tfloodlights = purchaseFloodlights;\n\t\t} else if (~_TMDL.pageType.indexOf(\"cart\")) {\n\t\t\tfloodlights = cartFloodlights;\n\t\t}\n\t\t\n\t\t// iterate through line items\n\t\tfor (key in categoryOrders) {\n\t\t\tif (categoryOrders[key]>0 && floodlights[key] !== \"exclude\") {\t\t\n\t\t\t\tpnames=[]; pids=[]; pidsku=[]; sales=[]; quantities=[]; totqty=0; totamt=0;\n\t\t\t\tconsole.log(key,categoryOrders[key],categoryAmounts[key],\"\\n\"); // make sure formatted as xx.xx\n\n\t\t\t\tfor (var line=0; line < _TMDL.pids.length; line++) {\n\t\t\t\t\tif (_TMDL.dcmcat[line] == key) {\t\n\t\t\t\t\t\tpnames.push(_TMDL.pnames[line]);\n\t\t\t\t\t\tpids.push(_TMDL.pids[line]);\n\t\t\t\t\t\tpidsku.push(_TMDL.pidsku[line]);\n\t\t\t\t\t\tsales.push(_TMDL.sales[line]);\n\t\t\t\t\t\tquantities.push(_TMDL.quantities[line]);\n\t\t\t\t\t\ttotqty+=_TMDL.quantities[line];\n\t\t\t\t\t\ttotamt+=_TMDL.sales[line];\t\n\t\t\t\t\t}\t\t\t\t\n\t\t\t\t}\n\n\t\t\t\timgsrc1 = \"https://ad.doubleclick.net/ddm/activity\"+floodlights[key]+\";qty=1;cost=\"+totamt+\";u1=\"+_TMDL.geo.toUpperCase()+\";u2=\"+_TMDL.ll\n\t\t\t\t\t//+\";u5=\"+encodeURIComponent(document.referrer)\n\t\t\t\t\t+\";u25=\"+pids.join(\"_\")\n\t\t\t\t\t+\";u26=\"+encodeURIComponent(pnames.join(\"_\"))\n\t\t\t\t\t+\";u58=\"+mc1\n\t\t\t\t\t+\";u31=\"+_TMDL.cc+\";u32=\"+pids.join(\"_\")+\";u33=\"+pidsku.join(\"_\")+\";u34=\"+_TMDL.purchaseID+\";u35=\"+totqty\n\t\t\t\t\t+\";u39=\"+sales.join(\"_\")+\";u40=\"+quantities.join(\"_\")\n\t\t\t\t\t+\";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=\"+_TMDL.purchaseID+\"?\";\n\t\t\t\timgsrc = imgsrc1;\n\t\t\t\tif (debug) {\n\t\t\t\t\tconsole.log(key,pnames.join(\"_\"),\"\\n\");\n\t\t\t\t\tconsole.log(imgsrc1,\"\\n\");\n\t\t\t\t} \n\t\t\t\tBootstrapper.imageRequest(imgsrc1);\n\t\t\t}\n\t\t}\n\n\t};\n\n\tdoFloodlights(0);var imgsrc=\"\";\n}\ncatch(err)\n{\n\tif (typeof(_TMutils) !== \"undefined\") {_TMutils.logRuleCall(\"DCM Cart and Purchase\",err.message,imgsrc);}\n\t_satellite.logger.error(\"DCM Cart and Purchase\");\n}\n",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RL0bcfb7ed292f400495880750aaae4dbc",
      "name": "ENSSHIM",
      "events": [
        {
          "modulePath": "core/src/lib/events/libraryLoaded.js",
          "settings": {
          },
          "ruleOrder": -90.0
        }
      ],
      "conditions": [

      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "global": true,
            "source": "if (typeof Bootstrapper !== 'object') {\n\twindow.Bootstrapper = {};\n\tBootstrapper.imageRequest = function(a) {var c=new Image(0,0);c.src=a;return c};\n\tBootstrapper.insertScript = function(a, c, d, h) {\n                var p = document.getElementsByTagName(\"script\"), g;\n                h = void 0 !== h ? h : !0;\n                if (void 0 !== c ? c : 1)\n                    for (g = 0; g < p.length; g++)\n                        if (p[g].src === a && p[g].readyState && /loaded|complete/.test(p[g].readyState))\n                            return;\n                if (d) {\n                    d = 1 == d && \"object\" == typeof b.scDataObj ? b.scDataObj : d;\n                    e.rand = Math.random() * (\"1E\" + (10 * Math.random()).toFixed(0));\n                    c = window.location.href;\n                    \"object\" === typeof d && d.PageID && (c = d.PageID,\n                    delete d.PageID);\n                    if (\"object\" === typeof d)\n                        for (g in d) {\n                            g = ~c.indexOf(\"#\") ? c.slice(c.indexOf(\"#\"), c.length) : \"\";\n                            c = c.slice(0, g.length ? c.length - g.length : c.length);\n                            c += ~c.indexOf(\"?\") ? \"&\" : \"?\";\n                            for (k in d)\n                                c += k + \"=\" + d[k] + \"&\";\n                            c = c.slice(0, -1) + g;\n                            break\n                        }\n                    a += \"?\";\n                    h && (a += \"r=\" + e.rand + \"&\");\n                    a += \"ClientID=\" + encodeURIComponent(e.options.clientId) + \"&PageID=\" + encodeURIComponent(c)\n                }\n                (function(a, c, b) {\n                    var d = c.head || c.getElementsByTagName(\"head\");\n                    setTimeout(function() {\n                        if (\"item\"in d) {\n                            if (!d[0]) {\n                                setTimeout(arguments.callee, 25);\n                                return\n                            }\n                            d = d[0]\n                        }\n                        var a = c.createElement(\"script\");\n                        a.src = b;\n                        a.onload = a.onerror = function() {\n                            this.addEventListener && (this.readyState = \"loaded\")\n                        }\n                        ;\n                        d.insertBefore(a, d.firstChild)\n                    }, 0)\n                }\n                )(window, document, a)\n            }\n            ;\n            Bootstrapper.loadScriptCallback = function(a, c, b) {\n                var d = document.getElementsByTagName(\"script\"), e;\n                b = d[0];\n                for (e = 0; e < d.length; e++)\n                    if (d[e].src === a && d[e].readyState && /loaded|complete/.test(d[e].readyState))\n                        try {\n                            c()\n                        } catch (g) {\n                            //window[ensightenOptions.ns].reportException(g)\n                        } finally {\n                            return\n                        }\n                d = document.createElement(\"script\");\n                d.type = \"text/javascript\";\n                d.async = !0;\n                d.src = a;\n                d.onerror = function() {\n                    this.addEventListener && (this.readyState = \"loaded\")\n                }\n                ;\n                d.onload = d.onreadystatechange = function() {\n                    if (!this.readyState || \"complete\" === this.readyState || \"loaded\" === this.readyState) {\n                        this.onload = this.onreadystatechange = null;\n                        this.addEventListener && (this.readyState = \"loaded\");\n                        try {\n                            c.call(this)\n                        } catch (g) {\n                            //window[ensightenOptions.ns].reportException(g)\n                        }\n                    }\n                }\n                ;\n                b.parentNode.insertBefore(d, b)\n            }\n            ;\n}\n\n\nwindow._TMutils = {\n\tgetQueryParam : function (p,url) {\n\t\t\t//var url = window.location.search,\n\t\t\tvar match;\n\t\t\tif (window.location.href.indexOf(\"#\") !== -1) {\n\t\t\t\turl += \"&\" + window.location.href.split(\"#\")[1]\n\t\t\t}\n\t\t\tmatch = new RegExp(\"[?&]\" + p + \"=([^&]*)\", \"i\").exec(url);\n\t\t\treturn match ? IRF.util.safeDecodeURIComponent(match[1].replace(/\\+/g, \" \")) : null\n\t},\n  readCookie : function(name) {\n\t\tvar nameEQ = name + \"=\";\n\t\tvar ca = document.cookie.split(';');\n\t\tfor(var i=0;i < ca.length;i++) {\n\t\t\tvar c = ca[i];\n\t\t\twhile (c.charAt(0)==' ') c = c.substring(1,c.length);\n\t\t\tif (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);\n\t\t}\n\t\treturn null;\n\t},\n\tcreateCookie : function(name,value,days) {\n\t\tvar expires = \"\";\n\t\tvar date;\n\t\tvar domainstr = (~window.location.host.indexOf(\"microsoft.com\")) ? \"; domain=.microsoft.com; path=/; \" : \"; path=/; \";\n\t\tif (days) {\n\t\t\tdate = new Date();\n\t\t\tdate.setTime(date.getTime()+(days*24*60*60*1000));\n\t\t\texpires = \"; expires=\"+date.toGMTString();\n\t\t}\n\t\tdocument.cookie = name+\"=\"+value+expires+domainstr;\n\t},\n\tsafeDecodeURIComponent : function (s) {\n\t\tif (s) {\n\t\t\ts = s.replace(/%([EF][0-9A-F])%([89AB][0-9A-F])%([89AB][0-9A-F])/gi, function (code, hex1, hex2, hex3) {\n\t\t\t\t\tvar n1 = parseInt(hex1, 16) - 224;\n\t\t\t\t\tvar n2 = parseInt(hex2, 16) - 128;\n\t\t\t\t\tif (n1 == 0 && n2 < 32) {\n\t\t\t\t\t\treturn code\n\t\t\t\t\t}\n\t\t\t\t\tvar n3 = parseInt(hex3, 16) - 128;\n\t\t\t\t\tvar n = (n1 << 12) + (n2 << 6) + n3;\n\t\t\t\t\tif (n > 65535) {\n\t\t\t\t\t\treturn code\n\t\t\t\t\t}\n\t\t\t\t\treturn String.fromCharCode(n)\n\t\t\t\t});\n\t\t\ts = s.replace(/%([CD][0-9A-F])%([89AB][0-9A-F])/gi, function (code, hex1, hex2) {\n\t\t\t\t\tvar n1 = parseInt(hex1, 16) - 192;\n\t\t\t\t\tif (n1 < 2) {\n\t\t\t\t\t\treturn code\n\t\t\t\t\t}\n\t\t\t\t\tvar n2 = parseInt(hex2, 16) - 128;\n\t\t\t\t\treturn String.fromCharCode((n1 << 6) + n2)\n\t\t\t\t});\n\t\t\ts = s.replace(/%([0-7][0-9A-F])/gi, function (code, hex) {\n\t\t\t\t\treturn String.fromCharCode(parseInt(hex, 16))\n\t\t\t\t});\n\t\t\ts = s.replace(\"+\", \" \")\n\t\t}\n\t\treturn s\n\t},\n\tlogRuleCall : function (ruleName,debugParams,imageURL) {\n\t\tvar pType = \"other\";var market = \"en-us\";var cookieMSFPC = \"msfpc\";\n\t\tvar ff2,ff3,ff4,ff5,ff6;ff2=ff3=ff4=ff5=ff6=\"\";\n\t\tvar jsDomain = encodeURIComponent(window.location.hostname.toLowerCase());\n        if (typeof _TMDL == \"object\") {pType = _TMDL.pageType;market = _TMDL.ll;}\n        function impGuid() {var result,i,j;result=\"\";\n            for (j = 0; j < 32; j++) {if (j == 8 || j == 12 || j == 16 || j == 20)result = result + \"-\";\n                i = Math.floor(Math.random() * 16).toString(16).toUpperCase();result=result+i;}return result;}\n\t\t(function(imageURL){\t\n\t\tvar climit,temp2,temp3,temp4,URLlen;climit=255;URLlen=imageURL.length;\n\t\tif (URLlen <= climit) {ff2=imageURL;}\n\t\tif (URLlen > climit){ff2 = imageURL.slice(0,climit);temp2 = imageURL.slice(climit,URLlen);if (temp2.length <= climit){ff3=temp2;}else {ff3 = temp2.slice(0,climit);temp3 = temp2.slice(climit,URLlen);if (temp3.length <= climit) {ff4=temp3;}else{ff4 = temp3.slice(0,climit);temp4 = temp3.slice(climit,URLlen);if (temp4.length <= climit) {ff5=temp4;}else{ff5=temp4.slice(0,climit);ff6= temp4.slice(climit,URLlen);}}}}})(encodeURIComponent(imageURL));\n\t\tvar dtUTCTime = new Date;\n        var curUTCTime = dtUTCTime.getUTCFullYear() + \"-\" + dtUTCTime.getUTCMonth() + 1 + \"-\" + dtUTCTime.getUTCDate() + \"T\" + dtUTCTime.getUTCHours() + \":\" + dtUTCTime.getUTCMinutes() + \":\" + dtUTCTime.getUTCSeconds() + \".\" + dtUTCTime.getUTCMilliseconds() + \"Z\";\n        var str = \"https://web.vortex.data.microsoft.com/collect/v1/t.js?ver\\x3d%272.1%27\\x26name\\x3d%27Ms.Webi.PageView%27\\x26\";\n        str += \"time\\x3d'\" + curUTCTime + \"'\" + \"\\x26appId\\x3d%27JS%3AUniStore%27\\x26-ver\\x3d%271.0%27\\x26-\" + \"impressionGuid\\x3d%27\" + impGuid() + \"%27\" + \"\\x26-pageName\\x3d%27\" + encodeURIComponent(ruleName) + \"%27\" + \"\\x26-pageType\\x3d%27\" + pType + \"%27\" + \"\\x26-market\\x3d%27\" + encodeURIComponent(market) + \"%27\" + \"\\x26-uri\\x3d%27\" + encodeURIComponent(document.URL) + \"%27\" + \"\\x26-referrerUri\\x3d%27\" + encodeURIComponent(document.referrer) + \"%27\" + \"\\x26-pageTags\\x3d%27%7B%22flightring%22%3A%22\" + encodeURIComponent(debugParams) + \"%22\" + \",%22field2%22%3A%22\" + encodeURIComponent(ff2) + \"%22,%22field3%22%3A%22\" + encodeURIComponent(ff3) +\"%22,%22field4%22%3A%22\" + encodeURIComponent(ff4) + \"%22,%22field5%22%3A%22\" + encodeURIComponent(ff5) +\"%22,%22field6%22%3A%22\" + encodeURIComponent(ff6) +\"%22%7D%27\\x26-behavior\\x3d0\" + \"\\x26*baseType\\x3d%27Ms.Content.PageView%27\\x26*cookieEnabled\\x3dtrue\\x26*isJs\\x3dtrue\" + \"\\x26*title\\x3d%27\" + encodeURIComponent(document.title) + \"%27\" + \"\\x26*isLoggedIn\\x3dfalse\\x26*flashInstalled\\x3dfalse\\x26ext-app-env\\x3d%27DEV%27\\x26ext-javascript-libVer\\x3d%274.2.11%27\" + \"\\x26ext-javascript-domain\\x3d%27\" + jsDomain + \"%27\" + \"\\x26ext-javascript-msfpc\\x3d%27\" + cookieMSFPC + \"%27\" + \"\\x26ext-javascript-userConsent\\x3dfalse\";\n        var imgTag = new Image;imgTag.src = str;\n\t}\n};\n",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RL369c413f84c54b4a89a9eaa73a57154a",
      "name": "Media_/LL-LL/ Reddit Xbox Purchase",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 50.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/customCode.js",
          "settings": {
            "source": function(event, target) {
  return (window.location.host.toLowerCase()=="query.prod.cms.rt.microsoft.com" && ~window.location.search.indexOf("pN=congrats"));
}
          }
        },
        {
          "modulePath": "core/src/lib/conditions/dateRange.js",
          "settings": {
            "end": "2022-07-01T00:00:00Z",
            "start": "2021-11-03T00:00:00Z"
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "//Reddit Xbox Pixel\nif (_TMDL.geo==\"US\" || _TMDL.geo==\"AU\" || _TMDL.geo==\"GB\") {\ntry\n{\nvar ps=\"\",inScope=0\nfor (var i=0; i<_TMDL.pids.length; i++) {\nif (_TMDL.pidsku.length > i) {\nps = _TMDL.pidsku[i].toUpperCase();\nif (ps==\"CFQ7TTC0K5DJ-000C\" || ps==\"CFQ7TTC0K5DJ-000D\" || ps==\"CFQ7TTC0K5ZM-0002\" || ps==\"CFQ7TTC0K5ZM-7SR4\" || ps==\"CFQ7TTC0K63H-0007\" || ps==\"CFQ7TTC0K63H-0008\" || ps==\"CFQ7TTC0K63H-000L\" || ps==\"CFQ7TTC0K63H-000M\" || \n    ps==\"CFQ7TTC0K63H-000R\" || ps==\"CFQ7TTC0K63H-000S\" || ps==\"CFQ7TTC0K63H-000X\" || ps==\"CFQ7TTC0K63H-000Z\" || ps==\"CFQ7TTC0K63H-001C\" || ps==\"CFQ7TTC0K63H-001R\" || ps==\"CFQ7TTC0K63H-001Q\" || ps==\"CFQ7TTC0K63H-001V\" || \n    ps==\"CFQ7TTC0K63H-001W\" || ps==\"CFQ7TTC0K63H-0021\" || ps==\"CFQ7TTC0K63H-0022\" || ps==\"CFQ7TTC0K63H-0025\" || ps==\"CFQ7TTC0K63H-0026\" || ps==\"CFQ7TTC0K63H-002F\" || ps==\"CFQ7TTC0K63H-001S\" || ps==\"CFQ7TTC0K63H-001T\" || \n    ps==\"CFQ7TTC0K63H-001X\" || ps==\"CFQ7TTC0K63H-001Z\" || ps==\"CFQ7TTC0K63H-0023\" || ps==\"CFQ7TTC0K63H-0024\" || ps==\"CFQ7TTC0K63H-0029\" || ps==\"CFQ7TTC0K5ZM-0003\" || ps==\"CFQ7TTC0K63H-002M\" || ps==\"CFQ7TTC0K63H-002N\" || \n    ps==\"CFQ7TTC0K63H-002P\" || ps==\"CFQ7TTC0K63H-0005\" || ps==\"CFQ7TTC0K63H-0006\" || ps==\"CFQ7TTC0K63H-000Q\" || ps==\"CFQ7TTC0K63H-000W\" || ps==\"CFQ7TTC0K63H-000P\" || ps==\"CFQ7TTC0K63H-0018\" || ps==\"CFQ7TTC0K63H-0019\" || \n    ps==\"CFQ7TTC0K63H-001F\" || ps==\"CFQ7TTC0K63H-001G\" || ps==\"CFQ7TTC0K63H-002S\" || ps==\"CFQ7TTC0K63H-0001\" || ps==\"CFQ7TTC0K63H-000H\" || ps==\"CFQ7TTC0K63H-000K\" || ps==\"CFQ7TTC0K63H-0012\" || ps==\"CFQ7TTC0K63H-002J\" || \n    ps==\"CFQ7TTC0K63H-0020\" || ps==\"CFQ7TTC0K63H-002B\" || ps==\"CFQ7TTC0K63H-001D\" || ps==\"CFQ7TTC0K63H-001H\" || ps==\"CFQ7TTC0K63H-001K\" || ps==\"CFQ7TTC0K63H-001L\" || ps==\"CFQ7TTC0K63H-002C\" || ps==\"CFQ7TTC0K63H-0027\" || \n    ps==\"CFQ7TTC0K63H-0028\" || ps==\"CFQ7TTC0K63H-002Q\" || ps==\"CFQ7TTC0K63H-002R\" || ps==\"CFQ7TTC0K63H-0003\" || ps==\"CFQ7TTC0K63H-0004\" || ps==\"CFQ7TTC0K63H-0009\" || ps==\"CFQ7TTC0K63H-000B\" || ps==\"CFQ7TTC0K63H-000C\" || \n    ps==\"CFQ7TTC0K63H-000D\" || ps==\"CFQ7TTC0K63H-000F\" || ps==\"CFQ7TTC0K63H-000G\" || ps==\"CFQ7TTC0K63H-001B\" || ps==\"CFQ7TTC0K63H-001N\" || ps==\"CFQ7TTC0K63H-002D\" || ps==\"CFQ7TTC0K63H-002G\" || ps==\"CFQ7TTC0K63H-0002\" || \n    ps==\"CFQ7TTC0K63H-000J\" || ps==\"CFQ7TTC0K63H-002K\" || ps==\"CFQ7TTC0K63H-002L\" || ps==\"CFQ7TTC0K63H-000N\" || ps==\"CFQ7TTC0K63H-000T\" || ps==\"CFQ7TTC0K63H-000V\" || ps==\"CFQ7TTC0K63H-0011\" || ps==\"CFQ7TTC0K63H-0010\" || \n    ps==\"CFQ7TTC0K63H-002H\" || ps==\"CFQ7TTC0K63H-0013\" || ps==\"CFQ7TTC0K63H-0014\" || ps==\"CFQ7TTC0K63H-0015\" || ps==\"CFQ7TTC0K63H-0016\" || ps==\"CFQ7TTC0K63H-0017\" || ps==\"CFQ7TTC0K63H-001M\" || ps==\"CFQ7TTC0K63H-001P\" || \n    ps==\"CFQ7TTC0K63H-001J\" || ps==\"8T07Q5SRTV11-498S\" || ps==\"90Z8K1DBJ8ZD-0TR4\" || ps==\"8T07Q5SRTV11-058T\" || ps==\"8T07Q5SRTV11-637M\" || ps==\"8WJ714N3RBTL-490G\" || ps==\"8T07Q5SRTV11-8XR4\" || ps==\"8RDMHCQPFTB3-5D0N\" || \n    ps==\"8T07Q5SRTV11-90ZR\" || ps==\"8T07Q5SRTV11-HV5X\" || ps==\"8T07Q5SRTV11-K73G\" || ps==\"8V07B7D9RT94-4N65\" || ps==\"8P80WLPWCS0X-CJD3\" || ps==\"8T07Q5SRTV11-F0GG\" || ps==\"8S1VNGFW2JV8-GDJM\" || ps==\"8WH200Q1JG76-GHM1\" || \n    ps==\"8S1VNGFW2JV8-KMDS\" || ps==\"8RNHQJKR23JQ-685Q\" || ps==\"8RNHQJKR23JQ-L036\" || ps==\"8T07Q5SRTV11-B192\" || ps==\"940J83PK147R-B1PX\" || ps==\"8PD10J7J6MDG-DWDF\" || ps==\"8TZDQ3K9F52M-GGR9\" || ps==\"8SM6PVLK1H52-KXFF\" || \n    ps==\"8V9DX9W37PD3-9SVP\" || ps==\"8QMN3Q6FQJFH-FMZ8\" || ps==\"8T07Q5SRTV11-HVT1\" || ps==\"910PCTKGCV8T-MBT6\" || ps==\"9496XKF4D9D0-H7MF\" || ps==\"8TRWZ09B0G07-FDV4\" || ps==\"8T8KCNB1XS3D-84PC\" || ps==\"8XN59CRBSQGZ-JBFJ\" || \n    ps==\"9052SHFFCXL5-KJDD\" || ps==\"92PQ94D376XZ-F638\" || ps==\"9082KXHLZ2XR-B09V\" || ps==\"8V5N5W7RQTT7-H982\" || ps==\"8TDWHGLL0VZP-J7F2\" || ps==\"8XN59CRBSQGZ-HG3Q\" || ps==\"8ZW2DXG78JC7-4JMD\" || ps==\"8XN59CRBSQGZ-M3FS\" || \n    ps==\"8T07Q5SRTV11-CBN1\" || ps==\"8NFTLGZ7S1L3-87DS\" || ps==\"8XN59CRBSQGZ-25XW\" || ps==\"8P472LSRHZ0T-7776\" || ps==\"8PD7FXKHP5RW-6VR4\" || ps==\"8X4FHH4X4MHX-6ZG5\" || ps==\"93382MKKGJ02-BZM7\" || ps==\"922M1DK9HZV8-BBD5\" || \n    ps==\"93ZM50FF452F-6ZWX\" || ps==\"8WJTT248MM6G-8NTM\" || ps==\"911C2SNM16G4-HP38\" || ps==\"8MWHG706SV3N-DTWZ\" || ps==\"8T07Q5SRTV11-D5XD\" || ps==\"8VMJMHBJTFL5-2N5N\" || ps==\"8RSN7J6375GG-99WM\" || ps==\"8PRG8Q2265SL-BDSK\" || \n    ps==\"936L5FN0W6V6-92B9\" || ps==\"8XRD3S750JFG-8K4D\" || ps==\"8XGF1S3VFFDB-JK66\" || ps==\"8ZFM1D39DZWP-62BD\" || ps==\"8NSDBHZ1N3D8-0002\" || ps==\"901JF2ZPTLXQ-5209\" || ps==\"8RKW2L0CR8SP-GPLV\" || ps==\"8PWCCRL7F0BN-0QCF\" || \n    ps==\"8R47GMDT9ZG6-6DGZ\" || ps==\"8TNQZRJQ38W1-G19L\" || ps==\"94BWQ0QBKZFB-H3QM\" || ps==\"8XGF1S3VFFDB-2HSZ\" || ps==\"8V2CFLQ6FPF0-B2RC\" || ps==\"91DQRB97L130-JQ56\" || ps==\"911C2SNM16G4-75FQ\" || ps==\"8W3GK9F99GJH-8JNJ\" || \n    ps==\"8W3GK9F99GJH-12QS\" || ps==\"91VGJSDXVF5N-8P0P\" || ps==\"8MTPBK7QLTVD-M30R\" || ps==\"929C19165TL3-93ZL\" || ps==\"927Q1VG7LRXZ-5N34\" || ps==\"90V7LC49LGKS-JXJT\" || ps==\"91N2GCXRWHQ6-K8QZ\" || ps==\"8S6F8FH2SKBF-KLFN\" || \n    ps==\"943M1NC8ZG69-20XL\" || ps==\"8RX4V78HT8Q8-DW63\" || ps==\"8QQQT5GCMJ7B-52DC\" || ps==\"92KZG88SZ07Q-B063\" || ps==\"8NMPB6V29840-9VR5\" || ps==\"8THSBP49Z46X-9779\" || ps==\"8XN59CRBSQGZ-3MJ2\" || ps==\"8XRD3S750JFG-9BLL\" || \n    ps==\"8XRD3S750JFG-LFPL\" || ps==\"9082KXHLZ2XR-B9N1\" || ps==\"8W6SDMBQ072S-BNGM\" || ps==\"8RX4V78HT8Q8-KGN2\" || ps==\"934ZNJCQ2VXR-DXFX\" || ps==\"8T6N0J1ZG7SL-2L5C\" || ps==\"8NPCSJJW4CGV-9LDS\" || ps==\"8NPCSJJW4CGV-F9RF\" || \n    ps==\"8QC1QMT3JC2Z-1R7D\" || ps==\"8W8V368G8KZX-LJS1\" || ps==\"9082KXHLZ2XR-LCR8\" || ps==\"91D6W1CT940X-8M5K\" || ps==\"8QJQB1F4V0DJ-0VF1\" || ps==\"8NPCSJJW4CGV-L5NQ\" || ps==\"934ZNJCQ2VXR-F5VS\" || ps==\"8Z2MHHTK24GC-1SSJ\" || \n    ps==\"8P25R836686S-6P2J\" || ps==\"8V9DX9W37PD3-6ZB0\" || ps==\"8RPM8T9CK0P6-GSTK\" || ps==\"8Z1DCQL8Z512-5P6C\" || ps==\"8XP6LKM3MPX8-2587\" || ps==\"8PCN2542HZ64-K33P\" || ps==\"8W3GK9F99GJH-D9FW\" || ps==\"8WQTH21CMCL4-FS5P\" || \n    ps==\"8MTPBK7QLTVD-3RK9\" || ps==\"90V7LC49LGKS-2WDZ\" || ps==\"8MV3XWV6TWBM-36VS\" || ps==\"8MV3XWV6TWBM-KRNQ\" || ps==\"8WNCCQXW5X1N-H2BK\" || ps==\"8P8F24GFKJ18-4VRH\" || ps==\"8P0WSDDC3WQG-PZTD\" || ps==\"8MM77Q8LM45C-5S9S\" || \n    ps==\"8MM77Q8LM45C-9MR0\" || ps==\"8P2NZWC0JJL6-6M3W\" || ps==\"8SM6PVLK1H52-FCNP\" || ps==\"942Q7T9W9B1H-FPHD\" || ps==\"90G6MJNF223N-KM4P\" || ps==\"8QMDT7ZSF6TP-6P4S\" || ps==\"90GZCDQBW2DF-BFDQ\" || ps==\"8W1XD96LJLCD-JX5W\" || \n    ps==\"8R419TH0Z8NV-QXM0\" || ps==\"94CZ2B1VPCR7-PGDN\" || ps==\"8RTF503L2PL9-FV6V\" || ps==\"936NDVCJZP78-M8JT\" || ps==\"8NPCSJJW4CGV-JZLF\" || ps==\"942J774TP9JN-D73K\" || ps==\"90BBJ44JTM04-GBR5\" || ps==\"8P25R836686S-C6RX\" || \n    ps==\"8P25R836686S-0C7W\" || ps==\"8P25R836686S-40N7\" || ps==\"8NZP0DD82NGP-BDGV\" || ps==\"8XNCBK6NS06C-DKNX\" || ps==\"8ND3067HN3RS-B62Z\" || ps==\"8Z80TH5JF0F3-HLHN\" || ps==\"92R4FRRQS20D-5M8M\" || ps==\"93CQ5LVZBBDR-419G\" || \n    ps==\"8NPCSJJW4CGV-G03D\" || ps==\"8T7S7VDWQNDV-0TZQ\" || ps==\"8NPCSJJW4CGV-JXR3\" || ps==\"8P25R836686S-B7V3\" || ps==\"90BDN4KXVSBN-76GM\" || ps==\"904H9VM1QG4H-HNZV\" || ps==\"8V23FGLC1NM8-35VP\" || ps==\"8P25R836686S-JGQ9\" || \n    ps==\"8R1R8THV8Q73-37PJ\" || ps==\"91K4CGDZQDF8-M3RM\" \n\n){\ninScope=1\n}\nif (inScope) {\nvar image = new Image(1, 1);\nimage.src =\"https://alb.reddit.com/rp.gif?id=t2_7knbgndc&event=Purchase&integration=noscript\";\n}\n}}}\ncatch(err)\n{\n_satellite.logger.error(\"Media_/LL-LL/ Reddit Xbox Purchase\");\n}}",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RL1bd4a77a2f604eb69d942ed8e47a1507",
      "name": "Media_/fr-fr/store/b/sale",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 50.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/path.js",
          "settings": {
            "paths": [
              {
                "value": "/fr-fr/store/b/sale"
              },
              {
                "value": "/fr-fr/store/b/sale/"
              }
            ]
          }
        },
        {
          "modulePath": "core/src/lib/conditions/domain.js",
          "settings": {
            "domains": [
              "microsoft.com"
            ]
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "try\n{\n  \n// ADNXS\n   //Carousel\n jQuery(\"div:eq(31)\").on(\"mousedown\", function(){\nvar image = new Image(1, 1);\nimage.src = \"//secure.adnxs.com/px?id=1268102&t=2\";\n});\n //Featured Product Image Links\njQuery(\".m-content-placement-item:lt(3)\").on(\"mousedown\", function(){\nvar image = new Image(1, 1);\nimage.src = \"//secure.adnxs.com/px?id=1268102&t=2\";\n});\n //Product Cards  \njQuery(\"div.m-channel-placement-item.f-wide.f-full-bleed-image\").on(\"mousedown\", function(){\nvar image = new Image(1, 1);\nimage.src = \"//secure.adnxs.com/px?id=1268102&t=2\";\n});\n  \n\n\n//DoubleClick\n  //Carousel\n jQuery(\"div:eq(31)\").on(\"mousedown\", function(){\n    Bootstrapper.imageRequest(\"https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1=\"+_TMDL.geo+\";u2=\"+_TMDL.ll+\";u6=\"+encodeURIComponent(_TMDL.pagename)+\";u25=\"+_TMDL.pids[0]+\";u26=\"+encodeURIComponent(_TMDL.pnames[0])+\";u50=Deals\"+\";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1?\");\n});\n  \n  //Featured Product Image Links\njQuery(\".m-content-placement-item:lt(3)\").on(\"mousedown\", function(){\n    Bootstrapper.imageRequest(\"https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1=\"+_TMDL.geo+\";u2=\"+_TMDL.ll+\";u6=\"+encodeURIComponent(_TMDL.pagename)+\";u25=\"+_TMDL.pids[0]+\";u26=\"+encodeURIComponent(_TMDL.pnames[0])+\";u50=Shop Now\"+\";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1?\");\n});\n  \n  //Product Cards  \njQuery(\"div.m-channel-placement-item.f-wide.f-full-bleed-image\").on(\"mousedown\", function(){\n    Bootstrapper.imageRequest(\"https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1=\"+_TMDL.geo+\";u2=\"+_TMDL.ll+\";u6=\"+encodeURIComponent(_TMDL.pagename)+\";u25=\"+_TMDL.pids[0]+\";u26=\"+encodeURIComponent(_TMDL.pnames[0])+\";u50=Product Options\"+\";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1?\");\n});\n  \n  \n//Yahoo\n  //Carousel\n jQuery(\"div:eq(31)\").on(\"mousedown\", function(){\n    Bootstrapper.imageRequest(\"https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&ea=SurfaceButtonClick\");\n});\n  \n  //Featured Product Image Links\njQuery(\".m-content-placement-item:lt(3)\").on(\"mousedown\", function(){\n    Bootstrapper.imageRequest(\"https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&ea=SurfaceButtonClick\");\n});\n  \n  //Product Cards  \njQuery(\"div.m-channel-placement-item.f-wide.f-full-bleed-image\").on(\"mousedown\", function(){\n    Bootstrapper.imageRequest(\"https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&ea=SurfaceButtonClick\");\n});\n\n}\ncatch(err)\n{\n\t_satellite.logger.error(\"Media_/fr-fr/store/b/sale\");\n}\n  ",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RLde28aecd30d74703bdf3a1ed721c0109",
      "name": "Media.LL-LL.store.b.student",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 50.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/path.js",
          "settings": {
            "paths": [
              {
                "value": "/en-gb/store/b/student"
              },
              {
                "value": "/en-gb/store/b/student/"
              },
              {
                "value": "/fr-fr/store/b/student"
              },
              {
                "value": "/fr-fr/store/b/student/"
              },
              {
                "value": "/de-de/store/b/student"
              },
              {
                "value": "/de-de/store/b/student/"
              }
            ]
          }
        },
        {
          "modulePath": "core/src/lib/conditions/domain.js",
          "settings": {
            "domains": [
              "microsoft.com"
            ]
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "try\n  {\n    \n //ADNXS\n    \n //Hero\njQuery(\".m-hero\").on(\"mousedown\", function(){\nvar image = new Image(1, 1);\nimage.src = \"//secure.adnxs.com/px?id=1268102&t=2\";\n    });\n \n//QuickLinks\njQuery(\".m-updated-quicklinks li:lt(2)\").on(\"mousedown\", function(){\nvar image = new Image(1, 1);\nimage.src = \"//secure.adnxs.com/px?id=1268102&t=2\";\n    });\n\n    \n //\"Shop Surface\" - Only capturing first 'card' (anchor + img). Remainder of isn't identified in spec.   \njQuery(\"#primaryR5 img:eq(0)\").on(\"mousedown\", function(){\nvar image = new Image(1, 1);\nimage.src = \"//secure.adnxs.com/px?id=1268102&t=2\";\n    });\n \njQuery(\"#primaryR5 a:eq(0)\").on(\"mousedown\", function(){\nvar image = new Image(1, 1);\nimage.src = \"//secure.adnxs.com/px?id=1268102&t=2\";\n    });\n    \n//Surface Bundles\njQuery(\"#primaryR7 a:gt(1)\").on(\"mousedown\", function(){\nvar image = new Image(1, 1);\nimage.src = \"//secure.adnxs.com/px?id=1268102&t=2\";\n    });\n    \n\n //DoubleClick\n    \njQuery(\".m-hero\").on(\"mousedown\", function(){\nBootstrapper.imageRequest(\"https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=lrn_std;u1=\"+_TMDL.geo+\";u2=\"+_TMDL.ll+\";u6=\"+encodeURIComponent(_TMDL.pagename)+\";u25=\"+_TMDL.pids[0]+\";u26=\"+encodeURIComponent(_TMDL.pnames[0])+\";u50=Learn More\"+\";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1?\");\n});\n\njQuery(\".m-updated-quicklinks li:lt(2)\").on(\"mousedown\", function(){\nBootstrapper.imageRequest(\"https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1=\"+_TMDL.geo+\";u2=\"+_TMDL.ll+\";u6=\"+encodeURIComponent(_TMDL.pagename)+\";u25=\"+_TMDL.pids[0]+\";u26=\"+encodeURIComponent(_TMDL.pnames[0])+\";u50=Surface for Students Surface Accessories\"+\";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1?\");\n});\n\njQuery(\"#primaryR5\").on(\"mousedown\", function(){ Bootstrapper.imageRequest(\"https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1=\"+_TMDL.geo+\";u2=\"+_TMDL.ll+\";u6=\"+encodeURIComponent(_TMDL.pagename)+\";u25=\"+_TMDL.pids[0]+\";u26=\"+encodeURIComponent(_TMDL.pnames[0])+\";u50=Shop Surface\"+\";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1?\");\n});\n\njQuery(\"#primaryR7 a:gt(1)\").on(\"mousedown\", function(){ Bootstrapper.imageRequest(\"https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1=\"+_TMDL.geo+\";u2=\"+_TMDL.ll+\";u6=\"+encodeURIComponent(_TMDL.pagename)+\";u25=\"+_TMDL.pids[0]+\";u26=\"+encodeURIComponent(_TMDL.pnames[0])+\";u50=Shop Surface\"+\";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1?\");\n});\n \n    \n  }\ncatch(err)\n  {\n\t_satellite.logger.error(\"Media.LL-LL.store.b.student\");\n  }",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RLa95c5c1f9ffa4ad69c72b6459e7ef0bc",
      "name": "AU/ConsumerConsultationTag",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 50.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/path.js",
          "settings": {
            "paths": [
              {
                "value": "/en-au/store/b/online-computer-shopping-appointments",
                "valueIsRegex": true
              }
            ]
          }
        },
        {
          "modulePath": "core/src/lib/conditions/domain.js",
          "settings": {
            "domains": [
              "microsoft.com"
            ]
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "// JavaScript source code\ntry {\n    //Floodlight pv\n    var image = new Image(1, 1);\n    image.src = \"https://ad.doubleclick.net/ddm/activity/src=8406733;type=corpothe;cat=corpo0;u1=\" + _TMDL.geo + \";u2=\" + _TMDL.ll + \";u6=\" + encodeURIComponent(_TMDL.pagename) + \";u25=\" + _TMDL.pids[0] + \";u26=\" + encodeURIComponent(_TMDL.pnames[0]) + \";u52=Visit;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;gdpr=${GDPR};gdpr_consent=${GDPR_CONSENT_755};ord=1?\";\n\n    // Yahoo pv\n    var image = new Image(1, 1);\n    image.src = \"https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&he={INSERT_MACRO_HERE}&ea=AUSLandingPageVisit\";\n\n    // training - training\n    $('a[href*=\"https://digitalreservations.microsoft.com/en-au/appointment/create\"]').on(\"mousedown\", function () {\n        var cN = $(this).attr(\"data-bi-cn\");\n        \n        var image = new Image(1, 1);\n        image.src = \"https://ad.doubleclick.net/ddm/activity/src=8406733;type=corpothe;cat=corpo000;u1=\" + _TMDL.geo + \";u2=\" + _TMDL.ll + \";u6=\" + encodeURIComponent(_TMDL.pagename) + \";u25=\" + _TMDL.pids[0] + \";u26=\" + encodeURIComponent(_TMDL.pnames[0]) + \";u50=\" + cN + \";u52=Click;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;gdpr=${GDPR};gdpr_consent=${GDPR_CONSENT_755};ord=1?\";\n\n        //Yahoo clk\n        image2 = new Image(1, 1);\n        image2.src = \"https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&he={INSERT_MACRO_HERE}&ea=AUSbuttonclick\";\n    });\n\n}\ncatch (err) {\n    _satellite.logger.error(\"AU/ConsumerConsultationTag\");\n}",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RLb84483393e0944389f21094936208317",
      "name": "Media_/ja-jpr/store/b/sale",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 50.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/path.js",
          "settings": {
            "paths": [
              {
                "value": "/ja-jp/store/b/sale"
              },
              {
                "value": "/ja-jp/store/b/sale/"
              }
            ]
          }
        },
        {
          "modulePath": "core/src/lib/conditions/domain.js",
          "settings": {
            "domains": [
              "microsoft.com"
            ]
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "try\n{\n  \n// ADNXS\n \n //Featured Product Image Links\njQuery(\".m-content-placement-item:lt(11)\").on(\"mousedown\", function(){\nvar image = new Image(1, 1);\nimage.src = \"//secure.adnxs.com/px?id=1268102&t=2\";\n});\n //Product Cards  \njQuery(\"div.m-channel-placement-item.f-wide.f-full-bleed-image\").on(\"mousedown\", function(){\nvar image = new Image(1, 1);\nimage.src = \"//secure.adnxs.com/px?id=1268102&t=2\";\n});\n  \n\n\n//DoubleClick\n \n  //Featured Product Image Links\njQuery(\".m-content-placement-item:lt(11)\").on(\"mousedown\", function(){\n    Bootstrapper.imageRequest(\"https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1=\"+_TMDL.geo+\";u2=\"+_TMDL.ll+\";u6=\"+encodeURIComponent(_TMDL.pagename)+\";u25=\"+_TMDL.pids[0]+\";u26=\"+encodeURIComponent(_TMDL.pnames[0])+\";u50=Shop Now\"+\";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1?\");\n});\n  \n  //Product Cards  \njQuery(\"div.m-channel-placement-item.f-wide.f-full-bleed-image\").on(\"mousedown\", function(){\n    Bootstrapper.imageRequest(\"https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1=\"+_TMDL.geo+\";u2=\"+_TMDL.ll+\";u6=\"+encodeURIComponent(_TMDL.pagename)+\";u25=\"+_TMDL.pids[0]+\";u26=\"+encodeURIComponent(_TMDL.pnames[0])+\";u50=Product Options\"+\";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1?\");\n});\n  \n  \n//Yahoo\n \n  //Featured Product Image Links\njQuery(\".m-content-placement-item:lt(11)\").on(\"mousedown\", function(){\n    Bootstrapper.imageRequest(\"https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&ea=SurfaceButtonClick\");\n});\n  \n  //Product Cards  \njQuery(\"div.m-channel-placement-item.f-wide.f-full-bleed-image\").on(\"mousedown\", function(){\n    Bootstrapper.imageRequest(\"https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&ea=SurfaceButtonClick\");\n});\n\n}\ncatch(err)\n{\n\t_satellite.logger.error(\"Media_/ja-jp/store/b/sale\");\n}\n  ",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RL0dd585760c004cee808940a37d10a6ba",
      "name": "BoostSurfaceCart",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 50.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/customCode.js",
          "settings": {
            "source": function(event, target) {
  return (window.location.host.toLowerCase()=="query.prod.cms.rt.microsoft.com" && ~window.location.search.indexOf("pN=cart"));
}
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "var addToCart = 'button[class=\"checkoutConfirm\"]';\n\nfunction attachPixels(elementAddress) {\n    $(document).on('mousedown', elementAddress, '', function () {\n        window.uetq_Amplify = window.uetq_Amplify || [];\n        window.uetq_Amplify.push('event', 'click', { 'event_label': _TMDL.pageName, 'action_label': 'checkout'});\n    });\n} \n\ntry {\n    (function (w, d, t, r, u) {\n        var f, n, i; w[u] = w[u] || [], f = function () {\n            var o = { ti: \"149014572\" }; o.q = w[u], w[u] = new UET(o), w[u].push(\"pageLoad\")\n        },\n            n = d.createElement(t), n.src = r, n.async = 1,\n            n.onload = n.onreadystatechange = function () {\n                var s = this.readyState; s && s !== \"loaded\" && s !== \"complete\" || (f(), n.onload = n.onreadystatechange = null)\n            }, i = d.getElementsByTagName(t)[0], i.parentNode.insertBefore(n, i)\n    })(window, document, \"script\", \"//bat.bing.com/bat.js\", \"uetq_Amplify\");\n\n    attachPixels(addToCart);\n}\ncatch (err) {\n    _satellite.logger.error(\"Boost Surface Cart\");\n}",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RL4291be31c51a49aca3a412fadc14bca7",
      "name": "Holiday Sale Page",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 50.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/path.js",
          "settings": {
            "paths": [
              {
                "value": "\\/store\\/b\\/sale",
                "valueIsRegex": true
              },
              {
                "value": "(en-ca|fr-ca)\\/store\\/b\\/boxing-week",
                "valueIsRegex": true
              },
              {
                "value": "(us|ca|jp|au)\\/store\\/b\\/cyber-monday",
                "valueIsRegex": true
              },
              {
                "value": "(us|ca|jp|au)\\/store\\/b\\/black-friday",
                "valueIsRegex": true
              }
            ]
          }
        },
        {
          "modulePath": "core/src/lib/conditions/dateRange.js",
          "settings": {
            "end": "2022-02-01T00:00:00Z",
            "start": "2021-10-28T00:00:00Z"
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "// Holiday Script\nvar debug = 0, fireTags = 1;\nvar ehnsToAvoid = [\"Extended free returns\", \"Pick the perfect gift with a product expert\", \"Fast, free shipping\", \"Our best price of the season\", \"90 days of free support\", \"60-day low price promise\", \"Free returns\", \"Free shipping\"];\nvar usAndSingapore = 'div.card, ';\nvar div_enCa = 'div#coreui-contentplacement-f5d4afi, div#coreui-contentplacement-lzrgp5j, ';\nvar div_frca = 'div#coreui-contentplacement-h1khlym, div#coreui-contentplacement-y1o0trq, ';\nvar div_frfr = 'div#coreui-contentplacement-qxreqji, div#StoreLocations-HighlightHero-6ywe7ix div div div div ul, ';\nvar div_jajp = 'div#coreui-contentplacement-zlfss3q, div#coreui-hero-npd01s8 div div div ul, ';\nvar div_dede = 'div#coreui-contentplacement-a4imfpx, div#coreui-contentplacement-grqvg59, div#coreui-featurecollection-t1clixa div section ul, ';\nvar div_engb = 'div#coreui-contentplacement-fiqwvm2, div#coreui-contentplacement-bkhqr5t, div#coreui-contentplacement-ntwsdzm, ';\nvar div_enau = 'div#StoreLocations-HighlightHero-0qj0sa2, div#coreui-contentplacement-pwrxlcn, ';\nvar div_row = 'div.m-channel-placement a';\nvar allLocales = \"\" + usAndSingapore + div_enCa + div_frca + div_frfr + div_jajp + div_dede + div_engb + div_enau + div_row;\n\ntry {\n\t$(document).on('mousedown', allLocales, '', function () {\n\t\tif (debug) { console.log(\"Tag is running\") }\n\n\t\t// to prevent the US site from running the Microsoft store promise section\n\t\tvar ehn = $(this).attr(\"data-bi-ehn\");\n\t\tif (ehn && ehnsToAvoid.includes(ehn)) {\n\t\t\tfireTags = 0;\n\t\t\tif (debug) {console.log(\"avoiding\")}\n\t\t}\n\n\t\tvar rand = parseInt(Math.random() * 10000000000000);\n\t\tif (fireTags) {\n\t\t\tBootstrapper.imageRequest(\"https://ats.everesttech.net/ats/ats?cmd=ACTION&MerchantID=MICROSOFTSTORE&ActionID=50188&ActionName=Store_Site_Visit&cachebuster=\" + rand);\n\t\t\tBootstrapper.imageRequest(\"https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&ea=SurfaceButtonClick\");\n\t\t\tBootstrapper.imageRequest(\"https://secure.adnxs.com/px?id=1268102&t=2\");\n\t\t}\n\t\tfireTags = 1;\n\n\t});\n} catch (clkerr) { console.log(\"sale page err\"); }",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RL591f593703cb481b8a8e6531e1c69d10",
      "name": "FBCVF",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 60.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/customCode.js",
          "settings": {
            "source": function(event, target) {
  return (window.location.host.toLowerCase()=="query.prod.cms.rt.microsoft.com");
}
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "try\n{\n\tvar marketMap = {\n\t\t\"AT\": \"562684790554330\",  \n\t\t\"AU\": \"284489665351238\", // iProspect\n\t\t\"BE\": \"1441341485948213\", // iProspect  (FR) \n\t\t\"BR\": \"1351385668312384\", // iProspect\n\t\t\"CA\": \"822106911286239\", // iProspect\n\t\t\"CH\": \"1701617263415580\",   \n\t\t\"CN\": \"1675926909345981\", \n\t\t\"DE\": \"108292966463738\",  // iProspect\n\t\t\"DK\": \"254705608267657\",  // iProspect\n\t\t\"ES\": \"1626525834066953\",  // iProspect\n\t\t\"FI\": \"1719588481615214\", \n\t\t\"FR\": \"824192544408978\", // iProspect\n\t\t\"GB\": \"120587825211084\", // iProspect\n\t\t\"HK\": \"539267979583843\", \n\t\t\"IE\": \"249404655562787\", // IProspect (added 9/13/17)\n\t\t\"IN\": \"1974106256199230\",  // (EN) iProspect\n\t\t\"IR\": \"172987109739933\",  \n\t\t\"IT\": \"1598310580201695\",  // iProspect\n\t\t\"JP\": \"288860468248601\", // iProspect\n\t\t\"KR\": \"1413279412072377\", // iProspect\n\t\t\"MX\": \"113583175941450\",  // iProspect\n\t\t\"NL\": \"656219287899900\", // iProspect\n\t\t\"NO\": \"1675926909345981\",  \n\t\t\"NZ\": \"1925863447693257\", // iProspect 9/13/17\n\t\t\"PH\" : \"109126313071654\", // iProspect  (NEW)\n\t\t\"PT\" : \"1368140109922230\",\n\t\t\"RU\": \"514282922073511\",  \n\t\t\"SE\": \"1400129366740315\", // iProspect\n\t\t\"SG\": \"1240252356085595\", // iProspect\n\t\t\"TW\": \"266771177060777\",  // iProspect\n\t\t\"US\": \"141890703034968\" // iProspect\n\t};\n\n\tvar llfbmap = {\n\t\t\"fr-ca\": \"165913903949482\",  \n\t\t\"hi-in\": \"1419329368162069\", \n\t\t\"nl-be\": \"129122374248830\", \n\t\t\"de-ch\": \"1674321202841213\", // iProspect\n\t\t\"never\": \"1111111111111111\"\n\t};\n\n\tvar feedID=\"\";\n\tvar baseurl=\"\",imgurl=\"\";\n\tvar ts = new Date().valueOf();\n\tvar contentIDs=\"\";\n\tvar i=0;\n\tvar pidstringarr=[];\n\tvar pnamearr=[];\n\n\ttry {\n\t\tif(_TMDL && marketMap[(_TMDL.geo).toUpperCase()] ){\n\t\t\tfeedID = marketMap[(_TMDL.geo).toUpperCase()].toLowerCase();\n\t\t}\n\t} catch(err) {}\n\n\ttry {\n\t\tif(_TMDL && llfbmap[(_TMDL.ll).toLowerCase()]){\n\t\t\tfeedID = llfbmap[(_TMDL.ll).toLowerCase()].toLowerCase();\n\t\t}\n\t} catch(llerr) {}\n\n\n\tif (_TMDL.cc==\"Unknown\" && _TMDL.geo==\"US\") {\n\t\t_TMDL.cc=\"USD\";\n\t}\n\n\n\tfor (i=0; i<_TMDL.pidsku.length;i++){\n\t\tpidstringarr.push('\"'+_TMDL.pidsku[i]+'\"');\n\t\tpnamearr.push('\"'+_TMDL.pnames[i]+'\"');\n\t}\n\n\n\tif (feedID && _TMDL.isprod) {\n\t\tbaseurl = \"https://www.facebook.com/tr?id=\"; \n\t\tif (_TMDL.pageType==\"cart\") {\n\t\t\timgurl = \"&ev=AddToCart\"+\"&dpo=LDU&dpoco=0&dpost=0\"\n\t\t\t\t+\"&ts=\"+ts\n\t\t\t\t+\"&cd[product_catalog_id]=\"+feedID\n\t\t\t\t+\"&cd[content_ids]=[\"+encodeURIComponent(pidstringarr.join(\",\")) + \"]\"\n\t\t\t\t+\"&cd[content_names]=[\"+encodeURIComponent(pnamearr.join(\",\")) + \"]\"\n\t\t\t\t+\"&cd[content_type]=product\";\n\n\t\t\t   \tBootstrapper.imageRequest(baseurl+\"1770559986549030\"+imgurl);\n\t\n\t\t} else if (_TMDL.pageType==\"receipt\") {\t\n\t\t\timgurl = \"&ev=Purchase\"+\"&dpo=LDU&dpoco=0&dpost=0\"\n\t\t\t\t+\"&ts=\"+ts\n\t\t\t\t+\"&cd[currency]=\"+_TMDL.cc\n\t\t\t\t+\"&cd[value]=\"+_TMDL.totamount\n\t\t\t\t+\"&cd[product_catalog_id]=\"+feedID\n\t\t\t\t+\"&cd[content_ids]=[\"+encodeURIComponent(pidstringarr.join(\",\")) + \"]\"\n\t\t\t\t+\"&cd[content_names]=[\"+encodeURIComponent(pnamearr.join(\",\")) + \"]\"\n\t\t\t\t+\"&cd[content_type]=product\"\n\t\t\t\t+\"&cd[order_id]=\"+_TMDL.purchaseID;\n\n\t\t\t          \tBootstrapper.imageRequest(baseurl+\"1770559986549030\"+imgurl);\n          \n\t\t\tif (_TMDL.geo.toLowerCase()==\"sg\") {\n\t\t\t\t// SG CMO pixel\n\t\t\t\tBootstrapper.imageRequest(\"https://www.facebook.com/tr?id=1264846640217138&ev=PageView&noscript=1\");\n\t\t\t\tBootstrapper.imageRequest(baseurl+\"1264846640217138\"+imgurl);\t\t\t\n\t\t\t}\n\t\t\t\n\t\t\tif (_TMDL.geo.toLowerCase()==\"gb\") {\n\t\t\t\tBootstrapper.imageRequest(baseurl+\"1093198564158197\"+imgurl);\t\n\t\t\t}\n\n\t\t}\n\t}\n}\ncatch(err)\n{\n\tif (typeof(_TMutils) !== \"undefined\") {_TMutils.logRuleCall(\"FB CVF\",err.message,imgurl);}\n\t_satellite.logger.error(\"FB CVF\");\t\n}\n\n\n\n\n\n\n\n",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RLa7f4e9bd070e4fedb22dccc5fbfd1f05",
      "name": "DCM.HomeBar",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 50.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/path.js",
          "settings": {
            "paths": [
              {
                "value": "/en-us/store/b/sale"
              },
              {
                "value": "/en-us/store/b/sale/"
              },
              {
                "value": "/fr-ca/store/b/sale/"
              },
              {
                "value": "/fr-ca/store/b/sale/"
              },
              {
                "value": "/en-ca/store/b/sale"
              },
              {
                "value": "/en-ca/store/b/sale/"
              },
              {
                "value": "/en-gb/store/b/student"
              },
              {
                "value": "/en-gb/store/b/student/"
              },
              {
                "value": "/fr-fr/store/b/student"
              },
              {
                "value": "/fr-fr/store/b/student/"
              },
              {
                "value": "/de-de/store/b/student"
              },
              {
                "value": "/de-de/store/b/student/"
              }
            ]
          }
        },
        {
          "modulePath": "core/src/lib/conditions/domain.js",
          "settings": {
            "domains": [
              "microsoft.com"
            ]
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "try {\njQuery(\"#uhf-g-nav\").on(\"mousedown\", function(){\n    Bootstrapper.imageRequest(\"https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1=\"+_TMDL.geo+\";u2=\"+_TMDL.ll+\";u6=\"+encodeURIComponent(_TMDL.pagename)+\";u25=\"+_TMDL.pids[0]+\";u26=\"+encodeURIComponent(_TMDL.pnames[0])+\";u50=Homebar Options \"+\";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1?\");\n\t});\n} \ncatch(err) {\n\t_satellite.logger.error(\"DCM.Homebar\");\n}",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RL76a8462d758d4a46b290f35986c7b088",
      "name": "OffAmobeeCV",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 60.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/customCode.js",
          "settings": {
            "source": function(event, target) {
  return (window.location.host.toLowerCase()=="query.prod.cms.rt.microsoft.com" && ~window.location.search.indexOf("pN=congrats"));
}
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "/*\nOffice Amobee Turn CV\n*/\ntry\n{\n\tvar ps;\n\tvar inScope=0;\n\n\tvar u1=\"https://d.turn.com/r/dd/id/L21rdC84ODQvY2lkLzE3NDc0Nzk4MzYvdC8y/kv/\"\n\t\t+\"qty=\"+_TMDL.totqty\n\t\t+\",langlocale=\"+_TMDL.ll\n\t\t+\",currency=\"+_TMDL.cc\n\t\t+\",liqty=\"+_TMDL.quantities.join(\"_\")\n\t\t+\",lirev=\"+_TMDL.sales.join(\"_\")\n\t\t+\",orderid=\"+_TMDL.purchaseID\n\t\t+\",product=\"+encodeURIComponent(_TMDL.pnames.join(\"_\"))\n\t\t+\",conversio=ConsPurchase,market=\"+_TMDL.ll\n\t\t+\",typg=congrats,offerid=\"+_TMDL.pidsku.join(\"_\");\n\tdbugimgurl = u1;\n\tvar u2=\"https://r.turn.com/r/beacon?b2=BR7c3AESZXq9Insb7vIh5jSMguWT7u7Yff10h-EMyivou6cxrU_k3avmwgRgF-V1ngmFZWpmYYcTkFV2hicvfQ&cid=\"+_TMDL.cc+\"&bprice=\"+_TMDL.totamount;\n\t\t\n\tfor (var i=0; i<_TMDL.pidsku.length; i++) {\n\t\tps = _TMDL.pidsku[i].toUpperCase();\n\t\tif (ps==\"CFQ7TTC0K5DM-007R\" || ps==\"CFQ7TTC0K5DM-007W\"){\n\t\t\t// Home Annual\n\t\t\tinScope=1;\n\t\t} else if (ps==\"CFQ7TTC0K5FB-0002\" || ps==\"CFQ7TTC0K5FC-0002\" || ps==\"CFQ7TTC0K5FB-000D\" || ps==\"CFQ7TTC0K5FC-000C\") {\n\t\t\t// Home and Student 2016 (for Mac and Windows SKUs)\n\t\t\tinScope=1;\t\t\n\t\t} \n\t}\n\n\tif (~_TMDL.pageType.indexOf(\"receipt\") && _TMDL.isprod) {\n\t\tBootstrapper.imageRequest(u1); \n\t\tif (inScope==1) {dbugimgurl = u2;Bootstrapper.imageRequest(u2);}\n\t}\n}\ncatch(err)\n{\n\tif (typeof(_TMutils) !== \"undefined\") {_TMutils.logRuleCall(\"OffAmoBeeCV\",err.message,dbugimgurl);}\n\t_satellite.logger.error(\"OffAmoBeeCV\");\t\n}\n",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RL427b9e2007e24b8fb1e06bfec30434ac",
      "name": "IRLP",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 50.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/customCode.js",
          "settings": {
            "source": function(event, target) {
  return (window.location.host.toLowerCase()=="www.microsoft.com");
}
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "try\n{\n\tvar marketMap = {\n\t\t'NZ' : 'A1143145-4ed3-453a-8ac9-f0c166db12591',\n\t\t'AU' : 'A1143145-4ed3-453a-8ac9-f0c166db12591',\n\t\t'CA' : 'A1143100-98df-45ee-8c6e-2dec4e6eb56e1',\n\t\t'BG' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',\n\t\t'RU' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1', //added for CEE\n\t\t'HR' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',\n\t\t'CY' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',\n\t\t'HU' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',\n\t\t'SK' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',\n\t\t'EE' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',\n\t\t'CZ' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',\n\t\t'GR' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',\n\t\t'LT' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',\n\t\t'PL' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',\n\t\t'FR' : 'A1143111-30b6-46be-bbab-c7bbbca8eb991',\n\t\t'TW' : 'A1143121-28a1-47b0-8a2c-8128049efd901',\n\t\t'HK' : 'A1143121-28a1-47b0-8a2c-8128049efd901',\n\t\t'CN' : 'A1143121-28a1-47b0-8a2c-8128049efd901',\n\t\t'DE' : 'A1143124-6b0f-4685-b9ab-e289200ad2901',\n\t\t'IN' : 'A1143126-787b-4983-ad6f-e804972459e91',\n\t\t'JP' : 'A1143130-b81e-4371-9b61-b590cea59c051',\n\t\t'BO' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',\n\t\t'DO' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',\n\t\t'GT' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',\n\t\t'HN' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',\n\t\t'PA' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',\n\t\t'PY' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',\n\t\t'SV' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',\n\t\t'VE' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',\n\t\t'EC' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',\n\t\t'CR' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',\n\t\t'PE' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',\n\t\t'CL' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',\n\t\t'AR' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',\n\t\t'MX' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',  // was MEX\n\t\t'BR' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',\n\t\t'BS' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',\n\t\t'BB' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',\n\t\t'CO' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',\n\t\t'JM' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',\n\t\t'NI' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',\n\t\t'TT' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',\n\t\t'UY' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',\n\t\t'BH' : 'A1143144-62f4-44be-93a3-7c960374e2961',\n\t\t'MA' : 'A1143144-62f4-44be-93a3-7c960374e2961',\n\t\t'OM' : 'A1143144-62f4-44be-93a3-7c960374e2961',\n\t\t'QA' : 'A1143144-62f4-44be-93a3-7c960374e2961',\n\t\t'NG' : 'A1143144-62f4-44be-93a3-7c960374e2961',\n\t\t'KW' : 'A1143144-62f4-44be-93a3-7c960374e2961',\n\t\t'EG' : 'A1143144-62f4-44be-93a3-7c960374e2961',\n\t\t'SA' : 'A1143144-62f4-44be-93a3-7c960374e2961',\n\t\t'IL' : 'A1143144-62f4-44be-93a3-7c960374e2961',\n\t\t'ZA' : 'A1143144-62f4-44be-93a3-7c960374e2961',\n\t\t'TR' : 'A1143144-62f4-44be-93a3-7c960374e2961',\n\t\t'AE' : 'A1143144-62f4-44be-93a3-7c960374e2961', // was UAE\n\t\t'PH' : 'A1143145-4ed3-453a-8ac9-f0c166db12591',\n\t\t'TH' : 'A1143145-4ed3-453a-8ac9-f0c166db12591',\n\t\t'ID' : 'A1143145-4ed3-453a-8ac9-f0c166db12591',\n\t\t'MY' : 'A1143145-4ed3-453a-8ac9-f0c166db12591',\n\t\t'KR' : 'A1143145-4ed3-453a-8ac9-f0c166db12591',\n\t\t'SG' : 'A1143145-4ed3-453a-8ac9-f0c166db12591',\n\t\t'GB' : 'A1143151-5b4f-4392-9e5d-0d32d4dda7b21',\n\t\t'UK' : 'A1143151-5b4f-4392-9e5d-0d32d4dda7b21',\n\t\t'PR' : 'A1133099-331c-4cdf-89b0-06dc20e168021', // map to US\n\t\t'US' : 'A1133099-331c-4cdf-89b0-06dc20e168021',\n\t\t'LU' : 'A1143167-163d-430c-aa98-4062268d1ce01', // was LUX\n\t\t'BE' : 'A1143167-163d-430c-aa98-4062268d1ce01',\n\t\t'IE' : 'A1143151-5b4f-4392-9e5d-0d32d4dda7b21', // map to GB/UK\n\t\t'AT' : 'A1143124-6b0f-4685-b9ab-e289200ad2901', // map to DE\n\t\t'NL' : 'A1143167-163d-430c-aa98-4062268d1ce01',\n\t\t'FI' : 'A1143167-163d-430c-aa98-4062268d1ce01',\n\t\t'DK' : 'A1143167-163d-430c-aa98-4062268d1ce01',\n\t\t'NO' : 'A1143167-163d-430c-aa98-4062268d1ce01',\n\t\t'SE' : 'A1143167-163d-430c-aa98-4062268d1ce01',\n\t\t'PT' : 'A1143167-163d-430c-aa98-4062268d1ce01',\n\t\t'IT' : 'A1143167-163d-430c-aa98-4062268d1ce01',\n\t\t'ES' : 'A1143167-163d-430c-aa98-4062268d1ce01',\n\t\t'CH' : 'A1143124-6b0f-4685-b9ab-e289200ad2901',  // map to DE\n\t\t// FR\n\t\t'RE' : 'A1143111-30b6-46be-bbab-c7bbbca8eb991',\n\t\t'NC' : 'A1143111-30b6-46be-bbab-c7bbbca8eb991',\n\t\t'AD' : 'A1143111-30b6-46be-bbab-c7bbbca8eb991',\n\t\t// APAC TH\n\t\t'VN' : 'A1143145-4ed3-453a-8ac9-f0c166db12591',\n\t\t'PF' : 'A1143145-4ed3-453a-8ac9-f0c166db12591',\n\t\t'KH' : 'A1143145-4ed3-453a-8ac9-f0c166db12591',\n\t\t'LA' : 'A1143145-4ed3-453a-8ac9-f0c166db12591',\n\t\t//'GA' : 'A1143145-4ed3-453a-8ac9-f0c166db12591', removed to map to MEA\n\n\t\t// FI\n\t\t'IS' : 'A1143167-163d-430c-aa98-4062268d1ce01',\n\t\t'GL' : 'A1143167-163d-430c-aa98-4062268d1ce01',\n\t\t// IN\n\t\t'PK' : 'A1143126-787b-4983-ad6f-e804972459e91',\n\t\t'LK' : 'A1143126-787b-4983-ad6f-e804972459e91',\n\t\t'BD' : 'A1143126-787b-4983-ad6f-e804972459e91',\n\t\t'NP' : 'A1143126-787b-4983-ad6f-e804972459e91',\n\t\t'MM' : 'A1143126-787b-4983-ad6f-e804972459e91',\n\t\t// LATAM\n\t\t'GP' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',\n\t\t'KY' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',\n\t\t// NL\n\t\t'AW' : 'A1143167-163d-430c-aa98-4062268d1ce01',\n\t\t// US\n\t\t'GU' : 'A1133099-331c-4cdf-89b0-06dc20e168021',\n\t\t'BM' : 'A1133099-331c-4cdf-89b0-06dc20e168021',\n\t\t'VI' : 'A1133099-331c-4cdf-89b0-06dc20e168021',\n\t\t// UK\n\t\t'JE' : 'A1143151-5b4f-4392-9e5d-0d32d4dda7b21',\n\t\t// CEE\n\t\t'RO' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',  // added to CEE\n\t\t'UA' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',  // added to CEE\n\t\t'SI' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',  // added to CEE\n\t\t'MT' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',  // added to CEE\n\t\t'LV' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',  // added to CEE\n\t\t'MU' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',  // added to CEE\n\t\t'KZ' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',  // added to CEE\n\t\t'RS' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',  // added to CEE\n\t\t'BY' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',  // added to CEE\n\t\t'BA' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',  // added to CEE\n\t\t'GE' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',  // added to CEE\n\t\t'AL' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',  // added to CEE\n\t\t'AM' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',  // added to CEE\n\t\t'MK' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',  // added to CEE\n\t\t'MD' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',  // added to CEE\n\t\t'AZ' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',  // added to CEE\n\t\t'UZ' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1'  // added to CEE\n\t\t// Everything else map to MEA\n\t};\n\n\tvar mapstring=\"\";\n\tvar u=\"\";\n\n\tif(_TMDL && marketMap[(_TMDL.geo).toUpperCase()] ){mapstring = marketMap[(_TMDL.geo).toUpperCase()];}\n\t\n\tif (mapstring==\"\") {\n\t\t// map to MEA as catchall\n\t\tmapstring = 'A1143144-62f4-44be-93a3-7c960374e2961';\n\t}\n\n\tu = \"https://d.impactradius-event.com/\"+mapstring+\".js\";\n\n\t(function (a, b, c, d, e, f, g) {\n\t\te['ire_o'] = c;\n\t\te[c] = e[c] || function () {\n\t\t\t(e[c].a = e[c].a || []).push(arguments);\n\t\t};\n\t\tf = d.createElement(b);\n\t\tg = d.getElementsByTagName(b)[0];\n\t\tf.async = 1;\n\t\tf.src = a;\n\t\tif (a) {\n\t\t\tg.parentNode.insertBefore(f, g);\n\t\t}\n\t})(u, 'script', 'ire', document, window);\n\n\tire('identify', {customerId: '', customerEmail: ''});\n}\ncatch(err)\n{\n\t_satellite.logger.error(\"IRLP\");\t\n}",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RL157bd311b6164957a5cb7ea6964a05e9",
      "name": "AMOCV",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 60.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/customCode.js",
          "settings": {
            "source": function(event, target) {
  return (window.location.host.toLowerCase()=="query.prod.cms.rt.microsoft.com" && ~window.location.search.indexOf("pN=congrats"));
}
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "// AMOCV\n\ntry \n{\n\tvar marketMap = {\n\t\"TR\" : \"MEA_TR\",\n\t\"KE\" : \"MEA_KE\",\n\t\"ZA\" : \"MEA_ZA\",\n\t\"IL\" : \"MEA_IL\",\n\t\"AE\" : \"MEA_AE\",\n\t\"EG\" : \"MEA_EG\",\n\t\"SA\" : \"MEA_SA\",\n\t\"PK\" : \"MEA_PK\",\n\t\"NG\" : \"MEA_NG\",\n\t\"QA\" : \"MEA_QA\",\n\t\"KW\" : \"MEA_KW\",\n\t\"LE\" : \"MEA_LE\",\n\t\"ZW\" : \"MEA_ZW\",\n\t// phase 2 and 3\n\n\t'BE' : 'WE_BE',\n\t'CN' : 'APAC_CHINA',\n\t'CZ' : 'CEE_CZ',\n\t'GR' : 'WE_GR',\n\t'HU' : 'CEE_HU',\n\t'LU' : 'WE_LU',\n\t'NL' : 'WE_NL',\n\t'PL' : 'CEE_PL',\n\t'RO' : 'CEE_RO',\n\t'RU' : 'CEE_RU',\n\t'SK' : 'CEE_SK',\n\t'CL' : 'LATAM_CL',\n\t'CR' : 'LATAM_CR',\n\t'DK' : 'WE_DK',\n\t'FI' : 'WE_FI',\n\t'MX' : 'LATAM_MX',\n\t'NO' : 'WE_NO',\n\t'PE' : 'LATAM_PE',\n\t'PR' : 'LATAM_PR',\n\t'SE' : 'WE_SE',\n\t'TT' : 'LATAM_TT',\n\t'AR' : 'LATAM_AR',\n\t'AT' : 'WE_AT',\n\t'BR' : 'LATAM_BR',\n\t'CO' : 'LATAM_CO',\n\t'FR' : 'WE_FR',\n\t'ID' : 'APAC_ID',\n\t'IE' : 'WE_IE',\n\t'IT' : 'WE_IT',\n\t'MY' : 'SEA_MY',\n\t'PH' : 'SEA_PH',\n\t'PT' : 'WE_PT',\n\t'SG' : 'SEA_SG',\n\t'ES' : 'WE_ES',\n\t'CH' : 'WE_CH',\n\t'TH' : 'APAC_TH',\n\t'AU' : 'SEA_AU',\n\t'DE' : 'WE_DE',\n\t'IN' : 'INDIA_IN',\n\t'NZ' : 'SEA_NZ',\n\t'GB' : 'WE_GB',\n\t'CA' : 'NA_CA',\n\t'HK' : 'SEA_HK',\n\t'JP' : 'APAC_JP',\n\t'KR' : 'SEA_KO',\n\t'TW' : 'GCR_TW',\n\t'US' : 'NA_US',\n\n\t// added 2/28/18\n\t'AZ' : 'CEE_CZ',\n\t'BY' : 'CEE_CZ',\n\t'BG' : 'CEE_CZ',\n\t'HR' : 'CEE_CZ',\n\t'KZ' : 'CEE_CZ',\n\t'LV' : 'CEE_CZ',\n\t'SI' : 'CEE_CZ',\n\t'UA' : 'CEE_CZ',\n\t'EE' : 'CEE_CZ',\n\n\t// added 3/27/18\n\t'VN' : 'SEA_VN'\n\n\t};\n\n\tvar prefix=\"\",userid=\"4249\";\n\n\ttry {\n\t\tif(_TMDL && marketMap[(_TMDL.geo).toUpperCase()] ){\n\t\t\tprefix = marketMap[(_TMDL.geo).toUpperCase()].toLowerCase();\n\t\t}\n\t} catch(err) {if (typeof(_TMutils) !== \"undefined\") {_TMutils.logRuleCall(\"AMO CV\",err.message,\"No AMO GEO Match\");}}\n\n\t//var prefix = 'SEA_SG';  // hardcode for now until next wave of markets \n\n\tif ((_TMDL.geo).toUpperCase()==\"CN\") {userid=\"4559\";}\n\n\tvar imgurl=\"\",\n\ttotamount=0,\n\tdebugstring=\"\",\n\tcc=(_TMDL.cc)?_TMDL.cc.toLowerCase() : \"\",\n\tclvamount=0;\n\n\t//var skus2update=[[\"P2W-00004\",10],[\"QR2-00011\",10],[\"RU2-00004\",10],[\"6GQ-00364\",5],[\"QQ2-00031\",5],[\"6GQ-00241\",5],[\"AAA-04580\",5],[\"R4T-00009\",5],[\"R4T-00010\",5]]; // updated 11/17/15\n\tvar skus2update=[[\"P2W-00004\",1]];\n\n\tvar clvlineitem=0;\n\n\tfor (var i=0; i<_TMDL.sales.length;i++) {\n\t\tif (parseFloat(_TMDL.sales[i]) > 0) {\n\t\t\ttotamount += parseFloat(_TMDL.sales[i]);\n\t\t}\n\t\t// check for a match against the SKUs with a multiplier\n\t\tclvlineitem=parseFloat(_TMDL.sales[i]);\n\t\tfor (var j=0; j<skus2update.length; j++) {\t\t\t\n\t\t\tif (_TMDL.skus[i].toLowerCase()==skus2update[j][0].toLowerCase()) {\n\t\t\t\t// sku matches, update price by applying multiplier\n\t\t\t\t// multiplier is second item in the nested array\n\t\t\t\tclvlineitem = parseFloat(skus2update[j][1]*_TMDL.sales[i]);\n\t\t\t} \n\t\t}\n\t\tclvamount+=clvlineitem;\n\t}\n\n\t//---------------------------------------\n\t// added for Office CPA bidding 8/9/17\n\t//---------------------------------------\n\n\tvar ev_officeHomeAnnual=\"\",\n\t\tev_officePersonalAnnual=\"\",\n\t\tev_officeHomeStudent=\"\",\n\t\tev_officeHomeMonthly=\"\",\n\t\tev_officePersonalMonthly=\"\",\n\t\tev_officeOther=\"\";\n\n\tvar ev_officeHomeAnnual_rev=0,\n\t\tev_officePersonalAnnual_rev=0,\n\t\tev_officeHomeStudent_rev=0,\n\t\tev_officeHomeMonthly_rev=0,\n\t\tev_officePersonalMonthly_rev=0,\n\t\tev_officeOther_rev=0;\n\t\n\tvar otherSKUS=[\n\t['CFQ7TTC0K5F8'],\n\t['CFQ7TTC0K5FD'],\n\t['CFQ7TTC0K5FF'],\n\t['CFQ7TTC0K5BB'],\n\t['CFQ7TTC0K5BC'],\n\t['CFQ7TTC0K5BD'],\n\t['8N0LL43Q1H85'],\n\t['CFQ7TTC0K5DZ'],\n\t['CFQ7TTC0K5F2'],\n\t['CFQ7TTC0K5F3'],\n\t['CFQ7TTC0K5BH'],\n\t['CFQ7TTC0K5D6'],\n\t['CFQ7TTC0K5D7'],\n\t['CFQ7TTC0K5CD'],\n\t['CFQ7TTC0K5CF'],\n\t['CFQ7TTC0K5CP'],\n\t['CFQ7TTC0K5CS'],\n\t['CFQ7TTC0K5CT'],\n\t['CFQ7TTC0K5D0'],\n\t['CFQ7TTC0K5DN']\n\t];\n\n\tvar ps=\"\",officeCPAstring=\"\";\n\n\tfor (var i=0; i<_TMDL.pids.length; i++) {\n\t\tif (_TMDL.pidsku.length > i) {\n\t\t\tps = _TMDL.pidsku[i].toUpperCase();\n\t\t\tif (ps==\"CFQ7TTC0K5DM-007R\" || ps==\"CFQ7TTC0K5DM-007W\"){\n\t\t\t\tev_officeHomeAnnual=1;\n\t\t\t\tev_officeHomeAnnual_rev+=parseFloat(_TMDL.sales[i]);\n\t\t\t} else if (ps==\"CFQ7TTC0K5BF-007R\" || ps==\"CFQ7TTC0K5BF-007V\"){\n\t\t\t\tev_officePersonalAnnual=1;\n\t\t\t\tev_officePersonalAnnual_rev+=parseFloat(_TMDL.sales[i]);\n\t\t\t} else if (ps==\"CFQ7TTC0K5FB-0002\" || ps==\"CFQ7TTC0K5FC-0002\" || ps==\"CFQ7TTC0K5FB-000D\" || ps==\"CFQ7TTC0K5FC-000C\") {\n\t\t\t\tev_officeHomeStudent=1;\t\t\n\t\t\t\tev_officeHomeStudent_rev+=parseFloat(_TMDL.sales[i]);\n\t\t\t} else if (ps==\"CFQ7TTC0K5DM-007P\" || ps==\"CFQ7TTC0K5DM-007V\"){\n\t\t\t\tev_officeHomeMonthly=1;\n\t\t\t\tev_officeHomeMonthly_rev+=parseFloat(_TMDL.sales[i]);\n\t\t\t} else if (ps==\"CFQ7TTC0K5BF-007Q\" || ps==\"CFQ7TTC0K5BF-007S\"){\n\t\t\t\tev_officePersonalMonthly=1;\t\t\t\n\t\t\t\tev_officePersonalMonthly_rev+=parseFloat(_TMDL.sales[i]);\n\t\t\t}\n\t\t}\n\t\tfor (var j=0; j<otherSKUS.length; j++) {                                \n\t\t\tif (_TMDL.pids[i].toLowerCase()==otherSKUS[j][0].toLowerCase()) { \n\t\t\t\tev_officeOther = 1;\n\t\t\t\tev_officeOther_rev+=parseFloat(_TMDL.sales[i]);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tif (ev_officeHomeAnnual) {\n\t\tofficeCPAstring+=\"&ev_officeHomeAnnual=1\";\n\t\tofficeCPAstring+=\"&ev_officeHomeAnnual_rev=\"+ev_officeHomeAnnual_rev;\n\t}\n\tif (ev_officePersonalAnnual) {\n\t\tofficeCPAstring+=\"&ev_officePersonalAnnual=1\";\n\t\tofficeCPAstring+=\"&ev_officePersonalAnnual_rev=\"+ev_officePersonalAnnual_rev;\n\t}\n\tif (ev_officeHomeStudent) {\n\t\tofficeCPAstring+=\"&ev_officeHomeStudent=1\";\n\t\tofficeCPAstring+=\"&ev_officeHomeStudent_rev=\"+ev_officeHomeStudent_rev;\n\t}\n\tif (ev_officeHomeMonthly) {\n\t\tofficeCPAstring+=\"&ev_officeHomeMonthly=1\";\n\t\tofficeCPAstring+=\"&ev_officeHomeMonthly_rev=\"+ev_officeHomeMonthly_rev;\n\t}\n\tif (ev_officePersonalMonthly) {\n\t\tofficeCPAstring+=\"&ev_officePersonalMonthly=1\";\n\t\tofficeCPAstring+=\"&ev_officePersonalMonthly_rev=\"+ev_officePersonalMonthly_rev;\n\t}\n\tif (ev_officeOther) {\n\t\tofficeCPAstring+=\"&ev_officeOther=1\";\n\t\tofficeCPAstring+=\"&ev_officeOther_rev=\"+ev_officeOther_rev;\n\t}\n\n\t//---------------------------\n\t// end office CPA addition\n\t//---------------------------\n\n\tif (_TMDL.pageType==\"receipt\" && _TMDL.isprod) {\n\t\t//imgurl=\"//pixel.everesttech.net/px2/4249?px_evt=t&ev_\"+prefix+\"_order=1&ev_revenue=\"+totamount+\"&ev_\"+prefix+\"_revenue=\"+totamount+\"&ev_currency_code=\"+_TMDL.cc+\"&ev_transid=\"+_TMDL.purchaseID;\n\t\timgurl=\"https://pixel.everesttech.net/px2/\"+userid+\"?px_evt=t\"\n\t\t\t+\"&ev_order=1\"\n\t\t\t+\"&ev_revenue=\"+totamount\n\t\t\t+\"&ev_clv_revenue=\"+clvamount\n\t\t\t+\"&ev_\"+cc+\"_currency_code=1\"\n\t\t\t+\"&ev_\"+prefix+\"_order=1\"\n\t\t\t+\"&ev_\"+prefix+\"_revenue=\"+totamount\n\t\t\t+\"&ev_\"+prefix+\"_clv_revenue=\"+clvamount\n\t\t\t+\"&ev_transid=\"+_TMDL.purchaseID\n\t\t\t+officeCPAstring;\n\t}\n\n\t//SAMPLE:  http://pixel.everesttech.net/px2/4249?px_evt=t&ev_order=1&ev_revenue=2.38&ev_clv_revenue=2.38&ev_mkd_currency_code=1&ev_mea_tr_order=1&ev_mea_tr_revenue=2.38&ev_mea_tr_clv_revenue=2.38&ev_transid=test999999\n\n\tdebugstring=\"\"+totamount+\": \"+_TMDL.totamount+\"   clv: \"+clvamount;\n\n\tif (imgurl && prefix && _TMDL.isprod && _TMDL.pageType==\"receipt\") {\n\t\tBootstrapper.imageRequest(imgurl);\n\t}\n} catch(err)\n{\n\t_satellite.logger.error(\"AMO CV\");\t\n}\n\n\n",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RLdd9cb2d8786b4d0493ea469b80845b11",
      "name": "Media_/en-gb/store/cart Twitter",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 50.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/path.js",
          "settings": {
            "paths": [
              {
                "value": "/en-gb/store/cart",
                "valueIsRegex": true
              }
            ]
          }
        },
        {
          "modulePath": "core/src/lib/conditions/domain.js",
          "settings": {
            "domains": [
              "microsoft.com"
            ]
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "try\n{\n//Page View  \nvar image = new Image(1, 1);\nimage.src =\"https://analytics.twitter.com/i/adsct?p_id=Twitter&p_user_id=0&txn_id=nzzcs&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0&type=image&version=1.1.0\";\n  \nvar image2 = new Image(1, 1);\nimage2.src =\"//t.co/i/adsct?p_id=Twitter&p_user_id=0&txn_id=nzzcs&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0&type=image&version=1.1.0\";  \n\n\n }\ncatch(err)\n{\n\t_satellite.logger.error(\"Media_/en-gb/store/cart Twitter\");\n}\n",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RL245f9ce34bfa4f3d8082b7eaf6a88731",
      "name": "OFF_AMO_ADNXS_CV",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 60.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/customCode.js",
          "settings": {
            "source": function(event, target) {
  return (window.location.host.toLowerCase()=="query.prod.cms.rt.microsoft.com" && ~window.location.search.indexOf("pN=congrats"));
}
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "/* OFF_AMO_ADNXS_CV */\n\n\nvar isTrial=0;\nvar inScope=0;\nvar trialskus = {\n\t\"cfq7ttc0k5bc-0003\" : 1,\n\t\"cfq7ttc0k5dm-007n\" : 1,\n\t\"cfq7ttc0k5dm-007q\" : 1,\n\t\"cfq7ttc0k5dm-007s\" : 1,\n\t\"cfq7ttc0k5dm-00hq\" : 1,\n\t\"cfq7ttc0k5dm-00hr\" : 1\n};\n\n// added for Alta\nvar office365bigids = {\n\t\"cfq7ttc0k5bf\" : 1,\n\t\"cfq7ttc0k5dm\" : 1,\n\t\"cfq7ttc0k5bc\" : 1,\n\t\"8pc5bjbhn74p\" : 1, //new\n\t\"94cm694vj57p\" : 1, //new\n\t\"900rpbx20ts6\" : 1, //new\n\t\"93r684wj71vj\" : 1, //new\n\t\"8v9j0t4jfz6w\" : 1, //new\n\t\"cfq7ttc0k5bd\" : 1,\n\t\"8nfjc88fkmrz\" : 1, //new\n\t\"8szwm812t6n1\" : 1, //new\n\t\"cfq7ttc0k5bg\" : 1, //new\n\t\"8v883x3j1v40\" : 1  //new\n};\n\nfor (var i = 0; i < _TMDL.pidsku.length; i++) {\n  // update check to also look for office365bigids to adapt to Alta\n\tif (_TMDL.pnames && (~_TMDL.pnames[i].toLowerCase().indexOf(\"office\") || ~_TMDL.pnames[i].toLowerCase().indexOf(\"o365\") || ~_TMDL.pnames[i].toLowerCase().indexOf(\"off365\") || office365bigids[_TMDL.pids[i].toLowerCase()]==1 )  && trialskus[_TMDL.pidsku[i].toLowerCase()]!==1) {\n\t\tinScope=1;\n\t}\n}\n\nvar amourl,adnxurl;\n\ntry {\n  if (inScope) {\n      adnxurl = \"https://secure.adnxs.com/px?id=1089341&order_id=\"+_TMDL.purchaseID+\"&other=\"+_TMDL.pidsku.join(\"_\")+\"&t=2\";\n      Bootstrapper.imageRequest(adnxurl);\n\n      amourl = \"https://pixel.everesttech.net/px2/5584?px_evt=t&ev_ConsPurchase=1\"+\n          \"&ev_transaction_market_\"+_TMDL.geo+\"=1\"+\n          \"&ev_items=\"+_TMDL.totqty+\n          \"&ev_currency_\"+_TMDL.cc+\"=1\"+\n          \"&ev_revenue=\"+_TMDL.totamount+\n          \"&ev_transid=\"+_TMDL.purchaseID;\n      Bootstrapper.imageRequest(amourl);\n  }\n} catch(err) {_satellite.logger.log(\"OFF_AMO_ADNXS_CV ERR\");}\n\n\n",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RL8d9a434b8bda46f6962536ba8508db38",
      "name": "Personal Shopper AU- Facebook",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 50.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/path.js",
          "settings": {
            "paths": [
              {
                "value": "/en-au/store/b/online-computer-shopping-appointments",
                "valueIsRegex": true
              }
            ]
          }
        },
        {
          "modulePath": "core/src/lib/conditions/domain.js",
          "settings": {
            "domains": [
              "microsoft.com"
            ]
          }
        },
        {
          "modulePath": "core/src/lib/conditions/dateRange.js",
          "settings": {
            "end": "2022-01-31T00:00:00Z",
            "start": "2021-11-11T00:00:00Z"
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "try\n{\n// Facebook\n jQuery(\"a#coreui-highlightfeature-v8eiq2s-0\").on(\"mousedown\", function(){\nvar image = new Image(1, 1);\nimage.src =\"https://www.facebook.com/tr?id=1770559986549030&amp&ev=CompleteRegistration&cd[content_names]=[\"+encodeURIComponent(_TMDL.pagename) + \"]\";\n  \n });\n }\ncatch(err)\n{\n\t_satellite.logger.error(\"Personal Shopper AU- Facebook\");\n}\n",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RLe39a0c628c1f4bda9ac9927f913e881c",
      "name": "Media_/EN-US/Business Consultation Signup Facebook (AEM/RT)",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 50.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/path.js",
          "settings": {
            "paths": [
              {
                "value": "/en-us/store/b/business-consultation",
                "valueIsRegex": true
              }
            ]
          }
        },
        {
          "modulePath": "core/src/lib/conditions/domain.js",
          "settings": {
            "domains": [
              "microsoft.com"
            ]
          }
        },
        {
          "modulePath": "core/src/lib/conditions/dateRange.js",
          "settings": {
            "end": "2022-07-01T00:00:00Z",
            "start": "2021-07-12T00:00:00Z"
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "try\n{\n// Facebook pixel\n$('a[href*=\"https://digitalreservations.microsoft.com/en-us/appointment/create\"]').on(\"mousedown\", function () {\n    var image = new Image(1, 1);\n    image.src =\"https://www.facebook.com/tr?id=1770559986549030&ev=CompleteRegistration&cd%5Bcontent_names%5D=%5Bbusiness%20consultation%20-%20allmodules%5D&dt=1l9jpcf0884e2ejscx0mouivuhqnr3hy\";\n});\n\n }\ncatch(err)\n{\n\t_satellite.logger.error(\"Media_/EN-US/Business Consultation Signup Facebook (AEM/RT)\");\n}\n\n",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RL2444c1412bfa470391b29c2cc1b3311e",
      "name": "Media_/LL-LL/Reddit Surface PV (AEM/RT)",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 50.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/path.js",
          "settings": {
            "paths": [
              {
                "value": "(us|au|gb)\\/d\\/surface",
                "valueIsRegex": true
              }
            ]
          }
        },
        {
          "modulePath": "core/src/lib/conditions/dateRange.js",
          "settings": {
            "end": "2022-07-01T00:00:00Z",
            "start": "2021-11-03T00:00:00Z"
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "try\n{\n//Reddit Surface Pixel\nvar image = new Image(1, 1);\nimage.src =\"https://alb.reddit.com/rp.gif?id=t2_ch5mi&event=PageVisit&integration=noscript\";\n\n}\ncatch(err)\n{\n\t_satellite.logger.error(\"Media_/LL-LL/Reddit Surface PV (AEM/RT)\");\n}\n",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RL4d95565cb7de40e784c80ee275c7b124",
      "name": "TikTok_LP",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 60.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/customCode.js",
          "settings": {
            "source": function(event, target) {
  return (window.location.host.toLowerCase()=="www.microsoft.com");
}
          }
        },
        {
          "modulePath": "core/src/lib/conditions/path.js",
          "settings": {
            "paths": [
              {
                "value": "/(en-us|en-gb|fr-fr|de-de)",
                "valueIsRegex": true
              }
            ]
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "try\n{\n!function (w, d, t) {\n  w.TiktokAnalyticsObject=t;var ttq=w[t]=w[t]||[];ttq.methods=[\"page\",\"track\",\"identify\",\"instances\",\"debug\",\"on\",\"off\",\"once\",\"ready\",\"alias\",\"group\",\"enableCookie\",\"disableCookie\"],ttq.setAndDefer=function(t,e){t[e]=function(){t.push([e].concat(Array.prototype.slice.call(arguments,0)))}};for(var i=0;i<ttq.methods.length;i++)ttq.setAndDefer(ttq,ttq.methods[i]);ttq.instance=function(t){for(var e=ttq._i[t]||[],n=0;n<ttq.methods.length;n++)ttq.setAndDefer(e,ttq.methods[n]);return e},ttq.load=function(e,n){var i=\"https://analytics.tiktok.com/i18n/pixel/events.js\";ttq._i=ttq._i||{},ttq._i[e]=[],ttq._i[e]._u=i,ttq._t=ttq._t||{},ttq._t[e]=+new Date,ttq._o=ttq._o||{},ttq._o[e]=n||{};var o=document.createElement(\"script\");o.type=\"text/javascript\",o.async=!0,o.src=i+\"?sdkid=\"+e+\"&lib=\"+t;var a=document.getElementsByTagName(\"script\")[0];a.parentNode.insertBefore(o,a)};\n\n//part2\n  ttq.load('C5S71GC247CAE4T3VM1G');\n  ttq.page();\n}(window, document, 'ttq');\n\n}\ncatch(err)\n{\n\t_satellite.logger.error(\"TikTok LP\");\n}",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RL81d828f12cec453ba0309f909a2aaf39",
      "name": "Media_/EN-US/d/surface Twitter (AEM/RT)",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 60.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/domain.js",
          "settings": {
            "domains": [
              "microsoft.com"
            ]
          }
        },
        {
          "modulePath": "core/src/lib/conditions/path.js",
          "settings": {
            "paths": [
              {
                "value": "/en-us/d/surface",
                "valueIsRegex": true
              },
              {
                "value": "/en-us/d/surface/",
                "valueIsRegex": true
              }
            ]
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "try {\n  \n  //Page Load\n  var image = new Image(1,1);\n  image.src = \"https://analytics.twitter.com/i/adsct?p_id=Twitter&p_user_id=0&txn_id=o4co9&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0&type=image&version=1.1.0\";\n  var image2 = new Image(1,1);\n  image2.src=\"//t.co/i/adsct?p_id=Twitter&p_user_id=0&txn_id=o4co9&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0&type=image&version=1.1.0\";\n\n  \n   //Configure Now button\njQuery(\"a:contains('Configure now'),button:contains('Configure now')\").on(\"mousedown\", function(){\nvar image = new Image(1,1);\n  image.src = \"https://analytics.twitter.com/i/adsct?p_id=Twitter&p_user_id=0&txn_id=o4co9u&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0&type=image&version=1.1.0\";\nvar image2 = new Image(1,1);  \n  image2.src=\"//t.co/i/adsct?p_id=Twitter&p_user_id=0&txn_id=o4co9&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0&type=image&version=1.1.0\";\n});\n  \n   //Surface Laptop Go for Business Button\njQuery(\"[href='https://www.microsoft.com/en-us/p/surface-laptop-go-for-business/8NR6D2WCLC72?icid=PDP_LaptopGo_forbusiness_C97_060421']\").on(\"mousedown\", function(){\nvar image = new Image(1,1);\n  image.src = \"https://analytics.twitter.com/i/adsct?p_id=Twitter&p_user_id=0&txn_id=o4co9&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0&type=image&version=1.1.0\";\nvar image2 = new Image(1,1);\n  image2.src=\"//t.co/i/adsct?p_id=Twitter&p_user_id=0&txn_id=o4co9&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0&type=image&version=1.1.0\";\n});\n\n}\ncatch(err)\n{\n\t_satellite.logger.error(\"Media_/EN-US/d/surface Twitter (AEM/RT)\");\n}",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RL289b7578fe5749c98866fb2212076816",
      "name": "Surface_XANDR /d/ LP",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 70.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/path.js",
          "settings": {
            "paths": [
              {
                "value": "/en-us/d/surface-go/8v9dp4lnknsz",
                "valueIsRegex": true
              },
              {
                "value": "/en-us/d/surface-book-2/8mcpzjjcc98c",
                "valueIsRegex": true
              }
            ]
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "if (~window.location.pathname.toLowerCase().indexOf(\"surface\") && ~window.location.pathname.toLowerCase().indexOf(\"/d/\")) {\n\tif (~window.location.pathname.toLowerCase().indexOf(\"/en-us/d/surface-go/8v9dp4lnknsz\")){\n\t\tBootstrapper.imageRequest(\"https://secure.adnxs.com/px?id=1182093&seg=19686450&t=2\");\t\n\t} else if (~window.location.pathname.toLowerCase().indexOf(\"/en-us/d/surface-book-2/8mcpzjjcc98c\")){\n\t\tBootstrapper.imageRequest(\"https://secure.adnxs.com/px?id=1182149&seg=19686725&t=2\");\t\t\n\t} \t\n}",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RL10436da76aec413189e4b07115fde524",
      "name": "Media_/LL-LL/Commercial Consultation Tag (RT)",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 50.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/path.js",
          "settings": {
            "paths": [
              {
                "value": "/en-au/store/b/business-consultation",
                "valueIsRegex": true
              },
              {
                "value": "/en-au/store/b/business-consultation/",
                "valueIsRegex": true
              },
              {
                "value": "/en-gb/store/b/business-consultation/",
                "valueIsRegex": true
              },
              {
                "value": "/en-gb/store/b/business-consultation",
                "valueIsRegex": true
              }
            ]
          }
        },
        {
          "modulePath": "core/src/lib/conditions/domain.js",
          "settings": {
            "domains": [
              "microsoft.com"
            ]
          }
        },
        {
          "modulePath": "core/src/lib/conditions/dateRange.js",
          "settings": {
            "end": "2021-11-05T00:00:00Z",
            "start": "2021-06-21T00:00:00Z"
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "\ntry\n{\n// Floodlight pv\nvar image = new Image(1, 1);\nimage.src =\"https://ad.doubleclick.net/ddm/activity/src=8406733;type=corpothe;cat=corpo0;u1=\"+_TMDL.geo+\";u2=\"+_TMDL.ll+\";u6=\"+encodeURIComponent(_TMDL.pagename)+\";u25=\"+_TMDL.pids[0]+\";u26=\"+encodeURIComponent(_TMDL.pnames[0])+\";u52=Visit;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;gdpr=${GDPR};gdpr_consent=${GDPR_CONSENT_755};ord=1?\";  \n  \n// Floodlight Click\nvar image = new Image(1, 1);\njQuery(\"a.c-hyperlink:Lt(1),a.c-call-to-action:Lt(1)\").on(\"mousedown\", function(){  \nvar image = new Image(1, 1);\nimage.src =\"https://ad.doubleclick.net/ddm/activity/src=8406733;type=corpothe;cat=corpo000;u1=\"+_TMDL.geo+\";u2=\"+_TMDL.ll+\";u6=\"+encodeURIComponent(_TMDL.pagename)+\";u25=\"+_TMDL.pids[0]+\";u26=\"+encodeURIComponent(_TMDL.pnames[0])+\";u50=Book a Consultation;u52=Click;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;gdpr=${GDPR};gdpr_consent=${GDPR_CONSENT_755};ord=1?\";\n\n//Xandr\nimage2 = new Image(1, 1); \nimage2.src=\"https://secure.adnxs.com/px?id=1488447&t=2\";\n\n});\n\n}\ncatch(err)\n{\n\t_satellite.logger.error(\"Media_/LL-LL/Consumer Consultation Tag (RT)\");\n}\n\n",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RL45841b807ebc4e208726abe1ec8503f4",
      "name": "XboxGrCPE_PMP /EN-US/ (AEM/RT)",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 70.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/domain.js",
          "settings": {
            "domains": [
              "microsoft.com"
            ]
          }
        },
        {
          "modulePath": "core/src/lib/conditions/path.js",
          "settings": {
            "paths": [
              {
                "value": "/en-us/store/b/xbox",
                "valueIsRegex": true
              }
            ]
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "//OVERWRITES jquery contains to make it case insensitive\njQuery.expr[':'].contains = function(a, i, m) {\n  return jQuery(a).text().toUpperCase()\n      .indexOf(m[3].toUpperCase()) >= 0;\n};\n\nvar debug=0,fireDCM=1;\nvar ll=_TMDL.geo.toLowerCase();\n\nfunction attachAnalyticsToElement(elementAddress, actionName, actionURL) {\n\t$(document).on('mousedown', elementAddress, '', function() {\n\t\tif (debug) { \n\t\t\tconsole.log(actionName); \n\t\t}\n\n\t\tvar j={},pid=\"\",cN=\"\",u=\"\",hr=\"\";\n\t\tvar\ta = \"\" + (Math.random() * 10000000000000);\n\n\t\ttry {\n\t\t\tj=JSON.parse($(this).attr(\"data-m\"));\n\t\t\tpid = j.pid;\n\t\t\tcN= j.cN;\n\t\t\t//hr=this.href;\n\t\t} catch(proderr) {\n\t\t\tif (debug) { \n\t\t\t\tconsole.log(\"catch \"+ actionName + \" \" + hr); \n\t\t\t}\n\t\t}\n\n\t\tu=actionURL + \";u1=\"\n\t\t+_TMDL.geo\n\t\t+\";u2=\"+_TMDL.ll\n\t\t+\";u6=\"+encodeURIComponent(window.location.pathname)\n\t\t+\";u25=\"+pid\n\t\t+\";u26=\"+encodeURIComponent(cN)\n\t\t+\";u50=\"+encodeURIComponent(cN)\n\t\t+\";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=\"\t+ a + \"?\";\n\n\t\tif (debug) { \n\t\t\tconsole.log(actionName+\" u25=\"+pid+\" u26=\"+cN+\"\\t\"+u); \n\t\t}\n\n\t\tif (fireDCM) {\n\t\t\tBootstrapper.imageRequest(u);\n\t\t}\n\t});\n}\n\n\nif (ll==\"us\" || ll==\"ca\" || ll==\"gb\" || ll==\"au\") {\n\ttry {\n\t\tattachAnalyticsToElement(\n\t\t\t'a.small-icon, a.f-image',\n\t\t\t'Hero banner click on Learn More or Free Return & Shipping Icons above the hero',\n\t\t\t'https://ad.doubleclick.net/ddm/activity/src=8391491;type=xbxp;cat=lrn_std');\n\n\t\tattachAnalyticsToElement(\n\t\t\t\"div[id*='oneStore-quicklinksmodule-'] a.large-icon, div[id*='coreui-hero-'] ul li:contains('SHOP NOW'), div[id*='coreui-hero-'] ul li:contains('Shop now')\",\n\t\t\t'Hero banner click on Shop Now or icon menu below banner',\n\t\t\t'https://ad.doubleclick.net/ddm/activity/src=8391491;type=xbxp;cat=pchn_std');\n\n\t\tattachAnalyticsToElement(\n\t\t\t\"div[id*='coreui-hero-'] ul li:contains('Learn more')\",\n\t\t\t'Hero banner click on Learn More',\n\t\t\t'https://ad.doubleclick.net/ddm/activity/src=8391491;type=xbxp;cat=lrn_std');\n\n\t\tattachAnalyticsToElement(\n\t\t\t\"div:contains('Shop') section.m-content-placement-item, div:contains('Join') section.m-content-placement-item\",\n\t\t\t'Click on c-call-to-action Shop Now',\n\t\t\t'https://ad.doubleclick.net/ddm/activity/src=8391491;type=xbxp;cat=pchn_std');\n\n\t\tattachAnalyticsToElement(\n\t\t\t\"div[id*='coreui-productplacement'] div.m-channel-placement-item, div[id*='coreui-productplacement'] a.c-hyperlink\",\n\t\t\t'Click on m-channel-placement on the product trays',\n\t\t\t'https://ad.doubleclick.net/ddm/activity/src=8391491;type=xbxp;cat=pchn_std');\n\n\t\tattachAnalyticsToElement(\n\t\t\t\"div:contains('Learn more') section.m-content-placement-item\",\n\t\t\t'Click on c-call-to-action Learn More',\n\t\t\t'https://ad.doubleclick.net/ddm/activity/src=8391491;type=xbxp;cat=lrn_std');\n\t} catch(clkerr) {\n\t\tconsole.log(\"Xbox PMP CPE Error\");\n\t}\n}",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RL35f46b2def3744e68e9b97e4f36cdc6a",
      "name": "GlobalSurfaceEngagements/Yahoo-Xndr-Adobe",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 50.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/path.js",
          "settings": {
            "paths": [
              {
                "value": "(us|gb|jp|ca|de|au|es|nl|fr)/.*surface",
                "valueIsRegex": true
              }
            ]
          }
        },
        {
          "modulePath": "core/src/lib/conditions/sessions.js",
          "settings": {
            "count": 1,
            "operator": "="
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "// GlobalSurfaceEngagements/Yahoo-Xndr-Adobe\nvar micClick = 'p > a[href]';\nvar micClick2 = 'div > a[href]';\nvar micClick3 = 'span > a[href]';\nvar micClick3 = 'u > a[href]';\nvar micClick4 = 'font > a[href]';\nvar secondConfig = 'button[data-action*=\"Configure\"]';\nvar cardClick = 'div[class*=\"slide-item\"]';\nvar hasClicked = false;\n\nfunction attachPixels(elementAddress) {\n    $(document).on('mousedown', elementAddress, '', function () {\n        if (!hasClicked) {\n            let varInt = parseInt(Math.random() * 10000000000000);;\n            var image1 = new Image(1, 1);\n            image1.src = 'https://ats.everesttech.net/ats/ats?cmd=ACTION&MerchantID=MICROSOFTSTORE&ActionID=50188&ActionName=MSFT_Store_SiteEngagement&custom1=$$SOME_CP_MACRO$$&cachebuster=' + varInt;\n\n            var image2 = new Image(1, 1);\n            image2.src = \"https://secure.adnxs.com/px?id=1268102&t=2\";\n\n            var image3 = new Image(1, 1);\n            image3.src = \"https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&ea=SurfaceButtonClick\";\n            hasClicked = true;\n        }\n\n    });\n}\n\ntry {\n    attachPixels(micClick);\n    attachPixels(micClick2);\n    attachPixels(micClick3);\n    attachPixels(micClick4);\n    attachPixels(secondConfig);\n    attachPixels(cardClick);\n}\ncatch (err) {\n    _satellite.logger.error(\"Global Engagements\");\n}",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RL8911370103d74c219b6171527af1b357",
      "name": "Media_/EN-US/Commercial Consultation Tag (AEM/RT)",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 50.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/path.js",
          "settings": {
            "paths": [
              {
                "value": "/en-us/store/b/business-consultation",
                "valueIsRegex": true
              },
              {
                "value": "/en-us/store/b/business-consultation/",
                "valueIsRegex": true
              }
            ]
          }
        },
        {
          "modulePath": "core/src/lib/conditions/domain.js",
          "settings": {
            "domains": [
              "microsoft.com"
            ]
          }
        },
        {
          "modulePath": "core/src/lib/conditions/dateRange.js",
          "settings": {
            "end": "2022-08-01T00:00:00Z",
            "start": "2021-06-21T00:00:00Z"
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "try {\n\t// Floodlight pv\n\tvar image = new Image(1, 1);\n\timage.src = \"https://ad.doubleclick.net/ddm/activity/src=8406733;type=corpothe;cat=corpo0;u1=\" + _TMDL.geo + \";u2=\" + _TMDL.ll + \";u6=\" + encodeURIComponent(_TMDL.pagename) + \";u25=\" + _TMDL.pids[0] + \";u26=\" + encodeURIComponent(_TMDL.pnames[0]) + \";u52=Visit;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;gdpr=${GDPR};gdpr_consent=${GDPR_CONSENT_755};ord=1?\";\n\n\tvar image2 = new Image(1, 1);\n\timage2.src = \"https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&he={INSERT_MACRO_HERE}&ea=USAlandingpagevisit\";\n\n\t$('a[href*=\"https://digitalreservations.microsoft.com/en-us/appointment/create\"]').on(\"mousedown\", function () {\n\t\tvar data = JSON.parse($(this).attr(\"data-m\"));\n\t\tvar cN = data[\"cN\"];\n\n\t\tvar imageCl = new Image(1, 1);\n\t\timageCl.src = \"https://ad.doubleclick.net/ddm/activity/src=8406733;type=corpothe;cat=corpo000;u1=\" + _TMDL.geo + \";u2=\" + _TMDL.ll + \";u6=\" + encodeURIComponent(_TMDL.pagename) + \";u25=\" + _TMDL.pids[0] + \";u26=\" + encodeURIComponent(_TMDL.pnames[0]) + \";u50=\"+ cN + \";u52=Click;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;gdpr=${GDPR};gdpr_consent=${GDPR_CONSENT_755};ord=1?\";\n\t});\n}\ncatch (err) {\n\t_satellite.logger.error(\"Media_/EN-US/Commercial Consultation Tag (AEM/RT)\");\n}\n",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RL3846f5bb89ac402c9528c708ad36d21f",
      "name": "SurfaceGrowthCPE",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 50.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/domain.js",
          "settings": {
            "domains": [
              "microsoft.com"
            ]
          }
        },
        {
          "modulePath": "core/src/lib/conditions/path.js",
          "settings": {
            "paths": [
              {
                "value": "(us|ca|de|au|gb|sg|fr|jp)\\/p\\/surface-book-3",
                "valueIsRegex": true
              },
              {
                "value": "(us|ca|de|au|gb|sg|fr|jp)\\/p\\/surface-go-2",
                "valueIsRegex": true
              },
              {
                "value": "(us|ca|de|au|gb|sg|fr|jp)\\/d\\/surface-book-3",
                "valueIsRegex": true
              },
              {
                "value": "(us|ca|de|au|gb|sg|fr|jp)\\/d\\/surface-go-2",
                "valueIsRegex": true
              }
            ]
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "// OVERWRITES jquery contains to make it case insensitive\njQuery.expr[':'].contains = function(a, i, m) {\n  return jQuery(a).text().toUpperCase()\n      .indexOf(m[3].toUpperCase()) >= 0;\n};\n\nvar debug=0,fireDCM=1;\nvar ll=_TMDL.geo.toLowerCase();\n\nfunction attachAnalyticsToElement(elementAddress, actionName, actionURL) {\n\t$(document).on('mousedown', elementAddress, '', function() {\n\t\tif (debug) { \n\t\t\tconsole.log(actionName); \n\t\t}\n\n\t\tvar j={},pid=\"\",cN=\"\",u=\"\",hr=\"\";\n\t\tvar\ta = \"\" + (Math.random() * 10000000000000);\n\n\t\ttry {\n\t\t\tj=JSON.parse($(this).attr(\"data-m\"));\n\t\t\tpid = j.pid;\n\t\t\tcN= j.cN;\n\t\t\t//hr=this.href;\n\t\t} catch(proderr) {\n\t\t\tif (debug) { \n\t\t\t\tconsole.log(\"catch \"+ actionName + \" \" + hr); \n\t\t\t}\n\t\t}\n\n\t\tu=actionURL + \";u1=\"\n\t\t+_TMDL.geo\n\t\t+\";u2=\"+_TMDL.ll\n\t\t+\";u6=\"+encodeURIComponent(window.location.pathname)\n\t\t+\";u25=\"+pid\n\t\t+\";u26=\"+encodeURIComponent(cN)\n\t\t+\";u50=\"+encodeURIComponent(cN)\n\t\t+\";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=\"\t+ a + \"?\";\n\n\t\tif (debug) { \n\t\t\tconsole.log(actionName+\" u25=\"+pid+\" u26=\"+cN+\"\\t\"+u); \n\t\t}\n\n\t\tif (fireDCM) {\n\t\t\tBootstrapper.imageRequest(u);\n\t\t}\n\t});\n}\n\ntry {\n\tattachAnalyticsToElement(\n\t\t\"div#coreui-contentplacement-25bhfyl section.m-content-placement-item, div#coreui-contentplacement-34ednys section.m-content-placement-item, div#coreui-banner-0drta14 a\",\n\t\t'Configurations Add to Cart',\n\t\t'https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std');\n} catch(clkerr) {\n\tconsole.log(\"Surface PDP Configs CPE Error\");\n}\n\n\n",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RLab2298c7467f48a6ad45da5d885a3a2d",
      "name": "AUSurfSMB",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 70.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/customCode.js",
          "settings": {
            "source": function(event, target) {
  return (~window.location.href.toLowerCase().indexOf("www.microsoft.com/en-au/p/surface-pro-6-for-business-choice-of-accessory/8p88kcx6r5s7") 
    || ~window.location.href.toLowerCase().indexOf("www.microsoft.com/en-au/d/surface-pro-6-for-business-choice-of-accessory/8p88kcx6r5s7")
    || ~window.location.href.toLowerCase().indexOf("www.microsoft.com/en-au/p/surface-book-2-for-business-choice-of-accessory/8pcw0wkflz2x")
	|| ~window.location.href.toLowerCase().indexOf("www.microsoft.com/en-au/d/surface-book-2-for-business-choice-of-accessory/8pcw0wkflz2x")
	|| ~window.location.href.toLowerCase().indexOf("www.microsoft.com/en-au/store/b/business")	
	)
}
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "/*  AU Surface SMB \n\nCampaign:  AU Surface SMB\nContact: Lauren Ward @ Carat\nTags:  Outbrain, DV360\n*/\n\n// Landing Page Tags\n\n// DV360 Activity Name: Microsoft_LP_landing page\nvar\ta = \"\" + (Math.random() * 10000000000000);\nBootstrapper.imageRequest('https://ad.doubleclick.net/ddm/activity/src=6487971;type=invmedia;cat=micro00;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;ord=' + a + '?');\n// Appnexus Microsoft_LP_landing page\nBootstrapper.imageRequest(\"https://secure.adnxs.com/px?id=1120808&seg=18111539&t=2\");\n\n\n$(document).on('mousedown','button[id*=\"buttons_BuildABundleButton\"]','', function() {\n\t// Outbrain\n\tBootstrapper.imageRequest(\"https://tr.outbrain.com/pixel?marketerId=00fbc5a6837b6c040daa1e33bdf0cadcaa&name=lead\");\n\t// DV360 Activity Name:  Microsoft_Int_button click\n\tBootstrapper.imageRequest(\"https://ad.doubleclick.net/ddm/activity/src=6487971;type=invmedia;cat=micro000;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;ord=1?\");\n\t// Appnexus Microsoft_Int_button click\n\tBootstrapper.imageRequest(\"https://secure.adnxs.com/px?id=1120809&seg=18111541&t=2\");\n});\n",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RLce4a6bfbd6d944ca9c40cf443cb714a6",
      "name": "SundaySkyCart",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 50.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/customCode.js",
          "settings": {
            "source": function(event, target) {
  return (window.location.host.toLowerCase()=="query.prod.cms.rt.microsoft.com" && ~window.location.search.indexOf("pN=cart"));
}
          }
        },
        {
          "modulePath": "core/src/lib/conditions/dateRange.js",
          "settings": {
            "end": "2023-08-01T00:00:00Z",
            "start": "2023-03-20T00:00:00Z"
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "// SundaySkyCart\ntry {\n    var rand1 = parseInt(Math.random() * 10000000000000);\n    var rand2 = parseInt(Math.random() * 10000000000000);\n    var rand3 = parseInt(Math.random() * 10000000000000);\n    var rand4 = parseInt(Math.random() * 10000000000000);\n    \n    var image = new Image(1, 1);\n    image.src = \"https://s-vop.sundaysky.com/t/v1/img?a=microsoft&ap=1&pb=f&sp=https://www.microsoft.com/\" + _TMDL.ll + \"/store/cart&cb=\" + rand1 +\"&m=cart&udt[segment]=[visitor,cart]&udt[userid]=[USER_ID]&udt[sku]=\" + _TMDL.pids.map(x => x.toUpperCase()) + \"&udt[cat]=\" + _TMDL.prdType + \"&udt[bu]=[surface]&udt[kw]=[KEYWORDS]\";\n\n    var image2 = new Image(1, 1);\n    image2.src = \"https://s-vop.sundaysky.com/t/v1/img?a=microsoft&cb=\" + rand2 +\"&s=1\";\n\n    var image3 = new Image(1, 1);\n    image3.src = \"https://s-vop.sundaysky.com/t/v1/img?a=microsoft&cb=\" + rand3 +\"&s=2\";\n\n    var image4 = new Image(1, 1);\n    image4.src = \"https://s-vop.sundaysky.com/t/v1/img?a=microsoft&cb=\" + rand4 +\"&s=3\";\n} catch {\n    _satellite.logger.error(\"Sunday Sky Cart\");\n}",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RLbabdaaa9429a4087b3d39b2cae35a0ff",
      "name": "Media.Verizon.Surface_081620 (RT)",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 50.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/path.js",
          "settings": {
            "paths": [
              {
                "value": "(/en-ca|/en-au|/en-gb|/fr-fr|fr-ca)\\/p\\/surface",
                "valueIsRegex": true
              },
              {
                "value": "(/en-ca|/en-au|/en-gb|/fr-fr|fr-ca)\\/d\\/surface",
                "valueIsRegex": true
              }
            ]
          }
        },
        {
          "modulePath": "core/src/lib/conditions/domain.js",
          "settings": {
            "domains": [
              "microsoft.com"
            ]
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "try\n{\n  \n//Yahoo\n   //Shop now \njQuery(\"#PromotionBar a\").on(\"mousedown\", function(){\n  var image = new Image(1, 1);\n  image.src = \"https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=10084084&ea=SurfaceButtonClick\";\n});\n //Get started\njQuery(\"#purchaseColumn a\").on(\"mousedown\", function(){\n  var image = new Image(1, 1);\n  image.src = \"https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=10084084&ea=SurfaceButtonClick\";\n});\n //Configure now & Sticky\njQuery('button[id*=\"ConfigureDeviceButton\"]').on(\"mousedown\", function(){\n  var image = new Image(1, 1);\n  image.src = \"https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=10084084&ea=SurfaceButtonClick\";\n});\n  \n}\ncatch(err)\n{\n\t_satellite.logger.error(\"Media.Verizon.Surface_081620(RT)\");\n}\n",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RLf78ee9c5c2c44d33972fc7ed9cab2aab",
      "name": "GOOGCV",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 60.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/customCode.js",
          "settings": {
            "source": function(event, target) {
  return (window.location.host.toLowerCase()=="query.prod.cms.rt.microsoft.com" && ~window.location.search.indexOf("pN=congrats"));
}
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "/* GOOGCV  */\nvar gclidstring = (_satellite.cookie.get(\"_tm_gclid\"))? \"&gclaw=\" + _satellite.cookie.get(\"_tm_gclid\") : \"\";\nvar googcvurl = \"https://www.googleadservices.com/pagead/conversion/923371515/?value=\"+_TMDL.totamount\n\t+\"&currency_code=\"+_TMDL.cc.toUpperCase()\n\t+gclidstring\n\t+\"&label=yOJJCOecrGYQ-4-muAM&guid=ON&script=0\";\n\n\t\nif (_TMDL.isprod) {\n\tBootstrapper.imageRequest(googcvurl);\n}\n\n",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RLef0315aa87014acb9bc9a60708599d11",
      "name": "VRZNLPXbox",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 60.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/domain.js",
          "settings": {
            "domains": [
              "microsoft.com"
            ]
          }
        },
        {
          "modulePath": "core/src/lib/conditions/path.js",
          "settings": {
            "paths": [
              {
                "value": "^/en-us/p/xbox.*",
                "valueIsRegex": true
              },
              {
                "value": "^/de-de/p/xbox.*",
                "valueIsRegex": true
              },
              {
                "value": "^/fr-fr/p/xbox.*",
                "valueIsRegex": true
              },
              {
                "value": "^/en-gb/p/xbox.*",
                "valueIsRegex": true
              },
              {
                "value": "^/en-au/p/xbox.*",
                "valueIsRegex": true
              },
              {
                "value": "^/jp-jp/p/xbox.*",
                "valueIsRegex": true
              },
              {
                "value": "^/en-ca/p/xbox.*",
                "valueIsRegex": true
              },
              {
                "value": "^/fr-ca/p/xbox.*",
                "valueIsRegex": true
              },
              {
                "value": "^/en-us/d/xbox.*",
                "valueIsRegex": true
              },
              {
                "value": "^/de-de/d/xbox.*",
                "valueIsRegex": true
              },
              {
                "value": "^/fr-fr/d/xbox.*",
                "valueIsRegex": true
              },
              {
                "value": "^/en-gb/d/xbox.*",
                "valueIsRegex": true
              },
              {
                "value": "^/en-au/d/xbox.*",
                "valueIsRegex": true
              },
              {
                "value": "^/jp-jp/d/xbox.*",
                "valueIsRegex": true
              },
              {
                "value": "^/en-ca/d/xbox.*",
                "valueIsRegex": true
              },
              {
                "value": "^/fr-ca/d/xbox.*",
                "valueIsRegex": true
              }
            ]
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "try {\n  var image = new Image(1,1);\n  image.src = \"//sp.analytics.yahoo.com/spp.pl?a=10000&.yp=10084084&ea=ViewProduct&product_id=\" + _pageBITags.pageContracts.ProductInfo.id + \"-\" + _pageBITags.pageContracts.ProductInfo.sku;\n}\ncatch(err)\n{\n\t_satellite.logger.error(\"Verizon_LP\");\n}",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RLdd63082829944caab330da98d7c66899",
      "name": "Surface/StoreBusiness/US-GB/Yahoo",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 50.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/path.js",
          "settings": {
            "paths": [
              {
                "value": "/en-us/store/b/business",
                "valueIsRegex": true
              },
              {
                "value": "/en-us/store/b/microsoft-small-business",
                "valueIsRegex": true
              },
              {
                "value": "/en-gb/store/b/business",
                "valueIsRegex": true
              },
              {
                "value": "/en-gb/store/b/microsoft-small-business",
                "valueIsRegex": true
              },
              {
                "value": "/en-us/store/b/surfaceforbusiness",
                "valueIsRegex": true
              }
            ]
          }
        },
        {
          "modulePath": "core/src/lib/conditions/dateRange.js",
          "settings": {
            "end": "2023-08-01T00:00:00Z",
            "start": "2022-07-26T00:00:00Z"
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "var allClicks = 'a[href]';\nvar cardClicks = 'div[class*=\"material-card\"]';\nvar watchVideo = 'a[data-bi-ct*=\"Video\"]';\n\nfunction attachPixels(elementAddress) {\n    $(document).on('mousedown', elementAddress, '', function () {\n        var image = new Image(1, 1);\n        image.src = \"https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&he={INSERT_MACRO_HERE}&auid={INSERT_MACRO_HERE}&ea=UserEngagementConversion\";\n    });\n}\n\ntry {\n    var image = new Image(1, 1);\n    image.src = \"https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&he={INSERT_MACRO_HERE}&auid={INSERT_MACRO_HERE}&ea=LandingPageVisits\";\n\n    attachPixels(allClicks);\n    attachPixels(cardClicks);\n    attachPixels(watchVideo);\n}\ncatch (err) {\n    _satellite.logger.error(\"US-StoreBusiness-Yahoo/Floodlight\");\n}\n",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RL7d79c8419a9a418b8b1c73ae64a0c9e1",
      "name": "DIGSHELL",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 45.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/domain.js",
          "settings": {
            "domains": [
              "microsoft.com"
            ]
          }
        },
        {
          "modulePath": "core/src/lib/conditions/path.js",
          "settings": {
            "paths": [
              {
                "value": "\\/p\\/",
                "valueIsRegex": true
              },
              {
                "value": "\\/d\\/",
                "valueIsRegex": true
              }
            ]
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "try\n{\n\twindow.shell_Tracking = {\n\n\t\t_init: function () {\n\t\t\tshell_Tracking.hostname = window.location.hostname.replace(/\\.microsoft\\.com$/i, '');\n\t\t\tshell_Tracking.URI = window.location.pathname.toString();\n\t\t\t//setup page path dimensions\n\t\t\tshell_Tracking._getPath();\n\t\t},\n\n\t\t_getIsProd: function () {\n\t\t\tvar env = 'test';\n\t\t\tif (shell_Tracking.hostname.match(/\\./g)) {\n\t\t\t\tenv = 'test';\n\t\t\t\tshell_Tracking.env = 'test';\n\t\t\t} else if (window.location.hostname.match(/\\.microsoft\\.com$/i)) {\n\t\t\t\tenv = '';\n\t\t\t\tshell_Tracking.env = 'prod';\n\t\t\t\tshell_Tracking.hostname = 'onestore';\n\t\t\t}\n\t\t\treturn env;\n\t\t},\n\n\t\t_getLocale: function () {\n\t\t\tshell_Tracking.locale = shell_Tracking.URI.replace(/^\\/(..\\-..).*/i, '$1');\n\t\t\tvar locale = shell_Tracking.locale.replace(/\\-/ig, '').replace(/\\//ig, '').toLowerCase();\n\t\t\treturn locale;\n\t\t},\n\n\t\t_removeLocale: function () {\n\t\t\tvar path = shell_Tracking.URI.replace(/^\\/..\\-..\\/?(.*)/i, '$1').toLowerCase();\n\t\t\treturn path;\n\t\t},\n\n\t\t_getPath: function () {\n\t\t\tvar path = shell_Tracking._removeLocale();\n\t\t\tpath = path.replace(/\\/$/, '').replace(/^\\//, '');\n\t\t\tshell_Tracking.path = path;\n\t\t},\n\n\t\t_onBeforePageView: function () {\n\t\t\t/*\n\t\t\tvar authCookie = shell_Tracking._getCookie('StoreMsaUser');\n\t\t\tif (authCookie) {\n\t\t\t\tshell_Tracking.auth = 'y';\n\t\t\t} else {\n\t\t\t\tshell_Tracking.auth = 'n';\n\t\t\t}\n\t\t\t*/\n\t\t},\n\n\t\t_getCookie: function (name) {\n\t\t\tvar nameEQ = name + \"=\";\n\t\t\tvar ca = document.cookie.split(';');\n\t\t\tfor (var i = 0; i < ca.length; i++) {\n\t\t\t\tvar c = ca[i];\n\t\t\t\twhile (c.charAt(0) == ' ') { c = c.substring(1, c.length); }\n\t\t\t\tif (c.indexOf(nameEQ) == 0) { return unescape(c.substring(nameEQ.length, c.length)); }\n\t\t\t}\n\t\t\treturn null;\n\t\t},\n\n\t\t_getMetaValue: function(name) {\n\t\t\treturn $('meta[name=\"' + name + '\"]').attr('content');\n\t\t},\n\n\t\t_recordXboxDigitalPurchase: function (data) {\n\t\t\tvar worksonxbox = ((shell_Tracking._getMetaValue(\"ms\\\\.prod_worksonxbox\") && shell_Tracking._getMetaValue(\"ms\\\\.prod_worksonxbox\")!=='false') || (window.location.pathname.indexOf(\"xbox\") > -1)) ? true : false;\n\t\t\tvar pass_type = shell_Tracking._getMetaValue(\"ms\\\\.prod_pass_type\");\n\t\t\tvar productFamily = shell_Tracking._getMetaValue(\"ms\\\\.prod_family\");\n\t\t\tvar lcpath = window.location.pathname.toLowerCase();\n\n\t\t   var tax = data.lineItems[0].taxAmount;\n\t\t   var price = data.lineItems[0].totalAmount - tax;\n\t\t   \n\t\t\t// original floodlight\n\t\t\t//shell_Tracking._dispatchDCMpurchase(worksonxbox,pass_type,productFamily,data,\"src=6952136;type=store00;cat=store00\");  // added 6/26/17 -- keep as the generic version\n\n\t\t\t\n\t\t\t//xbox live gold : \n\t\t\t\t// \tCFQ7TTC0K5ZM -- physical\n\t\t\t\t// \tcfq7ttc0k5dj -- digital\n\t\t\t\t//   /src=8391497;type=xlg_sale;cat=pch_dgtl;qty=1;cost=[Revenue];\n\t\t\t// games and gamepass:  //src=8406391;type=xgpg_sls;cat=pch_dgtl;qty=1;cost=[Revenue];\n\n\n\n\t\t\tif (~window.location.pathname.toLowerCase().indexOf(\"cfq7ttc0k5zm\") || ~window.location.pathname.toLowerCase().indexOf(\"cfq7ttc0k5dj\")) {\n\t\t\t\t// XboxLiveGold_GBL_PchComplete_Transaction_DigitalStore:  src=8391497;type=xlg_sale;cat=pch_dgtl\n\t\t\t\tshell_Tracking._dispatchDCMpurchase(worksonxbox,pass_type,productFamily,data,\"src=8391497;type=xlg_sale;cat=pch_dgtl\");\n\t\t\t\tif(_TMDL.fbpchurl) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\t//fire facebook purchase pixel\n\t\t\t\t\t\tBootstrapper.imageRequest(_TMDL.fbpchurl+\"&cd[value]=\"+price+\"&cd[order_id]=\"+data.orderId);\n\t\t\t\t\t\tBootstrapper.imageRequest((_TMDL.fbpchurl+\"&cd[value]=\"+price+\"&cd[order_id]=\"+data.orderId).replace(\"464550763913771\",\"1770559986549030\"));\t\t\t\t\t\t\t\n\t\t\t\t\t} catch(fberr) {}\n\t\t\t\t}\n\t\t\t} else if (~lcpath.indexOf(\"cfq7ttc0k6l8\") || ~lcpath.indexOf(\"cfq7ttc0kgq8\") ||~lcpath.indexOf(\"cfq7ttc0khs0\") || (productFamily && productFamily.toLowerCase() == 'passes' && pass_type && pass_type.toLowerCase() == 'xbox') || (productFamily.toLowerCase() == 'games' && (worksonxbox || ~lcpath.indexOf(\"xbox\") ) )) {\n\t\t\t\t//XboxGamePassGames_GBL_PchComplete_Transaction_DigitalStore\t/src=8406391;type=xgpg_sls;cat=pch_dgtl;qty=1;cost=[Revenue];\n\t\t\t\tshell_Tracking._dispatchDCMpurchase(worksonxbox,pass_type,productFamily,data,\"src=8406391;type=xgpg_sls;cat=pch_dgtl\");\n\t\t\t\tif(_TMDL.fbpchurl) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\t//fire facebook purchase pixel\n\t\t\t\t\t\tBootstrapper.imageRequest(_TMDL.fbpchurl+\"&cd[value]=\"+price+\"&cd[order_id]=\"+data.orderId);\n\t\t\t\t\t\tBootstrapper.imageRequest((_TMDL.fbpchurl+\"&cd[value]=\"+price+\"&cd[order_id]=\"+data.orderId).replace(\"464550763913771\",\"1770559986549030\"));\t\t\t\t\t\t\t\n\t\t\t\t\t} catch(fberr) {}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t//WindowsSoftware_GBL_PchComplete_Transaction_DigitalStore:  src=8406157;type=stot_sl;cat=pch_dgtl\n\t\t\t\t//WindowsSoftware_GBL_PchComplete_Transaction_DigitalStore:   src=8406727;type=wsft_sls;cat=pch_dgtl;  (CORRECT ONE)\n\t\t\t\t//Store-Other_GBL_PchComplete_Transaction_DigitalStore:  src=8406391;type=xgpg;cat=pdv_dgtl\n\t\t\t\t\n\t\t\t\t//shell_Tracking._dispatchDCMpurchase(worksonxbox,pass_type,productFamily,data,\"src=8406391;type=xgpg;cat=pdv_dgtl\");\n\t\t\t\tshell_Tracking._dispatchDCMpurchase(worksonxbox,pass_type,productFamily,data,\"src=8406727;type=wsft_sls;cat=pch_dgtl;\");\n\t\t\t}\n\t\t\t\n\t\t\ttry {\n\t\t\t\tif (typeof _TMDL.convcallbacks!=='undefined') {\n\t\t\t\t\tfor (var i=0; i< _TMDL.convcallbacks.length; i++) {\n\t\t\t\t\t\t_TMDL.convcallbacks[i](data,price,tax,data.orderId);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} catch(callbackerr) {}\n\t\t\t\n\t\t},\n\t\t_dispatchDCMpurchase: function(worksonxbox,pass_type,productFamily,data,floodlightparams) {\n\t\t\t// added 6/26/17 -- this will be the older tag from before the DCM restructure\n\t\t\tvar a = \"\" + parseInt(1E5 * 1E4 * Math.random() * Math.random(),10)+ parseInt((Math.random() * 100000000),10);\n\t\t\t//var shell_locale = shell_Tracking.locale || shell_Tracking.URI.replace(/^\\/(..\\-..).*/i, '$1');\n\t\t\t//var geo = shell_locale.split(\"-\")[1];\n\t\t   //var locale = shell_locale.replace(/\\-/ig, '').replace(/\\//ig, '').toLowerCase();\n\t\t   var title = data.lineItems[0].title;\n\t\t   var productType = data.lineItems[0].productType;\n\t\t   var productId = data.lineItems[0].productId;\n\t\t   var availabilityId = data.lineItems[0].availabilityId;\n\t\t   var tax = data.lineItems[0].taxAmount;\n\t\t   var price = data.lineItems[0].totalAmount - tax;\n\t\t   var currencyCode = data.lineItems[0].currencyCode;\n\t\t   //var paymentTypeEvent = '';\n\t\t\tvar url = \"https://ad.doubleclick.net/ddm/activity/\"+floodlightparams+\";qty=1;cost=\"+price+\";u1=\"+_TMDL.geo.toUpperCase()+\";u2=\"+_TMDL.ll\n\t\t\t +\";u25=\"+productId\n\t\t\t +\";u26=\"+encodeURIComponent(title)\n\t\t\t +\";u30=\"+productType\n\t\t\t +\";u31=\"+currencyCode\n\t\t\t +\";u32=\"+productId\n\t\t\t +\";u33=\"+productId\n\t\t\t +\";u34=\"+data.orderId\n\t\t\t //+\";u35=\"+_TMDL.totqty\n\t\t\t +\";u35=1\"\n\t\t\t +\";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=\"+data.orderId;\n\n\t\t var px = new Image(1, 1);\n\t\t px.src = url;\n\t  },\n\t\t\n\t\t_dispatchGamePassGamesRT: function () {\n\t\t\tvar url = \"https://www.facebook.com/tr?id=1218689904914212&ev=PageView&noscript=1\";\n\t\t\tvar px = new Image(1, 1);\n\t\t\tpx.src = url;\n\t\t\tBootstrapper.imageRequest(\"https://googleads.g.doubleclick.net/pagead/viewthroughconversion/968413686/?value=0&guid=ON&script=0\");\n\t\t\tBootstrapper.imageRequest(\"https://bat.bing.com/action/0?ti=4000034&Ver=2\");\n\t\t},\n\n\t};\n\t\n\tvar url=\"\";\n\tvar worksonxbox = shell_Tracking._getMetaValue(\"ms\\\\.prod_worksonxbox\")==\"true\" || (window.location.pathname.toLowerCase().indexOf(\"xbox\") > -1) || (typeof _TMDL.pnames[0] !== 'undefined' && _TMDL.pnames[0].toLowerCase().indexOf(\"xbox\")>-1);\n\tvar type = $('meta[name=\"ms\\\\.prod_type\"]').attr('content') || '';\n\tvar pass_type = $('meta[name=\"ms\\\\.prod_pass_type\"]').attr('content') || '';\n\tif (worksonxbox && type && (type.toLowerCase() == 'games' || type.toLowerCase() == 'addons') || (window.location.pathname.match(/\\/xbox$/i)) || (pass_type && pass_type.toLowerCase() == 'xbox')) {\n\n\t\tshell_Tracking._init();\n\n\t\trequire(['jquery'], function ($) {\n\t\t\t$('document').ready(function () {\n\t\t\t\ttry {\n\t\t\t\t\t//shell_Tracking._onBeforePageView();\n\t\t\t\t\t//shell_Tracking._recordOmniturePageView();\n\t\t\t\t\t//shell_Tracking._initClickTracking();\n\t\t\t\t} catch (ex) { }\n\t\t\t});\n\t\t});\n\t}\n}\ncatch(err)\n{\n\t_satellite.logger.error(\"DIGSHELL\");\t\n}\n\n",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RL6aa63bb8d47c4dd5b51460f0542eefe4",
      "name": "GBLDL",
      "events": [
        {
          "modulePath": "core/src/lib/events/libraryLoaded.js",
          "settings": {
          },
          "ruleOrder": -80.0
        }
      ],
      "conditions": [

      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "try {\n    var _TMDL = {\n        busgrp: [],\n        cc: \"Unknown\",\n        isprod: false,\n        geo: \"\",\n        host: window.location.hostname.toLowerCase(),\n        itemprices: [],\n        lineItems: [],\n        ll: \"other\",\n        muid: \"\",\n        pagename: \"other\",\n        pageName: \"other\",\n        pageType: \"other\",\n        path: window.location.pathname.toLowerCase(),\n        pids: [],\n        pidsku: [],\n        pnames: [],\n        prdCt: [],\n        prdFam: [],\n        prdPrCat: [],\n        prdSecCat: [],\n        prdSubCat: [],\n        prdType: [],\n        pT: \"\",\n        purchaseID: \"\",\n        quantities: [],\n        reflc: \"\",\n        revsumdiv: [],\n        sales: [],\n        skus: [],\n        totamount: 0,\n        totAmountWTax: 0,\n        totqty: 0,\n\n        logRuleCall: function (r, d, i) {\n            if (typeof _TMutils === 'object') {\n                _TMutils.logRuleCall(r, d, i);\n            } else {\n                try {\n                    _satellite.logger.error(\"error in logging and no _satellite obj\");\n                } catch (_saterr) { }\n            }\n        },\n\n        getQSParam: function (arr, param2find) {\n            var n,\n                i = 0,\n                j = arr.length,\n                nvpair = [];\n\n            for (i = 0; i < j; i++) {\n                nvpair = arr[i].split(\"=\");\n                if (nvpair[0].toLowerCase() == param2find.toLowerCase() && nvpair[1]) {\n                    return nvpair[1];\n                }\n            }\n            return \"\";\n        },\n\n        readCookie: function (name) {\n            var nameEQ = name + \"=\";\n            var ca = document.cookie.split(';');\n            for (var i = 0; i < ca.length; i++) {\n                var c = ca[i];\n                while (c.charAt(0) == ' ') c = c.substring(1, c.length);\n                if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length, c.length);\n            }\n            return null;\n        },\n\n        createCookie: function (name, value, days) {\n            var expires = \"\";\n            var date;\n            var domainstr = (~window.location.host.indexOf(\"microsoft.com\")) ? \"; domain=.microsoft.com; path=/; \" : \"; path=/; \";\n            if (days) {\n                date = new Date();\n                date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));\n                expires = \"; expires=\" + date.toGMTString();\n            }\n            document.cookie = name + \"=\" + value + expires + domainstr;\n        }\n    };\n\n    var qs = \"\",\n        qsdecoded = \"\",\n        qs2 = \"\",\n        qsarr = [],\n        jsonstr = \"\",\n        jsonobj = {},\n        jsonstr,\n        pt,\n        pc,\n        ptlower,\n        _pagetypemap = {}\n        ;\n\n    if (document.referrer) {\n        reflc = document.referrer.toLowerCase();\n    }\n\n    qs = (window.location.search) ? window.location.search : \"\";\n    if (qs.indexOf(\"?n=ensighten.html?\") == 0) {\n        qs = qs.substring(17);\n    }\n\n    if (qs.indexOf(\"?\") == 0) {\n        qs = qs.substring(1);\n    }\n\n    qs = qs.replace(/%20&%20/g, \"%20%26%20\");\n    qs = qs.replace(/ & /g, \"%20%26%20\");\n    qsarr = qs.split(\"&\");\n\n    if (~window.location.host.indexOf(\"compass-ssl.xboxlive.com\") || ~window.location.host.indexOf(\"query.prod.cms.rt.microsoft.com\")) {\n        // top level params from iframe:  pN=cart&cl=en-US&market=US\n        _TMDL.purchaseID = _TMDL.getQSParam(qsarr, \"orderId\") || _TMDL.getQSParam(qsarr, \"id\");\n        _TMDL.muid = _TMDL.getQSParam(qsarr, \"muid\");\n        _TMDL.pageName = _TMDL.getQSParam(qsarr, \"pN\");\n        _TMDL.pageType = _TMDL.pageName;\n        _TMDL.geo = _TMDL.getQSParam(qsarr, \"market\");\n        _TMDL.ll = _TMDL.getQSParam(qsarr, \"culture\") || _TMDL.getQSParam(qsarr, \"cl\");\n        _TMDL.totamount = _TMDL.getQSParam(qsarr, \"totAmtWoTx\");\n        _TMDL.totAmountWTax = _TMDL.getQSParam(qsarr, \"totAmt\");\n        jsonstr = _TMDL.getQSParam(qsarr, \"orderLineItems\");\n\n        if (~reflc.indexOf(\"www.microsoft.com\") && window.navigator.userAgent.toLowerCase().indexOf(\"soasta\") < 0) { _TMDL.isprod = true; }\n\n        if (!jsonstr) {\n            _TMDL.logRuleCall(\"orderLineItems json missing\");\n        } else {\n            try {\n                if (jsonstr.indexOf(\"[\") > -1) {\n                    jsonstr = jsonstr.replace(/%22%20Dis/g, '%20Dis');\n                    jsonstr = jsonstr.replace(/portable%2013%22%20/g, 'portable%2013%20');\n                    jsonstr = jsonstr.replace(/%22%204K/g, '%204K');\n                    jsonstr = jsonstr.replace(/%22Samsung%2049%22%20/g, '%22Samsung%2049%20');\n                    jsonstr = jsonstr.replace(/%22%2F/g, '%2F');\n                    jsonstr = jsonstr.replace(/5%22%20%2F/g, '5%2F');\n                    jsonstr = jsonstr.replace(/%223%2F4%22%20/g, '%223%2F4%20');\n                    jsonstr = jsonstr.replace(/15.6%22%20/g, '15.6%20');\n                    jsonstr = jsonstr.replace(/%22/g, '\"');\n                    _TMDL.lineItems = JSON.parse(jsonstr);\n                } else {\n                    jsonstr = jsonstr.replace(/%22%20Dis/g, '%20Dis');\n                    jsonstr = jsonstr.replace(/portable%2013%22%20/g, 'portable%2013%20');\n                    jsonstr = jsonstr.replace(/%22Samsung%2049%22%20/g, '%22Samsung%2049%20');\n                    jsonstr = jsonstr.replace(/%22%204K/g, '%204K');\n                    jsonstr = jsonstr.replace(/%22%2F/g, '%2F');\n                    jsonstr = jsonstr.replace(/5%22%20%2F/g, '5%2F');\n                    jsonstr = jsonstr.replace(/%223%2F4%22%20/g, '%223%2F4%20');\n                    jsonstr = jsonstr.replace(/15.6%22%20/g, '15.6%20');\n                    _TMDL.lineItems = JSON.parse(decodeURIComponent(jsonstr));\n                }\n            } catch (jsonparseerr) { _TMDL.logRuleCall(\"jsonparse error\", \"jsonparse error\", window.location.search); _satellite.logger.error(\"jsonparse error\"); }\n        }\n\n    } else if (typeof _pageBITags == \"object\") {\n        // consume _pageBITags object from the non-iframe pages (e.g. OneRF)\n        pt = _pageBITags.pageTags;\n        ptlower = pt.pageType.toLowerCase();\n        _TMDL.pageName = pt.pageName;\n        _TMDL.ll = pt.mkt;\n        _TMDL.lang = pt.mkt.split(\"-\")[0];\n        _TMDL.geo = pt.mkt.split(\"-\")[1];\n        _TMDL.pageType = pt.pageType;\n        if (~window.location.host.toLowerCase().indexOf(\"www.microsoft.com\") && window.navigator.userAgent.toLowerCase().indexOf(\"soasta\") < 0) { _TMDL.isprod = true; }\n\n        try {\n            _TMDL.muid = _TMDL.readCookie(\"MUID\");\n        } catch (muiderr) { _TMDL.logRuleCall(\"muid err\"); }\n\n        if (~ptlower.indexOf(\"category\")) {\n\n            // CATEGORY PAGE\n\n            // https://onestore-ppe.microsoft.com/en-sg/store/b/surface?icid=CNavDevicesSurface&setswitch=optimizely_disabled%3A1%2Censighten_disabled%3D0\n\n        } else if ((~ptlower.indexOf(\"pdp\") || ~ptlower.indexOf(\"detail\")) && (typeof _pageBITags == \"object\" && typeof _pageBITags.pageContracts == \"object\" && typeof _pageBITags.pageContracts.ProductInfo == \"object\")) {\n            // PDP PAGE\n            pc = _pageBITags.pageContracts.ProductInfo;\n            _TMDL.pids.push(pc.id);\n            _TMDL.skus.push(pc.sku);\n            _TMDL.pidsku.push(pc.id + \"-\" + pc.sku);\n            _TMDL.prdCt.push(pc.prdCt);\n            _TMDL.prdPrCat.push(pc.priCat);\n            _TMDL.prdSecCat.push(pc.prdSecCat);\n            _TMDL.prdSubCat.push(pc.prdSubCat);\n            _TMDL.prdType.push(pc.family);\n            _TMDL.pnames.push(pc.title);\n            _TMDL.cc = pc.cur;\n            _TMDL.quantities.push(1);\n            _TMDL.sales.push(_pageBITags.pageContracts.ProductInfo.rtPrice);\n            _TMDL.quantities.push(1);\n            _TMDL.itemprices.push(_TMDL.sales[0]);\n        } else if ((~ptlower.indexOf(\"pdp\") || ~ptlower.indexOf(\"detail\")) && ~_TMDL.path.indexOf(\"/configure/\")) {\n            ptlower = \"configure\";\n            _TMDL.pageType = \"configure\";\n        }\n    }\n\n    try {\n        // remap pagetypes\n        _pagetypemap = {\n            // old : new\n            \"pdp\": \"detail\",\n            \"product details\": \"detail\",\n            \"sfw-pdp-pagetemplate\": \"detail\",\n            \"sfw-category-pagetemplate\": \"category\",\n            \"onestore-shoppingcart-template\": \"cart\",\n            \"congrats\": \"receipt\"\n        };\n\n        if (_pagetypemap[_TMDL.pageType.toLowerCase()]) {\n            _TMDL.pageType = _pagetypemap[_TMDL.pageType.toLowerCase()];\n        }\n\n        _TMDL.pT = (_TMDL.pageType == \"receipt\") ? \"rP\" : _TMDL.pageType;\n\n        // added 7/12/18 due to Convergence making category pagetype less reliable\n\n        if (~window.location.pathname.indexOf(\"/b/\") && window.location.pathname.indexOf(\"RETg7o\") < 0) {\n            _TMDL.pageType = \"category\";\n        }\n\n    } catch (err) { _TMDL.logRuleCall(\"pageTypeMapError\", _TMDL.pageType); }\n\n    //--------------------------------------------------------\n    // create backwards compatible arrays from orderLineItems\n    //--------------------------------------------------------\n\n    var temppname;\n    for (var i = 0; i < _TMDL.lineItems.length; i++) {\n        temppname = \"\";\n        _TMDL.pids.push((_TMDL.lineItems[i].pId) ? _TMDL.lineItems[i].pId : \"\");\n        _TMDL.skus.push((_TMDL.lineItems[i].sku) ? _TMDL.lineItems[i].sku : \"\");\n        try {\n            temppname = decodeURIComponent(_TMDL.lineItems[i].ti);\n        } catch (pnameerr) {\n            temppname = (_TMDL.lineItems[i].ti) ? _TMDL.lineItems[i].ti : \"\";\n        }\n        _TMDL.pnames.push(temppname);\n        _TMDL.sales.push((_TMDL.lineItems[i].tot && typeof _TMDL.lineItems[i].txA !== 'undefined' && typeof _TMDL.lineItems[i].q !== 'undefined') ? (_TMDL.lineItems[i].tot - (_TMDL.lineItems[i].q * _TMDL.lineItems[i].txA)) : _TMDL.lineItems[i].tot);\n        _TMDL.prdPrCat.push((_TMDL.lineItems[i].pC) ? _TMDL.lineItems[i].pC : \"\");\n        _TMDL.prdFam.push((_TMDL.lineItems[i].pF) ? _TMDL.lineItems[i].pF : \"\");\n        _TMDL.prdType.push((_TMDL.lineItems[i].pT) ? _TMDL.lineItems[i].pT : \"\");\n        _TMDL.pidsku.push(_TMDL.pids[i] + \"-\" + _TMDL.skus[i]);\n        _TMDL.quantities.push((_TMDL.lineItems[i].q) ? _TMDL.lineItems[i].q : 1);\n\n        if (_TMDL.lineItems[i].cur) {\n            _TMDL.cc = _TMDL.lineItems[i].cur;\n        }\n\n        _TMDL.totqty += _TMDL.quantities[i];\n        _TMDL.itemprices.push(_TMDL.sales[i] / _TMDL.quantities[i]);\n    }\n\n\n\n    var missingCCpagetype = \"\";\n    if (_TMDL.cc == \"Unknown\" && ~window.location.host.indexOf(\"query.prod.cms.rt.microsoft.com\")) {\n        missingCCpagetype = (~window.location.href.indexOf(\"pN=congrats\")) ? \"receipt\" : \"cart\";\n        if (missingCCpagetype == \"receipt\") { _TMDL.logRuleCall(\"missingCC\" + missingCCpagetype + \"_\" + _TMDL.geo, \"missingCC\" + \"_\" + _TMDL.geo, window.location.search); }\n    }\n\n    var ccmap = {\n        'US': 'USD',\n        'AU': 'AUD',\n        'BR': 'BRL',\n        'CA': 'CAD',\n        'CH': 'CHF',\n        'DK': 'DKK',\n        'GB': 'GBP',\n        'JP': 'JPY',\n        'MX': 'MXN',\n        'NO': 'NOK',\n        'RU': 'RUB',\n        'SE': 'SEK',\n        'AT': 'EUR',\n        'BE': 'EUR',\n        'CY': 'EUR',\n        'DE': 'EUR',\n        'ES': 'EUR',\n        'FI': 'EUR',\n        'FR': 'EUR',\n        'GR': 'EUR',\n        'IR': 'EUR',\n        'IT': 'EUR',\n        'LU': 'EUR',\n        'NL': 'EUR',\n        'PT': 'EUR',\n        'NEVERHIT': 'Unknown'\n    };\n\n    if (_TMDL.cc == \"Unknown\" || _TMDL.cc == \"\") {\n        try {\n            if (ccmap[_TMDL.geo.toUpperCase()]) {\n                _TMDL.cc = ccmap[_TMDL.geo.toUpperCase()];\n            }\n        } catch (ccerr) { }\n    }\n\n    if (_TMDL.cc == \"Unknown\" && (window.location.href.indexOf('\"EUR\"') > -1 || window.location.href.indexOf(\"%22EUR%22\") > -1)) {\n        _TMDL.cc = \"EUR\";\n    }\n\n    _TMDL.pagename = _TMDL.pageName; // backwards compatibility for some tags\n    // make global for access in other tags\n    window._TMDL = window._TMDL || _TMDL;\n\n}\n\ncatch (err) { console.log(\"DataLayer: \" + err.message); }",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RL39439012f01b464592c200a1997c464c",
      "name": "AMOSurfCV",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 60.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/customCode.js",
          "settings": {
            "source": function(event, target) {
  return (window.location.host.toLowerCase()=="query.prod.cms.rt.microsoft.com" && ~window.location.search.indexOf("pN=congrats"));
}
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "/* \nRule: AMOSurfCV\n\nOriginally placed for Klarna\n\n<img src=\"https://pixel.everesttech.net/px2/4249?px_evt=t&ev_Surface_Plus_Consumer_purchase_orders=1&ev_Surface_Plus_Consumer_purchase_products=&ev_Surface_Plus_Consumer_purchase_revenue=&ev_transid=\" width=\"1\" height=\"1\"/>\n\nThe below updates can be made to the pixel macros to include transaction ID, order, products and revenue: \nev_transid= Unique transaction id, client should dynamically pass order id.\nev_Surface_Plus_Consumer_purchase_orders= Count should be 1, which has been hardcoded.\nev_Surface_Plus_Consumer_purchase_products= Should pass quantity of products in order.\nev_Surface_Plus_Consumer_purchase_revenue= Should pass the revenue for order.\n*/\n\n\ntry {\n\tvar i=0,inScope=0,totamt=0,totqty=0, imageURL=\"\",cc=\"\";\n\tfor (i=0; i<_TMDL.pidsku.length; i++) {\n\t\tif (~_TMDL.pnames[i].toLowerCase().indexOf(\"surface\")) {\n\t\t\tinScope=1;\n\t\t\ttotamt+=_TMDL.sales[i];\n\t\t\ttotqty+=_TMDL.quantities[i]\n\t\t} \n\t}\n\tcc=(_TMDL.cc)?_TMDL.cc.toLowerCase() : \"\";\n\n\timageURL = \"https://pixel.everesttech.net/px2/4249?px_evt=t\"\n\t\t+\"&ev_Surface_Plus_Consumer_purchase_orders=1\"\n\t\t+\"&ev_Surface_Plus_Consumer_purchase_products=\"+totqty\n\t\t+\"&ev_\"+cc+\"_Surface_Plus_Consumer_purchase_revenue=\"+totamt\n\t\t+\"&ev_transid=\"+_TMDL.purchaseID;\n\t\t\n\tif (_TMDL.pT==\"rP\" && inScope) {\n\t\tBootstrapper.imageRequest(imageURL);\n\t}\n} catch(e) {\n\tconsole.log(\"surfaceplusamoerr\");\n}",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RL009343dd3b9f47f4b08f2029bb4787ad",
      "name": "Surface-Consumer/Commercial Xandr Yahoo US",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 50.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/path.js",
          "settings": {
            "paths": [
              {
                "value": "/en-us/d/surface-laptop-studio-for-business",
                "valueIsRegex": true
              },
              {
                "value": "/en-us/d/surface-pro-8-for-business",
                "valueIsRegex": true
              }
            ]
          }
        },
        {
          "modulePath": "core/src/lib/conditions/dateRange.js",
          "settings": {
            "end": "2022-07-01T00:00:00Z",
            "start": "2021-12-30T00:00:00Z"
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "var debug = 0, fireTags = 1;\n\nfunction attachADNXSAnalyticsToElement(elementAddress) {\n\t$(document).on('mousedown', elementAddress, '', function () {\n\t\tvar rand = parseInt(Math.random() * 10000000000000);\n\t\tvar yahooURL = 'https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&ea=SurfaceButtonClick';\n\t\tvar adobeURL = 'https://ats.everesttech.net/ats/ats?cmd=ACTION&MerchantID=MICROSOFTSTORE&ActionID=50188&ActionName=Store_Site_Visit&cachebuster=' + rand;\n\n\t\tif (debug) {\n\t\t\tconsole.log(\"tag has fired\");\n\t\t}\n\n\t\tif (fireTags) {\n\t\t\tBootstrapper.imageRequest(yahooURL);\n\t\t\tBootstrapper.imageRequest(adobeURL);\n\t\t}\n\t});\n}\n\ntry {\n\t// Configure\n\tif (~window.location.pathname.toLowerCase().indexOf(\"surface\") && ~window.location.pathname.toLowerCase().indexOf(\"/d/\")) {\n\t\t// Configure Now CTA\n\t\tattachADNXSAnalyticsToElement('button[id*=\"ConfigureDeviceButton\"]');\n\n\t\t// Business\t\n\t\tattachADNXSAnalyticsToElement('div.store-finance-offer a');\n\n\t\t// Eligibility\t\t\t\n\t\tattachADNXSAnalyticsToElement('a[href*=\"student-discounts?successurl\"]');\n\n\t\t// Cart\n\t\tattachADNXSAnalyticsToElement('button[id*=\"AddToCartButton\"]');\n\n\t\t// Shop Now CTA from PDP (Surface_GBL_PchNow_Count_)  eeeeee\n\t\t$(document).on('mousedown', 'div.pi-promotion-bar a', '', function () {\n\t\t\tvar inScope = 1;\n\n\t\t\ttry {\n\t\t\t\tif (~this.href.indexOf(\"/build/\") || ~this.href.indexOf(\"student-discounts?successurl\")) {\n\t\t\t\t\t_satellite.logger.log(\"out of scope\");\n\t\t\t\t\tinScope = 0;\n\t\t\t\t}\n\t\t\t} catch (shperr) { _satellite.logger.log(\"shopnow err\"); }\n\n\t\t\tif (inScope) {\n\t\t\t\tif (debug) {\n\t\t\t\t\tconsole.log('tag has fired');\n\t\t\t\t}\n\t\t\t\tvar rand = parseInt(Math.random() * 10000000000000);\n\t\t\t\tvar yahooURL = 'https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&ea=SurfaceButtonClick';\n\t\t\t\tvar adobeURL = 'https://ats.everesttech.net/ats/ats?cmd=ACTION&MerchantID=MICROSOFTSTORE&ActionID=50188&ActionName=Store_Site_Visit&cachebuster=' + rand;\n\n\t\t\t\tBootstrapper.imageRequest(yahooURL);\n\t\t\t\tBootstrapper.imageRequest(adobeURL);\n\t\t\t} else {\n\t\t\t\tconsole.log('not in scope');\n\t\t\t}\n\t\t});\n\t}\n}\ncatch (clkerr) {\n\tconsole.log(\"Com/Con Surface Campaign\");\n}",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RL4bdf667038384adf9295cffa45ec5c85",
      "name": "Media_/en-gb/Small Business LinkedIn",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 50.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/path.js",
          "settings": {
            "paths": [
              {
                "value": "/en-gb/store/b/microsoft-small-business",
                "valueIsRegex": true
              }
            ]
          }
        },
        {
          "modulePath": "core/src/lib/conditions/domain.js",
          "settings": {
            "domains": [
              "microsoft.com"
            ]
          }
        }
      ],
      "actions": [
        {
          "modulePath": "linkedin/src/lib/actions/loadInsightTag.js",
          "settings": {
          }
        }
      ]
    },
    {
      "id": "RLdc101373a5e7415e876f8ac4e95a3db7",
      "name": "ContentSquare - Confirmation Page",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 60.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/customCode.js",
          "settings": {
            "source": function(event, target) {
  return (window.location.host.toLowerCase()=="query.prod.cms.rt.microsoft.com" && ~window.location.search.indexOf("pN=congrats"));
}
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "try {\nfunction loadjsfile(filename){\n    if (!filename) {\n        return;\n    }\n    var fileref=document.createElement('script')\n    fileref.setAttribute(\"type\",\"text/javascript\")\n    fileref.setAttribute(\"src\", filename)\n   if (typeof fileref!=\"undefined\")\n    document.getElementsByTagName(\"head\")[0].appendChild(fileref)\n}\nfunction getGeoMarketLink() {\n    var geoMarket = /&market=([a-z]{2})&/im.exec(window.location.search) && /&market=([a-z]{2})&/im.exec(window.location.search)[1]; //Extract market location from the query param\n    var CSGeoGUID; //define placeholder for market specific GUID\n    switch (geoMarket) { //Assign GUID to its respective market\n    case 'US':\n        CSGeoGUID = '05d32363-d534-4d93-9b65-cde674775e71';\n        break;\n    case 'CA':\n        CSGeoGUID = '63ed781a-0b4b-47a5-bbec-c555ac4835f3';\n        break;\n    case 'BR':\n        CSGeoGUID = 'e5577ace-d4c5-461f-b2a3-97eea3f39911';\n        break;\n    case 'AU':\n        CSGeoGUID = 'b8569749-38c8-434f-a4e5-457de94c4196';\n        break;\n    case 'JP':\n        CSGeoGUID = '82cbb6ea-e5bd-42bc-a3ed-9ab7ce1b5163';\n        break;\n    case 'GB':\n        CSGeoGUID = '554c90f5-1a44-4097-9def-c02c0e5a3718';\n        break;\n    case 'FR':\n        CSGeoGUID = 'a08fefef-0f4f-4c7d-8f54-2abbf4ab7d61';\n        break;\n    case 'DE':\n        CSGeoGUID = '77a061a5-1c09-4b9a-bf5f-1b5b67bba94c';\n        break;\n    case 'IT':\n        CSGeoGUID = '67b0cfc3-fb2e-44cb-b361-72a4c939e3dc';\n        break;\n    case 'NL':\n        CSGeoGUID = 'a1967146-1da8-459a-a731-7aed4cca30fb';\n        break;\n    case 'NZ':\n        CSGeoGUID = 'c4b2b846-8b73-415f-abbe-016f561ebfec';\n        break;\n    case 'SG':\n        CSGeoGUID = '53de0804-eb07-467b-bda1-1d5b5116d441';\n        break;\n    case 'ES':\n        CSGeoGUID = '1fac8122-e96d-4248-891b-bcfeadb26d0d';\n        break;\n    default:\n        break;\n    }\n    var CSLink = CSGeoGUID && 'https://cdnssl.clicktale.net/www32/ptc/' + CSGeoGUID + '.js';\n    return CSLink;\n}\nloadjsfile(getGeoMarketLink());\n  } \ncatch (err) { satellite.logger.error(\"ContentSquare - Confirmation Page\");}",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RLe040c5eabaf4405db3051b8b14c37a12",
      "name": "GBLCV",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 60.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/customCode.js",
          "settings": {
            "source": function(event, target) {
  return (window.location.host.toLowerCase()=="query.prod.cms.rt.microsoft.com" && ~window.location.search.indexOf("pN=congrats"));
}
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "/* GBL CV\n\nAmnet Oath\nAOL\nBidTellect\nHCode\nMediaIQ\nMediaMath\ntaboola_url\nQuantcast \n\n*/\n\ntry\n{\n\tvar \n\thcode_u=\"\",\n\tmediaIQ_imgurl=\"\",\n\tmediamath_url=\"\",\n\tamnetOath=\"\",\n\ttaboola_url=\"\",\n\toathdot=\"\",\n\tquantcast=\"\",\n\tdbugimgurl=\"\"\n\t;\n\n\tif (_TMDL.isprod && _TMDL.pT==\"rP\")\n\t{\n\n\t\tdbugimgurl=\"BidTellect\";\n\t\tBootstrapper.imageRequest(\"https://bttrack.com/pixel/uconversion/2682\");\n\n\t\t// --------------------------------------------------------------------------------\n\t\t// HCode, from Carat <NAME REMOVED>, potentially decommissionable end of Q3FY19\n\t\t// --------------------------------------------------------------------------------\n\n\t\thcode_u=\"https://api.retargetly.com/track?t=eBWRHK&r_type=consumer\"\n\t\t+\"&r_market=\"+_TMDL.geo\n\t\t+\"&r_product=\"+encodeURIComponent(_TMDL.pnames.join(\"_\"))\n\t\t+\"&r_currency=\"+_TMDL.cc\n\t\t+\"&r_SKU=\"+_TMDL.pidsku.join(\"_\")\n\t\t+\"&r_irderid=\"+_TMDL.purchaseID\n\t\t+\"&r_units=\"+_TMDL.quantities.join(\"_\")\n\t\t+\"&r-seats=\"+_TMDL.sales.join(\"_\")\n\t\t+\"&r_quanity=\"+_TMDL.quantities.join(\"_\");\n\t\t\n\t\tdbugimgurl=hcode_u;\n\t\tBootstrapper.imageRequest(hcode_u);\n\n\t\t/*\n\t\tMedia IQ Appnexus \n\t\t*/\n\n\t\tmediaIQ_imgurl = \"https://secure.adnxs.com/px?id=929469&seg=10765629&redir=https%3A%2F%2Fsecure.adnxs.com%2Fgetuid%3Fhttps%3A%2F%2Fpixel.mediaiqdigital.com%2Fpixel%3Fu1%3DConsPurchase%26u2%3D\"\n\t\t+_TMDL.ll\n\t\t+\"%26u3%3D\"+_TMDL.ll.split(\"-\")[1]\n\t\t+\"%26u6%3D\"+\"thankyoupage\"\n\t\t+\"%26u20%3D\"+_TMDL.pidsku.join(\"_\")\n\t\t+\"%26u26%3D\"+encodeURIComponent(_TMDL.pnames.join(\"_\"))\n\t\t+\"%26u31%3D\"+_TMDL.cc\n\t\t+\"%26u34%3D\"+_TMDL.purchaseID\n\t\t+\"%26u35%3D\"+_TMDL.totqty\n\t\t+\"%26u39%3D\"+_TMDL.sales.join(\"_\")\n\t\t+\"%26u40%3D\"+_TMDL.quantities.join(\"_\")\n\t\t+\"%26pixel_id%3D929469%26uid%3D%24UID&t=2\";\n\n\t\tdbugimgurl=mediaIQ_imgurl;\n\t\tBootstrapper.imageRequest(mediaIQ_imgurl);\n\n\t\t//-----------\n\t\t// MediaMath\n\t\t//-----------\n\n\n\t\tmediamath_url=\"https://pixel.mathtag.com/event/img?mt_id=1259909&mt_adid=166372\"\n\t\t\t+\"&site_language=\"+_TMDL.ll\n\t\t\t+\"&page_name=thankyou\"\n\t\t\t+\"&product_name=\"+encodeURIComponent(_TMDL.pnames.join(\"_\"))\n\t\t\t+\"&currency_code=\"+_TMDL.cc\n\t\t\t+\"&total_units=\"+_TMDL.totqty\n\t\t\t+\"&s2=\"+_TMDL.ll\n\t\t\t+\"&s3=\"+_TMDL.geo\n\t\t\t+\"&s6=thankyou\"\n\t\t\t+\"&s20=\"+_TMDL.pidsku.join(\"_\")\n\t\t\t+\"&s26=\"+encodeURIComponent(_TMDL.pnames.join(\"_\"))\n\t\t\t+\"&s31=\"+_TMDL.cc\n\t\t\t+\"&s34=\"+_TMDL.purchaseID\n\t\t\t+\"&s35=\"+_TMDL.totqty\n\t\t\t+\"&s39=\"+_TMDL.sales.join(\"_\")\n\t\t\t+\"&s40=\"+_TMDL.quantities.join(\"_\")\n\t\t\t+\"&v1=ConsPurchase&v5=\"+_TMDL.pidsku.join(\"_\")+\"&v11=\"+_TMDL.geo\n\t\t\t;\n\n\t\tdbugimgurl=mediamath_url;\n\t\tBootstrapper.imageRequest(mediamath_url);\n\t\n\t\t//---------------------\t\n\t\t// Oath Dot \n\t\t//---------------------\t\n\n\t\toathdot = \"https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&ea=ConsPurchase&qua=\"+_TMDL.totqty+\"&off=\"+_TMDL.pidsku.join(\"|\");\n\t\tdbugimgurl=oathdot;\n\t\tBootstrapper.imageRequest(oathdot);\n\n\t\t//-----------------------------------\n\t\t// Quantcast\n\t\t//    similar tags on other pages\n\t\t//-----------------------------------\n\n\t\tquantcast = \"https://pixel.quantserve.com/pixel/p-tTB93UFC5vepM.gif?labels=_fp.channel.\"+_TMDL.geo+\",_fp.event.receipt,_fp.subchannel.\"+_TMDL.totqty+\",_fp.customer.\"+_TMDL.ll+\",_fp.pcat.\"+_TMDL.pidsku.join(\",\")+\"&orderid=\"+_TMDL.purchaseID+\"&revenue=\"+_TMDL.totamount;\n\t\t\n\t\tdbugimgurl=quantcast;\n\t\tBootstrapper.imageRequest(quantcast);\n\n\t\t//------------------------------------------\t\n\t\t// Taboola for Office Direct\n\t\t//------------------------------------------\t\n\n\t\ttaboola_url=\"//trc.taboola.com/globalpixelhome/log/3/action?name=microsoft_global&item-url=\"+_TMDL.pidsku.join(\"_\");\n\t\tdbugimgurl=taboola_url;\n\t\tBootstrapper.imageRequest(taboola_url);\n\t}\n}\ncatch(err)\n{\n\tif (typeof(_TMutils) !== \"undefined\") {_TMutils.logRuleCall(\"GBLCV\",err.message,dbugimgurl);}\n\t_satellite.logger.error(\"GBLCV\");\t\n}",
            "language": "javascript"
          }
        }
      ]
    },
    {
      "id": "RL2e354527c27c461fb61aa31ea1bf6cad",
      "name": "XboxGrCPE_XDLConfig",
      "events": [
        {
          "modulePath": "core/src/lib/events/pageBottom.js",
          "settings": {
          },
          "ruleOrder": 70.0
        }
      ],
      "conditions": [
        {
          "modulePath": "core/src/lib/conditions/domain.js",
          "settings": {
            "domains": [
              "microsoft.com"
            ]
          }
        },
        {
          "modulePath": "core/src/lib/conditions/path.js",
          "settings": {
            "paths": [
              {
                "value": "(us|ca|au|gb)\\/store\\/configure\\/xbox-design-lab\\/900WZDF9XJVG",
                "valueIsRegex": true
              }
            ]
          }
        }
      ],
      "actions": [
        {
          "modulePath": "core/src/lib/actions/customCode.js",
          "settings": {
            "source": "var debug=0,fireDCM=1;\nvar ll=_TMDL.geo.toLowerCase();\n\nif (ll==\"us\" || ll==\"ca\" || ll==\"gb\" || ll==\"au\") {\n\ttry {\n\t\t$(document).on('mousedown','button.f-primary','', function() {\n\t\t\tif (typeof $(this).data('bi-mto') === 'undefined') {\n    \t\t\t// data attribute doesn't exist\n    \t\t\treturn;\n\t\t\t}\n\n\n\t\t\tif (debug) { \n\t\t\t\tconsole.log(\"Add to cart\"); \n\t\t\t}\n\n\t\t\tvar j={},pid=\"\",cN=\"\",u=\"\",hr=\"\";\n\t\t\tvar\ta = \"\" + (Math.random() * 10000000000000);\n\n\t\t\ttry {\n\t\t\t\tj=JSON.parse($(this).attr(\"data-m\"));\n\t\t\t\tpid = j.pid;\n\t\t\t\tcN= j.cN;\n\t\t\t\t//hr=this.href;\n\t\t\t} catch(proderr) {\n\t\t\t\tif (debug) { \n\t\t\t\t\tconsole.log(\"catch Add to cart \"+hr); \n\t\t\t\t}\n\t\t\t}\n\n\t\t\tu=\"https://ad.doubleclick.net/ddm/activity/src=8391491;type=xbxp;cat=pchn_std;u1=\"\n\t\t\t+_TMDL.geo\n\t\t\t+\";u2=\"+_TMDL.ll\n\t\t\t+\";u6=\"+encodeURIComponent(window.location.pathname)\n\t\t\t+\";u25=\"+pid\n\t\t\t+\";u26=\"+encodeURIComponent(cN)\n\t\t\t+\";u50=\"+encodeURIComponent(cN)\n\t\t\t+\";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=\"\t+ a + \"?\";\n\n\t\t\tif (debug) { \n\t\t\t\tconsole.log(\"Add to cart: u25=\"+pid+\" u26=\"+cN+\"\\t\"+u); \n\t\t\t}\n\n\t\t\tif (fireDCM) {\n\t\t\t\tBootstrapper.imageRequest(u);\n\t\t\t}\n\t\t});\n\t} catch(clkerr) {\n\t\tconsole.log(\"Xbox Design Lab\");\n\t}\n}",
            "language": "javascript"
          }
        }
      ]
    }
  ]
}
})();

var _satellite = (function () {
	'use strict';

	if (!window.atob) { console.warn('Adobe Launch is unsupported in IE 9 and below.'); return; }

	var reactorDocument = document;

	/*
	object-assign
	(c) Sindre Sorhus
	@license MIT
	*/
	/* eslint-disable no-unused-vars */
	var getOwnPropertySymbols = Object.getOwnPropertySymbols;
	var hasOwnProperty$1 = Object.prototype.hasOwnProperty;
	var propIsEnumerable = Object.prototype.propertyIsEnumerable;

	function toObject(val) {
		if (val === null || val === undefined) {
			throw new TypeError('Object.assign cannot be called with null or undefined');
		}

		return Object(val);
	}

	function shouldUseNative() {
		try {
			if (!Object.assign) {
				return false;
			}

			// Detect buggy property enumeration order in older V8 versions.

			// https://bugs.chromium.org/p/v8/issues/detail?id=4118
			var test1 = new String('abc');  // eslint-disable-line no-new-wrappers
			test1[5] = 'de';
			if (Object.getOwnPropertyNames(test1)[0] === '5') {
				return false;
			}

			// https://bugs.chromium.org/p/v8/issues/detail?id=3056
			var test2 = {};
			for (var i = 0; i < 10; i++) {
				test2['_' + String.fromCharCode(i)] = i;
			}
			var order2 = Object.getOwnPropertyNames(test2).map(function (n) {
				return test2[n];
			});
			if (order2.join('') !== '0123456789') {
				return false;
			}

			// https://bugs.chromium.org/p/v8/issues/detail?id=3056
			var test3 = {};
			'abcdefghijklmnopqrst'.split('').forEach(function (letter) {
				test3[letter] = letter;
			});
			if (Object.keys(Object.assign({}, test3)).join('') !==
					'abcdefghijklmnopqrst') {
				return false;
			}

			return true;
		} catch (err) {
			// We don't expect any of the above to throw, but better to be safe.
			return false;
		}
	}

	var objectAssign = shouldUseNative() ? Object.assign : function (target, source) {
		var from;
		var to = toObject(target);
		var symbols;

		for (var s = 1; s < arguments.length; s++) {
			from = Object(arguments[s]);

			for (var key in from) {
				if (hasOwnProperty$1.call(from, key)) {
					to[key] = from[key];
				}
			}

			if (getOwnPropertySymbols) {
				symbols = getOwnPropertySymbols(from);
				for (var i = 0; i < symbols.length; i++) {
					if (propIsEnumerable.call(from, symbols[i])) {
						to[symbols[i]] = from[symbols[i]];
					}
				}
			}
		}

		return to;
	};

	var reactorObjectAssign = objectAssign;

	var reactorWindow = window;

	/***************************************************************************************
	 * (c) 2021 Adobe. All rights reserved.
	 * This file is licensed to you under the Apache License, Version 2.0 (the "License");
	 * you may not use this file except in compliance with the License. You may obtain a copy
	 * of the License at http://www.apache.org/licenses/LICENSE-2.0
	 *
	 * Unless required by applicable law or agreed to in writing, software distributed under
	 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
	 * OF ANY KIND, either express or implied. See the License for the specific language
	 * governing permissions and limitations under the License.
	 ****************************************************************************************/

	var createDynamicHostResolver = function (
	  turbineEmbedCode,
	  dynamicCdnEnabled,
	  cdnAllowList,
	  debugController
	) {
	  // A missing list means that we are not trying to dynamic replace (archives,
	  // sftp, no premium CDN option enabled on the company).
	  // even an empty list is flagging to us that we're trying to enforce dynamic
	  var isDynamicEnforced = Boolean(
	    dynamicCdnEnabled && Array.isArray(cdnAllowList)
	  );
	  var shouldAugment = Boolean(isDynamicEnforced && turbineEmbedCode);

	  // using document.createElement('a') because IE10/11 doesn't support new URL()
	  var turbineUrl = document.createElement('a');
	  if (isDynamicEnforced) {
	    var throwUnavailableEmbedCode = function () {
	      var missingEmbedCodeError = new Error(
	        'Unable to find the Library Embed Code for Dynamic Host Resolution.'
	      );
	      missingEmbedCodeError.code = 'dynamic_host_resolver_constructor_error';
	      throw missingEmbedCodeError;
	    };
	    if (turbineEmbedCode) {
	      if (!/^((https?:)?\/\/).+/.test(turbineEmbedCode)) {
	        throwUnavailableEmbedCode();
	      }
	      if (/^\/\/.+/.test(turbineEmbedCode)) {
	        // for IE 10, you must throw on the protocol
	        turbineUrl.href = reactorWindow.location.protocol + turbineEmbedCode;
	      } else {
	        turbineUrl.href = turbineEmbedCode;
	      }
	    }

	    // check URL construction
	    if (!turbineUrl.hostname) {
	      throwUnavailableEmbedCode();
	    }
	    // is this within the allowed list of hosts?
	    if (cdnAllowList.indexOf(turbineUrl.hostname) === -1) {
	      var dynamicDeniedError = new Error(
	        'This library is not authorized for this domain. ' +
	          'Please contact your CSM for more information.'
	      );
	      dynamicDeniedError.code = 'dynamic_host_not_allowed';
	      throw dynamicDeniedError;
	    }
	  }

	  /**
	   * Returns the host of the Turbine embed code, or an empty string if Dynamic Host
	   * is not enabled.
	   * @returns {string}
	   */
	  var memoizedHostResult;
	  var getTurbineHost = function () {
	    if (memoizedHostResult != null) {
	      return memoizedHostResult;
	    }

	    if (shouldAugment) {
	      // be sure we always force https to Adobe managed domains.
	      // IE 10/11 returns the :443 protocol when modern browsers don't, so this replacement
	      // is bringing every browser in line with the same return value
	      var sanitizedHost = turbineUrl.host;
	      if (/:80$/.test(sanitizedHost)) {
	        sanitizedHost = sanitizedHost.replace(':80', '');
	      } else if (/:80\/$/.test(sanitizedHost)) {
	        sanitizedHost = sanitizedHost.replace(':80/', '');
	      } else if (/:443$/.test(sanitizedHost)) {
	        sanitizedHost = sanitizedHost.replace(':443', '');
	      } else if (/:443\/$/.test(sanitizedHost)) {
	        sanitizedHost = sanitizedHost.replace(':443/', '');
	      }

	      memoizedHostResult = turbineUrl.protocol + '//' + sanitizedHost;
	    } else {
	      memoizedHostResult = '';
	    }

	    return memoizedHostResult;
	  };

	  /**
	   * Returns a url decorated with the host of the Turbine embed code. If Dynamic host
	   * is disabled, the original sourceUrl is returned unmodified.
	   * @param sourceUrl
	   * @returns {string|*}
	   */
	  var decorateWithDynamicHost = function (sourceUrl) {
	    if (shouldAugment && typeof sourceUrl === 'string') {
	      var urlParts = [
	        getTurbineHost(),
	        sourceUrl.charAt(0) === '/' ? sourceUrl.slice(1) : sourceUrl
	      ];

	      return urlParts.join('/');
	    }

	    return sourceUrl;
	  };

	  var dynamicHostResolver = {
	    getTurbineHost: getTurbineHost,
	    decorateWithDynamicHost: decorateWithDynamicHost,
	    get isDynamicEnforced() {
	      return isDynamicEnforced;
	    }
	  };

	  if (reactorWindow) {
	    debugController.onDebugChanged(function (isEnabled) {
	      if (isEnabled) {
	        reactorWindow.dynamicHostResolver = dynamicHostResolver;
	      } else {
	        delete reactorWindow.dynamicHostResolver;
	      }
	    });
	  }

	  return dynamicHostResolver;
	};

	/***************************************************************************************
	 * (c) 2017 Adobe. All rights reserved.
	 * This file is licensed to you under the Apache License, Version 2.0 (the "License");
	 * you may not use this file except in compliance with the License. You may obtain a copy
	 * of the License at http://www.apache.org/licenses/LICENSE-2.0
	 *
	 * Unless required by applicable law or agreed to in writing, software distributed under
	 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
	 * OF ANY KIND, either express or implied. See the License for the specific language
	 * governing permissions and limitations under the License.
	 ****************************************************************************************/
	/**
	 * Rules can be ordered by users at the event type level. For example, assume both Rule A and Rule B
	 * use the Library Loaded and Window Loaded event types. Rule A can be ordered to come before Rule B
	 * on Library Loaded but after Rule B on Window Loaded.
	 *
	 * Order values are integers and act more as a priority. In other words, multiple rules can have the
	 * same order value. If they have the same order value, their order of execution should be
	 * considered nondetermistic.
	 *
	 * @param {Array} rules
	 * @returns {Array} An ordered array of rule-event pair objects.
	 */
	var buildRuleExecutionOrder = function (rules) {
	  var ruleEventPairs = [];

	  rules.forEach(function (rule) {
	    if (rule.events) {
	      rule.events.forEach(function (event) {
	        ruleEventPairs.push({
	          rule: rule,
	          event: event
	        });
	      });
	    }
	  });

	  return ruleEventPairs.sort(function (ruleEventPairA, ruleEventPairB) {
	    return ruleEventPairA.event.ruleOrder - ruleEventPairB.event.ruleOrder;
	  });
	};

	/*
	Copyright 2020 Adobe. All rights reserved.
	This file is licensed to you under the Apache License, Version 2.0 (the "License");
	you may not use this file except in compliance with the License. You may obtain a copy
	of the License at http://www.apache.org/licenses/LICENSE-2.0

	Unless required by applicable law or agreed to in writing, software distributed under
	the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
	OF ANY KIND, either express or implied. See the License for the specific language
	governing permissions and limitations under the License.
	*/
	var DEBUG_LOCAL_STORAGE_NAME = 'debug';

	var createDebugController = function (localStorage, logger) {
	  var getPersistedDebugEnabled = function () {
	    return localStorage.getItem(DEBUG_LOCAL_STORAGE_NAME) === 'true';
	  };

	  var setPersistedDebugEnabled = function (enabled) {
	    localStorage.setItem(DEBUG_LOCAL_STORAGE_NAME, enabled);
	  };

	  var debugChangedCallbacks = [];
	  var onDebugChanged = function (callback) {
	    debugChangedCallbacks.push(callback);
	  };

	  logger.outputEnabled = getPersistedDebugEnabled();

	  return {
	    onDebugChanged: onDebugChanged,
	    getDebugEnabled: getPersistedDebugEnabled,
	    setDebugEnabled: function (enabled) {
	      if (getPersistedDebugEnabled() !== enabled) {
	        setPersistedDebugEnabled(enabled);
	        logger.outputEnabled = enabled;
	        debugChangedCallbacks.forEach(function (callback) {
	          callback(enabled);
	        });
	      }
	    }
	  };
	};

	/***************************************************************************************
	 * (c) 2018 Adobe. All rights reserved.
	 * This file is licensed to you under the Apache License, Version 2.0 (the "License");
	 * you may not use this file except in compliance with the License. You may obtain a copy
	 * of the License at http://www.apache.org/licenses/LICENSE-2.0
	 *
	 * Unless required by applicable law or agreed to in writing, software distributed under
	 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
	 * OF ANY KIND, either express or implied. See the License for the specific language
	 * governing permissions and limitations under the License.
	 ****************************************************************************************/
	var MODULE_NOT_FUNCTION_ERROR = 'Module did not export a function.';

	var createExecuteDelegateModule = function (
	  moduleProvider,
	  replaceTokens,
	  settingsFileTransformer
	) {
	  return function (moduleDescriptor, syntheticEvent, moduleCallParameters) {
	    moduleCallParameters = moduleCallParameters || [];
	    var moduleExports = moduleProvider.getModuleExports(
	      moduleDescriptor.modulePath
	    );

	    if (typeof moduleExports !== 'function') {
	      throw new Error(MODULE_NOT_FUNCTION_ERROR);
	    }

	    // dynamically replace the host on the module settings
	    var moduleDefinition = moduleProvider.getModuleDefinition(
	      moduleDescriptor.modulePath
	    );

	    // We're transforming URLs in-place to ensure that the developer's settings object reference
	    // is the same object reference as moduleDescriptor.settings. Therefore, we must only transform
	    // the settings one time and save a reference saying that we've done that. We're saving this in
	    // the module descriptor of each event, condition, and action so that we aren't modifying the
	    // settings object.
	    var moduleSettings = moduleDescriptor.settings || {};
	    if (
	      !moduleDescriptor.hasTransformedFilePaths &&
	      moduleDefinition.filePaths
	    ) {
	      settingsFileTransformer(
	        moduleSettings,
	        moduleDefinition.filePaths,
	        moduleDescriptor.modulePath
	      );
	      moduleDescriptor.hasTransformedFilePaths = true;
	    }

	    // replace tokens
	    var moduleDescriptorSettings = replaceTokens(
	      moduleSettings,
	      syntheticEvent
	    );
	    return moduleExports
	      .bind(null, moduleDescriptorSettings)
	      .apply(null, moduleCallParameters);
	  };
	};

	/***************************************************************************************
	 * (c) 2017 Adobe. All rights reserved.
	 * This file is licensed to you under the Apache License, Version 2.0 (the "License");
	 * you may not use this file except in compliance with the License. You may obtain a copy
	 * of the License at http://www.apache.org/licenses/LICENSE-2.0
	 *
	 * Unless required by applicable law or agreed to in writing, software distributed under
	 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
	 * OF ANY KIND, either express or implied. See the License for the specific language
	 * governing permissions and limitations under the License.
	 ****************************************************************************************/
	/**
	 * "Cleans" text by trimming the string and removing spaces and newlines.
	 * @param {string} str The string to clean.
	 * @returns {string}
	 */
	var cleanText = function (str) {
	  return typeof str === 'string' ? str.replace(/\s+/g, ' ').trim() : str;
	};

	/***************************************************************************************
	 * (c) 2017 Adobe. All rights reserved.
	 * This file is licensed to you under the Apache License, Version 2.0 (the "License");
	 * you may not use this file except in compliance with the License. You may obtain a copy
	 * of the License at http://www.apache.org/licenses/LICENSE-2.0
	 *
	 * Unless required by applicable law or agreed to in writing, software distributed under
	 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
	 * OF ANY KIND, either express or implied. See the License for the specific language
	 * governing permissions and limitations under the License.
	 ****************************************************************************************/
	/**
	 * Log levels.
	 * @readonly
	 * @enum {string}
	 * @private
	 */
	var levels = {
	  LOG: 'log',
	  INFO: 'info',
	  DEBUG: 'debug',
	  WARN: 'warn',
	  ERROR: 'error'
	};

	/**
	 * Rocket unicode surrogate pair.
	 * @type {string}
	 */
	var ROCKET = '\uD83D\uDE80';

	/**
	 * The user's internet explorer version. If they're not running internet explorer, then it should
	 * be NaN.
	 * @type {Number}
	 */
	var ieVersion = parseInt(
	  (/msie (\d+)/.exec(navigator.userAgent.toLowerCase()) || [])[1]
	);

	/**
	 * Prefix to use on all messages. The rocket unicode doesn't work on IE 10.
	 * @type {string}
	 */
	var launchPrefix = ieVersion === 10 ? '[Launch]' : ROCKET;

	/**
	 * Whether logged messages should be output to the console.
	 * @type {boolean}
	 */
	var outputEnabled = false;

	/**
	 * Processes a log message.
	 * @param {string} level The level of message to log.
	 * @param {...*} arg Any argument to be logged.
	 * @private
	 */
	var process = function (level) {
	  if (outputEnabled && window.console) {
	    var logArguments = Array.prototype.slice.call(arguments, 1);
	    logArguments.unshift(launchPrefix);
	    // window.debug is unsupported in IE 10
	    if (level === levels.DEBUG && !window.console[level]) {
	      level = levels.INFO;
	    }
	    window.console[level].apply(window.console, logArguments);
	  }
	};

	/**
	 * Outputs a message to the web console.
	 * @param {...*} arg Any argument to be logged.
	 */
	var log = process.bind(null, levels.LOG);

	/**
	 * Outputs informational message to the web console. In some browsers a small "i" icon is
	 * displayed next to these items in the web console's log.
	 * @param {...*} arg Any argument to be logged.
	 */
	var info = process.bind(null, levels.INFO);

	/**
	 * Outputs debug message to the web console. In browsers that do not support
	 * console.debug, console.info is used instead.
	 * @param {...*} arg Any argument to be logged.
	 */
	var debug = process.bind(null, levels.DEBUG);

	/**
	 * Outputs a warning message to the web console.
	 * @param {...*} arg Any argument to be logged.
	 */
	var warn = process.bind(null, levels.WARN);

	/**
	 * Outputs an error message to the web console.
	 * @param {...*} arg Any argument to be logged.
	 */
	var error = process.bind(null, levels.ERROR);

	/**
	 * Outputs a warning message to the web console.
	 * @param {...*} arg Any argument to be logged.
	 */
	var logDeprecation = function () {
	  var wasEnabled = outputEnabled;
	  outputEnabled = true;

	  process.apply(
	    null,
	    Array.prototype.concat(levels.WARN, Array.prototype.slice.call(arguments))
	  );

	  if (!wasEnabled) {
	    outputEnabled = false;
	  }
	};

	var logger = {
	  log: log,
	  info: info,
	  debug: debug,
	  warn: warn,
	  error: error,
	  deprecation: logDeprecation,
	  /**
	   * Whether logged messages should be output to the console.
	   * @type {boolean}
	   */
	  get outputEnabled() {
	    return outputEnabled;
	  },
	  set outputEnabled(value) {
	    outputEnabled = value;
	  },
	  /**
	   * Creates a logging utility that only exposes logging functionality and prefixes all messages
	   * with an identifier.
	   */
	  createPrefixedLogger: function (identifier) {
	    var loggerSpecificPrefix = '[' + identifier + ']';

	    return {
	      log: log.bind(null, loggerSpecificPrefix),
	      info: info.bind(null, loggerSpecificPrefix),
	      debug: debug.bind(null, loggerSpecificPrefix),
	      warn: warn.bind(null, loggerSpecificPrefix),
	      error: error.bind(null, loggerSpecificPrefix)
	    };
	  }
	};

	/***************************************************************************************
	 * (c) 2017 Adobe. All rights reserved.
	 * This file is licensed to you under the Apache License, Version 2.0 (the "License");
	 * you may not use this file except in compliance with the License. You may obtain a copy
	 * of the License at http://www.apache.org/licenses/LICENSE-2.0
	 *
	 * Unless required by applicable law or agreed to in writing, software distributed under
	 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
	 * OF ANY KIND, either express or implied. See the License for the specific language
	 * governing permissions and limitations under the License.
	 ****************************************************************************************/

	var NAMESPACE = 'com.adobe.reactor.';

	var getNamespacedStorage = function (storageType, additionalNamespace) {
	  var finalNamespace = NAMESPACE + (additionalNamespace || '');

	  // When storage is disabled on Safari, the mere act of referencing window.localStorage
	  // or window.sessionStorage throws an error. For this reason, we wrap in a try-catch.
	  return {
	    /**
	     * Reads a value from storage.
	     * @param {string} name The name of the item to be read.
	     * @returns {string}
	     */
	    getItem: function (name) {
	      try {
	        return reactorWindow[storageType].getItem(finalNamespace + name);
	      } catch (e) {
	        return null;
	      }
	    },
	    /**
	     * Saves a value to storage.
	     * @param {string} name The name of the item to be saved.
	     * @param {string} value The value of the item to be saved.
	     * @returns {boolean} Whether the item was successfully saved to storage.
	     */
	    setItem: function (name, value) {
	      try {
	        reactorWindow[storageType].setItem(finalNamespace + name, value);
	        return true;
	      } catch (e) {
	        return false;
	      }
	    }
	  };
	};

	/***************************************************************************************
	 * (c) 2017 Adobe. All rights reserved.
	 * This file is licensed to you under the Apache License, Version 2.0 (the "License");
	 * you may not use this file except in compliance with the License. You may obtain a copy
	 * of the License at http://www.apache.org/licenses/LICENSE-2.0
	 *
	 * Unless required by applicable law or agreed to in writing, software distributed under
	 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
	 * OF ANY KIND, either express or implied. See the License for the specific language
	 * governing permissions and limitations under the License.
	 ****************************************************************************************/

	var DATA_ELEMENTS_NAMESPACE = 'dataElements.';

	var dataElementSessionStorage = getNamespacedStorage(
	  'sessionStorage',
	  DATA_ELEMENTS_NAMESPACE
	);
	var dataElementLocalStorage = getNamespacedStorage(
	  'localStorage',
	  DATA_ELEMENTS_NAMESPACE
	);

	var storageDurations = {
	  PAGEVIEW: 'pageview',
	  SESSION: 'session',
	  VISITOR: 'visitor'
	};

	var pageviewCache = {};

	var serialize = function (value) {
	  var serialized;

	  try {
	    // On some browsers, with some objects, errors will be thrown during serialization. For example,
	    // in Chrome with the window object, it will throw "TypeError: Converting circular structure
	    // to JSON"
	    serialized = JSON.stringify(value);
	    // eslint-disable-next-line no-empty
	  } catch (e) {}

	  return serialized;
	};

	var setValue = function (key, storageDuration, value) {
	  var serializedValue;

	  switch (storageDuration) {
	    case storageDurations.PAGEVIEW:
	      pageviewCache[key] = value;
	      return;
	    case storageDurations.SESSION:
	      serializedValue = serialize(value);
	      if (serializedValue) {
	        dataElementSessionStorage.setItem(key, serializedValue);
	      }
	      return;
	    case storageDurations.VISITOR:
	      serializedValue = serialize(value);
	      if (serializedValue) {
	        dataElementLocalStorage.setItem(key, serializedValue);
	      }
	      return;
	  }
	};

	var getValue = function (key, storageDuration) {
	  var value;

	  // It should consistently return the same value if no stored item was found. We chose null,
	  // though undefined could be a reasonable value as well.
	  switch (storageDuration) {
	    case storageDurations.PAGEVIEW:
	      return pageviewCache.hasOwnProperty(key) ? pageviewCache[key] : null;
	    case storageDurations.SESSION:
	      value = dataElementSessionStorage.getItem(key);
	      return value === null ? value : JSON.parse(value);
	    case storageDurations.VISITOR:
	      value = dataElementLocalStorage.getItem(key);
	      return value === null ? value : JSON.parse(value);
	  }
	};

	var dataElementSafe = {
	  setValue: setValue,
	  getValue: getValue
	};

	/***************************************************************************************
	 * (c) 2017 Adobe. All rights reserved.
	 * This file is licensed to you under the Apache License, Version 2.0 (the "License");
	 * you may not use this file except in compliance with the License. You may obtain a copy
	 * of the License at http://www.apache.org/licenses/LICENSE-2.0
	 *
	 * Unless required by applicable law or agreed to in writing, software distributed under
	 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
	 * OF ANY KIND, either express or implied. See the License for the specific language
	 * governing permissions and limitations under the License.
	 ****************************************************************************************/

	var getErrorMessage = function (
	  dataDef,
	  dataElementName,
	  errorMessage,
	  errorStack
	) {
	  return (
	    'Failed to execute data element module ' +
	    dataDef.modulePath +
	    ' for data element ' +
	    dataElementName +
	    '. ' +
	    errorMessage +
	    (errorStack ? '\n' + errorStack : '')
	  );
	};

	var createGetDataElementValue = function (
	  moduleProvider,
	  getDataElementDefinition,
	  replaceTokens,
	  undefinedVarsReturnEmpty,
	  settingsFileTransformer
	) {
	  return function (name, syntheticEvent) {
	    var dataDef = getDataElementDefinition(name);

	    if (!dataDef) {
	      return undefinedVarsReturnEmpty ? '' : undefined;
	    }

	    var storageDuration = dataDef.storageDuration;
	    var moduleExports;
	    var moduleDefinition;

	    try {
	      moduleExports = moduleProvider.getModuleExports(dataDef.modulePath);
	      moduleDefinition = moduleProvider.getModuleDefinition(dataDef.modulePath);
	    } catch (e) {
	      logger.error(getErrorMessage(dataDef, name, e.message, e.stack));
	      return;
	    }

	    if (typeof moduleExports !== 'function') {
	      logger.error(
	        getErrorMessage(dataDef, name, 'Module did not export a function.')
	      );
	      return;
	    }

	    var value;

	    var dataElementSettings = dataDef.settings || {};
	    if (!dataDef.hasTransformedFilePaths && moduleDefinition.filePaths) {
	      settingsFileTransformer(
	        dataElementSettings,
	        moduleDefinition.filePaths,
	        dataDef.modulePath
	      );
	      dataDef.hasTransformedFilePaths = true;
	    }

	    try {
	      value = moduleExports(
	        replaceTokens(dataElementSettings, syntheticEvent),
	        syntheticEvent
	      );
	    } catch (e) {
	      logger.error(getErrorMessage(dataDef, name, e.message, e.stack));
	      return;
	    }

	    if (storageDuration) {
	      if (value != null) {
	        dataElementSafe.setValue(name, storageDuration, value);
	      } else {
	        value = dataElementSafe.getValue(name, storageDuration);
	      }
	    }

	    if (value == null && dataDef.defaultValue != null) {
	      value = dataDef.defaultValue;
	    }

	    if (typeof value === 'string') {
	      if (dataDef.cleanText) {
	        value = cleanText(value);
	      }

	      if (dataDef.forceLowerCase) {
	        value = value.toLowerCase();
	      }
	    }

	    return value;
	  };
	};

	/***************************************************************************************
	 * (c) 2017 Adobe. All rights reserved.
	 * This file is licensed to you under the Apache License, Version 2.0 (the "License");
	 * you may not use this file except in compliance with the License. You may obtain a copy
	 * of the License at http://www.apache.org/licenses/LICENSE-2.0
	 *
	 * Unless required by applicable law or agreed to in writing, software distributed under
	 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
	 * OF ANY KIND, either express or implied. See the License for the specific language
	 * governing permissions and limitations under the License.
	 ****************************************************************************************/

	var specialPropertyAccessors = {
	  text: function (obj) {
	    return obj.textContent;
	  },
	  cleanText: function (obj) {
	    return cleanText(obj.textContent);
	  }
	};

	/**
	 * This returns the value of a property at a given path. For example, a <code>path<code> of
	 * <code>foo.bar</code> will return the value of <code>obj.foo.bar</code>.
	 *
	 * In addition, if <code>path</code> is <code>foo.bar.getAttribute(unicorn)</code> and
	 * <code>obj.foo.bar</code> has a method named <code>getAttribute</code>, the method will be
	 * called with a value of <code>"unicorn"</code> and the value will be returned.
	 *
	 * Also, if <code>path</code> is <code>foo.bar.@text</code> or other supported properties
	 * beginning with <code>@</code>, a special accessor will be used.
	 *
	 * @param host
	 * @param path
	 * @param supportSpecial
	 * @returns {*}
	 */
	var getObjectProperty = function (host, propChain, supportSpecial) {
	  var value = host;
	  var attrMatch;
	  for (var i = 0, len = propChain.length; i < len; i++) {
	    if (value == null) {
	      return undefined;
	    }
	    var prop = propChain[i];
	    if (supportSpecial && prop.charAt(0) === '@') {
	      var specialProp = prop.slice(1);
	      value = specialPropertyAccessors[specialProp](value);
	      continue;
	    }
	    if (
	      value.getAttribute &&
	      (attrMatch = prop.match(/^getAttribute\((.+)\)$/))
	    ) {
	      var attr = attrMatch[1];
	      value = value.getAttribute(attr);
	      continue;
	    }
	    value = value[prop];
	  }
	  return value;
	};

	/**
	 * Returns the value of a variable.
	 * @param {string} variable
	 * @param {Object} [syntheticEvent] A synthetic event. Only required when using %event... %this...
	 * or %target...
	 * @returns {*}
	 */
	var createGetVar = function (
	  customVars,
	  getDataElementDefinition,
	  getDataElementValue
	) {
	  return function (variable, syntheticEvent) {
	    var value;

	    if (getDataElementDefinition(variable)) {
	      // Accessing nested properties of a data element using dot-notation is unsupported because
	      // users can currently create data elements with periods in the name.
	      value = getDataElementValue(variable, syntheticEvent);
	    } else {
	      var propChain = variable.split('.');
	      var variableHostName = propChain.shift();

	      if (variableHostName === 'this') {
	        if (syntheticEvent) {
	          // I don't know why this is the only one that supports special properties, but that's the
	          // way it was in Satellite.
	          value = getObjectProperty(syntheticEvent.element, propChain, true);
	        }
	      } else if (variableHostName === 'event') {
	        if (syntheticEvent) {
	          value = getObjectProperty(syntheticEvent, propChain);
	        }
	      } else if (variableHostName === 'target') {
	        if (syntheticEvent) {
	          value = getObjectProperty(syntheticEvent.target, propChain);
	        }
	      } else {
	        value = getObjectProperty(customVars[variableHostName], propChain);
	      }
	    }

	    return value;
	  };
	};

	/***************************************************************************************
	 * (c) 2017 Adobe. All rights reserved.
	 * This file is licensed to you under the Apache License, Version 2.0 (the "License");
	 * you may not use this file except in compliance with the License. You may obtain a copy
	 * of the License at http://www.apache.org/licenses/LICENSE-2.0
	 *
	 * Unless required by applicable law or agreed to in writing, software distributed under
	 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
	 * OF ANY KIND, either express or implied. See the License for the specific language
	 * governing permissions and limitations under the License.
	 ****************************************************************************************/
	/**
	 * Determines if the provided name is a valid variable, where the variable
	 * can be a data element, element, event, target, or custom var.
	 * @param variableName
	 * @returns {boolean}
	 */
	var createIsVar = function (customVars, getDataElementDefinition) {
	  return function (variableName) {
	    var nameBeforeDot = variableName.split('.')[0];

	    return Boolean(
	      getDataElementDefinition(variableName) ||
	        nameBeforeDot === 'this' ||
	        nameBeforeDot === 'event' ||
	        nameBeforeDot === 'target' ||
	        customVars.hasOwnProperty(nameBeforeDot)
	    );
	  };
	};

	/***************************************************************************************
	 * (c) 2017 Adobe. All rights reserved.
	 * This file is licensed to you under the Apache License, Version 2.0 (the "License");
	 * you may not use this file except in compliance with the License. You may obtain a copy
	 * of the License at http://www.apache.org/licenses/LICENSE-2.0
	 *
	 * Unless required by applicable law or agreed to in writing, software distributed under
	 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
	 * OF ANY KIND, either express or implied. See the License for the specific language
	 * governing permissions and limitations under the License.
	 ****************************************************************************************/
	var extractModuleExports = function (script, require, turbine) {
	  var module = {
	    exports: {}
	  };

	  script.call(module.exports, module, module.exports, require, turbine);

	  return module.exports;
	};

	/***************************************************************************************
	 * (c) 2017 Adobe. All rights reserved.
	 * This file is licensed to you under the Apache License, Version 2.0 (the "License");
	 * you may not use this file except in compliance with the License. You may obtain a copy
	 * of the License at http://www.apache.org/licenses/LICENSE-2.0
	 *
	 * Unless required by applicable law or agreed to in writing, software distributed under
	 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
	 * OF ANY KIND, either express or implied. See the License for the specific language
	 * governing permissions and limitations under the License.
	 ****************************************************************************************/

	var createModuleProvider = function () {
	  var moduleByReferencePath = {};

	  var getModule = function (referencePath) {
	    var module = moduleByReferencePath[referencePath];

	    if (!module) {
	      throw new Error('Module ' + referencePath + ' not found.');
	    }

	    return module;
	  };

	  var registerModule = function (
	    referencePath,
	    moduleDefinition,
	    extensionName,
	    require,
	    turbine
	  ) {
	    var module = {
	      definition: moduleDefinition,
	      extensionName: extensionName,
	      require: require,
	      turbine: turbine
	    };
	    module.require = require;
	    moduleByReferencePath[referencePath] = module;
	  };

	  var hydrateCache = function () {
	    Object.keys(moduleByReferencePath).forEach(function (referencePath) {
	      try {
	        getModuleExports(referencePath);
	      } catch (e) {
	        var errorMessage =
	          'Error initializing module ' +
	          referencePath +
	          '. ' +
	          e.message +
	          (e.stack ? '\n' + e.stack : '');
	        logger.error(errorMessage);
	      }
	    });
	  };

	  var getModuleExports = function (referencePath) {
	    var module = getModule(referencePath);

	    // Using hasOwnProperty instead of a falsey check because the module could export undefined
	    // in which case we don't want to execute the module each time the exports is requested.
	    if (!module.hasOwnProperty('exports')) {
	      module.exports = extractModuleExports(
	        module.definition.script,
	        module.require,
	        module.turbine
	      );
	    }

	    return module.exports;
	  };

	  var getModuleDefinition = function (referencePath) {
	    return getModule(referencePath).definition;
	  };

	  var getModuleExtensionName = function (referencePath) {
	    return getModule(referencePath).extensionName;
	  };

	  return {
	    registerModule: registerModule,
	    hydrateCache: hydrateCache,
	    getModuleExports: getModuleExports,
	    getModuleDefinition: getModuleDefinition,
	    getModuleExtensionName: getModuleExtensionName
	  };
	};

	/***************************************************************************************
	 * (c) 2017 Adobe. All rights reserved.
	 * This file is licensed to you under the Apache License, Version 2.0 (the "License");
	 * you may not use this file except in compliance with the License. You may obtain a copy
	 * of the License at http://www.apache.org/licenses/LICENSE-2.0
	 *
	 * Unless required by applicable law or agreed to in writing, software distributed under
	 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
	 * OF ANY KIND, either express or implied. See the License for the specific language
	 * governing permissions and limitations under the License.
	 ****************************************************************************************/

	var warningLogged = false;

	var createNotifyMonitors = function (_satellite) {
	  return function (type, event) {
	    var monitors = _satellite._monitors;

	    if (monitors) {
	      if (!warningLogged) {
	        logger.warn(
	          'The _satellite._monitors API may change at any time and should only ' +
	            'be used for debugging.'
	        );
	        warningLogged = true;
	      }

	      monitors.forEach(function (monitor) {
	        if (monitor[type]) {
	          monitor[type](event);
	        }
	      });
	    }
	  };
	};

	/***************************************************************************************
	 * (c) 2017 Adobe. All rights reserved.
	 * This file is licensed to you under the Apache License, Version 2.0 (the "License");
	 * you may not use this file except in compliance with the License. You may obtain a copy
	 * of the License at http://www.apache.org/licenses/LICENSE-2.0
	 *
	 * Unless required by applicable law or agreed to in writing, software distributed under
	 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
	 * OF ANY KIND, either express or implied. See the License for the specific language
	 * governing permissions and limitations under the License.
	 ****************************************************************************************/

	/**
	 * Replacing any variable tokens (%myDataElement%, %this.foo%, etc.) with their associated values.
	 * A new string, object, or array will be created; the thing being processed will never be
	 * modified.
	 * @param {*} thing Thing potentially containing variable tokens. Objects and arrays will be
	 * deeply processed.
	 * @param {HTMLElement} [element] Associated HTML element. Used for special tokens
	 * (%this.something%).
	 * @param {Object} [event] Associated event. Used for special tokens (%event.something%,
	 * %target.something%)
	 * @returns {*} A processed value.
	 */
	var createReplaceTokens = function (isVar, getVar, undefinedVarsReturnEmpty) {
	  var replaceTokensInString;
	  var replaceTokensInObject;
	  var replaceTokensInArray;
	  var replaceTokens;
	  var variablesBeingRetrieved = [];

	  var getVarValue = function (token, variableName, syntheticEvent) {
	    if (!isVar(variableName)) {
	      return token;
	    }

	    variablesBeingRetrieved.push(variableName);
	    var val = getVar(variableName, syntheticEvent);
	    variablesBeingRetrieved.pop();
	    return val == null && undefinedVarsReturnEmpty ? '' : val;
	  };

	  /**
	   * Perform variable substitutions to a string where tokens are specified in the form %foo%.
	   * If the only content of the string is a single data element token, then the raw data element
	   * value will be returned instead.
	   *
	   * @param str {string} The string potentially containing data element tokens.
	   * @param element {HTMLElement} The element to use for tokens in the form of %this.property%.
	   * @param event {Object} The event object to use for tokens in the form of %target.property%.
	   * @returns {*}
	   */
	  replaceTokensInString = function (str, syntheticEvent) {
	    // Is the string a single data element token and nothing else?
	    var result = /^%([^%]+)%$/.exec(str);

	    if (result) {
	      return getVarValue(str, result[1], syntheticEvent);
	    } else {
	      return str.replace(/%(.+?)%/g, function (token, variableName) {
	        return getVarValue(token, variableName, syntheticEvent);
	      });
	    }
	  };

	  replaceTokensInObject = function (obj, syntheticEvent) {
	    var ret = {};
	    var keys = Object.keys(obj);
	    for (var i = 0; i < keys.length; i++) {
	      var key = keys[i];
	      var value = obj[key];
	      ret[key] = replaceTokens(value, syntheticEvent);
	    }
	    return ret;
	  };

	  replaceTokensInArray = function (arr, syntheticEvent) {
	    var ret = [];
	    for (var i = 0, len = arr.length; i < len; i++) {
	      ret.push(replaceTokens(arr[i], syntheticEvent));
	    }
	    return ret;
	  };

	  replaceTokens = function (thing, syntheticEvent) {
	    if (typeof thing === 'string') {
	      return replaceTokensInString(thing, syntheticEvent);
	    } else if (Array.isArray(thing)) {
	      return replaceTokensInArray(thing, syntheticEvent);
	    } else if (typeof thing === 'object' && thing !== null) {
	      return replaceTokensInObject(thing, syntheticEvent);
	    }

	    return thing;
	  };

	  return function (thing, syntheticEvent) {
	    // It's possible for a data element to reference another data element. Because of this,
	    // we need to prevent circular dependencies from causing an infinite loop.
	    if (variablesBeingRetrieved.length > 10) {
	      logger.error(
	        'Data element circular reference detected: ' +
	          variablesBeingRetrieved.join(' -> ')
	      );
	      return thing;
	    }

	    return replaceTokens(thing, syntheticEvent);
	  };
	};

	/***************************************************************************************
	 * (c) 2017 Adobe. All rights reserved.
	 * This file is licensed to you under the Apache License, Version 2.0 (the "License");
	 * you may not use this file except in compliance with the License. You may obtain a copy
	 * of the License at http://www.apache.org/licenses/LICENSE-2.0
	 *
	 * Unless required by applicable law or agreed to in writing, software distributed under
	 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
	 * OF ANY KIND, either express or implied. See the License for the specific language
	 * governing permissions and limitations under the License.
	 ****************************************************************************************/
	var createSetCustomVar = function (customVars) {
	  return function () {
	    if (typeof arguments[0] === 'string') {
	      customVars[arguments[0]] = arguments[1];
	    } else if (arguments[0]) {
	      // assume an object literal
	      var mapping = arguments[0];
	      for (var key in mapping) {
	        customVars[key] = mapping[key];
	      }
	    }
	  };
	};

	var commonjsGlobal = typeof globalThis !== 'undefined' ? globalThis : typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {};

	function getAugmentedNamespace(n) {
		if (n.__esModule) return n;
		var a = Object.defineProperty({}, '__esModule', {value: true});
		Object.keys(n).forEach(function (k) {
			var d = Object.getOwnPropertyDescriptor(n, k);
			Object.defineProperty(a, k, d.get ? d : {
				enumerable: true,
				get: function () {
					return n[k];
				}
			});
		});
		return a;
	}

	function createCommonjsModule(fn) {
	  var module = { exports: {} };
		return fn(module, module.exports), module.exports;
	}

	/**
	 * @this {Promise}
	 */
	function finallyConstructor(callback) {
	  var constructor = this.constructor;
	  return this.then(
	    function(value) {
	      // @ts-ignore
	      return constructor.resolve(callback()).then(function() {
	        return value;
	      });
	    },
	    function(reason) {
	      // @ts-ignore
	      return constructor.resolve(callback()).then(function() {
	        // @ts-ignore
	        return constructor.reject(reason);
	      });
	    }
	  );
	}

	// Store setTimeout reference so promise-polyfill will be unaffected by
	// other code modifying setTimeout (like sinon.useFakeTimers())
	var setTimeoutFunc = setTimeout;

	function isArray(x) {
	  return Boolean(x && typeof x.length !== 'undefined');
	}

	function noop() {}

	// Polyfill for Function.prototype.bind
	function bind(fn, thisArg) {
	  return function() {
	    fn.apply(thisArg, arguments);
	  };
	}

	/**
	 * @constructor
	 * @param {Function} fn
	 */
	function Promise$1(fn) {
	  if (!(this instanceof Promise$1))
	    throw new TypeError('Promises must be constructed via new');
	  if (typeof fn !== 'function') throw new TypeError('not a function');
	  /** @type {!number} */
	  this._state = 0;
	  /** @type {!boolean} */
	  this._handled = false;
	  /** @type {Promise|undefined} */
	  this._value = undefined;
	  /** @type {!Array<!Function>} */
	  this._deferreds = [];

	  doResolve(fn, this);
	}

	function handle(self, deferred) {
	  while (self._state === 3) {
	    self = self._value;
	  }
	  if (self._state === 0) {
	    self._deferreds.push(deferred);
	    return;
	  }
	  self._handled = true;
	  Promise$1._immediateFn(function() {
	    var cb = self._state === 1 ? deferred.onFulfilled : deferred.onRejected;
	    if (cb === null) {
	      (self._state === 1 ? resolve : reject)(deferred.promise, self._value);
	      return;
	    }
	    var ret;
	    try {
	      ret = cb(self._value);
	    } catch (e) {
	      reject(deferred.promise, e);
	      return;
	    }
	    resolve(deferred.promise, ret);
	  });
	}

	function resolve(self, newValue) {
	  try {
	    // Promise Resolution Procedure: https://github.com/promises-aplus/promises-spec#the-promise-resolution-procedure
	    if (newValue === self)
	      throw new TypeError('A promise cannot be resolved with itself.');
	    if (
	      newValue &&
	      (typeof newValue === 'object' || typeof newValue === 'function')
	    ) {
	      var then = newValue.then;
	      if (newValue instanceof Promise$1) {
	        self._state = 3;
	        self._value = newValue;
	        finale(self);
	        return;
	      } else if (typeof then === 'function') {
	        doResolve(bind(then, newValue), self);
	        return;
	      }
	    }
	    self._state = 1;
	    self._value = newValue;
	    finale(self);
	  } catch (e) {
	    reject(self, e);
	  }
	}

	function reject(self, newValue) {
	  self._state = 2;
	  self._value = newValue;
	  finale(self);
	}

	function finale(self) {
	  if (self._state === 2 && self._deferreds.length === 0) {
	    Promise$1._immediateFn(function() {
	      if (!self._handled) {
	        Promise$1._unhandledRejectionFn(self._value);
	      }
	    });
	  }

	  for (var i = 0, len = self._deferreds.length; i < len; i++) {
	    handle(self, self._deferreds[i]);
	  }
	  self._deferreds = null;
	}

	/**
	 * @constructor
	 */
	function Handler(onFulfilled, onRejected, promise) {
	  this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;
	  this.onRejected = typeof onRejected === 'function' ? onRejected : null;
	  this.promise = promise;
	}

	/**
	 * Take a potentially misbehaving resolver function and make sure
	 * onFulfilled and onRejected are only called once.
	 *
	 * Makes no guarantees about asynchrony.
	 */
	function doResolve(fn, self) {
	  var done = false;
	  try {
	    fn(
	      function(value) {
	        if (done) return;
	        done = true;
	        resolve(self, value);
	      },
	      function(reason) {
	        if (done) return;
	        done = true;
	        reject(self, reason);
	      }
	    );
	  } catch (ex) {
	    if (done) return;
	    done = true;
	    reject(self, ex);
	  }
	}

	Promise$1.prototype['catch'] = function(onRejected) {
	  return this.then(null, onRejected);
	};

	Promise$1.prototype.then = function(onFulfilled, onRejected) {
	  // @ts-ignore
	  var prom = new this.constructor(noop);

	  handle(this, new Handler(onFulfilled, onRejected, prom));
	  return prom;
	};

	Promise$1.prototype['finally'] = finallyConstructor;

	Promise$1.all = function(arr) {
	  return new Promise$1(function(resolve, reject) {
	    if (!isArray(arr)) {
	      return reject(new TypeError('Promise.all accepts an array'));
	    }

	    var args = Array.prototype.slice.call(arr);
	    if (args.length === 0) return resolve([]);
	    var remaining = args.length;

	    function res(i, val) {
	      try {
	        if (val && (typeof val === 'object' || typeof val === 'function')) {
	          var then = val.then;
	          if (typeof then === 'function') {
	            then.call(
	              val,
	              function(val) {
	                res(i, val);
	              },
	              reject
	            );
	            return;
	          }
	        }
	        args[i] = val;
	        if (--remaining === 0) {
	          resolve(args);
	        }
	      } catch (ex) {
	        reject(ex);
	      }
	    }

	    for (var i = 0; i < args.length; i++) {
	      res(i, args[i]);
	    }
	  });
	};

	Promise$1.resolve = function(value) {
	  if (value && typeof value === 'object' && value.constructor === Promise$1) {
	    return value;
	  }

	  return new Promise$1(function(resolve) {
	    resolve(value);
	  });
	};

	Promise$1.reject = function(value) {
	  return new Promise$1(function(resolve, reject) {
	    reject(value);
	  });
	};

	Promise$1.race = function(arr) {
	  return new Promise$1(function(resolve, reject) {
	    if (!isArray(arr)) {
	      return reject(new TypeError('Promise.race accepts an array'));
	    }

	    for (var i = 0, len = arr.length; i < len; i++) {
	      Promise$1.resolve(arr[i]).then(resolve, reject);
	    }
	  });
	};

	// Use polyfill for setImmediate for performance gains
	Promise$1._immediateFn =
	  // @ts-ignore
	  (typeof setImmediate === 'function' &&
	    function(fn) {
	      // @ts-ignore
	      setImmediate(fn);
	    }) ||
	  function(fn) {
	    setTimeoutFunc(fn, 0);
	  };

	Promise$1._unhandledRejectionFn = function _unhandledRejectionFn(err) {
	  if (typeof console !== 'undefined' && console) {
	    console.warn('Possible Unhandled Promise Rejection:', err); // eslint-disable-line no-console
	  }
	};

	var src$1 = /*#__PURE__*/Object.freeze({
		__proto__: null,
		'default': Promise$1
	});

	var require$$0 = /*@__PURE__*/getAugmentedNamespace(src$1);

	/***************************************************************************************
	 * (c) 2017 Adobe. All rights reserved.
	 * This file is licensed to you under the Apache License, Version 2.0 (the "License");
	 * you may not use this file except in compliance with the License. You may obtain a copy
	 * of the License at http://www.apache.org/licenses/LICENSE-2.0
	 *
	 * Unless required by applicable law or agreed to in writing, software distributed under
	 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
	 * OF ANY KIND, either express or implied. See the License for the specific language
	 * governing permissions and limitations under the License.
	 ****************************************************************************************/

	// For building Turbine we are using Rollup. For running the turbine tests we are using
	// Karma + Webpack. You need to specify the default import when using promise-polyfill`
	// with Webpack 2+. We need `require('promise-polyfill').default` for running the tests
	// and `require('promise-polyfill')` for building Turbine.
	var reactorPromise =
	  (typeof window !== 'undefined' && window.Promise) ||
	  (typeof commonjsGlobal !== 'undefined' && commonjsGlobal.Promise) ||
	  require$$0.default ||
	  require$$0;

	/*
	Copyright 2020 Adobe. All rights reserved.
	This file is licensed to you under the Apache License, Version 2.0 (the "License");
	you may not use this file except in compliance with the License. You may obtain a copy
	of the License at http://www.apache.org/licenses/LICENSE-2.0

	Unless required by applicable law or agreed to in writing, software distributed under
	the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
	OF ANY KIND, either express or implied. See the License for the specific language
	governing permissions and limitations under the License.
	*/

	var createAddActionToQueue = function (
	  executeDelegateModule,
	  normalizeRuleComponentError,
	  logActionError
	) {
	  return function (action, rule, syntheticEvent, lastPromiseInQueue) {
	    return lastPromiseInQueue.then(function () {
	      // This module is used when ruleComponentSequencing is enabled.
	      // action.timeout is always supplied to this module as >= 0 when delayNext is true.

	      var delayNextAction = action.delayNext;
	      var actionTimeoutId;

	      return new reactorPromise(function (resolve, reject) {
	        var moduleResult = executeDelegateModule(action, syntheticEvent, [
	          syntheticEvent
	        ]);

	        if (!delayNextAction) {
	          return resolve();
	        }

	        var promiseTimeoutMs = action.timeout;
	        var timeoutPromise = new reactorPromise(function (resolve, reject) {
	          actionTimeoutId = setTimeout(function () {
	            reject(
	              new Error(
	                'A timeout occurred because the action took longer than ' +
	                  promiseTimeoutMs / 1000 +
	                  ' seconds to complete. '
	              )
	            );
	          }, promiseTimeoutMs);
	        });

	        reactorPromise.race([moduleResult, timeoutPromise]).then(resolve, reject);
	      })
	        .catch(function (e) {
	          clearTimeout(actionTimeoutId);
	          e = normalizeRuleComponentError(e);
	          logActionError(action, rule, e);
	          return reactorPromise.reject(e);
	        })
	        .then(function () {
	          clearTimeout(actionTimeoutId);
	        });
	    });
	  };
	};

	/*
	Copyright 2020 Adobe. All rights reserved.
	This file is licensed to you under the Apache License, Version 2.0 (the "License");
	you may not use this file except in compliance with the License. You may obtain a copy
	of the License at http://www.apache.org/licenses/LICENSE-2.0

	Unless required by applicable law or agreed to in writing, software distributed under
	the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
	OF ANY KIND, either express or implied. See the License for the specific language
	governing permissions and limitations under the License.
	*/

	var createAddConditionToQueue = function (
	  executeDelegateModule,
	  normalizeRuleComponentError,
	  isConditionMet,
	  logConditionError,
	  logConditionNotMet
	) {
	  return function (condition, rule, syntheticEvent, lastPromiseInQueue) {
	    return lastPromiseInQueue.then(function () {
	      // This module is used when ruleComponentSequencing is enabled.
	      // condition.timeout is always supplied to this module as >= 0.
	      // Conditions always assume delayNext = true because we have to know the
	      // condition result before moving on.
	      var conditionTimeoutId;

	      return new reactorPromise(function (resolve, reject) {
	        var moduleResult = executeDelegateModule(condition, syntheticEvent, [
	          syntheticEvent
	        ]);

	        var promiseTimeoutMs = condition.timeout;
	        var timeoutPromise = new reactorPromise(function (resolve, reject) {
	          conditionTimeoutId = setTimeout(function () {
	            reject(
	              new Error(
	                'A timeout occurred because the condition took longer than ' +
	                  promiseTimeoutMs / 1000 +
	                  ' seconds to complete. '
	              )
	            );
	          }, promiseTimeoutMs);
	        });

	        reactorPromise.race([moduleResult, timeoutPromise]).then(resolve, reject);
	      })
	        .catch(function (e) {
	          clearTimeout(conditionTimeoutId);
	          e = normalizeRuleComponentError(e);
	          logConditionError(condition, rule, e);
	          return reactorPromise.reject(e);
	        })
	        .then(function (result) {
	          clearTimeout(conditionTimeoutId);
	          if (!isConditionMet(condition, result)) {
	            logConditionNotMet(condition, rule);
	            return reactorPromise.reject();
	          }
	        });
	    });
	  };
	};

	/*
	Copyright 2020 Adobe. All rights reserved.
	This file is licensed to you under the Apache License, Version 2.0 (the "License");
	you may not use this file except in compliance with the License. You may obtain a copy
	of the License at http://www.apache.org/licenses/LICENSE-2.0

	Unless required by applicable law or agreed to in writing, software distributed under
	the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
	OF ANY KIND, either express or implied. See the License for the specific language
	governing permissions and limitations under the License.
	*/

	var lastPromiseInQueue = reactorPromise.resolve();

	var createAddRuleToQueue = function (
	  addConditionToQueue,
	  addActionToQueue,
	  logRuleCompleted
	) {
	  return function (rule, syntheticEvent) {
	    if (rule.conditions) {
	      rule.conditions.forEach(function (condition) {
	        lastPromiseInQueue = addConditionToQueue(
	          condition,
	          rule,
	          syntheticEvent,
	          lastPromiseInQueue
	        );
	      });
	    }

	    if (rule.actions) {
	      rule.actions.forEach(function (action) {
	        lastPromiseInQueue = addActionToQueue(
	          action,
	          rule,
	          syntheticEvent,
	          lastPromiseInQueue
	        );
	      });
	    }

	    lastPromiseInQueue = lastPromiseInQueue.then(function () {
	      logRuleCompleted(rule);
	    });

	    // Allows later rules to keep running when an error occurs within this rule.
	    lastPromiseInQueue = lastPromiseInQueue.catch(function () {});

	    return lastPromiseInQueue;
	  };
	};

	var isPromiseLike = function (value) {
	  return Boolean(
	    value && typeof value === 'object' && typeof value.then === 'function'
	  );
	};

	/*
	Copyright 2020 Adobe. All rights reserved.
	This file is licensed to you under the Apache License, Version 2.0 (the "License");
	you may not use this file except in compliance with the License. You may obtain a copy
	of the License at http://www.apache.org/licenses/LICENSE-2.0

	Unless required by applicable law or agreed to in writing, software distributed under
	the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
	OF ANY KIND, either express or implied. See the License for the specific language
	governing permissions and limitations under the License.
	*/

	var createEvaluateConditions = function (
	  executeDelegateModule,
	  isConditionMet,
	  logConditionNotMet,
	  logConditionError
	) {
	  return function (rule, syntheticEvent) {
	    var condition;

	    if (rule.conditions) {
	      for (var i = 0; i < rule.conditions.length; i++) {
	        condition = rule.conditions[i];

	        try {
	          var result = executeDelegateModule(condition, syntheticEvent, [
	            syntheticEvent
	          ]);

	          // If the result is promise-like, the extension needs to do something asynchronously,
	          // but the customer does not have rule component sequencing enabled on the property.
	          // If we didn't do this, the condition would always pass because the promise is
	          // considered "truthy".
	          if (isPromiseLike(result)) {
	            throw new Error(
	              'Rule component sequencing must be enabled on the property ' +
	                'for this condition to function properly.'
	            );
	          }

	          if (!isConditionMet(condition, result)) {
	            logConditionNotMet(condition, rule);
	            return false;
	          }
	        } catch (e) {
	          logConditionError(condition, rule, e);
	          return false;
	        }
	      }
	    }

	    return true;
	  };
	};

	/*
	Copyright 2020 Adobe. All rights reserved.
	This file is licensed to you under the Apache License, Version 2.0 (the "License");
	you may not use this file except in compliance with the License. You may obtain a copy
	of the License at http://www.apache.org/licenses/LICENSE-2.0

	Unless required by applicable law or agreed to in writing, software distributed under
	the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
	OF ANY KIND, either express or implied. See the License for the specific language
	governing permissions and limitations under the License.
	*/
	var createExecuteRule = function (evaluateConditions, runActions) {
	  return function (rule, normalizedSyntheticEvent) {
	    if (evaluateConditions(rule, normalizedSyntheticEvent)) {
	      runActions(rule, normalizedSyntheticEvent);
	    }
	  };
	};

	/*
	Copyright 2020 Adobe. All rights reserved.
	This file is licensed to you under the Apache License, Version 2.0 (the "License");
	you may not use this file except in compliance with the License. You may obtain a copy
	of the License at http://www.apache.org/licenses/LICENSE-2.0

	Unless required by applicable law or agreed to in writing, software distributed under
	the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
	OF ANY KIND, either express or implied. See the License for the specific language
	governing permissions and limitations under the License.
	*/
	var createGetModuleDisplayNameByRuleComponent = function (moduleProvider) {
	  return function (ruleComponent) {
	    var moduleDefinition = moduleProvider.getModuleDefinition(
	      ruleComponent.modulePath
	    );
	    return (
	      (moduleDefinition && moduleDefinition.displayName) ||
	      ruleComponent.modulePath
	    );
	  };
	};

	/*
	Copyright 2020 Adobe. All rights reserved.
	This file is licensed to you under the Apache License, Version 2.0 (the "License");
	you may not use this file except in compliance with the License. You may obtain a copy
	of the License at http://www.apache.org/licenses/LICENSE-2.0

	Unless required by applicable law or agreed to in writing, software distributed under
	the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
	OF ANY KIND, either express or implied. See the License for the specific language
	governing permissions and limitations under the License.
	*/
	var createGetSyntheticEventMeta = function (moduleProvider) {
	  return function (ruleEventPair) {
	    var rule = ruleEventPair.rule;
	    var event = ruleEventPair.event;

	    var moduleName = moduleProvider.getModuleDefinition(event.modulePath).name;
	    var extensionName = moduleProvider.getModuleExtensionName(event.modulePath);

	    return {
	      $type: extensionName + '.' + moduleName,
	      $rule: {
	        id: rule.id,
	        name: rule.name
	      }
	    };
	  };
	};

	/*
	Copyright 2020 Adobe. All rights reserved.
	This file is licensed to you under the Apache License, Version 2.0 (the "License");
	you may not use this file except in compliance with the License. You may obtain a copy
	of the License at http://www.apache.org/licenses/LICENSE-2.0

	Unless required by applicable law or agreed to in writing, software distributed under
	the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
	OF ANY KIND, either express or implied. See the License for the specific language
	governing permissions and limitations under the License.
	*/
	var createInitEventModule = function (
	  triggerRule,
	  executeDelegateModule,
	  normalizeSyntheticEvent,
	  getErrorMessage,
	  getSyntheticEventMeta,
	  logger
	) {
	  return function (guardUntilAllInitialized, ruleEventPair) {
	    var rule = ruleEventPair.rule;
	    var event = ruleEventPair.event;
	    event.settings = event.settings || {};

	    try {
	      var syntheticEventMeta = getSyntheticEventMeta(ruleEventPair);

	      executeDelegateModule(event, null, [
	        /**
	         * This is the callback that executes a particular rule when an event has occurred.
	         * @param {Object} [syntheticEvent] An object that contains detail regarding the event
	         * that occurred.
	         */
	        function trigger(syntheticEvent) {
	          // DTM-11871
	          // If we're still in the process of initializing event modules,
	          // we need to queue up any calls to trigger, otherwise if the triggered
	          // rule does something that triggers a different rule whose event module
	          // has not been initialized, that secondary rule will never get executed.
	          // This can be removed if we decide to always use the rule queue, since
	          // conditions and actions will be processed asynchronously, which
	          // would give time for all event modules to be initialized.

	          var normalizedSyntheticEvent = normalizeSyntheticEvent(
	            syntheticEventMeta,
	            syntheticEvent
	          );

	          guardUntilAllInitialized(function () {
	            triggerRule(normalizedSyntheticEvent, rule);
	          });
	        }
	      ]);
	    } catch (e) {
	      logger.error(getErrorMessage(event, rule, e));
	    }
	  };
	};

	/*
	Copyright 2020 Adobe. All rights reserved.
	This file is licensed to you under the Apache License, Version 2.0 (the "License");
	you may not use this file except in compliance with the License. You may obtain a copy
	of the License at http://www.apache.org/licenses/LICENSE-2.0

	Unless required by applicable law or agreed to in writing, software distributed under
	the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
	OF ANY KIND, either express or implied. See the License for the specific language
	governing permissions and limitations under the License.
	*/
	var createLogActionError = function (
	  getRuleComponentErrorMessage,
	  getModuleDisplayNameByRuleComponent,
	  logger,
	  notifyMonitors
	) {
	  return function (action, rule, e) {
	    var actionDisplayName = getModuleDisplayNameByRuleComponent(action);

	    logger.error(getRuleComponentErrorMessage(actionDisplayName, rule.name, e));

	    notifyMonitors('ruleActionFailed', {
	      rule: rule,
	      action: action
	    });
	  };
	};

	/*
	Copyright 2020 Adobe. All rights reserved.
	This file is licensed to you under the Apache License, Version 2.0 (the "License");
	you may not use this file except in compliance with the License. You may obtain a copy
	of the License at http://www.apache.org/licenses/LICENSE-2.0

	Unless required by applicable law or agreed to in writing, software distributed under
	the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
	OF ANY KIND, either express or implied. See the License for the specific language
	governing permissions and limitations under the License.
	*/
	var createLogConditionError = function (
	  getRuleComponentErrorMessage,
	  getModuleDisplayNameByRuleComponent,
	  logger,
	  notifyMonitors
	) {
	  return function (condition, rule, e) {
	    var conditionDisplayName = getModuleDisplayNameByRuleComponent(condition);

	    logger.error(
	      getRuleComponentErrorMessage(conditionDisplayName, rule.name, e)
	    );

	    notifyMonitors('ruleConditionFailed', {
	      rule: rule,
	      condition: condition
	    });
	  };
	};

	/*
	Copyright 2020 Adobe. All rights reserved.
	This file is licensed to you under the Apache License, Version 2.0 (the "License");
	you may not use this file except in compliance with the License. You may obtain a copy
	of the License at http://www.apache.org/licenses/LICENSE-2.0

	Unless required by applicable law or agreed to in writing, software distributed under
	the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
	OF ANY KIND, either express or implied. See the License for the specific language
	governing permissions and limitations under the License.
	*/
	var createLogConditionNotMet = function (
	  getModuleDisplayNameByRuleComponent,
	  logger,
	  notifyMonitors
	) {
	  return function (condition, rule) {
	    var conditionDisplayName = getModuleDisplayNameByRuleComponent(condition);

	    logger.log(
	      'Condition "' +
	        conditionDisplayName +
	        '" for rule "' +
	        rule.name +
	        '" was not met.'
	    );

	    notifyMonitors('ruleConditionFailed', {
	      rule: rule,
	      condition: condition
	    });
	  };
	};

	/*
	Copyright 2020 Adobe. All rights reserved.
	This file is licensed to you under the Apache License, Version 2.0 (the "License");
	you may not use this file except in compliance with the License. You may obtain a copy
	of the License at http://www.apache.org/licenses/LICENSE-2.0

	Unless required by applicable law or agreed to in writing, software distributed under
	the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
	OF ANY KIND, either express or implied. See the License for the specific language
	governing permissions and limitations under the License.
	*/
	var createLogRuleCompleted = function (logger, notifyMonitors) {
	  return function (rule) {
	    logger.log('Rule "' + rule.name + '" fired.');
	    notifyMonitors('ruleCompleted', {
	      rule: rule
	    });
	  };
	};

	/*
	Copyright 2020 Adobe. All rights reserved.
	This file is licensed to you under the Apache License, Version 2.0 (the "License");
	you may not use this file except in compliance with the License. You may obtain a copy
	of the License at http://www.apache.org/licenses/LICENSE-2.0

	Unless required by applicable law or agreed to in writing, software distributed under
	the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
	OF ANY KIND, either express or implied. See the License for the specific language
	governing permissions and limitations under the License.
	*/
	var createRunActions = function (
	  executeDelegateModule,
	  logActionError,
	  logRuleCompleted
	) {
	  return function (rule, syntheticEvent) {
	    var action;

	    if (rule.actions) {
	      for (var i = 0; i < rule.actions.length; i++) {
	        action = rule.actions[i];
	        try {
	          executeDelegateModule(action, syntheticEvent, [syntheticEvent]);
	        } catch (e) {
	          logActionError(action, rule, e);
	          return;
	        }
	      }
	    }

	    logRuleCompleted(rule);
	  };
	};

	/*
	Copyright 2020 Adobe. All rights reserved.
	This file is licensed to you under the Apache License, Version 2.0 (the "License");
	you may not use this file except in compliance with the License. You may obtain a copy
	of the License at http://www.apache.org/licenses/LICENSE-2.0

	Unless required by applicable law or agreed to in writing, software distributed under
	the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
	OF ANY KIND, either express or implied. See the License for the specific language
	governing permissions and limitations under the License.
	*/
	var createTriggerRule = function (
	  ruleComponentSequencingEnabled,
	  executeRule,
	  addRuleToQueue,
	  notifyMonitors
	) {
	  return function (normalizedSyntheticEvent, rule) {
	    notifyMonitors('ruleTriggered', {
	      rule: rule
	    });

	    if (ruleComponentSequencingEnabled) {
	      addRuleToQueue(rule, normalizedSyntheticEvent);
	    } else {
	      executeRule(rule, normalizedSyntheticEvent);
	    }
	  };
	};

	/*
	Copyright 2020 Adobe. All rights reserved.
	This file is licensed to you under the Apache License, Version 2.0 (the "License");
	you may not use this file except in compliance with the License. You may obtain a copy
	of the License at http://www.apache.org/licenses/LICENSE-2.0

	Unless required by applicable law or agreed to in writing, software distributed under
	the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
	OF ANY KIND, either express or implied. See the License for the specific language
	governing permissions and limitations under the License.
	*/
	var getRuleComponentErrorMessage = function (ruleComponentName, ruleName, error) {
	  return (
	    'Failed to execute "' +
	    ruleComponentName +
	    '" for "' +
	    ruleName +
	    '" rule. ' +
	    error.message +
	    (error.stack ? '\n' + error.stack : '')
	  );
	};

	/*
	Copyright 2020 Adobe. All rights reserved.
	This file is licensed to you under the Apache License, Version 2.0 (the "License");
	you may not use this file except in compliance with the License. You may obtain a copy
	of the License at http://www.apache.org/licenses/LICENSE-2.0

	Unless required by applicable law or agreed to in writing, software distributed under
	the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
	OF ANY KIND, either express or implied. See the License for the specific language
	governing permissions and limitations under the License.
	*/
	var isConditionMet = function (condition, result) {
	  return (result && !condition.negate) || (!result && condition.negate);
	};

	/*
	Copyright 2020 Adobe. All rights reserved.
	This file is licensed to you under the Apache License, Version 2.0 (the "License");
	you may not use this file except in compliance with the License. You may obtain a copy
	of the License at http://www.apache.org/licenses/LICENSE-2.0

	Unless required by applicable law or agreed to in writing, software distributed under
	the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
	OF ANY KIND, either express or implied. See the License for the specific language
	governing permissions and limitations under the License.
	*/
	var triggerCallQueue = [];
	var eventModulesInitialized = false;

	var guardUntilAllInitialized = function (callback) {
	  if (!eventModulesInitialized) {
	    triggerCallQueue.push(callback);
	  } else {
	    callback();
	  }
	};

	var initRules = function (buildRuleExecutionOrder, rules, initEventModule) {
	  buildRuleExecutionOrder(rules).forEach(function (ruleEventPair) {
	    initEventModule(guardUntilAllInitialized, ruleEventPair);
	  });

	  eventModulesInitialized = true;
	  triggerCallQueue.forEach(function (triggerCall) {
	    triggerCall();
	  });

	  triggerCallQueue = [];
	};

	/*
	Copyright 2020 Adobe. All rights reserved.
	This file is licensed to you under the Apache License, Version 2.0 (the "License");
	you may not use this file except in compliance with the License. You may obtain a copy
	of the License at http://www.apache.org/licenses/LICENSE-2.0

	Unless required by applicable law or agreed to in writing, software distributed under
	the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
	OF ANY KIND, either express or implied. See the License for the specific language
	governing permissions and limitations under the License.
	*/
	var normalizeRuleComponentError = function (e) {
	  if (!e) {
	    e = new Error(
	      'The extension triggered an error, but no error information was provided.'
	    );
	  }

	  if (!(e instanceof Error)) {
	    var stringifiedError =
	      typeof e === 'object' ? JSON.stringify(e) : String(e);
	    e = new Error(stringifiedError);
	  }

	  return e;
	};

	/*!
	 * isobject <https://github.com/jonschlinkert/isobject>
	 *
	 * Copyright (c) 2014-2017, Jon Schlinkert.
	 * Released under the MIT License.
	 */

	var isobject = function isObject(val) {
	  return val != null && typeof val === 'object' && Array.isArray(val) === false;
	};

	/*!
	 * is-plain-object <https://github.com/jonschlinkert/is-plain-object>
	 *
	 * Copyright (c) 2014-2017, Jon Schlinkert.
	 * Released under the MIT License.
	 */



	function isObjectObject(o) {
	  return isobject(o) === true
	    && Object.prototype.toString.call(o) === '[object Object]';
	}

	var isPlainObject = function isPlainObject(o) {
	  var ctor,prot;

	  if (isObjectObject(o) === false) return false;

	  // If has modified constructor
	  ctor = o.constructor;
	  if (typeof ctor !== 'function') return false;

	  // If has modified prototype
	  prot = ctor.prototype;
	  if (isObjectObject(prot) === false) return false;

	  // If constructor does not have an Object-specific method
	  if (prot.hasOwnProperty('isPrototypeOf') === false) {
	    return false;
	  }

	  // Most likely a plain Object
	  return true;
	};

	/***************************************************************************************
	 * (c) 2017 Adobe. All rights reserved.
	 * This file is licensed to you under the Apache License, Version 2.0 (the "License");
	 * you may not use this file except in compliance with the License. You may obtain a copy
	 * of the License at http://www.apache.org/licenses/LICENSE-2.0
	 *
	 * Unless required by applicable law or agreed to in writing, software distributed under
	 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
	 * OF ANY KIND, either express or implied. See the License for the specific language
	 * governing permissions and limitations under the License.
	 ****************************************************************************************/

	/**
	 * Normalizes a synthetic event so that it exists and has at least meta.
	 * @param {Object} syntheticEventMeta
	 * @param {Object} [syntheticEvent]
	 * @returns {Object}
	 */
	var normalizeSyntheticEvent = function (syntheticEventMeta, syntheticEvent) {
	  syntheticEvent = syntheticEvent || {};

	  // This ensures that as the user hands us a synthetic event for multiple rules,
	  // we aren't overwriting a new meta into the same object reference.
	  if (isPlainObject(syntheticEvent)) {
	    syntheticEvent = reactorObjectAssign({}, syntheticEvent, syntheticEventMeta);
	  } else {
	    // When syntheticEvent is not an object, there's nothing we can guarantee
	    // about the ability to "copy". Leave it alone.
	    reactorObjectAssign(syntheticEvent, syntheticEventMeta);
	  }

	  // Remove after some arbitrary time period when we think users have had sufficient chance
	  // to move away from event.type
	  if (!syntheticEvent.hasOwnProperty('type')) {
	    Object.defineProperty(syntheticEvent, 'type', {
	      get: function () {
	        logger.deprecation(
	          'Accessing event.type in Adobe Launch has been deprecated and will be ' +
	            'removed soon. Please use event.$type instead.'
	        );
	        return syntheticEvent.$type;
	      }
	    });
	  }

	  return syntheticEvent;
	};

	/***************************************************************************************
	 * (c) 2017 Adobe. All rights reserved.
	 * This file is licensed to you under the Apache License, Version 2.0 (the "License");
	 * you may not use this file except in compliance with the License. You may obtain a copy
	 * of the License at http://www.apache.org/licenses/LICENSE-2.0
	 *
	 * Unless required by applicable law or agreed to in writing, software distributed under
	 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
	 * OF ANY KIND, either express or implied. See the License for the specific language
	 * governing permissions and limitations under the License.
	 ****************************************************************************************/
	/**
	 * Creates a function that, when called with an extension name and module name, will return the
	 * exports of the respective shared module.
	 *
	 * @param {Object} extensions
	 * @param {Object} moduleProvider
	 * @returns {Function}
	 */
	var createGetSharedModuleExports = function (extensions, moduleProvider) {
	  return function (extensionName, moduleName) {
	    var extension = extensions[extensionName];

	    if (extension) {
	      var modules = extension.modules;
	      if (modules) {
	        var referencePaths = Object.keys(modules);
	        for (var i = 0; i < referencePaths.length; i++) {
	          var referencePath = referencePaths[i];
	          var module = modules[referencePath];
	          if (module.shared && module.name === moduleName) {
	            return moduleProvider.getModuleExports(referencePath);
	          }
	        }
	      }
	    }
	  };
	};

	/***************************************************************************************
	 * (c) 2017 Adobe. All rights reserved.
	 * This file is licensed to you under the Apache License, Version 2.0 (the "License");
	 * you may not use this file except in compliance with the License. You may obtain a copy
	 * of the License at http://www.apache.org/licenses/LICENSE-2.0
	 *
	 * Unless required by applicable law or agreed to in writing, software distributed under
	 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
	 * OF ANY KIND, either express or implied. See the License for the specific language
	 * governing permissions and limitations under the License.
	 ****************************************************************************************/
	/**
	 * Creates a function that, when called, will return a configuration object with data element
	 * tokens replaced.
	 *
	 * @param {Object} settings
	 * @returns {Function}
	 */
	var createGetExtensionSettings = function (replaceTokens, settings) {
	  return function () {
	    return settings ? replaceTokens(settings) : {};
	  };
	};

	/***************************************************************************************
	 * (c) 2017 Adobe. All rights reserved.
	 * This file is licensed to you under the Apache License, Version 2.0 (the "License");
	 * you may not use this file except in compliance with the License. You may obtain a copy
	 * of the License at http://www.apache.org/licenses/LICENSE-2.0
	 *
	 * Unless required by applicable law or agreed to in writing, software distributed under
	 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
	 * OF ANY KIND, either express or implied. See the License for the specific language
	 * governing permissions and limitations under the License.
	 ****************************************************************************************/
	/**
	 * Creates a function that, when called, will return the full hosted lib file URL.
	 *
	 * @param {string} hostedLibFilesBaseUrl
	 * @returns {Function}
	 */

	var createGetHostedLibFileUrl = function (
	  decorateWithDynamicHost,
	  hostedLibFilesBaseUrl,
	  minified
	) {
	  return function (file) {
	    if (minified) {
	      var fileParts = file.split('.');
	      fileParts.splice(fileParts.length - 1 || 1, 0, 'min');
	      file = fileParts.join('.');
	    }

	    return decorateWithDynamicHost(hostedLibFilesBaseUrl) + file;
	  };
	};

	/***************************************************************************************
	 * (c) 2017 Adobe. All rights reserved.
	 * This file is licensed to you under the Apache License, Version 2.0 (the "License");
	 * you may not use this file except in compliance with the License. You may obtain a copy
	 * of the License at http://www.apache.org/licenses/LICENSE-2.0
	 *
	 * Unless required by applicable law or agreed to in writing, software distributed under
	 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
	 * OF ANY KIND, either express or implied. See the License for the specific language
	 * governing permissions and limitations under the License.
	 ****************************************************************************************/
	var JS_EXTENSION = '.js';

	/**
	 * @private
	 * Returns the directory of a path. A limited version of path.dirname in nodejs.
	 *
	 * To keep it simple, it makes the following assumptions:
	 * path has a least one slash
	 * path does not end with a slash
	 * path does not have empty segments (e.g., /src/lib//foo.bar)
	 *
	 * @param {string} path
	 * @returns {string}
	 */
	var dirname = function (path) {
	  return path.substr(0, path.lastIndexOf('/'));
	};

	/**
	 * Determines if a string ends with a certain string.
	 * @param {string} str The string to test.
	 * @param {string} suffix The suffix to look for at the end of str.
	 * @returns {boolean} Whether str ends in suffix.
	 */
	var endsWith = function (str, suffix) {
	  return str.indexOf(suffix, str.length - suffix.length) !== -1;
	};

	/**
	 * Given a starting path and a path relative to the starting path, returns the final path. A
	 * limited version of path.resolve in nodejs.
	 *
	 * To keep it simple, it makes the following assumptions:
	 * fromPath has at least one slash
	 * fromPath does not end with a slash.
	 * fromPath does not have empty segments (e.g., /src/lib//foo.bar)
	 * relativePath starts with ./ or ../
	 *
	 * @param {string} fromPath
	 * @param {string} relativePath
	 * @returns {string}
	 */
	var resolveRelativePath = function (fromPath, relativePath) {
	  // Handle the case where the relative path does not end in the .js extension. We auto-append it.
	  if (!endsWith(relativePath, JS_EXTENSION)) {
	    relativePath = relativePath + JS_EXTENSION;
	  }

	  var relativePathSegments = relativePath.split('/');
	  var resolvedPathSegments = dirname(fromPath).split('/');

	  relativePathSegments.forEach(function (relativePathSegment) {
	    if (!relativePathSegment || relativePathSegment === '.') {
	      return;
	    } else if (relativePathSegment === '..') {
	      if (resolvedPathSegments.length) {
	        resolvedPathSegments.pop();
	      }
	    } else {
	      resolvedPathSegments.push(relativePathSegment);
	    }
	  });

	  return resolvedPathSegments.join('/');
	};

	/*!
	 * JavaScript Cookie v2.2.1
	 * https://github.com/js-cookie/js-cookie
	 *
	 * Copyright 2006, 2015 Klaus Hartl & Fagner Brack
	 * Released under the MIT license
	 */

	var js_cookie = createCommonjsModule(function (module, exports) {
	(function (factory) {
		var registeredInModuleLoader;
		{
			module.exports = factory();
			registeredInModuleLoader = true;
		}
		if (!registeredInModuleLoader) {
			var OldCookies = window.Cookies;
			var api = window.Cookies = factory();
			api.noConflict = function () {
				window.Cookies = OldCookies;
				return api;
			};
		}
	}(function () {
		function extend () {
			var i = 0;
			var result = {};
			for (; i < arguments.length; i++) {
				var attributes = arguments[ i ];
				for (var key in attributes) {
					result[key] = attributes[key];
				}
			}
			return result;
		}

		function decode (s) {
			return s.replace(/(%[0-9A-Z]{2})+/g, decodeURIComponent);
		}

		function init (converter) {
			function api() {}

			function set (key, value, attributes) {
				if (typeof document === 'undefined') {
					return;
				}

				attributes = extend({
					path: '/'
				}, api.defaults, attributes);

				if (typeof attributes.expires === 'number') {
					attributes.expires = new Date(new Date() * 1 + attributes.expires * 864e+5);
				}

				// We're using "expires" because "max-age" is not supported by IE
				attributes.expires = attributes.expires ? attributes.expires.toUTCString() : '';

				try {
					var result = JSON.stringify(value);
					if (/^[\{\[]/.test(result)) {
						value = result;
					}
				} catch (e) {}

				value = converter.write ?
					converter.write(value, key) :
					encodeURIComponent(String(value))
						.replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g, decodeURIComponent);

				key = encodeURIComponent(String(key))
					.replace(/%(23|24|26|2B|5E|60|7C)/g, decodeURIComponent)
					.replace(/[\(\)]/g, escape);

				var stringifiedAttributes = '';
				for (var attributeName in attributes) {
					if (!attributes[attributeName]) {
						continue;
					}
					stringifiedAttributes += '; ' + attributeName;
					if (attributes[attributeName] === true) {
						continue;
					}

					// Considers RFC 6265 section 5.2:
					// ...
					// 3.  If the remaining unparsed-attributes contains a %x3B (";")
					//     character:
					// Consume the characters of the unparsed-attributes up to,
					// not including, the first %x3B (";") character.
					// ...
					stringifiedAttributes += '=' + attributes[attributeName].split(';')[0];
				}

				return (document.cookie = key + '=' + value + stringifiedAttributes);
			}

			function get (key, json) {
				if (typeof document === 'undefined') {
					return;
				}

				var jar = {};
				// To prevent the for loop in the first place assign an empty array
				// in case there are no cookies at all.
				var cookies = document.cookie ? document.cookie.split('; ') : [];
				var i = 0;

				for (; i < cookies.length; i++) {
					var parts = cookies[i].split('=');
					var cookie = parts.slice(1).join('=');

					if (!json && cookie.charAt(0) === '"') {
						cookie = cookie.slice(1, -1);
					}

					try {
						var name = decode(parts[0]);
						cookie = (converter.read || converter)(cookie, name) ||
							decode(cookie);

						if (json) {
							try {
								cookie = JSON.parse(cookie);
							} catch (e) {}
						}

						jar[name] = cookie;

						if (key === name) {
							break;
						}
					} catch (e) {}
				}

				return key ? jar[key] : jar;
			}

			api.set = set;
			api.get = function (key) {
				return get(key, false /* read as raw */);
			};
			api.getJSON = function (key) {
				return get(key, true /* read as json */);
			};
			api.remove = function (key, attributes) {
				set(key, '', extend(attributes, {
					expires: -1
				}));
			};

			api.defaults = {};

			api.withConverter = init;

			return api;
		}

		return init(function () {});
	}));
	});

	/***************************************************************************************
	 * (c) 2017 Adobe. All rights reserved.
	 * This file is licensed to you under the Apache License, Version 2.0 (the "License");
	 * you may not use this file except in compliance with the License. You may obtain a copy
	 * of the License at http://www.apache.org/licenses/LICENSE-2.0
	 *
	 * Unless required by applicable law or agreed to in writing, software distributed under
	 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
	 * OF ANY KIND, either express or implied. See the License for the specific language
	 * governing permissions and limitations under the License.
	 ****************************************************************************************/



	// js-cookie has other methods that we haven't exposed here. By limiting the exposed API,
	// we have a little more flexibility to change the underlying implementation later. If clear
	// use cases come up for needing the other methods js-cookie exposes, we can re-evaluate whether
	// we want to expose them here.
	var reactorCookie = {
	  get: js_cookie.get,
	  set: js_cookie.set,
	  remove: js_cookie.remove
	};

	/***************************************************************************************
	 * (c) 2017 Adobe. All rights reserved.
	 * This file is licensed to you under the Apache License, Version 2.0 (the "License");
	 * you may not use this file except in compliance with the License. You may obtain a copy
	 * of the License at http://www.apache.org/licenses/LICENSE-2.0
	 *
	 * Unless required by applicable law or agreed to in writing, software distributed under
	 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
	 * OF ANY KIND, either express or implied. See the License for the specific language
	 * governing permissions and limitations under the License.
	 ****************************************************************************************/



	var getPromise = function(url, script) {
	  return new reactorPromise(function(resolve, reject) {
	    script.onload = function() {
	      resolve(script);
	    };

	    script.onerror = function() {
	      reject(new Error('Failed to load script ' + url));
	    };
	  });
	};

	var reactorLoadScript = function(url) {
	  var script = document.createElement('script');
	  script.src = url;
	  script.async = true;

	  var promise = getPromise(url, script);

	  document.getElementsByTagName('head')[0].appendChild(script);
	  return promise;
	};

	// Copyright Joyent, Inc. and other Node contributors.

	// If obj.hasOwnProperty has been overridden, then calling
	// obj.hasOwnProperty(prop) will break.
	// See: https://github.com/joyent/node/issues/1707
	function hasOwnProperty(obj, prop) {
	  return Object.prototype.hasOwnProperty.call(obj, prop);
	}

	var decode = function(qs, sep, eq, options) {
	  sep = sep || '&';
	  eq = eq || '=';
	  var obj = {};

	  if (typeof qs !== 'string' || qs.length === 0) {
	    return obj;
	  }

	  var regexp = /\+/g;
	  qs = qs.split(sep);

	  var maxKeys = 1000;
	  if (options && typeof options.maxKeys === 'number') {
	    maxKeys = options.maxKeys;
	  }

	  var len = qs.length;
	  // maxKeys <= 0 means that we should not limit keys count
	  if (maxKeys > 0 && len > maxKeys) {
	    len = maxKeys;
	  }

	  for (var i = 0; i < len; ++i) {
	    var x = qs[i].replace(regexp, '%20'),
	        idx = x.indexOf(eq),
	        kstr, vstr, k, v;

	    if (idx >= 0) {
	      kstr = x.substr(0, idx);
	      vstr = x.substr(idx + 1);
	    } else {
	      kstr = x;
	      vstr = '';
	    }

	    k = decodeURIComponent(kstr);
	    v = decodeURIComponent(vstr);

	    if (!hasOwnProperty(obj, k)) {
	      obj[k] = v;
	    } else if (Array.isArray(obj[k])) {
	      obj[k].push(v);
	    } else {
	      obj[k] = [obj[k], v];
	    }
	  }

	  return obj;
	};

	// Copyright Joyent, Inc. and other Node contributors.

	var stringifyPrimitive = function(v) {
	  switch (typeof v) {
	    case 'string':
	      return v;

	    case 'boolean':
	      return v ? 'true' : 'false';

	    case 'number':
	      return isFinite(v) ? v : '';

	    default:
	      return '';
	  }
	};

	var encode = function(obj, sep, eq, name) {
	  sep = sep || '&';
	  eq = eq || '=';
	  if (obj === null) {
	    obj = undefined;
	  }

	  if (typeof obj === 'object') {
	    return Object.keys(obj).map(function(k) {
	      var ks = encodeURIComponent(stringifyPrimitive(k)) + eq;
	      if (Array.isArray(obj[k])) {
	        return obj[k].map(function(v) {
	          return ks + encodeURIComponent(stringifyPrimitive(v));
	        }).join(sep);
	      } else {
	        return ks + encodeURIComponent(stringifyPrimitive(obj[k]));
	      }
	    }).join(sep);

	  }

	  if (!name) return '';
	  return encodeURIComponent(stringifyPrimitive(name)) + eq +
	         encodeURIComponent(stringifyPrimitive(obj));
	};

	var querystring = createCommonjsModule(function (module, exports) {

	exports.decode = exports.parse = decode;
	exports.encode = exports.stringify = encode;
	});

	/***************************************************************************************
	 * (c) 2017 Adobe. All rights reserved.
	 * This file is licensed to you under the Apache License, Version 2.0 (the "License");
	 * you may not use this file except in compliance with the License. You may obtain a copy
	 * of the License at http://www.apache.org/licenses/LICENSE-2.0
	 *
	 * Unless required by applicable law or agreed to in writing, software distributed under
	 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
	 * OF ANY KIND, either express or implied. See the License for the specific language
	 * governing permissions and limitations under the License.
	 ****************************************************************************************/



	// We proxy the underlying querystring module so we can limit the API we expose.
	// This allows us to more easily make changes to the underlying implementation later without
	// having to worry about breaking extensions. If extensions demand additional functionality, we
	// can make adjustments as needed.
	var reactorQueryString = {
	  parse: function(string) {
	    //
	    if (typeof string === 'string') {
	      // Remove leading ?, #, & for some leniency so you can pass in location.search or
	      // location.hash directly.
	      string = string.trim().replace(/^[?#&]/, '');
	    }
	    return querystring.parse(string);
	  },
	  stringify: function(object) {
	    return querystring.stringify(object);
	  }
	};

	/***************************************************************************************
	 * (c) 2017 Adobe. All rights reserved.
	 * This file is licensed to you under the Apache License, Version 2.0 (the "License");
	 * you may not use this file except in compliance with the License. You may obtain a copy
	 * of the License at http://www.apache.org/licenses/LICENSE-2.0
	 *
	 * Unless required by applicable law or agreed to in writing, software distributed under
	 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
	 * OF ANY KIND, either express or implied. See the License for the specific language
	 * governing permissions and limitations under the License.
	 ****************************************************************************************/

	var CORE_MODULE_PREFIX = '@adobe/reactor-';

	var modules = {
	  cookie: reactorCookie,
	  document: reactorDocument,
	  'load-script': reactorLoadScript,
	  'object-assign': reactorObjectAssign,
	  promise: reactorPromise,
	  'query-string': reactorQueryString,
	  window: reactorWindow
	};

	/**
	 * Creates a function which can be passed as a "require" function to extension modules.
	 *
	 * @param {Function} getModuleExportsByRelativePath
	 * @returns {Function}
	 */
	var createPublicRequire = function (getModuleExportsByRelativePath) {
	  return function (key) {
	    if (key.indexOf(CORE_MODULE_PREFIX) === 0) {
	      var keyWithoutScope = key.substr(CORE_MODULE_PREFIX.length);
	      var module = modules[keyWithoutScope];

	      if (module) {
	        return module;
	      }
	    }

	    if (key.indexOf('./') === 0 || key.indexOf('../') === 0) {
	      return getModuleExportsByRelativePath(key);
	    }

	    throw new Error('Cannot resolve module "' + key + '".');
	  };
	};

	/***************************************************************************************
	 * (c) 2017 Adobe. All rights reserved.
	 * This file is licensed to you under the Apache License, Version 2.0 (the "License");
	 * you may not use this file except in compliance with the License. You may obtain a copy
	 * of the License at http://www.apache.org/licenses/LICENSE-2.0
	 *
	 * Unless required by applicable law or agreed to in writing, software distributed under
	 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
	 * OF ANY KIND, either express or implied. See the License for the specific language
	 * governing permissions and limitations under the License.
	 ****************************************************************************************/

	var hydrateModuleProvider = function (
	  container,
	  moduleProvider,
	  debugController,
	  replaceTokens,
	  getDataElementValue,
	  settingsFileTransformer,
	  decorateWithDynamicHost
	) {
	  var extensions = container.extensions;
	  var buildInfo = container.buildInfo;
	  var environment = container.environment;
	  var propertySettings = container.property.settings;

	  if (extensions) {
	    var getSharedModuleExports = createGetSharedModuleExports(
	      extensions,
	      moduleProvider
	    );

	    Object.keys(extensions).forEach(function (extensionName) {
	      var extension = extensions[extensionName];
	      var extensionSettings = extension.settings;
	      if (Array.isArray(extension.filePaths)) {
	        extensionSettings = settingsFileTransformer(
	          extensionSettings,
	          extension.filePaths
	        );
	      }
	      var getExtensionSettings = createGetExtensionSettings(
	        replaceTokens,
	        extensionSettings
	      );

	      if (extension.modules) {
	        var prefixedLogger = logger.createPrefixedLogger(extension.displayName);
	        var getHostedLibFileUrl = createGetHostedLibFileUrl(
	          decorateWithDynamicHost,
	          extension.hostedLibFilesBaseUrl,
	          buildInfo.minified
	        );
	        var turbine = {
	          buildInfo: buildInfo,
	          environment: environment,
	          property: {
	            name: container.property.name,
	            id: container.property.id
	          },
	          getDataElementValue: getDataElementValue,
	          getExtensionSettings: getExtensionSettings,
	          getHostedLibFileUrl: getHostedLibFileUrl,
	          getSharedModule: getSharedModuleExports,
	          logger: prefixedLogger,
	          propertySettings: propertySettings,
	          replaceTokens: replaceTokens,
	          onDebugChanged: debugController.onDebugChanged,
	          get debugEnabled() {
	            return debugController.getDebugEnabled();
	          }
	        };

	        Object.keys(extension.modules).forEach(function (referencePath) {
	          var module = extension.modules[referencePath];
	          var getModuleExportsByRelativePath = function (relativePath) {
	            var resolvedReferencePath = resolveRelativePath(
	              referencePath,
	              relativePath
	            );
	            return moduleProvider.getModuleExports(resolvedReferencePath);
	          };
	          var publicRequire = createPublicRequire(
	            getModuleExportsByRelativePath
	          );

	          moduleProvider.registerModule(
	            referencePath,
	            module,
	            extensionName,
	            publicRequire,
	            turbine
	          );
	        });
	      }
	    });

	    // We want to extract the module exports immediately to allow the modules
	    // to run some logic immediately.
	    // We need to do the extraction here in order for the moduleProvider to
	    // have all the modules previously registered. (eg. when moduleA needs moduleB, both modules
	    // must exist inside moduleProvider).
	    moduleProvider.hydrateCache();
	  }
	  return moduleProvider;
	};

	/***************************************************************************************
	 * (c) 2017 Adobe. All rights reserved.
	 * This file is licensed to you under the Apache License, Version 2.0 (the "License");
	 * you may not use this file except in compliance with the License. You may obtain a copy
	 * of the License at http://www.apache.org/licenses/LICENSE-2.0
	 *
	 * Unless required by applicable law or agreed to in writing, software distributed under
	 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
	 * OF ANY KIND, either express or implied. See the License for the specific language
	 * governing permissions and limitations under the License.
	 ****************************************************************************************/

	var hydrateSatelliteObject = function (
	  _satellite,
	  container,
	  setDebugEnabled,
	  getVar,
	  setCustomVar
	) {
	  var customScriptPrefixedLogger = logger.createPrefixedLogger('Custom Script');

	  // Will get replaced by the directCall event delegate from the Core extension. Exists here in
	  // case there are no direct call rules (and therefore the directCall event delegate won't get
	  // included) and our customers are still calling the method. In this case, we don't want an error
	  // to be thrown. This method existed before Reactor.
	  _satellite.track = function (identifier) {
	    logger.log(
	      '"' + identifier + '" does not match any direct call identifiers.'
	    );
	  };

	  // Will get replaced by the Marketing Cloud ID extension if installed. Exists here in case
	  // the extension is not installed and our customers are still calling the method. In this case,
	  // we don't want an error to be thrown. This method existed before Reactor.
	  _satellite.getVisitorId = function () {
	    return null;
	  };

	  // container.property also has property settings, but it shouldn't concern the user.
	  // By limiting our API exposure to necessities, we provide more flexibility in the future.
	  _satellite.property = {
	    name: container.property.name,
	    id: container.property.id
	  };

	  _satellite.company = container.company;

	  _satellite.buildInfo = container.buildInfo;

	  _satellite.environment = container.environment;

	  _satellite.logger = customScriptPrefixedLogger;

	  /**
	   * Log a message. We keep this due to legacy baggage.
	   * @param {string} message The message to log.
	   * @param {number} [level] A number that represents the level of logging.
	   * 3=info, 4=warn, 5=error, anything else=log
	   */
	  _satellite.notify = function (message, level) {
	    logger.deprecation(
	      '_satellite.notify is deprecated. Please use the `_satellite.logger` API.'
	    );

	    switch (level) {
	      case 3:
	        customScriptPrefixedLogger.info(message);
	        break;
	      case 4:
	        customScriptPrefixedLogger.warn(message);
	        break;
	      case 5:
	        customScriptPrefixedLogger.error(message);
	        break;
	      default:
	        customScriptPrefixedLogger.log(message);
	    }
	  };

	  _satellite.getVar = getVar;
	  _satellite.setVar = setCustomVar;

	  /**
	   * Writes a cookie.
	   * @param {string} name The name of the cookie to save.
	   * @param {string} value The value of the cookie to save.
	   * @param {number} [days] The number of days to store the cookie. If not specified, the cookie
	   * will be stored for the session only.
	   */
	  _satellite.setCookie = function (name, value, days) {
	    var optionsStr = '';
	    var options = {};

	    if (days) {
	      optionsStr = ', { expires: ' + days + ' }';
	      options.expires = days;
	    }

	    var msg =
	      '_satellite.setCookie is deprecated. Please use ' +
	      '_satellite.cookie.set("' +
	      name +
	      '", "' +
	      value +
	      '"' +
	      optionsStr +
	      ').';

	    logger.deprecation(msg);
	    reactorCookie.set(name, value, options);
	  };

	  /**
	   * Reads a cookie value.
	   * @param {string} name The name of the cookie to read.
	   * @returns {string}
	   */
	  _satellite.readCookie = function (name) {
	    logger.deprecation(
	      '_satellite.readCookie is deprecated. ' +
	        'Please use _satellite.cookie.get("' +
	        name +
	        '").'
	    );
	    return reactorCookie.get(name);
	  };

	  /**
	   * Removes a cookie value.
	   * @param name
	   */
	  _satellite.removeCookie = function (name) {
	    logger.deprecation(
	      '_satellite.removeCookie is deprecated. ' +
	        'Please use _satellite.cookie.remove("' +
	        name +
	        '").'
	    );
	    reactorCookie.remove(name);
	  };

	  _satellite.cookie = reactorCookie;

	  // Will get replaced by the pageBottom event delegate from the Core extension. Exists here in
	  // case the customers are not using core (and therefore the pageBottom event delegate won't get
	  // included) and they are still calling the method. In this case, we don't want an error
	  // to be thrown. This method existed before Reactor.
	  _satellite.pageBottom = function () {};

	  _satellite.setDebug = setDebugEnabled;

	  var warningLogged = false;

	  Object.defineProperty(_satellite, '_container', {
	    get: function () {
	      if (!warningLogged) {
	        logger.warn(
	          '_satellite._container may change at any time and should only ' +
	            'be used for debugging.'
	        );
	        warningLogged = true;
	      }

	      return container;
	    }
	  });
	};

	/***************************************************************************************
	 * (c) 2021 Adobe. All rights reserved.
	 * This file is licensed to you under the Apache License, Version 2.0 (the "License");
	 * you may not use this file except in compliance with the License. You may obtain a copy
	 * of the License at http://www.apache.org/licenses/LICENSE-2.0
	 *
	 * Unless required by applicable law or agreed to in writing, software distributed under
	 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
	 * OF ANY KIND, either express or implied. See the License for the specific language
	 * governing permissions and limitations under the License.
	 ****************************************************************************************/

	function isArrayReference(str) {
	  return (
	    typeof str === 'string' &&
	    str.indexOf('[') !== -1 &&
	    str.indexOf(']') !== -1
	  );
	}
	function sanitizeArrayKey(pathStrSegment) {
	  return pathStrSegment.substr(
	    0,
	    // the name goes up to the start of the array bracket: 'someArrayName[]'
	    pathStrSegment.indexOf('[')
	  );
	}

	/**
	 * Recursive function to loop through settings and look for the setting to transform,
	 * which is the final entry within the pathSegments array. Alters settings in-place.
	 * @param {Array} pathSegments
	 * @param {Object} settings
	 * @param {Function} decorateWithDynamicHost
	 */
	function traverseIntoSettings(pathSegments, settings, decorateWithDynamicHost) {
	  // nothing to do
	  if (!pathSegments.length || !isPlainObject(settings)) {
	    return;
	  }

	  var currentKey = pathSegments[0];

	  // base case
	  if (pathSegments.length === 1) {
	    if (
	      settings.hasOwnProperty(currentKey) &&
	      typeof settings[currentKey] === 'string'
	    ) {
	      settings[currentKey] = decorateWithDynamicHost(settings[currentKey]);
	    }
	    return;
	  }

	  // still more work to do
	  var remainingPathSegments = pathSegments.slice(1);
	  if (isArrayReference(currentKey)) {
	    // 'someArrayReference[]' --> 'someArrayReference'
	    currentKey = sanitizeArrayKey(currentKey);
	    var settingsValue = settings[currentKey];
	    if (Array.isArray(settingsValue)) {
	      settingsValue.forEach(function (arrayEntryObject) {
	        return traverseIntoSettings(
	          remainingPathSegments,
	          arrayEntryObject,
	          decorateWithDynamicHost
	        );
	      });
	    }
	  } else {
	    // object case
	    return traverseIntoSettings(
	      remainingPathSegments,
	      settings[currentKey],
	      decorateWithDynamicHost
	    );
	  }
	}

	/**
	 * Returns a function that when called will attempt to traverse the passed in
	 * settings object to each file path and transform a relative URL to an absolute
	 * URL.
	 *
	 * @param isDynamicEnforced
	 * @param decorateWithDynamicHost
	 * @returns {(function(*=, *=, *=): (*))|*}
	 */
	var createSettingsFileTransformer = function (isDynamicEnforced, decorateWithDynamicHost) {
	  return function (settings, filePaths, moduleReferencePath) {
	    if (
	      !isDynamicEnforced ||
	      !isPlainObject(settings) ||
	      !Object.keys(settings).length ||
	      !Array.isArray(filePaths) ||
	      !filePaths.length
	    ) {
	      return settings;
	    }

	    // pull out the file paths by the module's reference path and loop over each urlPath
	    filePaths.forEach(function (filePathString) {
	      // The custom code action provides the ability to have the source code in the 'source'
	      // variable or to have an external file. Therefore, this module has 2 behaviors.
	      // It also does not provide a value of false for isExternal just as all other extensions
	      // that use fileTransform do not provide an isExternal variable check. Therefore, we need
	      // to treat Adobe's custom code action special, and don't augment the 'source' variable
	      // if isExternal is not also present.
	      var isAdobeCustomCodeAction = Boolean(
	        moduleReferencePath != null &&
	          /^core\/.*actions.*\/customCode\.js$/.test(moduleReferencePath)
	      );
	      if (
	        isAdobeCustomCodeAction &&
	        filePathString === 'source' &&
	        !settings.isExternal
	      ) {
	        return;
	      }

	      // modify the object in place
	      traverseIntoSettings(
	        filePathString.split('.'),
	        settings,
	        decorateWithDynamicHost
	      );
	    });

	    return settings;
	  };
	};

	/***************************************************************************************
	 * (c) 2017 Adobe. All rights reserved.
	 * This file is licensed to you under the Apache License, Version 2.0 (the "License");
	 * you may not use this file except in compliance with the License. You may obtain a copy
	 * of the License at http://www.apache.org/licenses/LICENSE-2.0
	 *
	 * Unless required by applicable law or agreed to in writing, software distributed under
	 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
	 * OF ANY KIND, either express or implied. See the License for the specific language
	 * governing permissions and limitations under the License.
	 ****************************************************************************************/

	// DYNAMIC URL













































	var _satellite = window._satellite;

	if (_satellite && !window.__satelliteLoaded) {
	  // If a consumer loads the library multiple times, make sure only the first time is effective.
	  window.__satelliteLoaded = true;

	  var container = _satellite.container;

	  // Remove container in public scope ASAP so it can't be manipulated by extension or user code.
	  delete _satellite.container;

	  /*
	    get rid of container.buildInfo decoration once deprecation is finished of
	    buildInfo.environment string
	   */
	  var buildInfo = reactorObjectAssign({}, container.buildInfo);
	  Object.defineProperty(buildInfo, 'environment', {
	    get: function () {
	      logger.deprecation(
	        'container.buildInfo.environment is deprecated.' +
	          'Please use `container.environment.stage` instead'
	      );
	      return container.environment.stage;
	    }
	  });
	  container.buildInfo = buildInfo;

	  var localStorage = getNamespacedStorage('localStorage');
	  var debugController = createDebugController(localStorage, logger);

	  var currentScriptSource = '';
	  if (reactorDocument.currentScript && reactorDocument.currentScript.getAttribute('src')) {
	    currentScriptSource = reactorDocument.currentScript.getAttribute('src');
	  }
	  var dynamicHostResolver;
	  try {
	    dynamicHostResolver = createDynamicHostResolver(
	      currentScriptSource,
	      Boolean(container.company.dynamicCdnEnabled),
	      container.company.cdnAllowList,
	      debugController
	    );
	  } catch (e) {
	    logger.warn('Please review the following error:');
	    throw e; // We don't want to continue allowing Turbine to start up if we detect an error in here
	  }

	  var settingsFileTransformer = createSettingsFileTransformer(
	    dynamicHostResolver.isDynamicEnforced,
	    dynamicHostResolver.decorateWithDynamicHost
	  );

	  var moduleProvider = createModuleProvider();

	  var replaceTokens;

	  var undefinedVarsReturnEmpty =
	    container.property.settings.undefinedVarsReturnEmpty;
	  var ruleComponentSequencingEnabled =
	    container.property.settings.ruleComponentSequencingEnabled;

	  var dataElements = container.dataElements || {};

	  var getDataElementDefinition = function (name) {
	    return dataElements[name];
	  };

	  // We support data elements referencing other data elements. In order to be able to retrieve a
	  // data element value, we need to be able to replace data element tokens inside its settings
	  // object (which is what replaceTokens is for). In order to be able to replace data element
	  // tokens inside a settings object, we need to be able to retrieve data element
	  // values (which is what getDataElementValue is for). This proxy replaceTokens function solves the
	  // chicken-or-the-egg problem by allowing us to provide a replaceTokens function to
	  // getDataElementValue that will stand in place of the real replaceTokens function until it
	  // can be created. This also means that createDataElementValue should not call the proxy
	  // replaceTokens function until after the real replaceTokens has been created.
	  var proxyReplaceTokens = function () {
	    return replaceTokens.apply(null, arguments);
	  };

	  var getDataElementValue = createGetDataElementValue(
	    moduleProvider,
	    getDataElementDefinition,
	    proxyReplaceTokens,
	    undefinedVarsReturnEmpty,
	    settingsFileTransformer
	  );

	  var customVars = {};
	  var setCustomVar = createSetCustomVar(customVars);

	  var isVar = createIsVar(customVars, getDataElementDefinition);

	  var getVar = createGetVar(
	    customVars,
	    getDataElementDefinition,
	    getDataElementValue
	  );

	  replaceTokens = createReplaceTokens(isVar, getVar, undefinedVarsReturnEmpty);

	  // Important to hydrate satellite object before we hydrate the module provider or init rules.
	  // When we hydrate module provider, we also execute extension code which may be
	  // accessing _satellite.
	  hydrateSatelliteObject(
	    _satellite,
	    container,
	    debugController.setDebugEnabled,
	    getVar,
	    setCustomVar
	  );

	  hydrateModuleProvider(
	    container,
	    moduleProvider,
	    debugController,
	    replaceTokens,
	    getDataElementValue,
	    settingsFileTransformer,
	    dynamicHostResolver.decorateWithDynamicHost
	  );

	  var notifyMonitors = createNotifyMonitors(_satellite);
	  var executeDelegateModule = createExecuteDelegateModule(
	    moduleProvider,
	    replaceTokens,
	    settingsFileTransformer
	  );

	  var getModuleDisplayNameByRuleComponent =
	    createGetModuleDisplayNameByRuleComponent(moduleProvider);
	  var logConditionNotMet = createLogConditionNotMet(
	    getModuleDisplayNameByRuleComponent,
	    logger,
	    notifyMonitors
	  );
	  var logConditionError = createLogConditionError(
	    getRuleComponentErrorMessage,
	    getModuleDisplayNameByRuleComponent,
	    logger,
	    notifyMonitors
	  );
	  var logActionError = createLogActionError(
	    getRuleComponentErrorMessage,
	    getModuleDisplayNameByRuleComponent,
	    logger,
	    notifyMonitors
	  );
	  var logRuleCompleted = createLogRuleCompleted(logger, notifyMonitors);

	  var evaluateConditions = createEvaluateConditions(
	    executeDelegateModule,
	    isConditionMet,
	    logConditionNotMet,
	    logConditionError
	  );
	  var runActions = createRunActions(
	    executeDelegateModule,
	    logActionError,
	    logRuleCompleted
	  );
	  var executeRule = createExecuteRule(evaluateConditions, runActions);

	  var addConditionToQueue = createAddConditionToQueue(
	    executeDelegateModule,
	    normalizeRuleComponentError,
	    isConditionMet,
	    logConditionError,
	    logConditionNotMet
	  );
	  var addActionToQueue = createAddActionToQueue(
	    executeDelegateModule,
	    normalizeRuleComponentError,
	    logActionError
	  );
	  var addRuleToQueue = createAddRuleToQueue(
	    addConditionToQueue,
	    addActionToQueue,
	    logRuleCompleted
	  );

	  var triggerRule = createTriggerRule(
	    ruleComponentSequencingEnabled,
	    executeRule,
	    addRuleToQueue,
	    notifyMonitors
	  );

	  var getSyntheticEventMeta = createGetSyntheticEventMeta(moduleProvider);

	  var initEventModule = createInitEventModule(
	    triggerRule,
	    executeDelegateModule,
	    normalizeSyntheticEvent,
	    getRuleComponentErrorMessage,
	    getSyntheticEventMeta,
	    logger
	  );

	  initRules(buildRuleExecutionOrder, container.rules || [], initEventModule);
	}

	// Rollup's iife option always sets a global with whatever is exported, so we'll set the
	// _satellite global with the same object it already is (we've only modified it).
	var src = _satellite;

	return src;

})();


